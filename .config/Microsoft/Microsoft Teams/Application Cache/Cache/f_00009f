(window.webPackBridgeJsonp=window.webPackBridgeJsonp||[]).push([[39],{"0bd73fb2923655c732c9":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("173e9cfb7855b90005c4"),a=n("edc85ca7e3cf7e290237"),r=n("574f6b7714533d85a391");function o(e,t,n,i){if(e&&t){var a=t-e;i[n]=a}}function c(e,t){return e&&t?t.endTime-t.startTime:0}t.addRumOneMarker=function(e){i.default.getRUMOneLogger().mark(e)},t.resetRumOneMarker=function(){var e=i.default.getRUMOneLogger();e.isRunning()||e.resetLogger()},t.writeRumOneData=function(){var e=i.default.getRUMOneLogger();if(e&&e.isRunning()){e.addExpectedControl("QuickEdit"),e.writeScenarioId("QuickEdit"),e.writePageTransitionType(a.default.none),e.collectW3CPerfTimings();var t=e.getMarkerTime("quickEditommand.click"),n=e.getMarkerTime("quickEdit.pltafterlayoutswitch.start"),l=e.getMarkerTime("quickEdit.plt.end");if(n&&l&&t){var s={},d=e.getMarkerTime("quickEdit.layoutManager.start"),u=e.getMarkerTime("quickEdit.layoutManager.end");d&&u&&o(d,u,"QuickEditLayoutManagerDuration",s),u&&n&&o(u,n,"QuickEditItemsViewCacheDuration",s);var f=e.getMarkerTime("quickEdit.loadExternalFiles.start"),m=e.getMarkerTime("quickEdit.loadExternalFiles.end");f&&m&&o(f,m,"QuickEditExternalJsLoadDuration",s);var b=e.getMarkerTime("quickEdit.serialization.start"),p=e.getMarkerTime("quickEdit.serialization.end");b&&p&&o(b,p,"QuickEditGridSerializationDuration",s);var g=e.getMarkerTime("quickEdit.gridrender.start"),v=e.getMarkerTime("quickEdit.gridrender.end");g&&v&&o(g,v,"QuickEditGridRenderDuration",s),o(t,l,"QuickEditPLTRenderDuration",s),o(n,l,"QuickEditPLTAfterLayoutSwitchDuration",s),window._spPageContextInfo&&(e.writeServerCorrelationId(window._spPageContextInfo.CorrelationId),e.collectSPClientFlights(window._spPageContextInfo)),e.writeControlPerformanceData(function(e,t,n){return new r.default(e,t,n,c,function(){return!isNaN(t)&&!isNaN(n)})}("QuickEdit",t,l)),e.writeEUPLBreakdown(JSON.stringify(s))}}}},"1b06ea838f66662d6498":function(e,t,n){"use strict";n.d(t,"a",function(){return i});var i=new(n("acd5f346751244db889c").a)("quickEdit")},"22cbe6295c263778c6ff":function(e,t,n){"use strict";n.r(t),n.d(t,"QuickEditActionExecutor",function(){return h});var i=n("64328bb588b46459132d"),a=n("275976081ce1abf67779"),r=n("44e6ed3c2eaab3f422db"),o=n("801b679406aabac77627"),c=n("bb1ad009e1d0371a2be6"),l=n("800956ab6ff71efe3834"),s=n("205cc11e505ee24c43a3"),d=n("1b06ea838f66662d6498"),u=n("a4060cda3c9c24220a4a"),f=n("ee92087a6ec1d0e9ecc9"),m=n("cf7af611ff1190650eec"),b=n("4e318b84c4772f9f58b9"),p=n("cc08c169973ba8efeefa"),g=n("0bd73fb2923655c732c9"),v=p.Killswitch.isActivated("8755e60f-68f8-4103-aa9e-be030b248b24","11/12/2019","Use rum one logging in quick edit."),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props.itemKey;return a.createElement(o.WithItemCache,null,function(n){var o=n.itemCache,p=n.dispatch,h=Object(l.getItemActionEngagement)(o,{itemKey:t,engagement:{name:"QuickEdit",isIntentional:!0}}),y=o.demandItem({deserizalizeKey:u.s},t).deserizalizeKey,_=y&&u.z.serialize({listKey:{webAbsoluteUrl:y.webAbsoluteUrl,listFullUrl:y.listFullUrl},viewKey:y.viewKey});return a.createElement(c.WithAction,{action:a.createElement(s.a,{layoutType:d.a})},function(t){var n=t.execute;return a.createElement(r.a,i.__assign({isAvailable:!0,onExecute:function(t){return i.__awaiter(e,void 0,void 0,function(){var e;return i.__generator(this,function(a){switch(a.label){case 0:return v||(g.resetRumOneMarker(),g.addRumOneMarker("quickEdit.layoutManager.start")),_&&p(Object(b.a)({items:(e={},e[_]=i.__assign({},f.g.pack(new m.Signal)),e)})),[4,n(t)];case 1:return a.sent(),v||g.addRumOneMarker("quickEdit.layoutManager.end"),[2]}})})}},h))})})},t}(a.PureComponent)},"24a2ec1a761638830c75":function(e,t,n){"use strict";var i=n("275976081ce1abf67779"),a=n("e480067f1004864ddd62"),r=n("d583ff3d9024b17ac27a"),o=n("94e728e81e928ae0c21b"),c=n("5b2d459d9e82cf3bf3bf"),l=n("a1b82108b0a8e1c90924"),s=n("6c9e49e3e750a4db3cb3"),d={root:"ms-TagItem",text:"ms-TagItem-text",close:"ms-TagItem-close",isSelected:"is-selected"},u=26;n.d(t,"b",function(){return m}),n.d(t,"a",function(){return b});var f=Object(a.a)(),m=function(e){var t=e.theme,n=e.styles,a=e.selected,r=e.disabled,c=e.enableTagFocusInDisabledPicker,l=e.children,s=e.className,d=e.index,u=e.onRemoveItem,m=e.removeButtonAriaLabel,b=e.title,p=void 0===b?"string"==typeof e.children?e.children:e.item.name:b,g=f(n,{theme:t,className:s,selected:a,disabled:r});return i.createElement("div",{className:g.root,role:"listitem",key:d,"data-selection-index":d,"data-is-focusable":(c||!r)&&!0},i.createElement("span",{className:g.text,"aria-label":p,title:p},l),i.createElement(o.IconButton,{onClick:u,disabled:r,iconProps:{iconName:"Cancel",styles:{root:{fontSize:"12px"}}},className:g.close,ariaLabel:m}))},b=Object(r.a)(m,function(e){var t,n,i,a,r=e.className,o=e.theme,f=e.selected,m=e.disabled,b=o.palette,p=o.effects,g=o.fonts,v=o.semanticColors,h=Object(c.R)(d,o);return{root:[h.root,g.medium,Object(c.Q)(o),{boxSizing:"content-box",flexShrink:"1",margin:2,height:u,lineHeight:u,cursor:"default",userSelect:"none",display:"flex",flexWrap:"nowrap",maxWidth:300,minWidth:0,borderRadius:p.roundedCorner2,color:v.inputText,background:!f||m?b.neutralLighter:b.themePrimary,selectors:(t={":hover":[!m&&!f&&{color:b.neutralDark,background:b.neutralLight,selectors:{".ms-TagItem-close":{color:b.neutralPrimary}}},m&&{background:b.neutralLighter},f&&!m&&{background:b.themePrimary}]},t[c.l]={border:"1px solid "+(f?"WindowFrame":"WindowText")},t)},m&&{selectors:(n={},n[c.l]={borderColor:"GrayText"},n)},f&&!m&&[h.isSelected,{color:b.white}],r],text:[h.text,{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",minWidth:30,margin:"0 8px"},m&&{selectors:(i={},i[c.l]={color:"GrayText"},i)}],close:[h.close,{color:b.neutralSecondary,width:30,height:"100%",flex:"0 0 auto",borderRadius:Object(s.a)(o)?p.roundedCorner2+" 0 0 "+p.roundedCorner2:"0 "+p.roundedCorner2+" "+p.roundedCorner2+" 0",selectors:{":hover":{background:b.neutralQuaternaryAlt,color:b.neutralPrimary},":active":{color:b.white,backgroundColor:b.themeDark}}},f&&{color:b.white,selectors:{":hover":{color:b.white,background:b.themeDark}}},m&&{selectors:(a={},a["."+l.a.msButtonIcon]={color:b.neutralSecondary},a)}]}},void 0,{scope:"TagItem"})},"2b59a0fb8f81c55fbaf0":function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return r});var i=n("264a40ebead766e0e784"),a=new i.ControlFacet("progressListGroupControl",{}),r=new i.ControlFacet("progressListControl",{groupControlHandler:Object(i.childControlOption)(a)})},"3904ebd1f9f5e501e8ce":function(e,t,n){"use strict";var i=n("64328bb588b46459132d"),a=n("275976081ce1abf67779"),r=n("958db96f3e5e5318cd6e"),o=n("e75d371903c4d34a93e5"),c=n("44e6ed3c2eaab3f422db"),l=n("c9764d34b3eb6a106977"),s=n("b0e26fa7634e6889091e"),d=n("8183bb1c55fccc7b597d"),u=n("71623759d63dd484b782"),f=n("37eb1a1a2ffc722b1c94"),m=n("661b65dcf8351e92fe44"),b=n("578e5017557fc66bb247"),p=n("5fef64b3561abb2ebffa"),g=n("aef40636031701b462d4"),v=n.n(g),h=n("6dec44e5485412f70439"),y=n("3bbe42d2eda1d0f5d766");function _(e){var t=this;return function(n){return i.__awaiter(t,void 0,void 0,function(){var t,a,r,o,c,l;return i.__generator(this,function(i){switch(i.label){case 0:return t=e.appId,a=e.itemKeys,r=e.getPreAuthUrl,o=e.driveUrl,r?(c=a.map(function(e){return n(Object(b.a)({fullUrl:p.canonicalUrlFacet},e)).fullUrl||""}),[4,n(Object(y.a)(o))]):[2,a.map(function(e){return n(Object(b.a)({vroomUrl:p.vroomUrlFacet},e)).vroomUrl||""})];case 1:return l=i.sent(),[2,new v.a({},{dataRequestor:n(h.b).dataRequestor}).getPreAuthUrls({appId:t,items:c,accessToken:l,driveUrl:o})]}})})}}var w=n("a5db57338f8274c3300c"),C=n("4986dedaa57d766e48bb")["_wLy2JS8/ZL6a9DW2sxTn5Q"],k=n("4fab54035bc77294dc42"),F=n("bb1ad009e1d0371a2be6");n.d(t,"a",function(){return O}),n.d(t,"b",function(){return x});var I=Object(r.createItemCacheComponent)(function(e,t){var n,r=t.itemKeys,o=t.action,b=t.isAvailable,p=t.itemKey,g=o.handler,v=g.appId,y=g.isPromoted,I="",O=p||(1===r.length?r[0]:""),x=e.demandItem({controlHandler:m.a,driveItemKey:k.a},O),S=x.controlHandler,E=x.driveItemKey;(I=E&&Object(h.d)(E)||"").indexOf("/v2.1")>-1&&(I=I.replace("/v2.1","/v2.0"));var A=m.a.evaluate(S)(e,{itemKey:O}).sharedPostData;n=A;var K=e.dispatch;if(!(b&&o.url&&n&&I))return null;var P=function(){return i.__awaiter(void 0,void 0,void 0,function(){var e,t,a;return i.__generator(this,function(c){switch(c.label){case 0:return e=window.open("","_blank"),[4,K(_({appId:v,itemKeys:r,getPreAuthUrl:!y,driveUrl:I})).catch(function(){})];case 1:return(t=c.sent())&&t.length>0&&e&&e.document?(e.opener=null,a=JSON.stringify(t||[]),Object(f.navigateViaPost)({url:o.url,postdata:i.__assign({},n,{appId:v,items:a}),document:e.document})):e&&e.close(),[2]}})})},T=y?Object(F.renderComponentOnExecute)(function(e){var t=e.resolve,n=e.reject,r=function(){return i.__awaiter(void 0,void 0,void 0,function(){return i.__generator(this,function(e){return n(new w.CancelError),[2]})})};return a.createElement(l.a,{dialogContentProps:{title:C.consentDialogTitle,onDismiss:r},hidden:!1},a.createElement("p",null,C.consentDialogMessage),a.createElement(s.a,null,a.createElement(d.a,{onClick:function(){return i.__awaiter(void 0,void 0,void 0,function(){return i.__generator(this,function(e){switch(e.label){case 0:return t(),[4,P()];case 1:return e.sent(),[2]}})})}},C.consentDialogContinueButton),a.createElement(u.a,{onClick:r},C.consentDialogCancelButton)))}):P;return a.createElement(c.a,i.__assign({isAvailable:b,onExecute:T},t))}),O=Object(o.withCurrentItem)()(I);function x(e,t,n){var i=e.file,a=e.folder,r=e.file&&e.file.extensions||void 0;return!0===n?!!a:!(!i||!t)&&(!r||-1!==r.indexOf(t.toLowerCase())||-1!==r.indexOf("*")||-1!==r.indexOf(".*"))}},"5e39fc4e09867bef67ce":function(e,t,n){"use strict";n.d(t,"a",function(){return c});var i=n("64328bb588b46459132d"),a=n("275976081ce1abf67779"),r=n("74910802e76ac3588bbf"),o=n("79e53ca9375b00e0be3a"),c=function(e){function t(t){var n=e.call(this,t)||this;return n._onFocusCapture=function(){var e=document.activeElement;e&&(n._div===e||Object(o.a)(n._div,e))&&n._keyboardManager.setIsActive(!0)},n._keyboardManager=new r.b({isDefault:!1}),n._keyboardManager&&n._keyboardManager.setIsActive(!0),n._parentContext=void 0,n._registerAsChild=!1,n}return i.__extends(t,e),t.prototype.componentWillUnmount=function(){this._keyboardManager&&(this._keyboardManager.setIsActive(!1),this._keyboardManager.dispose()),this._parentContext&&this._parentContext.registerActiveChild(!1)},t.prototype.render=function(){var e=this;return a.createElement(r.a.Consumer,null,function(t){var n=t.keyboardManager;return e._registerAsChild||(n.registerActiveChild(!0),e._registerAsChild=!0,e._parentContext=n),a.createElement("div",{ref:function(t){return e._div=t},onFocusCapture:e._onFocusCapture},a.createElement(r.a.Provider,{value:{keyboardManager:e._keyboardManager}},e.props.children))})},t}(a.PureComponent)},"7baee5760cf48380523c":function(e,t,n){"use strict";n.r(t);var i=n("64328bb588b46459132d"),a=n("275976081ce1abf67779"),r=n("9d410805f339fb056b8f"),o=n("c9764d34b3eb6a106977"),c=n("709c166948243d934acd"),l=n("fabc10f8a47ab6c08add"),s=n("033eaa4449bd36d1de5d"),d=n("a8c7165f33a4dc07ab0d");Object(d.loadStyles)([{rawString:".IFrameDialog_2772e31d .ms-Dialog-main{width:100%;max-width:600px}.IFrameDialog_2772e31d iframe{border:none;width:100%}\n"}]);var u=function(e){function t(t){var n=e.call(this,t)||this;return n._onClose=function(){n.setState({isOpen:!1})},n._iframeOnLoad=function(){var e=n.props.heightOffset;if(n._iframeElement&&n._iframeElement.contentDocument){var t=n._iframeElement.contentDocument.body.clientHeight;t<=0&&e&&(t=document.body.clientHeight*e),n._iframeElement.style.height=t+"px"}n.setState({isIFrameLoaded:!0}),n.props.onLoad&&n._iframeElement&&n.props.onLoad(n._iframeElement)},n.state={isOpen:!0,isIFrameLoaded:!1},n}return i.__extends(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.setState({isIFrameLoaded:!1})},t.prototype.render=function(){var e=this,t=this.props,n=t.url,d=(t.heightOffset,i.__rest(t,["url","heightOffset"])),u=this.state.isIFrameLoaded;return a.createElement(o.a,i.__assign({className:"IFrameDialog_2772e31d",hidden:!this.state.isOpen,type:c.a.close},d),a.createElement(r.a,null,!u&&a.createElement(l.a,{size:s.a.large}),a.createElement("iframe",{ref:function(t){return e._setupIFrameElementFunctions(t)},src:n,style:{display:u?"block":"none"},onLoad:this._iframeOnLoad})))},t.prototype._setupIFrameElementFunctions=function(e){if(e){var t=e;t.cancelPopUp=this._onClose,t.commitPopup=this._onClose}this._iframeElement=e},t}(a.Component),f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onDismiss=function(){t.props.resolve()},t}return i.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.title,n=e.linkLocation,i=e.launchBehaviorType;if(n&&void 0!==i){if("dialog"===i)return a.createElement(u,{url:n,heightOffset:.7,dialogContentProps:{title:t},onDismiss:this._onDismiss});"inPageNavigation"===i?window.open(n,"_self"):window.open(n,"_blank")}return this.props.resolve(),null},t}(a.PureComponent),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t.prototype.render=function(){var e=this.props.targetUrl;return e&&window.open(e,"_blank"),this.props.resolve(),null},t}(a.PureComponent),b=n("15ba69abe4e28f21b76e"),p=n("bab1d393317a3961d499"),g=n("958db96f3e5e5318cd6e"),v=n("44e6ed3c2eaab3f422db"),h=n("800956ab6ff71efe3834"),y=n("a4060cda3c9c24220a4a"),_=n("ee92087a6ec1d0e9ecc9"),w=n("0c7caf9d51779868234c"),C=n("5fef64b3561abb2ebffa"),k=n("fe00c914fafa817f5120"),F=Object(g.connectToItemCache)(function(e,t){var n=t.itemKey,a=e.demandItem({key:y.D,itemUrl:C.vroomUrlFacet},n),r=a.key,o=a.itemUrl,c="",l="",s="",d=!1;if(r&&o){var u=y.K.serialize({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl}),f=e.demandItem({driveUrl:_.p},u).driveUrl;if(f){var m=Object(w.a)(f);if(m){c=m.driveId||"";var b=e.demandItemFacet(C.fileNameFacet,n);b&&(s=b.name,(m=Object(w.a)(o))&&(d=!!(l=m.itemId||"")))}}}return i.__assign({isAvailable:d,onExecute:d&&r?function(){return i.__awaiter(void 0,void 0,void 0,function(){var e;return i.__generator(this,function(t){return e=Object(k.a)("spo:"+r.webAbsoluteUrl),window.open("https://fluidpreview.office.net/p/"+e+"/"+c+"/"+l+"/"+encodeURIComponent(s)),[2]})})}:void 0},Object(h.getItemActionEngagement)(e,{itemKey:n,engagement:{name:"OpenInBFile",isIntentional:!0}}))})(v.a),I=n("e75d371903c4d34a93e5"),O=n("4e318b84c4772f9f58b9"),x=n("fdbcb7664c17b5b4e4d9"),S=n("dafd9db62310f1337c17"),E=n("bb1ad009e1d0371a2be6"),A=n("5fa66f575765619863ae"),K=n("d27387ede93a2620cbf6"),P=Object(g.createItemCacheComponent)(function(e,t){var n=t.itemKey,r=t.itemSetKey,o=t.viewId,c=t.currentDerivedView,l=e.demandItemFacet(y.D,n);if(!l)return null;var s=l.webAbsoluteUrl,d=l.listFullUrl,u=e.demandItemFacet(y.s,r),f=y.s.serialize({webAbsoluteUrl:s,listFullUrl:d,rootFolder:u&&u.rootFolder||"",viewKey:{viewId:o}}),m=c&&y.X.serialize({viewId:c.id}),b=e.isItemFacetResolved(_.Pb,m)?e.demandItemFacet(_.Pb,m):void 0,p=Object(h.getItemActionEngagement)(e,{itemKey:n,engagement:{name:"SwitchView",isIntentional:!0}}),g=e.dispatch,w=Object(E.evaluateAction)(e,a.createElement(A.a,{itemKey:f}));return a.createElement(E.WithAction,{action:w},function(e){var t=e.isAvailable,r=e.execute;return a.createElement(v.a,i.__assign({isAvailable:t,isToggled:c?o===c.id:""===o,onExecute:function(e){return i.__awaiter(void 0,void 0,void 0,function(){var t,a,o;return i.__generator(this,function(l){switch(l.label){case 0:return g(Object(O.a)({items:i.__assign({},m?(t={},t[m]=i.__assign({},_.Qb.pack(!1),b&&c&&c.isDirty()?i.__assign({},_.j.pack(new S.a(b))):{}),t):{},n?(a={},a[f]=i.__assign({},x.e.pack({itemKey:n})),a):{})})),m&&c&&c.isDirty()&&g(Object(K.b)({items:(o={},o[m]=[_.Pb,_.j],o)})),[4,r(e)];case 1:return l.sent(),[2]}})})}},p))})}),T=Object(I.withCurrentItem)()(P),j=n("6946c0f0887243183999"),D=Object(g.connectToItemCache)(function(e,t){var n=t.currentDerivedView,a=t.listViewSetKey,r=!1,o=a&&y.K.serialize(a);if(a&&n){var c=e.demandItemFacet(_.nb,o);r=!(!(c&&c.permissions&&c.permissions.manageLists&&n&&n.id)||n.isPersonal||n.isDefault)}return i.__assign({isAvailable:r},Object(h.getItemActionEngagement)(e,{itemKey:o,engagement:{name:"SetDefaultView",isIntentional:!0}}))},function(e,t){var n=t.currentDerivedView,a=t.listViewSetKey;return{onExecute:n?function(){return i.__awaiter(void 0,void 0,void 0,function(){var t,r;return i.__generator(this,function(i){return e(Object(j.a)({items:(t={},t[y.L.serialize(a)]={views:(r={},r[n.id]={isDefault:!0},r)},t)})),[2]})})}:void 0}})(v.a),U=n("de961921ff36ea23aa69"),V=n("b7cf87cb13cd9c750b2f"),R=n("bd2835d22f85a2b6d99d"),N=n("b0e26fa7634e6889091e"),L=n("0740e1ac327ca777c207"),M=n("7d61c34bb660b33148a0"),z=n("8183bb1c55fccc7b597d"),B=n("82a5b752ca799aba4856"),Q=n("4986dedaa57d766e48bb")["_0aHe/eu0Mohgb+N1X6YOkA"],W=n("9550830cbfda1b20b739");Object(d.loadStyles)([{rawString:".saveViewDialogTextField_88ee8f33{margin-bottom:8px}.saveViewDialogCheckbox_88ee8f33{min-height:36px}.saveViewDialogSpinner_88ee8f33{display:inline-block;padding-bottom:7px;vertical-align:bottom}\n"}]);var q=function(e){function t(t){var n=e.call(this,t)||this;return n._onCheckboxChanged=function(e,t){n.setState({isPublicView:!!t})},n._onNameRef=function(e){e&&(e.focus(),e.select())},n._onNameChanged=function(e,t){void 0===t&&(t="");var i=n.props.validator;n.setState(function(){return{viewTitle:t,errorMessage:i?i(t):void 0}})},n._onClickAction=function(){n.setState({showSpinner:!0}),n.props.onContinue({viewTitle:n.state.viewTitle,isPublicView:n.state.isPublicView}).catch(function(e){n.setState({showSpinner:!1,errorMessage:e&&e.message})})},n._onKeyPress=function(e){13===e.which&&n._onClickAction()},n._initialViewTitle=t.viewTitle,n._initialIsPublicView=t.isPublicView,n.state={viewTitle:n._initialViewTitle,isPublicView:n._initialIsPublicView},n}return i.__extends(t,e),t.prototype.render=function(){var e=this.state,t=e.viewTitle,n=e.errorMessage,i=e.showSpinner;return a.createElement(o.a,{isOpen:!0,title:Q.SaveAs,onDismiss:this.props.onCancel},a.createElement(L.a,{label:Q.SaveViewExplanation,componentRef:this._onNameRef,value:t,onChange:this._onNameChanged,errorMessage:n,onKeyPress:this._onKeyPress,className:"saveViewDialogTextField_88ee8f33"}),a.createElement(M.a,{label:Q.SaveViewMakePublic,className:"saveViewDialogTextField_88ee8f33",disabled:t===this._initialViewTitle,defaultChecked:this._initialIsPublicView,onChange:this._onCheckboxChanged}),a.createElement(N.a,null,a.createElement(z.a,{disabled:!t||!!n||i,onClick:this._onClickAction,text:Q.SaveViewCommit}),i&&a.createElement(l.a,{size:s.a.medium,className:"saveViewDialogSpinner_88ee8f33"}),a.createElement(B.a,{text:W.a.cancelActionText,onClick:this.props.onCancel})))},t}(a.PureComponent),G=n("a5db57338f8274c3300c"),X=n("85bfca0cd3bb87373c39"),H=n("d6e6a1e726db94fe6759"),J=n("578e5017557fc66bb247"),Z=n("bdda16acc41d10fb2021"),Y=n("eb7a0bfa0cd4073aa989"),$=n("a083584f8eeab8771a10"),ee=n("5f6c4af8cb56376acb4d");var te=n("4fab947ce2688fcc8eb5"),ne=n("d502eee49001d6af3403"),ie=new te.a("saveViewProgressBatch");var ae=Object(ne.a)()(T),re=function(e){function t(t){var n=e.call(this,t)||this;return n._onComplete=function(){n.setState({isCompleted:!0}),n.props.onViewSaved&&n.props.onViewSaved(),n.props.resolve()},n._onContinue=function(e){return i.__awaiter(n,void 0,void 0,function(){var t,n,a,r,o,c,l,s,d,u,f,m,b,p,g=this;return i.__generator(this,function(v){switch(v.label){case 0:return a=e.viewTitle,r=e.isPublicView,o=this.props,c=o.listViewSetKey,l=o.itemCacheDispatch,s=o.itemSetKey,d=o.itemsScopeItemKey,u=o.currentViewKey,f=this.state.progressItemKey,m=l(Object(J.a)({currentDerivedView:_.j},u)).currentDerivedView,b=m&&m.title!==a,p=l(Object(J.a)({deserializedSetKey:y.s},s)).deserializedSetKey,b&&p&&m?[4,l(Object(X.a)({webAbsoluteUrl:p.webAbsoluteUrl,listFullUrl:p.listFullUrl}))]:[3,2];case 1:if(v.sent().some(function(e){return e.serverView.Title===a}))throw new Error(H.format(Q.SaveViewErrorCannotOverwrite,a));return[2,l(Object(R.a)({items:(t={},t[c]={views:(n={},n[a]={itemSetKey:s,isPublic:r,sourceView:m,progressItemKey:f},n)},t)})).then(function(){var e=l(Object(J.a)({createdViewKey:y.X},f)).createdViewKey;e&&g.setState({createdViewId:e.viewId,showDialog:!1})})];case 2:return[2,l((h={itemsScopeItemKey:d,listViewSetKey:c,itemSetKey:s,currentViewKey:u},function(e){var t,n,a=h.itemsScopeItemKey,r=h.listViewSetKey,o=h.itemSetKey,c=h.currentViewKey,l=e(Object(J.a)({childItems:x.a,parentItem:x.e,deserializedItemSetKey:y.s},o)),s=l.childItems,d=l.parentItem,u=l.deserializedItemSetKey;return e(Object($.a)({items:(t={},t[r]={views:(n={},n[c]={itemSetKey:o},n)},t)})).then(function(){var t,n;if(u){var r=y.s.serialize(i.__assign({},u,{filterParams:void 0,sortFieldKey:void 0,sortAscending:void 0,groupByFieldKey:void 0})),o=e(Object(J.a)({filterOptionSets:x.c},r)).filterOptionSets;if(o&&u.filterParams){var l={};for(var f in o)o.hasOwnProperty(f)&&(l[o[f]]=!0);e(Object(Z.a)({items:l}))}var m=new ee.a;m.resolveItems({items:(t={},t[r]=i.__assign({},s?x.a.pack(s):{},d?x.e.pack(d):{}),t[c]=i.__assign({},_.Qb.pack(!1)),t)}),e(m.execute()),e(Object(K.b)({items:(n={},n[c]=[_.Pb,_.j],n[r]=[x.a],n)})),e(Object(Y.a)({itemsScopeItemKey:a,currentItemKey:r}))}})})).then(function(){g.props.onViewSaved&&g.props.onViewSaved(),g.props.resolve()})]}var h})})},n._onCancel=function(){n.props.reject(new G.CancelError)},n.state={showDialog:!0,progressItemKey:ie.serializeNext()},n}return i.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.viewTitle,n=e.isPublicView,i=e.itemSetKey,r=this.state,o=r.showDialog,c=r.createdViewId,l=r.isCompleted;return o?a.createElement(q,{viewTitle:t,isPublicView:n,onContinue:this._onContinue,onCancel:this._onCancel}):!l&&c?a.createElement(ae,{viewId:c,currentDerivedView:void 0,onComplete:this._onComplete,itemSetKey:i}):null},t}(a.Component),oe=n("264a40ebead766e0e784"),ce=new oe.ControlFacet("saveViewActionControl"),le=n("898cf555a137d8981412"),se=n("784240ae17271fdef466"),de=Object(V.a)()(Object(g.connectToItemCache)()(re)),ue=Object(g.createItemCacheComponent)(function(e,t){var n=t.currentViewKey,r=Object(U.a)(e),o=Object(le.a)(e).itemsScopeItemKey,c=!1,l=e.demandItemFacet(y.s,r),s=e.demandItemFacet(_.j,n),d=e.demandItemFacet(ce,r),u=ce.evaluate(d)(e,{viewKey:n}).onViewSaved;if(l&&s){var f=y.K.serialize({webAbsoluteUrl:l.webAbsoluteUrl,listFullUrl:l.listFullUrl}),m=e.demandItemFacet(_.nb,f);c=!!(m&&s&&134217728!==s.viewType&&m.permissions&&(m.permissions.managePersonalViews||m.permissions.manageLists))}if(!s||!r||!o)return null;var b=Object(E.renderComponentOnExecute)(function(e){return a.createElement(se.a,{itemsScopeItemKey:o},a.createElement(de,i.__assign({},e,t,{itemSetKey:r,viewTitle:s.title,isPublicView:!s.isPersonal,onViewSaved:u})))},{scope:"global"});return a.createElement(v.a,i.__assign({isAvailable:c,onExecute:b},Object(h.getItemActionEngagement)(e,{itemKey:r,engagement:{name:"SaveView",isIntentional:!0}})))}),fe=n("0c6179dbfb538858488e"),me=n("dedce7a34d3ecbf5e40f");Object(d.loadStyles)([{rawString:"[dir='ltr'] .filterPanelClearAllButton_7e6021fe{margin-left:8px}[dir='rtl'] .filterPanelClearAllButton_7e6021fe{margin-right:8px}.filterPanelRoot_7e6021fe .ms-Panel-content{padding-bottom:0px}.filterPanelFooter_7e6021fe{display:-webkit-box;display:-ms-flexbox;display:flex}.filterPanelSuggestionsNone_7e6021fe{text-align:center;color:#797775;font-size:12px;line-height:30px}.filterPanelSuggestionItem_7e6021fe{padding:4px 6px}.peoplePickerRoot_7e6021fe{margin-bottom:12px}.filterPickerRoot_7e6021fe{margin-bottom:8px}\n"}]);var be,pe="filterPanelSuggestionsNone_7e6021fe",ge=n("4986dedaa57d766e48bb")._9brNxRcM2rAYjZAjORvLGw;!function(e){e[e.user=0]="user",e[e.fileType=1]="fileType",e[e.choice=2]="choice"}(be||(be={}));var ve=n("d7d144a7313c4e633cfa"),he=n("814049e387c5d777c75a"),ye=n("8a3684f41d44e5d9df56"),_e=n("cdb7d49c64b43d532424"),we=n("aba02007ddf17c261fe1"),Ce=n("adf6e81d5ecf9ea16532"),ke=n("192917b18135005f9dfd");Object(d.loadStyles)([{rawString:".checkboxRoot_d75c60c9{padding:8px 0;font-size:14px}.checkboxLabelRoot_d75c60c9{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}[dir='ltr'] .checkboxLabelRoot_d75c60c9{margin-left:4px}[dir='rtl'] .checkboxLabelRoot_d75c60c9{margin-right:4px}[dir='ltr'] .fileTypeCheckboxLabel_d75c60c9{margin-left:8px}[dir='rtl'] .fileTypeCheckboxLabel_d75c60c9{margin-right:8px}.userCheckboxRoot_d75c60c9{padding:4px 0}.userCheckboxRoot_d75c60c9 .ms-Persona-details{padding:0 8px}\n"}]);var Fe="checkboxRoot_d75c60c9",Ie="userCheckboxRoot_d75c60c9",Oe=n("222b3f6c82513e602ebc"),xe=function(e){function t(t){var n=e.call(this,t)||this;return n._onRenderCell=function(e,t){if(void 0===t&&(t=0),!e)return null;var r=n.props.onRenderCell,o=n.state.keysChecked,c=i.__assign({},e,{checked:o.indexOf(e.key)>=0,index:t}),l=function(e){var t;if(!e)return null;var i=e.key,r=e.checked,o=e.label,c=e.className,l=e.renderType,s=e.styleOverride;return a.createElement("div",{key:i,"data-automationid":"Checkbox","data-is-checked":r,"data-checked-label":o},a.createElement(M.a,{key:i,label:o,onRenderLabel:Ae(e),styles:s,className:Object(ve.css)(Fe,(t={},t[""+Ie]=l===be.user,t),c),checked:r,onChange:n._onToggleCheckbox.bind(null,e)}))};return r?r(c,l):l(c)},n._onToggleCheckbox=function(e,t,i){var a=n.props,r=a.checkedKeys,o=a.onChange;void 0===r&&n.setState(function(t){var n=t.keysChecked;if(i)n.push(e.key);else{var a=n.indexOf(e.key);a>=0&&n.splice(a,1)}return{keysChecked:n}}),o&&o(t,e,!!i)},n._warnMutuallyExclusive({checkedKeys:"defaultCheckedKeys"}),n.state={keysChecked:(void 0!==t.checkedKeys?t.checkedKeys:t.defaultCheckedKeys)||[]},n.root=void 0,n.focusZone=void 0,n}return i.__extends(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){void 0!==e.checkedKeys&&this.setState({keysChecked:e.checkedKeys})},t.prototype.render=function(){var e=this.props,t=e.ariaLabel,n=e.options,i=e.className;return a.createElement("div",{ref:this._resolveRef("root"),role:"group",className:i,"data-automationid":"CheckboxGroup","aria-label":t},n&&n.length>0&&a.createElement(r.a,{componentRef:this._resolveRef("focusZone"),direction:ye.a.vertical,isCircularNavigation:!0},a.createElement(Oe.a,{items:n,onRenderCell:this._onRenderCell})))},t.defaultProps={options:[]},t}(he.a),Se=function(e){return e?a.createElement(_e.a,{primaryText:e.label,imageUrl:e.imageSrc,size:we.c.size28,className:"checkboxLabelRoot_d75c60c9"}):null},Ee=function(e){return e?a.createElement("div",{className:"checkboxLabelRoot_d75c60c9"},a.createElement(Ce.a,i.__assign({},Object(ke.a)({extension:e.label,size:16}))),a.createElement("span",{className:"fileTypeCheckboxLabel_d75c60c9"},e.label)):null};function Ae(e){var t=e.onRenderLabel,n=e.renderType;t||(n===be.user?t=Se:n===be.fileType&&(t=Ee));var i=t;return function(t,n){return i?i(e):n&&t?n(t):null}}var Ke=n("5e39fc4e09867bef67ce"),Pe=n("0bdd75e78dcb9cfa71d6"),Te=n("a48ac27d6d227e44e1a5"),je=n("291bfd7ca3e0ca52b70d"),De=n("2c26c2606b3bd88ca274"),Ue=n("cc08c169973ba8efeefa"),Ve=De.b,Re=ge.ApplyFilterButtonAriaDescription,Ne=ge.ApplyFilterButtonLabel,Le=ge.ClearAllButtonLabel,Me=function(e){return H.format(ge.ClearAllButtonAriaDescription,e)},ze=function(e){function t(t){var n=e.call(this,t)||this;return n._onSelectedSuggestionOptionChange=function(e){n.setState(function(t){for(var n=-1,i=0;i<t.filterOptionSet.length;i++)if(t.filterOptionSet[i].value===e.value){n=i;break}return{filterOptionSet:-1===n?t.filterOptionSet.concat([e]):t.filterOptionSet,checkedFilterValues:-1===t.checkedFilterValues.indexOf(e.value)?t.checkedFilterValues.concat([e.value]):t.checkedFilterValues}})},n._onSelectedPersonasChange=function(e){var t=e&&e.length>0&&e[e.length-1];if(t){var i={display:t.name,value:t.name};n._onSelectedSuggestionOptionChange(i)}},n._onRenderNoResultFound=function(){var e=n.props.filterPickerProps,t=!e||!e.pageContextForPicker||!Object(Ue.getKillSwitch)(e.pageContextForPicker).isActivated("74450E1A-074B-45F1-82F4-FB3FBE834B78","10/15/2019","Use contains to get filter suggestion");return a.createElement("div",{className:pe},Object(H.format)(t?ge.NoResultFoundUsingContains:ge.NoResultFound,n._currentText))},n._onResolveSuggestions=function(e,t){n._currentText=e;var i=n.props.filterPickerProps;return i&&i.getFilterSuggestions?i.getFilterSuggestions(n.props.fieldInternalName,n.props.mappedColumnFieldType,e):[]},n._onSelectedSuggestionsChange=function(e){var t=e&&e.length>0&&e[e.length-1];if(t){var i={display:t.display,value:t.value};n._onSelectedSuggestionOptionChange(i)}},n._onCheckboxGroupChange=function(e,t,i){n.setState(function(e){var n=e.checkedFilterValues;if(i)n=n.concat([t.key]);else{var a=n.indexOf(t.key);a>-1&&(n=n.slice(0,a).concat(n.slice(a+1)))}return{checkedFilterValues:n}})},n._onClearAllClick=function(){n.setState({checkedFilterValues:[]})},n._currentText="",n.state={filterOptionSet:t.filterOptionSet,checkedFilterValues:t.checkedFilterValues},n}return i.__extends(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.props.isLoading&&!e.isLoading&&this.setState({filterOptionSet:e.filterOptionSet,checkedFilterValues:e.checkedFilterValues})},t.prototype.render=function(){var e=this,t=this.props,n=t.columnName,r=t.onClose,o=t.mappedColumnFieldType,c=(t.fieldInternalName,t.isLoading),s=t.applyFiltersAction,d=this.state,u=d.checkedFilterValues,f=d.filterOptionSet,m=f?function(e,t,n){var i=[];e&&e.length&&(i=e.map(function(e){var n={key:e.value,label:e.display};return t===je.a.User?n.renderType=be.user:t===je.a.FileIcon&&(n.renderType=be.fileType),n}));return i}(f,o):void 0,b=function(e){return H.format(ge.FilterSelectPanelTitle,e)}(n),p=u.length?Object(H.format)(ge.SectionTitleWithNumber,b,u.length):b;return a.createElement(Ke.a,null,a.createElement(fe.a,{"data-automationid":"FilterPanel",className:"filterPanelRoot_7e6021fe",isOpen:!0,type:me.a.smallFixedFar,headerText:p,onDismiss:r,closeButtonAriaLabel:ge.closeButtonAriaLabel,onRenderFooterContent:c?void 0:function(){return a.createElement("div",{className:"filterPanelFooter_7e6021fe"},a.createElement(E.WithAction,{action:s({filterOptionSet:f,checkedFilterKeys:u})},function(t){var n=t.isAvailable,r=t.execute;return a.createElement(z.a,{"data-automationid":"FilterPanel-Apply",onClick:function(){return i.__awaiter(e,void 0,void 0,function(){return i.__generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,r({})];case 1:return e.sent(),this.props.onComplete(),[3,3];case 2:return e.sent(),[3,3];case 3:return[2]}})})},disabled:!n,ariaDescription:Re,text:Ne})}),a.createElement(B.a,{className:"filterPanelClearAllButton_7e6021fe","data-automationid":"FilterPanel-ClearAll",onClick:e._onClearAllClick,ariaDescription:Me(n),text:Le}))}},c?a.createElement(l.a,null):a.createElement(a.Fragment,null,this._renderFilterPicker(b),a.createElement(xe,{ariaLabel:b,options:m,checkedKeys:u,onChange:this._onCheckboxGroupChange}))))},t.prototype._onRenderItem=function(){return null},t.prototype._getTextFromItem=function(e){return e.display},t.prototype._onRenderSuggestionsItem=function(e){return a.createElement("div",{className:"filterPanelSuggestionItem_7e6021fe"},e.display)},t.prototype._renderFilterPicker=function(e){var t=this.props,n=t.mappedColumnFieldType,i=t.filterPickerProps;return n===je.a.User&&i&&i.peoplePickerDataSource?a.createElement(Pe.PeoplePicker,{className:"peoplePickerRoot_7e6021fe",context:i.pageContextForPicker,peoplePickerType:Te.PeoplePickerType.listBelow,dataSource:i.peoplePickerDataSource,onRenderItem:this._onRenderItem,onSelectedPersonasChange:this._onSelectedPersonasChange,inputProps:{placeholder:ge.PeoplePickerPlaceholder,"aria-label":e},noResultsFoundText:ge.NoResults}):n===je.a.Text||n===je.a.Title?a.createElement(Ve,{className:"filterPickerRoot_7e6021fe",onResolveSuggestions:this._onResolveSuggestions,getTextFromItem:this._getTextFromItem,onRenderItem:this._onRenderItem,onRenderSuggestionsItem:this._onRenderSuggestionsItem,pickerSuggestionsProps:{onRenderNoResultFound:this._onRenderNoResultFound},inputProps:{placeholder:ge.FilterPickerPlaceholder,"aria-label":e},onChange:this._onSelectedSuggestionsChange}):null},t}(a.PureComponent);var Be,Qe,We=n("801b679406aabac77627"),qe=n("5004fc2f3329649ad54d"),Ge=new oe.ControlFacet("filterActionControl");n("909f685fd22f763fd12f"),n("8f87efd00acf85bf14b3"),n("95a42c24c7003bcd6d09");!function(e){e[e.user=0]="user",e[e.date=1]="date",e[e.fileType=2]="fileType",e[e.choice=3]="choice",e[e.hierarchy=4]="hierarchy"}(Be||(Be={})),function(e){e[e.none=0]="none",e[e.last3Months=1]="last3Months",e[e.last30Days=2]="last30Days",e[e.last7Days=3]="last7Days",e[e.yesterday=4]="yesterday",e[e.today=5]="today",e[e.tomorrow=6]="tomorrow",e[e.next7Days=7]="next7Days",e[e.next30Days=8]="next30Days",e[e.next3Months=9]="next3Months",e[e.nextYear=10]="nextYear"}(Qe||(Qe={}));n("04e1b5937bfb21936f94");var Xe=n("2f47541efad2ac2f992e");n("aaeb3ce0010e719a1043"),n("ed82754416f168d14460"),n("cfd15bb212a873934c4b");function He(e,t){var n,i=t.fieldName,a=t.fieldType,r=t.filterValue,o=t.operator,c=new S.a(e);switch(c.updateGroupBy(null),a){case je.a.User:n="Lookup";break;case je.a.FileIcon:n="Computed";break;case je.a.Choice:n="Choice";break;case je.a.DateTime:n="DateTime";break;default:n="Text"}var l={fieldName:i,values:[r],type:n,operator:o,id:i};return Xe.a(c,l),c.getEffectiveViewXml()}var Je=n("5e2d26706bb97efeb013"),Ze={ODB:1352},Ye=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.itemSetKey,r=t.filterableSet,o=t.internalName,c=t.filterOptionSet,l=t.fieldType,s=t.checkedFilterKeys;return a.createElement(We.WithItemCache,null,function(t){var d=t.itemCache,u=t.dispatch;if(!(o&&r&&c&&l))return a.createElement(E.WithAction,null);for(var f=[],m={},b=0,p=c;b<p.length;b++){var g=p[b];m[g.value]=g}for(var w=0,C=s;w<C.length;w++){var k=C[w];m[k]&&f.push(m[k].value)}var F,I=r.getFilteredItemSetKey({filterField:o,filterValues:f,filterType:l,useLookupId:!1}),S=d.demandItemFacet(y.s,I),K=d.demandItemFacet(x.e,n),P=d.demandItemFacet(y.s,n),T=P&&P.viewKey&&y.X.serialize(P.viewKey);P&&(F=d.demandItemFacet(_.qc,y.Q.serialize({webAbsoluteUrl:P.webAbsoluteUrl,listFullUrl:P.listFullUrl})));var j,D=Object(qe.a)(d,{feature:Ze,pageContext:F});if(D){var U=d.demandItemFacet(Ge,n),V=Ge.evaluate(U)(d,{viewKey:T}).onFilter;j=V}var R=Object(h.getItemActionEngagement)(d,{itemKey:n,engagement:{name:"ApplyFilters",isIntentional:!0}});return a.createElement(E.WithAction,{action:a.createElement(A.a,{itemKey:I})},function(t){var n=t.isAvailable,r=t.execute;return a.createElement(v.a,i.__assign({isAvailable:n,onExecute:function(t){return i.__awaiter(e,void 0,void 0,function(){var e,n,a;return i.__generator(this,function(o){switch(o.label){case 0:return D&&j&&(a=S&&S.filterParams,u(j({filterParams:a}))),u(Object(O.a)({items:i.__assign((e={},e[I]=i.__assign({},x.e.pack(K)),e),T?(n={},n[T]=i.__assign({},_.Qb.pack(!0)),n):{})})),[4,r(t)];case 1:return o.sent(),[2]}})})}},R))})})},t}(a.PureComponent),$e=Object(V.a)()(Object(g.connectToItemCache)(function(e,t){var n=t.columnKey,r=t.itemSetKey,o=e.demandItem({fieldType:_.P,mappedColumnFieldType:_.sb,internalName:_.cb},n),c=o.fieldType,l=o.mappedColumnFieldType,s=o.internalName,d=e.demandItem({deserializedSetKey:y.s,filterableSet:_.bc,filterOptionSets:x.c},r),u=d.deserializedSetKey,f=d.filterableSet,m=d.filterOptionSets,b=u&&e.demandItemFacet(_.qc,y.Q.serialize({webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl})),p=u&&e.demandItemFacet(_.sc,y.R.serialize({webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl})),g=e.demandItemFacet(_.Q,m&&m[n]),v=e.isItemFacetResolved(_.Q,m&&m[n]),h=f&&g&&f.appliedFilters&&s&&f.appliedFilters[s]?f.appliedFilters[s].values:[],w=u&&u.viewKey&&y.X.serialize(u.viewKey),C=w&&e.demandItemFacet(_.j,w),k=e.dispatch,F="User"===c||"UserMulti"===c||l===je.a.Text||l===je.a.Title?{pageContextForPicker:b,peoplePickerDataSource:p,getFilterSuggestions:function(e,t,n){return i.__awaiter(void 0,void 0,void 0,function(){var a,r,o;return i.__generator(this,function(i){return a=[],C&&u?(r=!b||!Object(Ue.getKillSwitch)(b).isActivated("74450E1A-074B-45F1-82F4-FB3FBE834B78","10/15/2019","Use contains to get filter suggestion"),o=r?function(e,t,n,i){return He(e,{fieldName:t,fieldType:n,filterValue:i,operator:"Contains"})}(C.getEffectiveViewXml(),e,t,n):function(e,t,n,i){return He(e,{fieldName:t,fieldType:n,filterValue:i,operator:"BeginsWith"})}(C.getEffectiveViewXml(),e,t,n),[2,k(Object(Je.a)({webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl,currentPageContext:b,qosName:"FilterPanel.GetFilterSuggesitons",viewXml:o,rootFolder:u.rootFolder})).then(function(t){if(t.ListData&&t.ListData.Row){var n={};t.ListData.Row.forEach(function(t){var i=t[e],r={display:i,value:i};n.hasOwnProperty(r.value)||(n[r.value]=r,a.push(r))})}return a})]):[2,a]})})}}:void 0;return{filterOptionSet:g||[],mappedColumnFieldType:void 0!==l?l:je.a.Text,fieldInternalName:s||"",applyFiltersAction:function(e){return a.createElement(Ye,i.__assign({},e,{itemSetKey:r,filterableSet:f,fieldType:c,internalName:s}))},isLoading:!v,checkedFilterValues:h,filterPickerProps:F}})(ze)),et=Object(g.createItemCacheComponent)(function(e,t){var n=t.columnKey,r=t.itemSetKey,o=t.isToggled,c=e.demandItemFacet(C.displayNameFacet,n),l=e.demandItemFacet(Ge,r),s=e.demandItemFacet(y.s,r),d=s&&s.viewKey&&y.X.serialize(s.viewKey),u=Ge.evaluate(l)(e,{viewKey:d,isAvailable:!0}).isAvailable,f=Object(E.renderComponentOnExecute)(function(e){return a.createElement($e,{onClose:function(){e.reject(new G.CancelError)},onComplete:function(){e.resolve()},columnName:c||"",columnKey:n,itemSetKey:r})});return a.createElement(v.a,i.__assign({isAvailable:u,isToggled:o,onExecute:f},Object(h.getItemActionEngagement)(e,{itemKey:r,engagement:{name:"LaunchFilterPanel",isIntentional:!0}})))}),tt=n("1a70d647fc1dcb25cddd"),nt=n("1570620a5bfaa589a3b2"),it=n("982f2ce1b1e042585250");var at=Object(tt.a)(function(){return i.__awaiter(void 0,void 0,void 0,function(){return i.__generator(this,function(e){switch(e.label){case 0:return[4,n.e(1).then(n.bind(null,"5d3c87f442d3acef003a"))];case 1:return[2,e.sent().SortActionExecutor]}})})},function(e,t){var n=t.sortFieldKey,a=t.itemSetKey,r=t.isAscending,o=e.demandItemFacet(y.s,a);if(!o)return!1;var c=Object(le.a)(e).itemsScopeItemKey;if(!c)return!1;var l=y.s.serialize(i.__assign({},o,{sortFieldKey:n,sortAscending:r})),s=e.demandItemFacet(nt.a,l),d=nt.a.evaluate(s)(e,{itemKey:l,itemsScopeItemKey:c,isAvailable:!0}),u=d.itemKey;if(!d.isAvailable)return!1;var f=e.demandItemFacet(it.c,c),m=f&&f.itemKey;return!!u&&u!==m},function(e,t){var n=t.sortFieldKey,i=t.itemSetKey,a=t.isAscending,r=e.demandItemFacet(y.s,i);if(!r)return!1;var o=e.demandItemFacet(x.g,i),c=o&&e.demandItemFacet(y.o,o.columnKey),l=c&&c.internalName||r.sortFieldKey,s=o?o.isAscending:r.sortAscending;return l===n&&s===a}),rt=new oe.ControlFacet("groupByActionControl"),ot=n("00620f24248a4f158ff6"),ct=n("aa112348dbd293212a65"),lt={ODB:1352},st=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.groupByFieldKey,r=t.itemSetKey;return a.createElement(We.WithItemCache,null,function(t){var o=t.itemCache,c=t.dispatch,l=o.demandItemFacet(y.s,r);if(!l)return a.createElement(E.WithAction,null);var s=y.K.serialize(l),d=o.demandItemFacet(_.nb,s),u=d&&d.templateType===ot.default.mySiteDocumentLibrary,f=Object(ct.a)(o,{enableGroupByInOneDrive:_.v}).enableGroupByInOneDrive,m=l.groupByFieldKey===n,b=y.s.serialize(i.__assign({},l,{groupByFieldKey:m?void 0:n})),p=y.D.serialize(l),g=l.viewKey&&y.X.serialize(l.viewKey),w=o.demandItemFacet(rt,r),C=rt.evaluate(w)(o,{itemSetKey:r,viewKey:g,groupedItemSetKey:b,isAvailable:!u||!!f}),k=C.isAvailable,F=C.onGroupBy,I=o.demandItemFacet(_.qc,y.Q.serialize({webAbsoluteUrl:l.webAbsoluteUrl,listFullUrl:l.listFullUrl})),S=Object(qe.a)(o,{feature:lt,pageContext:I}),K=Object(h.getItemActionEngagement)(o,{itemKey:r,engagement:{name:"GroupBy",isIntentional:!0}});return a.createElement(E.WithAction,{action:a.createElement(A.a,{itemKey:b})},function(t){var n=t.isAvailable,r=t.execute;return a.createElement(v.a,i.__assign({isAvailable:n&&k,isToggled:m,onExecute:function(t){return i.__awaiter(e,void 0,void 0,function(){var e,n,a,o;return i.__generator(this,function(l){switch(l.label){case 0:return S&&F&&(a=y.s.deserialize(b),o=a&&a.groupByFieldKey,c(F({groupByFieldKey:o}))),c(Object(O.a)({items:i.__assign((e={},e[b]=i.__assign({},x.e.pack({itemKey:p})),e),g?(n={},n[g]=i.__assign({},_.Qb.pack(!0)),n):{})})),[4,r(t)];case 1:return l.sent(),[2]}})})}},K))})})},t}(a.PureComponent),dt=n("c88e7380c3f2d1910abe"),ut=n("9e31270e173c703ec1f7"),ft={ODB:1318},mt=!1,bt=Object(g.connectToItemCache)(function(e,t){var n=t.itemSetKey,a=t.modifyType,r=t.columnKey,o=!1,c=e.demandItem({setKey:y.s,canModifySchema:_.e},n),l=c.setKey,s=c.canModifySchema,d=l&&l.viewKey?y.X.serialize(l.viewKey):void 0,u=e.demandItem({currentDerivedView:_.j},d).currentDerivedView,f=e.demandItemFacet(_.cb,r);if(l&&s&&u&&u.baseViewXml&&f)if(1===a||2===a){var m=u.getEffectiveFieldNames();if(m&&m.length){var b=m.indexOf(f),p=l.groupByFieldKey?1:0;o=1===a?b>p+1:b>=p&&b<m.length-1}}else o=!0;if(l){var g=e.demandItemFacet(_.qc,y.Q.serialize({webAbsoluteUrl:l.webAbsoluteUrl,listFullUrl:l.listFullUrl}));mt=Object(qe.a)(e,{feature:ft,pageContext:g})}return i.__assign({isAvailable:o},Object(h.getItemActionEngagement)(e,{itemKey:n,engagement:{name:"ModifyColumn",isIntentional:!0}}))},function(e,t){var n=t.itemSetKey,a=t.modifyType,r=t.columnKey,o=mt?ut.modifyColumnWithProgress:dt.a;return{onExecute:function(){return i.__awaiter(void 0,void 0,void 0,function(){var t,c;return i.__generator(this,function(i){return e(o({items:(t={},t[n]={columnModifyTypeMap:(c={},c[r]={modifyType:a},c)},t)})),[2]})})}}})(v.a),pt=n("f594c3c93ec9f3598a3f"),gt=n("9478e86dcd48357093ed"),vt=Object(g.connectToItemCache)(function(e,t){var n=t.itemSetKey,a=t.columnKey,r=t.aggregateType,o=e.demandItemFacet(_.f,n),c=o&&o[a]&&o[a].aggregateFunctionType||gt.a[0],l=c===gt.a[r]?void 0:gt.a[r];return i.__assign({isAvailable:!0,isToggled:c===gt.a[r]},l?Object(h.getItemActionEngagement)(e,{itemKey:n,engagement:{isIntentional:!0,action:"ModifyColumnAggregateType",name:l||"AggregateTypeNone",extraData:{PreviousAggregateType:c||"AggregateTypeNone",component:"ColumnContextMenu"}}}):{})},function(e,t){var n=t.itemSetKey,a=t.columnKey,r=t.aggregateType;return{onExecute:function(){return i.__awaiter(void 0,void 0,void 0,function(){var t;return i.__generator(this,function(i){return e(Object(pt.a)({items:(t={},t[n]={aggregateType:r,columnKey:a},t)})),[2]})})}}})(v.a),ht=n("bc38f53c4642d5526f0b"),yt=n("9e891d519df45958713d");n.d(t,"OpenAsHyperLinkExecutor",function(){return f}),n.d(t,"OpenAsShortcutExecutor",function(){return m}),n.d(t,"NewItemInOfficeClientAction",function(){return b.b}),n.d(t,"ItemOpenInOfficeClientAction",function(){return b.a}),n.d(t,"OpenInOfficeClientAction",function(){return b.c}),n.d(t,"ItemOpenInOfficeOnlineAction",function(){return p.a}),n.d(t,"OpenInOfficeOnlineAction",function(){return p.b}),n.d(t,"OpenInBFileAction",function(){return F}),n.d(t,"ItemSwitchViewAction",function(){return P}),n.d(t,"SwitchViewAction",function(){return T}),n.d(t,"SetDefaultViewAction",function(){return D}),n.d(t,"SaveViewAction",function(){return ue}),n.d(t,"LaunchFilterPanelAction",function(){return et}),n.d(t,"SortAction",function(){return at}),n.d(t,"GroupByAction",function(){return st}),n.d(t,"ModifyColumnAction",function(){return bt}),n.d(t,"ModifyColumnAggregateTypeAction",function(){return vt}),n.d(t,"ApproveRejectAction",function(){return ht.a}),n.d(t,"ItemFileHandlerOpenAction",function(){return yt.b}),n.d(t,"FileHandlerOpenAction",function(){return yt.a})},"9550830cbfda1b20b739":function(e,t,n){"use strict";var i=n("4986dedaa57d766e48bb")._QufdNEA86Lt9kRg1ZALxyw;t.a=i},"9e31270e173c703ec1f7":function(e,t,n){"use strict";n.r(t);var i,a=n("c88e7380c3f2d1910abe"),r=n("f5df325953ebb7f1143d"),o=n("64328bb588b46459132d"),c=n("4986dedaa57d766e48bb")._mdUvzXyVLdpWl82nZD7irQ,l=n("680b7ac74280293b48f0"),s=n("95da7825c4969f34e250"),d=n("9c98f89a0e31dc353072"),u=n("7c35367aa9ac1c882ae5"),f=n("2b59a0fb8f81c55fbaf0"),m=n("fdbcb7664c17b5b4e4d9"),b=n("3da5d317c00adfe8f79c"),p=n("959d5e23f32a2e71cc99"),g=new p.a("modifyColumnProgressItem",{columnKey:Object(p.f)(),modifyType:Object(p.e)(),targetIndex:Object(p.e)()}),v=new r.a("modifyColumnProgress",function(e,t){var n=Object.keys(t.columnModifyTypeMap)[0],i=t.columnModifyTypeMap[n].modifyType,a=t.columnModifyTypeMap[n].targetIndex;return g.serialize({columnKey:n,modifyType:i,targetIndex:a})}),h=n("ee92087a6ec1d0e9ecc9"),y=((i={})[b.d.started]=c.columnOperationStarted,i[b.d.completed]=c.columnOperationCompleted,i[b.d.failed]=c.columnOperationFailed,i),_=Object(l.b)(function(){return function(e){e(Object(s.c)(v,d.a)(Object(s.a)()(w))),e(Object(s.c)(v,u.c)(Object(s.a)()(C))),e(Object(s.c)(v,f.b)(Object(s.a)()(k)))}});function w(){return function(e){return function(e,t){var n,i=t.itemKey,a=t.format,c=Object(r.e)(e,t).phase,l=void 0,s=e.demandItemFacet(m.a,i),d=s&&s.itemKeys;if(d&&d.length>0)n=(l=y)&&l[c];else if("item"===a){var u=e.demandItemFacet(v,i),f=u&&u.taskKey;if(f){var b=e.demandItemFacet(g,f),p=b&&b.columnKey;if(p)n=e.demandItemFacet(h.cb,p)}}return o.__assign({},n?{title:n}:{})}}}function C(){return function(e){return function(e,t){return{reportMode:u.a.pin}}}}function k(){return function(e){return function(e,t){return{maxChildItemCount:0}}}}n.d(t,"modifyColumnWithProgress",function(){return F});var F=Object(r.f)({operationTypeFacet:a.b,progressKeyFacet:v,initializeBatch:function(){return _}})},"9e891d519df45958713d":function(e,t,n){"use strict";n.d(t,"b",function(){return s}),n.d(t,"a",function(){return d});var i=n("64328bb588b46459132d"),a=n("958db96f3e5e5318cd6e"),r=n("3904ebd1f9f5e501e8ce"),o=n("e75d371903c4d34a93e5"),c=n("5fef64b3561abb2ebffa"),l=n("800956ab6ff71efe3834"),s=Object(a.connectToItemCache)(function(e,t){var n=t.itemKey,a=t.action,o=!1;if(n){var s=e.demandItem({fileName:c.fileNameFacet,isFolder:c.folderFacet},n),d=s&&s.fileName,u=d&&d.extension||"",f=s&&s.isFolder||!1;o=Object(r.b)(a.availableOn,u,Boolean(f))}var m=a.handler,b=m.appId,p=m.isPromoted?"PromotedFileHandlerOpen":"FileHandlerOpen",g={appId:b};return i.__assign({isAvailable:o,itemKeys:n?[n]:[]},Object(l.getItemActionEngagement)(e,{itemKey:n,engagement:{name:p,isIntentional:!0,extraData:g}}))})(r.a),d=Object(o.withSelectedItems)()(Object(o.withExactlyOneItem)()(s))},aef40636031701b462d4:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){this._dataRequestor=t.dataRequestor}return e.prototype.getPreAuthUrls=function(e){var t=e.items,n=e.accessToken,i=void 0===n?void 0:n,a=e.driveUrl,r=void 0===a?"":a,o={items:t};return this._dataRequestor.send({path:(r||"/drive")+"/getPreAuthorizedUrls",apiName:"GetPreAuthorizedUrls",postData:JSON.stringify(o),requestType:"POST",accessToken:i,useAuthorizationHeaders:!!i}).then(function(e){return e.value})},e}();t.default=i}}]);