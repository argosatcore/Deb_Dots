(window.webPackBridgeJsonp=window.webPackBridgeJsonp||[]).push([[40],{"0dcb4ef0c72818ebbce5":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("6631b0451e9f577f414d"),n=r("8e315e7d1c81f1fe46e0"),o=r("256c2b1df06b9b785912"),i=r("0b8514f932f40951d460"),c=r("c1a09d7dd35e11297e15"),s=function(){function e(e,t){var r=t.asyncType,i=void 0===r?a.default:r,c=t.eventGroupType,s=void 0===c?n.default:c,u=t.targetWindow,d=void 0===u?window:u,l=this._scope=new o.default;this._async=l.attach(new i(this)),this._events=l.attach(new s(this)),this._targetWindow=d}return e.prototype.dispose=function(){this._scope.dispose()},e.prototype.wait=function(e){var t,r=e.duration,a=e.allowWakeWhenOnline,n=void 0!==a&&a,o=this._async,s=this._events,u=this._targetWindow,d=new c.default(function(){o.clearTimeout(t)}),l=function(){n&&d.complete()};return t=o.setTimeout(function(){d.complete()},r),s.on(u,"online",l),d.getPromise().then(function(){s.off(u,"online",l)},function(e){return s.off(u,"online",l),i.default.reject(e)})},e}();t.UploadWaiter=s},"26a436222c7071f5071f":function(e,t,r){"use strict";r.d(t,"a",function(){return a});var a=new(r("264a40ebead766e0e784").ControlFacet)("itemThumbnailControl")},"28d43522af463e91e061":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("64328bb588b46459132d"),n=r("0b8514f932f40951d460"),o=r("a24d70c7702f13f024d9"),i=r("4e087ea06522888b2152"),c=function(){function e(e,t){var r=t.uploadService,a=t.uploadStateMachine,n=t.useStreamingUpload,o=void 0!==n&&n;this._uploadService=r,this._uploadStateMachine=a,this._useStreamingUpload=o}return e.prototype.upload=function(e){var t=e.conflictBehavior,r=a.__rest(e,["conflictBehavior"]),c=r.qosData,s=new i.Qos({name:"VroomUploader.upload",extraData:c});return this._uploadState(r,{conflictBehavior:t,allowStreaming:this._useStreamingUpload}).then(function(e){return s.end({resultType:i.ResultTypeEnum.Success}),e},function(e){return s.end({resultType:n.default.isCanceled(e)?i.ResultTypeEnum.ExpectedFailure:i.ResultTypeEnum.Failure,error:e.message,resultCode:o.getResultCodeFromError(e),extraData:a.__assign({},c,o.getQosExtraDataFromError(e))}),n.default.reject(e)})},e.prototype._uploadState=function(e,t){var r=this,a=t.sessionUrl,o=t.item,i=t.error;if(o)return n.default.resolve(o);if(i){var c=void 0;return a&&(c=this._uploadService.cancelSession({qosData:e.qosData,sessionUrl:a}).then(function(){},function(){})),n.default.resolve(c).then(function(){return n.default.reject(i)})}return this._uploadStateMachine.advanceState(e,t).then(function(t){return r._uploadState(e,t)})},e}();t.Uploader=c,t.default=c},"39db02180d2ec50cbbfb":function(e,t,r){"use strict";r.r(t);var a,n=r("680b7ac74280293b48f0"),o=r("022addba5cf25ce091fb"),i=r("af8a4648dd318553c2f2"),c=r("3668a961dfce97a62ec8"),s=r("95da7825c4969f34e250"),u=r("902f37ccb11735819b88"),d=r("724c57678974b123bec4"),l=r("275976081ce1abf67779"),f=r("447964f318fe44ff3682"),m=r("95669b451bb4fedaf15d"),p=r("64328bb588b46459132d"),b=r("8969534cb3aba99e7c3a"),h=r("801b679406aabac77627"),v=r("fcf0c1042bbdc766028e"),g=r("f5df325953ebb7f1143d"),_=r("0a6fcc9f9518a7fcc53b"),y=r("5cf28e236c4257d408f7"),S=r("5fef64b3561abb2ebffa"),w=r("958db96f3e5e5318cd6e"),I=r("de961921ff36ea23aa69"),F=r("638c4a826f3cd38b4e52"),O=r("bb1ad009e1d0371a2be6"),E=r("44e6ed3c2eaab3f422db"),T=r("e75d371903c4d34a93e5"),j=r("cbd3c20d233b105c7895"),x=r("800956ab6ff71efe3834"),C=Object(w.createItemCacheComponent)(function(e,t){var r=t.itemKeys,a=t.removeFromSharedListWizard,n=t.removeItemsFromSharedList,o=void 0===n?y.b:n,i=Object(I.a)(e)||"";if(0===r.length)return null;for(var c=r.length<=200,s=a,u=0,d=r;u<d.length;u++){var f=d[u],m=e.demandItemFacet(j.a,f);j.a.evaluate(m)(e,{itemKey:f,isAvailable:!1}).isAvailable||(c=!1)}var b=e.dispatch,h=function(){return p.__awaiter(void 0,void 0,void 0,function(){var e,t;return p.__generator(this,function(a){switch(a.label){case 0:return e={itemSetKey:i},t=Object(F.a)(r,function(){return e}),[4,b(o({items:t}))];case 1:return a.sent(),[2]}})})},v=Object(O.renderComponentOnExecute)(function(e){return l.createElement(s,p.__assign({},e,{onItemRemoved:h,itemKeys:r}))});return l.createElement(E.a,p.__assign({isAvailable:c,onExecute:v},Object(x.getItemActionEngagement)(e,{itemKey:void 0,engagement:{name:"RemoveFromSharedList",isIntentional:!0,extraData:{itemCount:r.length}}})))}),R=Object(T.withSelectedItems)()(C),D=r("4986dedaa57d766e48bb")._9qgANGID0mrw6AApMqeriQ,U=r("4986dedaa57d766e48bb")._u2MwtU5vNsDaewBTKcTptg,k=r("d6e6a1e726db94fe6759"),q=r("3da5d317c00adfe8f79c"),N=r("9c98f89a0e31dc353072"),z=((a={})[q.d.started]=function(e){return Object(k.formatToArray)(Object(k.getLocalizedCountValue)(U.removeStartedItemsTitle,U.removeCompletedItemsTitleIntervals,e)||"",e)},a[q.d.completed]=function(e){return Object(k.formatToArray)(Object(k.getLocalizedCountValue)(U.removeCompletedItemsTitle,U.removeCompletedItemsTitleIntervals,e)||"",e)},a[q.d.failed]=function(e){return Object(k.formatToArray)(Object(k.getLocalizedCountValue)(U.removeFailedItemsTitle,U.removeFailedItemsTitleIntervals,e)||"",e)},a[q.d.canceled]=function(e){return Object(k.formatToArray)(Object(k.getLocalizedCountValue)(U.removeFailedItemsTitle,U.removeFailedItemsTitleIntervals,e)||"",e)},a),K=Object(n.b)(function(){return function(e){e(Object(s.c)(y.a,N.a)(Object(s.a)()(A)))}});function A(){return function(e){return B}}function B(e,t){var r,a=Object(g.e)(e,t),n=a.phase,o=a.count;return r=z[n](o),p.__assign({},r?{title:r}:{})}var P=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return p.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props,r=t.resolve,a=t.reject,n=t.onItemRemoved,o=t.itemKeys,i=function(){return p.__awaiter(e,void 0,void 0,function(){return p.__generator(this,function(e){switch(e.label){case 0:return r(),[4,n()];case 1:return e.sent(),[2]}})})},c=function(){return p.__awaiter(e,void 0,void 0,function(){return p.__generator(this,function(e){return a(new b.CancelError),[2]})})};return l.createElement(h.WithItemCache,null,function(e){var t=e.itemCache,r=M(t,o),a=r.title,n=r.prompt;return l.createElement(v.ConfirmationDialog,{onCancel:c,onConfirm:i,yesText:U.removeFromSharedListConfirmButtonText,noText:D.removeFromSharedListCancelButtonText,defaultToYes:!0,title:a,prompt:n})})},t}(l.PureComponent),M=function(e,t){if(t.length>1)return{title:D.itemsTitleWithAccess,prompt:D.itemsSubTextWithAccess};if(1===t.length){var r=e.demandItemFacet(S.folderFacet,t[0]);return{title:r?D.folderTitleWithAccess:D.fileTitleWithAccess,prompt:r?D.folderSubTextWithAccess:D.fileSubTextWithAccess}}return{title:"",prompt:""}},L=Object(g.f)({operationTypeFacet:y.c,progressKeyFacet:y.a,initializeBatch:function(){return K}});var W=Object(_.a)(function(){return{removeFromSharedListWizard:P,removeItemsFromSharedList:L}})(R),Q=r("ad509ccd8bb6781a5a82"),V={key:new f.a("removeFromSharedList").id,automationId:"removeFromSharedListCommand",name:Q.a.removeFromSharedList,action:l.createElement(m.b,null,l.createElement(W,null)),iconProps:{iconName:"Cancel"}},G=r("1d6ca65779224e04aaa8"),H=Object(s.a)()(function(){return function(e){return Z}});var J={name:"-",key:"divider_1",itemType:G.a.Divider},Y=[u.a,d.c,d.b,J,V];function Z(e,t){return{commands:Y}}var $=r("54f60ac18fdd1d2e0628"),X=r("319d5d68379b759dd907"),ee=r("c1d047631433c6878a84"),te=Object(s.a)()(function(){return function(e){return ae}});var re=[u.a,d.c,d.b,V,ee.a];function ae(e,t){return{commands:re}}var ne,oe=r("de455e56c423b6481855"),ie=r("0c7e5d362a9bb95e0dc2"),ce=r("072e92bba2790a1e2bca"),se=r("36d872fdf1e414343eb7"),ue=((ne={})[se.b]=!0,ne[se.d]=!0,ne[ce.e]=!0,ne[ce.a]=!0,ne[ce.d]=!0,ne),de=Object(s.a)()(function(){return function(e){return le}});function le(e,t){var r=t.itemSetKey,a=t.handler,n=a.columnKey,o=a.isAscending;if(!ue[n])return{};var i=e.demandItemFacet(oe.a,r);if(!i)return{};var c=ce.b[n];return c?{newItemSetKey:oe.a.serialize(p.__assign({},i,{sortBy:c,isAscending:o}))}:{}}var fe,me=r("1570620a5bfaa589a3b2"),pe=r("0e08eb9ea76754713936"),be=r("dbabf3ffb96f7573e1b2"),he=Object(s.a)()(function(){return function(e){return function(e,t){var r=t.itemKey,a=e.demandItemFacet(oe.a,r),n=a&&a.driveItemKey.endpoint,o=n&&Object(be.a)(e,{parentItemKey:X.a.serialize({endpoint:n}),stageItem:t.stageItem});return p.__assign({},o?{stageItem:o}:{})}}});var ve=((fe={})[ce.e]=!0,fe[ce.a]=!0,fe),ge=Object(s.a)()(function(){return function(e){return _e}});function _e(e,t){var r=t.itemSetKey,a=t.handler.columnKey;if(!ve[a])return{};var n=e.demandItemFacet(oe.a,r);if(!n)return{};var o=ce.b[a];return o?{newItemSetKey:oe.a.serialize(p.__assign({},n,{groupBy:o}))}:{}}var ye=Object(s.a)()(function(){return function(e){return Se}});function Se(e,t){var r=t.itemSetKey,a=e.demandItemFacet(oe.a,r);return a?{newItemSetKey:oe.a.serialize(p.__assign({},a,{groupBy:void 0}))}:{}}var we=r("59ae8255fdedb40e8263"),Ie=Object(s.a)()(function(){return function(e){return function(e,t){return{isAvailable:!1}}}});var Fe=Object(s.a)()(function(){return function(e){return function(e,t){return{isAvailable:!1}}}});var Oe=r("cb1ab6a528c31e7ad576"),Ee=r("ce1d17d6147b094ebc27"),Te=r("be9ddcf0ec56bc42b1b1"),je=r("5f6c4af8cb56376acb4d"),xe=r("3d240143e32215cc23a5"),Ce=r("8f99e6f92d80fbcf38ae"),Re=r("6dec44e5485412f70439"),De=r("959d5e23f32a2e71cc99"),Ue=new De.a("topCollaboratorItemKeyFacet",{id:Object(De.f)()}),ke=r("4e318b84c4772f9f58b9"),qe=r("98da34addf7164483ddc"),Ne=r("fdbcb7664c17b5b4e4d9"),ze=Object(n.e)()(function(e){var t=this,r=e.itemKey;return function(a){return p.__awaiter(t,void 0,void 0,function(){var t,n,o,i,c,s,u,d,l,f,m,b,h,v,g,_;return p.__generator(this,function(y){switch(y.label){case 0:return o=new je.a,i=a(Object(xe.a)({graphEndpoint:Ce.g})).graphEndpoint,c=Ee.a.deserialize(r),s=i||c.endpoint,u=s+"/me/people/?$top=3",[4,a(Object(Re.f)({url:u,qosName:"getTopCollaborator",endpoint:s}))];case 1:for(d=y.sent(),l=[],f=0,m=d.value;f<m.length;f++)b=m[f],h=b.id,v=b.displayName,g=b.userPrincipalName,_=Ue.serialize({id:h}),a(Object(ke.a)({items:(t={},t[_]=p.__assign({},S.displayNameFacet.pack(v),qe.emailFacet.pack(g)),t)})),l.push(_);return o.resolveItems({items:(n={},n[e.itemKey]=p.__assign({},Ne.a.pack({itemKeys:l})),n)}),a(o.execute()),[2]}})})}});r.d(t,"graphAddonDeferred",function(){return Ke});var Ke=Object(n.b)(function(){return function(e){e(Object(Oe.a)(function(){e($.graphAddonDataOnlyDeferred),e(Object(s.c)(X.a,i.a)(te)),e(Object(s.c)(X.a,c.a)(H)),e(Object(s.c)(oe.a,ie.a)(de)),e(Object(s.c)(oe.a,me.a)(he)),e(Object(s.c)(oe.a,pe.a)(ge)),e(Object(s.c)(oe.a,pe.b)(ye)),e(Object(s.c)(we.c,me.a)(Ie)),e(Object(s.c)(we.b,me.a)(Fe)),e(Object(o.g)(Ee.a,Te.a)(ze))}))}})},"54f60ac18fdd1d2e0628":function(e,t,r){"use strict";r.r(t);var a=r("64328bb588b46459132d"),n=r("680b7ac74280293b48f0"),o=r("022addba5cf25ce091fb"),i=r("95da7825c4969f34e250"),c=r("4fab54035bc77294dc42"),s=r("163bd1662ba0d8c200dc"),u=r("e87bb409a9007bb8123c"),d=r("63aeb04d7e4744f15272"),l=r("6187b1a01125644c0b13"),f=r("2807dfd01f20f29a2152"),m=r("e008263a4c0e246e4f4f"),p=r("64b1e6e25051aaaf0681"),b=r("6addfaf561d910b46fa0"),h=r("2c440e638bb16e83d44e"),v=r("26a436222c7071f5071f"),g=r("119e7fc4035eae889114"),_=r("6dec44e5485412f70439"),y=r("3da5d317c00adfe8f79c"),S=r("fdbcb7664c17b5b4e4d9"),w=r("01b70109f23a290743e9"),I=r("5f6c4af8cb56376acb4d"),F=Object(n.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options.folders,n=c.a.deserialize(t),o=n.endpoint,i=n.driveId,s=n.itemId,u=Object.keys(r)[0],d=r[u].progressItemKey;return function(e){return a.__awaiter(void 0,void 0,void 0,function(){var r,l,f,m,p,b,h,v;return a.__generator(this,function(g){switch(g.label){case 0:return m=Object(_.c)(n)+"/children",p={name:u,folder:{},"@microsoft.graph.conflictBehavior":"rename"},i&&s&&(p.parentReference={driveId:i,id:s}),[4,e(Object(_.f)({url:m,method:"POST",body:p,qosName:"createFolder",endpoint:o}))];case 1:return b=g.sent(),h=c.a.serialize({endpoint:o,driveId:i,itemId:b.id}),v=new I.a,d&&v.resolveItems({items:(r={},r[d]=a.__assign({},y.f.pack({itemKey:h})),r)}),v.invalidateItems({items:(l={},l[t]=[S.b],l)}),v.resolveItems({items:(f={},f[h]=a.__assign({},Object(w.a)({driveItem:b,parentFolderItemKey:t,endpoint:o})),f)}),e(v.execute()),[2]}})})}}),O=r("d27387ede93a2620cbf6"),E=r("5fef64b3561abb2ebffa"),T=Object(n.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=c.a.deserialize(t);return function(e){return a.__awaiter(void 0,void 0,void 0,function(){var n,o;return a.__generator(this,function(a){switch(a.label){case 0:return o=Object(_.c)(r),[4,e(Object(_.f)({url:o,method:"DELETE",qosName:"deleteItem",endpoint:r.endpoint}))];case 1:return a.sent(),e(Object(O.b)({items:(n={},n[t]=[E.deletedFacet],n)})),[2]}})})}}),j=r("56aac858adc5742217b8"),x=r("a9dd204dd0bee7467912"),C=r("578e5017557fc66bb247"),R=r("a24d70c7702f13f024d9"),D=Object(n.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options.names,n=c.a.deserialize(t);return function(e){return a.__awaiter(void 0,void 0,void 0,function(){var o,i,c,s,u,d,l;return a.__generator(this,function(f){switch(f.label){case 0:return o=Object.keys(r)[0],i=r[o],c=i.newName,s=i.newExtension,u=Object(_.c)(n),d=e(Object(C.a)({fileName:E.fileNameFacet},t)).fileName,l="string"==typeof s?s:d&&d.extension||"",[4,e(Object(_.f)({url:u,method:"PATCH",body:{name:""+c+l},qosName:"renameItem",endpoint:n.endpoint})).then(function(r){var n,o,i=new I.a;i.invalidateItems({items:(n={},n[t]=[E.displayNameFacet],n)}),i.resolveItems({items:(o={},o[t]=a.__assign({},E.displayNameFacet.pack(r.name),E.fileNameFacet.pack(Object(w.b)(r.name||"",!!r.folder))),o)}),e(i.execute())}).catch(function(e){if(e instanceof R.GraphError&&e.status===j.b)throw new j.a({facets:a.__assign({},x.m.pack({})),innerError:e});throw e})];case 1:return f.sent(),[2]}})})}}),U=r("28d43522af463e91e061"),k=r("e98307e3d02bf06255ee"),q=r("0dcb4ef0c72818ebbce5"),N=r("c3cad731bb834f32ee95"),z=r("aed6969132a8e15168e7"),K=r("3bbe42d2eda1d0f5d766"),A=r("2be4cdf0880f45f00879"),B=r("3560af8f1e8ae6e7a04f"),P=r("eef09ec91afb2fd77b66"),M=r("c21819129ba64362c121"),L=r("4e318b84c4772f9f58b9"),W=r("447964f318fe44ff3682"),Q=r("0b8514f932f40951d460"),V=r("a5db57338f8274c3300c"),G=Object(B.a)(function(){return new q.UploadWaiter({},{})}),H=Object(B.a)(function(e){var t=e(_.b).dataRequestor,r=function(e){function t(t){return e.call(this,t,{performanceNow:z.performanceNow})||this}return a.__extends(t,e),t}(z.ActivityBandwidthVerifier),n=new k.UploadService({},{dataRequestor:t}),o=new N.UploadStateMachine({},{activityBandwidthVerifierType:r,uploadService:n});return new U.Uploader({},{uploadService:n,uploadStateMachine:o})}),J=0,Y=Object(n.e)({mergeForSameItemKey:!1,maxParallelOperationCount:3,timeout:864e5})(function(e){var t=this,r=e.itemKey,n=e.options.sourceEntries,o=c.a.deserialize(r),i=o.endpoint,s=o.driveId,u=Object.keys(n)[0],d=n[u].progressItemKey;return function(e){return a.__awaiter(t,void 0,void 0,function(){var t,n,l,f,m,p,b,h,v;return a.__generator(this,function(g){switch(g.label){case 0:if(!(m=e(Object(C.a)({sourceFile:M.b},u)).sourceFile))throw new Error("No source file for Graph upload.");return p=Object(_.c)(o)+":",d&&e(Object(L.a)({items:(t={},t[d]=a.__assign({},y.r.pack({total:m.size,current:0})),t)})),[4,e(Z({progressItemKey:d,sourceFile:m,itemUrl:p,endpoint:i}))];case 1:return b=g.sent(),h=c.a.serialize({endpoint:i,driveId:s,itemId:b.id}),v=new I.a,d&&v.resolveItems({items:(n={},n[d]=a.__assign({},y.f.pack({itemKey:h}),Object(W.d)({progressSize:y.r},{progressSize:{current:m.size}})),n)}),v.invalidateItems({items:(l={},l[r]=[S.b],l)}),v.resolveItems({items:(f={},f[h]=a.__assign({},Object(w.a)({driveItem:b,parentFolderItemKey:r,endpoint:i})),f)}),e(v.execute()),[2]}})})}});function Z(e){var t=this,r=e.progressItemKey,n=e.sourceFile,o=e.itemUrl,i=e.endpoint;return function(e){return a.__awaiter(t,void 0,void 0,function(){var t,c,s,u,d,l,f,m,p,b;return a.__generator(this,function(a){switch(a.label){case 0:return t=e(H),c=e(G),[4,e(Object(K.a)(i))];case 1:s=a.sent(),u=new A.a,d=0,l=u.debounce(function(t){var a;t>d&&(r&&e(Object(L.a)({items:(a={},a[r]=Object(W.d)({progressSize:y.r},{progressSize:{current:t}}),a)})),d=t)},300,{leading:!1}),f=e(Object(P.a)(function(e){return e.demandItemFacet(y.e,r)})),m=t.upload({conflictBehavior:"fail",qosData:{uploadId:""+ ++J},accessToken:s,fileName:n.name,content:n,itemUrl:o,onProgress:l,onPromptForConfictBehavior:function(e){return Promise.reject(e)},onWait:function(e){return c.wait(e)}}),p=f?f.token.subscribe(function(){m.cancel()}):void 0,a.label=2;case 2:return a.trys.push([2,4,5,6]),[4,m];case 3:return[2,a.sent()];case 4:if(b=a.sent(),Q.default.isCanceled(b))throw new V.CancelError;throw b;case 5:return p&&p(),u.dispose(),[7];case 6:return[2]}})})}}var $=r("3c5e58fee5b0e3275498"),X=r("36e2fbcb644dd53b7016"),ee=r("f5454705d9d5f89bad27"),te=r("e66c59a0c38d59122168"),re=r("2852e19dad7ee30e33c6"),ae=(new te.a("addToOneDrive",function(e,t){return se(e,a.__assign({},t,{commandFacet:X.a}))}),new te.a("canCreateFolder",function(e,t){return se(e,a.__assign({},t,{commandFacet:X.b}))})),ne=(new te.a("canCreateLink",function(e,t){return se(e,a.__assign({},t,{commandFacet:X.c}))}),new te.a("canDelete",function(e,t){return se(e,a.__assign({},t,{commandFacet:X.d}))})),oe=new te.a("canDownload",function(e,t){return!e.demandItemFacet(re.c,t.itemKey)&&se(e,a.__assign({},t,{commandFacet:X.e}))}),ie=(new te.a("canInvite",function(e,t){return se(e,a.__assign({},t,{commandFacet:X.f}))}),new te.a("canMove",function(e,t){return se(e,a.__assign({},t,{commandFacet:X.g}))}),new te.a("canUseOfficeLens",function(e,t){return se(e,a.__assign({},t,{commandFacet:X.h}))}),new te.a("canRename",function(e,t){return se(e,a.__assign({},t,{commandFacet:X.i}))})),ce=new te.a("canUpload",function(e,t){return se(e,a.__assign({},t,{commandFacet:X.j}))});function se(e,t){var r=t.itemKey,a=t.commandFacet,n=e.demandItemFacet(c.a,r);if(!n)return!1;var o=n.endpoint,i=n.driveId,s=e.demandItemFacet(a,ee.a.serialize({endpoint:o,driveId:i}));return!!s&&!!s.roles&&function(e,t){var r=t.itemKey,a=t.oneOfRequiredRoles,n=function(e,t){if(function(e,t){var r=e.demandItemFacet($.a,t);return!r||!r.effectiveRoles||!r.owner}(e,t))return["read","write","owner"];var r=e.demandItemFacet($.a,t);if(r&&r.effectiveRoles)return r.effectiveRoles;return[]}(e,r);return function(e,t){var r=t.oneOfRequiredRoles,a=t.effectiveRoles;for(var n in a)if(n in r)return!0;return!1}(0,{oneOfRequiredRoles:a,effectiveRoles:n})}(e,{itemKey:r,oneOfRequiredRoles:s.roles})}var ue=Object(i.a)()(function(){return function(){return function(e,t){var r=t.itemKey;return{isAvailable:e.demandItemFacet(ae,r)}}}});var de=r("cfef2ab49d0d7bc1e869"),le=Object(i.a)()(function(){return function(){return function(e,t){var r=t.itemKey;return{isAvailable:e.demandItemFacet(ie,r),validator:de.a}}}});var fe=Object(i.a)()(function(){return function(){return function(e,t){var r=t.itemKey;return{isAvailable:e.demandItemFacet(ne,r)}}}});var me=Object(i.a)()(function(){return function(){return function(e,t){var r=t.itemKey;return{isAvailable:e.demandItemFacet(ce,r)}}}});var pe=Object(i.a)()(function(){return function(e){return be}});function be(e,t){if(1!==t.itemKeys.length)return{};var r=t.itemKeys[0];if(e.demandItemFacet(E.folderFacet,r))return{};var n=e.demandItemFacet(c.a,r),o=n?Object(_.c)(n):void 0,i=n&&n.endpoint||"";return{isAvailable:e.demandItemFacet(oe,r),getDownloadData:o?function(){return function(e){var t=this,r=e.itemUrl,n=e.endpoint;return function(o){return a.__awaiter(t,void 0,void 0,function(){var t,i,c,s;return a.__generator(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,o(Object(_.f)({url:e.itemUrl,method:"GET",qosName:"getItemDownloadUrl",endpoint:n}))];case 1:if(t=a.sent(),!(i=function(e){return 0===e.toLowerCase().lastIndexOf("https://graph.microsoft.com",0)}(r)?t["@microsoft.graph.downloadUrl"]:t["@content.downloadUrl"]))throw new Error("Unable to obtain download URL.");return[2,{method:"GET",url:i}];case 2:throw(c=a.sent())instanceof R.GraphError?(s=Object(R.getErrorResolution)(c,function(e,t){switch(e){case"unauthenticated":case 401:return x.b.pack({});case"itemNotFound":case 404:return x.f.pack({});case"accessDenied":case 403:return x.a.pack({});default:return x.m.pack({})}}),new j.a({innerError:c,facets:s})):c;case 3:return[2]}})})}}({itemUrl:o,endpoint:i})}:void 0}}var he=Object(i.a)()(function(){return function(e){return ve}});function ve(e,t){var r=t.itemKey,n=e.demandItemFacet(c.a,r);return{isAvailable:!0,getShareLink:function(){return function(e){var t=this;return function(r){return a.__awaiter(t,void 0,void 0,function(){var t,n,o;return a.__generator(this,function(a){switch(a.label){case 0:return(t=e.driveItem)?(n=Object(_.c)(t)+"/invite",[4,r(Object(_.g)({url:n,method:"POST",qosName:"getDefaultShareLink",endpoint:t.endpoint,headers:{prefer:"getDefaultLink","Content-type":"application/json"}}))]):[3,2];case 1:if(!(o=a.sent()))throw new Error("Unable to obtain default share URL");return[2,{url:o.value[0].link.webUrl,scope:o.value[0].link.scope}];case 2:throw new Error("Unable to obtain default share URL")}})})}}({driveItem:n})}}}var ge=Object(i.a)()(function(){return function(){return function(){return{}}}});var _e=Object(i.a)()(function(){return function(e){return ye}});function ye(e,t){var r=t.itemKey,n=t.link,o=t.recipients,i=e.demandItemFacet(c.a,r);return{isAvailable:!0,permissionInvite:function(){return function(e){var t=this;return function(r){return a.__awaiter(t,void 0,void 0,function(){var t,n,o,i,c,s,u,d,l,f,m,p;return a.__generator(this,function(a){switch(a.label){case 0:if(t=e.driveItem,n=e.link,o=e.recipients,!t||!n)throw new Error("Unable to obtain default share URL");return i=t.endpoint,s=btoa(n),c="u!"+s.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-"),u=o.map(function(e){return{email:e}}),d={recipients:u,roles:["read"]},l=i.replace("v1.0","beta"),f=l+"/shares/"+c+"/permission/grant",[4,r(Object(_.g)({url:f,method:"POST",qosName:"permissionGrant",endpoint:t.endpoint,headers:{"Content-type":"application/json",Accept:"application/json"},body:d}))];case 1:return m=a.sent(),p=m.value[0].grantedToIdentities.map(function(e){return{email:e.user.email}}),[2,{recipients:p}]}})})}}({driveItem:i,link:n,recipients:o})}}}var Se=r("1bf44020f3901b4e05c2"),we=Object(i.a)()(function(){return function(e){return Ie}});function Ie(e,t){var r=t.itemKey,a=t.desiredSize,n=e.demandItemFacet(c.a,r),o=function(e){return e&&(t=e,t&&"number"==typeof t.length)?e[0]:e;var t}(e.demandItemFacet(Se.a,r));return n&&o&&o.large?{thumbnail:{url:Ee(o.large.url,a),width:0,height:0}}:{}}var Fe=/width=[0-9]*/,Oe=/height=[0-9]*/;function Ee(e,t){var r=""+(t.width||"");Fe.test(e)?e=e.replace(Fe,"width="+r):e+=(e.indexOf("?")>-1?"&":"?")+"width="+r;var a=""+(t.height||"");return Oe.test(e)?e=e.replace(Oe,"height="+a):e+=(e.indexOf("?")>-1?"&":"?")+"height="+a,e}var Te=r("664990b3cc9463570172"),je=r("7a458e85783b71176e85"),xe=r("38b5b26773d7dabe2878"),Ce=r("8f99e6f92d80fbcf38ae"),Re=r("3d240143e32215cc23a5"),De=Object(n.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options,n=r.isFollowed,o=r.progressItemKey,i=xe.a.deserialize(t),s=i.driveItemKey,u=s.itemId,d=void 0===u?"":u;return function(e){return a.__awaiter(void 0,void 0,void 0,function(){var t,r,u,l,f,m,p,b,h,v,g;return a.__generator(this,function(S){switch(S.label){case 0:l=e(Object(Re.a)({useGraphEndpointForSavedForLater:Ce.o,graphEndpoint:Ce.g})),f=l.useGraphEndpointForSavedForLater,m=l.graphEndpoint,p=new I.a,b=xe.a.serialize(i),h=f&&m?m:s.endpoint,o&&e(Object(L.a)({items:(t={},t[o]=a.__assign({},y.s.pack({itemKey:c.a.serialize(s)})),t)})),v=n?{url:h+"/drives/"+s.driveId+"/items/"+d+"/follow",method:"POST",qosName:"followItem"}:{url:h+"/drives/"+s.driveId+"/following/"+d,method:"DELETE",qosName:"unfollowItem"},S.label=1;case 1:return S.trys.push([1,3,,4]),[4,e(Object(_.f)({url:v.url,method:v.method,qosName:v.qosName,endpoint:h}))];case 2:return S.sent(),p.invalidateItems({items:(r={},r[b]=[E.isFollowedFacet],r)}),p.resolveItems({items:(u={},u[b]=a.__assign({},E.isFollowedFacet.pack(n)),u)}),e(p.execute()),[3,4];case 3:throw g=S.sent(),new Error(g.message);case 4:return[2]}})})}}),Ue=r("202cbd74e3f23ed02585"),ke=r("e03a358d7e9a80ade819"),qe=r("7e3c1a3ef9a4a6f39fb9"),Ne=r("d6c3da553edc07112fb2");function ze(e,t){return Ne.a.serialize(a.__assign({},{driveItemKey:e.driveItemKey},t?{searchTerm:t}:{searchTerm:void 0}))}var Ke=Object(i.a)()(Be),Ae=Object(i.a)()(Be);function Be(){return function(e){return function(e,t){var r,a=t.itemKey,n=e.demandItemFacet(qe.a,a);if(n)r=function(e){return n?ze(n,e):void 0};else{var o=e.demandItemFacet(Ne.a,a);r=function(e){return o?ze(o,e):void 0}}return{isAvailable:!0,getSearchItemKey:r}}}}var Pe=r("db48f6075c5eb63351b0"),Me=r("094e1535cff726648423"),Le=r("004c1cdbe696eacb8020"),We=Object(i.a)()(function(){return function(e){return Qe}});function Qe(e,t){var r=t.handlers,n=t.itemKey,o=e.demandItemFacet(qe.a,n),i=e.demandItemFacet(Ne.a,n);if(r&&(o||i)){for(var c=[],s=0,u=r;s<u.length;s++){var d=u[s];if(d.key===Le.g.key)c.push("photo");else if(d.key===Le.h.key)c.push("video");else if(d.key===Le.a.key)c.push("folder");else if(d.key===Le.f.key)c.push("onenote");else if(d.key===Le.d.key)c.push("!photo");else if(d.key===Le.e.key)c.push("!video");else if(d.key===Le.b.key)c.push("!folder");else if(d.key===Le.c.key)c.push("!onenote");else{var l=Object(Me.a)(d);l&&c.push(l)}}if(o)return{itemKey:qe.a.serialize(a.__assign({},o,{extFilters:c}))}}return{}}var Ve=r("9ec68841fe22535372ee"),Ge=r("c70c28d41140929c0281"),He=r("e13c588884262941567a"),Je=Object(n.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options,n=Object.keys(r)[0];return function(e){return a.__awaiter(void 0,void 0,void 0,function(){var o,i,s,u,d,l,f,m,p;return a.__generator(this,function(b){switch(b.label){case 0:if(!e(Object(P.a)(function(e){return e.demandItemFacet(c.a,n)})))throw new Error("Source item does not have a driveItem key");return i=r[n],s=i.isMove,u=i.conflictBehavior,d=c.a.deserialize(t),[4,e(Object(Ge.demandItems)(function(e){return e.demandItemFacet(c.a,n)}))];case 1:if(!(l=b.sent()))throw new Error("Unable to get metadata for destination item.");f=Object(_.c)(l),b.label=2;case 2:return b.trys.push([2,4,,5]),[4,e(Object(_.f)({url:f+(s?"":"/copy"),method:s?"PATCH":"POST",body:{parentReference:{id:d.itemId||He.c,driveId:d.driveId||""},"@microsoft.graph.conflictBehavior":u},qosName:s?"moveItem":"copyItem",endpoint:d.endpoint}))];case 3:return b.sent(),(m=new I.a).invalidateItems({items:(o={},o[n]=s?[E.parentFolderItemFacet,E.deletedFacet]:[],o[t]=[S.b],o)}),e(m.execute()),[3,5];case 4:if((p=b.sent())instanceof R.GraphError&&p.status===j.b)throw new Ve.a({innerError:p,facets:a.__assign({},x.h.pack(p.status))});throw p;case 5:return[2]}})})}}),Ye=r("df48e25b04ff6342ce7b"),Ze=Object(i.a)()(function(){return function(){return function(e,t){return{validator:de.a}}}});var $e=r("894f2391cc313a7da701"),Xe=r("e17f546ab8812a549d96"),et=r("b28cff7ca93cb4538809"),tt=r("be9ddcf0ec56bc42b1b1"),rt=r("cc6309d2463e503ef82c"),at=r("cb1ab6a528c31e7ad576"),nt=r("29171b69bc1396c71276"),ot=r("de455e56c423b6481855"),it=r("f4ada3c3607c09804e69"),ct=Object(n.e)()(function(e){var t=e.itemKey,r=e.options.itemSetKey;return function(e){return a.__awaiter(void 0,void 0,void 0,function(){var n,o,i,s,u;return a.__generator(this,function(a){switch(a.label){case 0:if(!ot.a.matches(r))throw new j.a({code:"invalidItemSetForAddToOneDrive"});if(n=ot.a.deserialize(r).driveItemKey.endpoint,o=e(Object(P.a)(function(e){return e.demandItemFacet(E.fileNameFacet,t)})),i=e(Object(P.a)(function(e){return e.demandItemFacet(c.a,t)})),!n||!o||!i)throw new j.a({code:"missingItemInfoForAddToOneDrive"});return[4,e(Object(it.c)("GetDriveInfo",n))];case 1:s=a.sent(),a.label=2;case 2:return a.trys.push([2,4,,5]),[4,e(Object(it.b)(o.name,s.id,i,"AddToOneDrive_SWM",n))];case 3:return a.sent(),[3,5];case 4:if(!((u=a.sent())instanceof R.GraphError))throw u;return Object(it.a)(u),[3,5];case 5:return[2]}})})}});r.d(t,"graphAddonDataOnlyDeferred",function(){return ut});var st=Object(Xe.asModuleWithRetries)(function(){return Promise.all([r.e(7),r.e(53)]).then(r.bind(null,"f454982ae5b36fa2ce04"))},{chunkName:"addon-graph-deferredoperations"}),ut=Object(n.b)(function(){return function(e){var t=e(Object(Re.a)({useBatchedDeleteConfiguration:Ce.n})).useBatchedDeleteConfiguration;e(Object(at.a)(function(){e(Object(i.c)(qe.a,ke.a)(Ke)),e(Object(i.c)(Ne.a,ke.a)(Ae)),e(Object(i.c)(qe.a,Pe.a)(We)),e(Object(o.g)(c.a,s.b)(F)),e(t?Object(o.g)(c.a,u.b)(Object(n.d)(function(){return a.__awaiter(void 0,void 0,void 0,function(){return a.__generator(this,function(t){switch(t.label){case 0:return[4,e(Object($e.h)())];case 1:return t.sent(),[4,st()];case 2:return[2,t.sent().driveItemDeleteItemsBatchedOperationHandler]}})})})):Object(o.g)(c.a,u.b)(T)),e(Object(o.g)(c.a,d.b)(D)),e(Object(o.g)(c.a,l.b)(Y)),e(Object(o.g)(c.a,Ve.b)(Je)),e(Object(o.g)(c.a,nt.b)(ct)),e(Object(i.c)(c.a,f.a)(ue)),e(Object(i.c)(c.a,Ye.a)(Ze)),e(Object(i.c)(c.a,m.a)(le)),e(Object(i.c)(c.a,p.b)(fe)),e(Object(i.c)(c.a,b.a)(me)),e(Object(i.c)(c.a,Te.a)(he)),e(Object(i.c)(c.a,je.a)(_e)),e(Object(i.c)(c.a,h.a)(pe)),e(Object(i.c)(c.a,v.a)(we)),e(Object(i.c)(c.a,g.a)(ge)),e(Object(o.g)(xe.a,Ue.a)(De)),e(Object(o.g)(et.a,tt.a)(rt.a))}))}})},"5cf28e236c4257d408f7":function(e,t,r){"use strict";r.d(t,"c",function(){return o}),r.d(t,"a",function(){return i}),r.d(t,"b",function(){return c});var a=r("447964f318fe44ff3682"),n=r("f5df325953ebb7f1143d"),o=new a.a("removeItemsFromSharedList"),i=new n.a("removeItemsFromSharedList"),c=Object(n.f)({operationTypeFacet:o,progressKeyFacet:i})},"664990b3cc9463570172":function(e,t,r){"use strict";r.d(t,"a",function(){return a});var a=new(r("264a40ebead766e0e784").ControlFacet)("getDefaultShareLinkActionControl")},"7a458e85783b71176e85":function(e,t,r){"use strict";r.d(t,"a",function(){return a});var a=new(r("264a40ebead766e0e784").ControlFacet)("permissionInviteActionControl")},"9ec68841fe22535372ee":function(e,t,r){"use strict";r.d(t,"b",function(){return c}),r.d(t,"c",function(){return s}),r.d(t,"a",function(){return u});var a=r("64328bb588b46459132d"),n=r("447964f318fe44ff3682"),o=r("56aac858adc5742217b8"),i=r("f5df325953ebb7f1143d"),c=new n.a("moveCopyItems"),s=new i.a("moveCopyItems"),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t}(o.a)},aed6969132a8e15168e7:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.performanceNow=window.performance?function(){return window.performance.now()}:function(){return Date.now()};var a=function(){function e(e,t){this._performanceNow=t.performanceNow,this._startTime=this._performanceNow(),this._expirationTime=this._startTime+e.timeout,this._totalBytes=e.totalBytes,this._progressPoints=0}return e.prototype.doesActivityHaveRemainingCapacity=function(e){var t=this._getRateRatio(e);return void 0===t||t<=1},e.prototype.didActivityHaveExtraCapacity=function(){return this._getRateRatio(this._totalBytes)<=.5},e.prototype._getRateRatio=function(e){this._progressPoints++;var t,r=this._performanceNow(),a=r-this._startTime,n=this._expirationTime-r,o=this._totalBytes-e;return(this._progressPoints>=4&&a>=4e3||this._progressPoints>0&&0===o)&&n>0&&(t=o/n/(e/a)),t},e}();t.ActivityBandwidthVerifier=a},c21819129ba64362c121:function(e,t,r){"use strict";r.d(t,"a",function(){return n}),r.d(t,"b",function(){return o});var a=r("447964f318fe44ff3682"),n=new a.a("entryBatch"),o=new a.a("sourceFile")},c3cad731bb834f32ee95:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("64328bb588b46459132d"),n=r("a24d70c7702f13f024d9"),o=r("4e087ea06522888b2152"),i=r("0b8514f932f40951d460"),c=r("c1a09d7dd35e11297e15"),s=62914560,u=Math.pow(2,.25),d=function(){function e(e,t){this._uploadService=t.uploadService,this._activityBandwidthVerifierType=t.activityBandwidthVerifierType;var r=t.useCommitForUpload,a=void 0!==r&&r,n=t.checkForCompletedUploadOnSessionTermination,o=void 0===n||n,i=t.shouldCancelOnCompleteFailure,c=void 0===i||i,u=t.maximumFragmentSize,d=void 0===u?s:u;this._shouldCancelOnCompleteFailure=c,this._useCommitForUpload=a,this._checkForCompletedUploadOnSessionTermination=o,this._maximumFragmentSize=d}return e.prototype.advanceState=function(e,t){var r=this,a=t.sessionUrl,n=t.nextExpectedRanges;return(a?n?this._uploadItemState(e,t):this._getStatusState(e,t):this._createSessionState(e,t)).then(function(t){return t.error?r._handleGeneralErrorState(e,t):r._getState(t,{waitDuration:void 0,attemptsRemaining:void 0})})},e.prototype._createSessionState=function(e,t){var r=this,i=e.qosData,c=new o.Qos({name:"VroomUploader.createSession",extraData:i});return this._uploadService.createSession({qosData:i,itemUrl:e.itemUrl,headers:e.headers,allowCookies:e.allowCookies,accessToken:e.accessToken,fileName:e.fileName,fileSize:e.content.size,eTag:e.eTag,lastModifiedDate:e.lastModifiedDate,conflictBehavior:t.conflictBehavior,ignoreCookieAuth:e.ignoreCookieAuth}).then(function(e){return c.end({resultType:o.ResultTypeEnum.Success}),r._getState(t,{nextExpectedRanges:e.nextExpectedRanges,sessionUrl:e.uploadUrl})},function(s){return r._handleCreateSessionErrorState(e,r._getState(t,{error:s})).then(function(e){return e.error?c.end({resultType:o.ResultTypeEnum.Failure,error:s.message,resultCode:n.getResultCodeFromError(s),extraData:a.__assign({},i,n.getQosExtraDataFromError(s))}):c.end({resultType:o.ResultTypeEnum.ExpectedFailure,resultCode:"Canceled"}),e})})},e.prototype._handleCreateSessionErrorState=function(e,t){var r=this;return this._handleErrorState(t,function(a,n){switch(a){case"entityTagDoesNotMatch":case"resourceModified":case"versionNumberDoesNotMatch":case"nameAlreadyExists":case"unlockRequired":case 409:case 412:return r._promptForConflictBehaviorState(n,e,t)}})},e.prototype._getStatusState=function(e,t){var r=this,i=e.qosData,c=new o.Qos({name:"VroomUploader.getStatus",extraData:i});return this._uploadService.getStatus({qosData:i,sessionUrl:t.sessionUrl}).then(function(e){return c.end({resultType:o.ResultTypeEnum.Success}),r._getState(t,{nextExpectedRanges:e.nextExpectedRanges})},function(e){return c.end({resultType:o.ResultTypeEnum.Failure,error:e.message,resultCode:n.getResultCodeFromError(e),extraData:a.__assign({},i,n.getQosExtraDataFromError(e))}),r._getState(t,{error:e})})},e.prototype._uploadItemState=function(e,t){var r=this,i=e.qosData,c=e.content.size,s=this._getNextRange({fileSize:c,nextExpectedRanges:t.nextExpectedRanges}),u=new o.Qos({name:"VroomUploader.uploadItem",extraData:e.qosData});return(s&&s.start<c?t.allowStreaming?this._uploadStreamState({nextRange:s},e,t):this._uploadFragmentState({nextRange:s},e,t):this._useCommitForUpload?this._commitState(e,t):this._shouldCancelOnCompleteFailure?this._cancelSessionState(e,t):this._terminateUploadOnCompleteFailure(t)).then(function(t){return t.error?r._handleUploadItemErrorState(e,t).then(function(e){var t=e.error;return t?u.end({resultType:o.ResultTypeEnum.Failure,error:t.message,resultCode:n.getResultCodeFromError(t),extraData:a.__assign({},i,n.getQosExtraDataFromError(t))}):u.end({resultType:o.ResultTypeEnum.Success}),e}):(u.end({resultType:o.ResultTypeEnum.Success}),t)})},e.prototype._terminateUploadOnCompleteFailure=function(e){return i.default.resolve(this._getState(e,{error:new Error("The upload session is still open but there are no more bytes to upload.")}))},e.prototype._uploadFragmentState=function(e,t,r){var i=this,s=e.nextRange,d=t.onProgress,l=t.headers,f=t.content,m=t.content.size,p=t.qosData,b=r.sessionUrl,h=r.speed,v=void 0===h?1/8:h,g=s.start,_=s.end;d&&d(g);var y,S,w=this._getFragmentSize(v),I=Math.min(g+w,_),F=new c.default(function(){y&&y.cancel()}),O=v>1/1920?6e4:3e5,E=new this._activityBandwidthVerifierType({timeout:O,totalBytes:I-g}),T=new o.Qos({name:"VroomUploader.uploadFragment",extraData:a.__assign({},p,{startByte:g,endByte:I,fileSize:m,speed:v,fragmentSize:w})});return(y=this._uploadService.uploadFragment({qosData:p,headers:l,sessionUrl:b,startByte:g,endByte:I,fileSize:m,content:f.slice(g,I),timeout:O,onProgress:function(e){S=e,v>1/1920&&!E.doesActivityHaveRemainingCapacity(e-g)&&(T.end({resultType:o.ResultTypeEnum.ExpectedFailure,resultCode:"Aborted",extraData:a.__assign({},p,{lastByte:e})}),F.complete(i._getState(r,{speed:Math.max(.5*v,1/1920),nextExpectedRanges:void 0})),y&&y.cancel()),d&&d(e)}}).then(function(e){return d&&d(I),T.end({resultType:o.ResultTypeEnum.Success}),r=i._isItem(e)?i._getState(r,{item:e}):i._getState(r,{nextExpectedRanges:e.nextExpectedRanges,speed:Math.min(E.didActivityHaveExtraCapacity()?v*u:v,1)})},function(e){return T.end({resultType:o.ResultTypeEnum.Failure,error:e.message,resultCode:n.getResultCodeFromError(e),extraData:a.__assign({},p,n.getQosExtraDataFromError(e),{lastByte:S})}),i._getState(r,{error:e})})).done(function(e){F.complete(e)}),F.getPromise()},e.prototype._uploadStreamState=function(e,t,r){var i=this,s=e.nextRange,u=t.headers,d=t.onProgress,l=t.content,f=t.content.size,m=t.qosData,p=r.sessionUrl,b=s.start,h=s.end,v=Math.min(h-b,this._maximumFragmentSize),g=b+v;d&&d(b);var _,y=new c.default(function(){_&&_.cancel()}),S=new o.Qos({name:"VroomUploader.uploadStream",extraData:a.__assign({},m,{startByte:b,endByte:g,fileSize:f,fragmentSize:v})});return(_=this._uploadService.uploadFragment({qosData:m,headers:u,sessionUrl:p,startByte:b,endByte:g,fileSize:f,content:l.slice(b,g),timeout:864e5,onProgress:function(e){d&&d(e)}}).then(function(e){return d&&d(g),S.end({resultType:o.ResultTypeEnum.Success}),r=i._isItem(e)?i._getState(r,{item:e}):i._getState(r,{nextExpectedRanges:e.nextExpectedRanges})},function(e){return S.end({resultType:o.ResultTypeEnum.Failure,error:e.message,resultCode:n.getResultCodeFromError(e),extraData:a.__assign({},m,n.getQosExtraDataFromError(e),{lastByte:void 0})}),i._handleUploadStreamErrorState({nextRange:s},t,i._getState(r,{error:e}))})).done(function(e){y.complete(e)}),y.getPromise()},e.prototype._handleUploadStreamErrorState=function(e,t,r){var a=this,n=e.nextRange;return this._handleErrorState(r,function(e){switch(e){case 0:return a._wait({duration:1e3},t).then(function(){return a._getStatusState(t,r).then(function(e){return a._getNextRange({fileSize:t.content.size,nextExpectedRanges:e.nextExpectedRanges}).start>n.start?e:a._getState(r,{allowStreaming:!1})})})}})},e.prototype._commitState=function(e,t){var r=this,i=e.qosData,c=e.onProgress;c&&c(e.content.size);var s=new o.Qos({name:"VroomUploader.commit",extraData:i});return this._uploadService.commit({qosData:i,itemUrl:e.itemUrl,accessToken:e.accessToken,fileName:e.fileName,sessionUrl:t.sessionUrl,conflictBehavior:t.conflictBehavior}).then(function(e){return s.end({resultType:o.ResultTypeEnum.Success}),r._getState(t,{item:e})},function(e){return r._handleCommitErrorState(r._getState(t,{error:e})).then(function(t){return s.end({resultType:t.error?o.ResultTypeEnum.Failure:o.ResultTypeEnum.ExpectedFailure,error:e.message,resultCode:n.getResultCodeFromError(e),extraData:a.__assign({},i,n.getQosExtraDataFromError(e))}),t})})},e.prototype._handleCommitErrorState=function(e){var t=this;return this._handleErrorState(e,function(r){switch(r){case"uploadSessionFailed":case"uploadSessionNotFound":case 410:return i.default.resolve(t._getState(e,{error:void 0,sessionUrl:void 0}))}})},e.prototype._cancelSessionState=function(e,t){var r=this,i=e.qosData,c=new o.Qos({name:"VroomUploader.cancelSession",extraData:i});return this._uploadService.cancelSession({qosData:e.qosData,sessionUrl:t.sessionUrl}).then(function(){return c.end({resultType:o.ResultTypeEnum.Success}),r._getState(t,{sessionUrl:void 0})},function(e){return c.end({resultType:o.ResultTypeEnum.Failure,error:e.message,resultCode:n.getResultCodeFromError(e),extraData:a.__assign({},i,n.getQosExtraDataFromError(e))}),r._getState(t,{sessionUrl:void 0})})},e.prototype._handleUploadItemErrorState=function(e,t){var r=this,a=t.speed,n=void 0===a?1:a;return t=this._getState(t,{nextExpectedRanges:void 0}),this._handleErrorState(t,function(a,o){switch(a){case 0:return window.navigator.onLine?t.allowStreaming?i.default.resolve(r._getState(t,{allowStreaming:!1})):i.default.resolve(r._getState(t,{speed:Math.max(n*(1/8),1/1920)})):void 0;case"uploadSessionFailed":case"uploadSessionNotFound":case 404:return i.default.resolve(r._getState(t,{error:void 0,sessionUrl:void 0}));case"entityTagDoesNotMatch":case"resourceModified":case"versionNumberDoesNotMatch":case"nameAlreadyExists":case"unlockRequired":case 409:case 412:return r._promptForConflictBehaviorState(o,e,t);case"invalidRange":case 416:return r._wait({duration:1e3},e).then(function(){return r._getState(t,{error:void 0})})}})},e.prototype._getItemIfCompletedState=function(e,t){var r=this,i=e.qosData,c=new o.Qos({name:"VroomUploader.getItemIfCompleted",extraData:i});return this._uploadService.getItem({qosData:i,fileName:e.fileName,itemUrl:e.itemUrl,accessToken:e.accessToken}).then(function(a){return c.end({resultType:o.ResultTypeEnum.Success}),e.lastModifiedDate&&a.fileSystemInfo&&a.fileSystemInfo.lastModifiedDateTime===e.lastModifiedDate.toISOString()&&a.size===e.content.size&&"rename"!==t.conflictBehavior?r._getState(t,{item:a,error:void 0}):r._getState(t,{error:new Error("The upload session has terminated but the existing item does not match the input.")})},function(e){return c.end({resultType:o.ResultTypeEnum.Failure,error:e.message,resultCode:n.getResultCodeFromError(e),extraData:a.__assign({},i,n.getQosExtraDataFromError(e))}),r._getState(t,{error:e})})},e.prototype._handleGeneralErrorState=function(e,t){var r=this,a=t.waitDuration,n=void 0===a?500:a,o=t.attemptsRemaining,i=void 0===o?10:o;return this._handleErrorState(t,function(a){switch(a){case"uploadSessionNotFound":return r._checkForCompletedUploadOnSessionTermination?r._getItemIfCompletedState(e,t):void 0;case"authFailure":case"unauthenticated":case 401:case"lockMismatch":case 423:case 501:case"quotaLimitReached":case 507:return}if("number"==typeof a){if(a>=400&&a<500)return;if(0===a||a>=500&&a<600)return r._wait({duration:n,allowWakeWhenOnline:!0},e).then(function(){return r._getState(t,{error:void 0,waitDuration:Math.min(2*n,3e4),attemptsRemaining:void 0})});if(!i)return;return r._wait({duration:1e3},e).then(function(){return r._getState(t,{error:void 0,waitDuration:void 0,attemptsRemaining:Math.max(i-1,0)})})}})},e.prototype._handleErrorState=function(e,t){var r=e.error,a=n.getErrorResolution(r,t);return void 0===a&&(a=i.default.resolve(e)),a},e.prototype._promptForConflictBehaviorState=function(e,t,r){var c=this,s=t.onPromptForConfictBehavior,u=t.qosData,d=new o.Qos({name:"VroomUploader.promptForConflictBehavior",extraData:u});return i.default.resolve().then(function(){return s(e)}).then(function(e){return d.end({resultType:o.ResultTypeEnum.Success,extraData:u}),c._getState(r,{error:void 0,conflictBehavior:e})},function(t){return d.end({resultType:o.ResultTypeEnum.Failure,error:t.message,resultCode:n.getResultCodeFromError(e),extraData:a.__assign({},u,n.getQosExtraDataFromError(t))}),c._getState(r,{error:t})})},e.prototype._wait=function(e,t){var r=e.duration,a=e.allowWakeWhenOnline,c=t.onWait,s=t.qosData,u=new o.Qos({name:"VroomUploader.wait",extraData:s});return i.default.resolve(c({duration:r,allowWakeWhenOnline:a})).then(function(){u.end({resultType:o.ResultTypeEnum.Success})},function(e){return u.end({resultType:i.default.isCanceled(e)?o.ResultTypeEnum.Success:o.ResultTypeEnum.Failure,error:e&&e.message,resultCode:n.getResultCodeFromError(e)}),i.default.reject(e)})},e.prototype._getState=function(e,t){return a.__assign({},e,t)},e.prototype._getNextRange=function(e){var t=e.fileSize,r=e.nextExpectedRanges;return(void 0===r?[]:r).reduce(function(e,r){var a,n=r.split("-",2),o=n[0],i=n[1],c=parseInt(o,10);!e||c<e.start&&c<t?a={start:c,end:""===i?t:Math.min(parseInt(i,10)+1,t)}:a=e;return a},void 0)},e.prototype._isItem=function(e){return!!e.id},e.prototype._getFragmentSize=function(e){var t,r=e*s;return t=r>327680?r-r%327680:r-r%32768,Math.min(Math.max(t,32768),this._maximumFragmentSize)},e}();t.UploadStateMachine=d},cbd3c20d233b105c7895:function(e,t,r){"use strict";r.d(t,"a",function(){return a});var a=new(r("264a40ebead766e0e784").ControlFacet)("removeFromShardListActionControl")},cfef2ab49d0d7bc1e869:function(e,t,r){"use strict";var a,n=r("d6e6a1e726db94fe6759"),o=r("4986dedaa57d766e48bb")._Qr9VWNQuRRaLzAyN3mwy4A;function i(e){return function(t){return function(e,t){switch(e){case a.InvalidCharacters:return n.format(o.invalidNameError,t.invalidCharacters);case a.InvalidStart:return n.format(o.invalidNameStartError,t.cannotStartWith);case a.InvalidEnd:return n.format(o.invalidNameEndError,t.cannotEndWith);case a.Empty:return o.emptyNameError;case void 0:return}}(function(e,t){var r=e.trim();return 0===r.length?a.Empty:t.invalidCharactersRegex.test(r)?a.InvalidCharacters:t.cannotStartWithRegex&&t.cannotStartWithRegex.test(r)?a.InvalidStart:t.cannotEndWithRegex&&t.cannotEndWithRegex.test(r)?a.InvalidEnd:void 0}(t,e),e)}}r.d(t,"a",function(){return c}),r.d(t,"b",function(){return s}),function(e){e[e.InvalidStart=0]="InvalidStart",e[e.InvalidEnd=1]="InvalidEnd",e[e.InvalidCharacters=2]="InvalidCharacters",e[e.Empty=3]="Empty"}(a||(a={}));var c=i({invalidCharactersRegex:/["\*:<>\?\/\\\|]/,invalidCharacters:'" * : < > ? / \\ |'}),s=i({invalidCharactersRegex:/["\*:<>\?\/\\\|#%]/,invalidCharacters:'" * : < > ? / \\ # %|'})},e98307e3d02bf06255ee:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("64328bb588b46459132d"),n=r("c1a09d7dd35e11297e15"),o=function(){function e(e,t){this._dataRequestor=t.dataRequestor}return e.prototype.createSession=function(e){var t=e.qosData,r=e.itemUrl,n=e.headers,o=e.allowCookies,c=e.accessToken,s=e.fileName,u=e.fileSize,d=e.lastModifiedDate,l=e.eTag,f=e.conflictBehavior,m=e.ignoreCookieAuth,p={item:a.__assign({},i(r)?{"@microsoft.graph.conflictBehavior":f}:{"@name.conflictBehavior":f},d?{fileSystemInfo:{lastModifiedDateTime:d.toISOString()}}:{})},b=a.__assign({},l?{"If-Match":l}:{},m?{IgnoreCookieAuthentication:"t"}:{},{Prefer:"synchronousmetadata"},n);return this._dataRequestor.send({path:r+"/"+encodeURIComponent(s)+":/"+(i(r)?"createUploadSession":"oneDrive.createUploadSession"),requestType:"POST",apiName:"CreateSession",headers:b,allowCookies:o,accessToken:c,useAuthorizationHeaders:!0,postData:JSON.stringify(p),qosExtraData:a.__assign({conflictBehavior:f,fileSize:u},t)})},e.prototype.cancelSession=function(e){var t=e.qosData,r=e.sessionUrl;return this._dataRequestor.send({requestType:"DELETE",apiName:"CancelSession",path:r,needsAuthorization:!1,qosExtraData:t})},e.prototype.uploadFragment=function(e){var t=e.qosData,r=e.headers,o=e.sessionUrl,i=e.startByte,c=e.endByte,s=e.fileSize,u=e.content,d=e.timeout,l=e.onProgress,f=a.__assign({"Content-Range":"bytes "+i+"-"+Math.max(c-1,i)+"/"+s},r),m=!0,p=this._dataRequestor.send({path:o,needsAuthorization:!1,requestType:"PUT",apiName:"UploadFragment",headers:f,postData:u,timeout:d,hasContentType:!1,onUploadProgress:function(e){e.lengthComputable&&m&&l(i+e.loaded)},qosExtraData:a.__assign({},t,{startByte:i,endByte:c,fileSize:s})}),b=new n.default(function(){m=!1,p.cancel()});return p.done(function(e){m=!1,b.complete(e)},function(e){m=!1,b.error(e)}),b.getPromise()},e.prototype.commit=function(e){var t=e.qosData,r=e.itemUrl,n=e.accessToken,o=e.fileName,c=(e.description,e.eTag),s=e.conflictBehavior,u=e.sessionUrl,d={"If-Match":c},l=i(r)?{"@microsoft.graph.conflictBehavior":s,"@microsoft.graph.sourceUrl":u}:{"@name.conflictBehavior":s,"@content.sourceUrl":u};return this._dataRequestor.send({path:r+"/"+encodeURIComponent(o),requestType:"PUT",apiName:"CommitSession",headers:d,accessToken:n,useAuthorizationHeaders:!0,postData:JSON.stringify(l),qosExtraData:a.__assign({conflictBehavior:s},t)})},e.prototype.getStatus=function(e){var t=e.qosData,r=e.sessionUrl;return this._dataRequestor.send({requestType:"GET",apiName:"GetStatus",path:r,needsAuthorization:!1,qosExtraData:t})},e.prototype.getItem=function(e){var t=e.qosData,r=e.itemUrl,n=e.accessToken,o=e.fileName;return this._dataRequestor.send({requestType:"GET",apiName:"GetItem",path:r+"/"+encodeURIComponent(o),useAuthorizationHeaders:!0,accessToken:n,qosExtraData:a.__assign({},t)})},e}();function i(e){return 0===e.toLowerCase().lastIndexOf("https://graph.microsoft.com",0)}t.UploadService=o},e9c8562c28ece80d4f49:function(e,t,r){"use strict";r.r(t),r.d(t,"createFolderDialogControlHandler",function(){return u});var a=r("a4060cda3c9c24220a4a"),n=r("5e76ddf6bb30811ee697"),o=r("fcf654cc44d7ec457fe0"),i=r("ee92087a6ec1d0e9ecc9"),c=r("95da7825c4969f34e250"),s=r("cfef2ab49d0d7bc1e869"),u=Object(c.a)()(function(){return function(e){return function(e,t){var r,c=t.itemKey,u=e.demandItemFacet(a.D,c),d=s.a;if(u&&c){var l=u.rootFolder||new o.SimpleUri(u.listFullUrl).path,f=new n.a({context:{webAbsoluteUrl:u.webAbsoluteUrl,listUrl:u.listFullUrl}}),m=f.getUrlParts({path:l});m.fullItemUrl&&(r=400-m.fullItemUrl.length);var p=u&&e.demandItemFacet(i.qc,a.Q.serialize({webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl}));!p||p.supportPoundStorePath&&p.supportPercentStorePath||(d=s.b)}return{validator:d,maxLength:r}}}})},f4ada3c3607c09804e69:function(e,t,r){"use strict";r.d(t,"c",function(){return c}),r.d(t,"b",function(){return s}),r.d(t,"a",function(){return u});var a=r("56aac858adc5742217b8"),n=r("a9dd204dd0bee7467912"),o=r("6dec44e5485412f70439"),i=r("a24d70c7702f13f024d9");function c(e,t){var r=t+"/me/drive";return Object(o.f)({url:r,qosName:e,method:"POST",endpoint:t})}function s(e,t,r,a,n){var i=r.itemId,c=r.driveId,s=n.replace("v2.0","v2.1")+"/drives/"+t+"/root/children",u={name:e,remoteItem:{id:i||"",parentReference:{driveId:c||""}}};return Object(o.f)({url:s,qosName:a,method:"POST",body:u,endpoint:n})}function u(e){var t=Object(i.getErrorResolution)(e,function(e,t){switch(e){case"unauthenticated":case 401:return n.b.pack({});case"itemNotFound":case 404:return n.f.pack({});case"accessDenied":case 403:return n.a.pack({});default:return n.m.pack({})}});throw new a.a({innerError:e,facets:t})}},fcf0c1042bbdc766028e:function(e,t,r){"use strict";r.r(t);var a=r("275976081ce1abf67779"),n=r("c9764d34b3eb6a106977"),o=r("b0e26fa7634e6889091e"),i=r("8183bb1c55fccc7b597d"),c=r("82a5b752ca799aba4856"),s=r("b1dcd93e69c85f76518a"),u=r("4986dedaa57d766e48bb")._MSLAghTqZZ9UlMeNWvkeGQ;r.d(t,"ConfirmationDialog",function(){return d});var d=function(e){var t=e.onConfirm,r=e.onCancel,d=e.defaultToYes,l=void 0!==d&&d,f=e.yesText,m=void 0===f?u.yes:f,p=e.noText,b=void 0===p?u.no:p,h=l?i.a:c.a,v=l?c.a:i.a;return a.createElement(n.a,{onDismiss:r,isOpen:!0,title:e.title,maxWidth:e.maxWidth},a.createElement(s.a,null,e.prompt),a.createElement(o.a,null,a.createElement(h,{"data-automationid":"confirmbutton",onClick:t},m),a.createElement(v,{"data-automationid":"cancelbutton",onClick:r,componentRef:function(e){e&&e.focus()}},b)))}}}]);