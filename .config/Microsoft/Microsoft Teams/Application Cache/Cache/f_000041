webpackJsonp([23],{133:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.getXpathTo=function(e,t,r){if(void 0===t&&(t=!0),t&&""!==e.id)return'id("'+e.id+'")';if(r&&r(e),e===document.body||e===document.documentElement)return e.tagName;var n=0;if(!e.parentElement)return this.getElementIdentifier(e);for(var o=e.parentElement.children,i=0;i<o.length;i++){var s=o[i];if(s===e)return this.getXpathTo(e.parentElement,t,r)+"/"+this.getElementIdentifier(e)+"["+(n+1)+"]";1===s.nodeType&&s.tagName===e.tagName&&n++}},e.prototype.getElementIdentifier=function(e){return e.tagName},e.prototype.walkDomTree=function(e,t,r){void 0===r&&(r=[]);var n=r,o=[e];do{var i=o.pop();t(i,n),_.forEach(i.children,function(e){o.push(e)})}while(o.length>0);return n},e}();t.DOMTreeWalker=n},2124:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(2125),r(2132)},2125:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2126),o=r(2127),i=r(2128),s=r(2129),a=r(2130),u=r(2131),c=function(){function e(e,t,r){this.$rootScope=e,this.moduleMemoryCalculator=new n.AngularModuleMemoryCalculator(e,r),this.scopeMemoryCalculator=new o.ScopeMemoryCalculator(e,r),this.windowMemoryCalculator=new i.WindowMemoryCalculator(e,r),this.eventListenerWalker=new s.EventListenerDOMWalker,this.eventListenerV2Walker=new a.DetachedDomEventFinder(t),this.scopeDOMWalker=new u.ScopeDOMWalker}return e.$inject=["$rootScope","utilityService","$injector"],e.mapAngularMemorySizeResults=function(e){var t=[];return _.forEach(e.memorySizeDictionary,function(e){t.push(e)}),t},e.prototype.calculateTeamsAppModuleMemorySize=function(t){void 0===t&&(t=!1);var r=this.moduleMemoryCalculator.calculateAngularModuleMemorySize("teamspace",{memorySizeDictionary:{},computedModules:{}},t);return e.mapAngularMemorySizeResults(r)},e.prototype.sizeOfRootScopeInMB=function(){return this.scopeMemoryCalculator.sizeOfRootScopeInMB()},e.prototype.mapScopeMemoryResults=function(e){var t=[],r=this.scopeDOMWalker.createScopeElementMap();return _.forEach(e,function(e,n){var o={};o.id=n,o.xpath=void 0,o.watchCount=0,r[n]&&(o.xpath=r[n].xpath,o.watchCount=r[n].watchCount),o.sizeInMB=e,t.push(o)}),t},e.prototype.analyzeScopeMemory=function(){var e=this.scopeMemoryCalculator.traverseAndMeasureScopes(this.$rootScope);return this.mapScopeMemoryResults(e)},e.prototype.windowSize=function(){return this.windowMemoryCalculator.windowSize()},e.prototype.analyzeEventListeners=function(){var e=this.eventListenerWalker.getAllEventListenersFromDocumentNode();return e.sort(function(e,t){return t.listenerCount-e.listenerCount}),console.log("All Event Listeners"),console.table(e),e},e.prototype.analyzeScopeInfo=function(){var e=document.documentElement,t=this.scopeDOMWalker.populateScopeInformation(e);return console.log("All Scope Info"),console.table(t),t},e.prototype.startAnalysisForEventLeaks=function(){var e=this,t=this.eventListenerWalker.getAllEventListenersFromDocumentNode();return function(){var r=e.eventListenerWalker.getAllEventListenersFromDocumentNode();return e.diffEventListenerSnapshots(t,r)}},e.prototype.startAnalysisForEventLeaksV2=function(){var e=this;return this.eventListenerV2Walker.start(),function(){var t=e.eventListenerV2Walker.getRemovedElementsWithPendingEventsAttached();return e.eventListenerV2Walker.stop(),t}},e.prototype.diffEventListenerSnapshots=function(e,t){for(var r=_.intersectionBy(e,t,"xpath"),n=[],o=0;o<r.length;o++){var i=_.find(e,{xpath:r[o].xpath}),s=_.find(t,{xpath:r[o].xpath});s.listenerCount>i.listenerCount&&n.push({elementTag:i.elementTag,xpath:i.xpath,eventSummaryBefore:i.eventSummary,eventSummaryAfter:s.eventSummary,listenerCountDiff:s.listenerCount-i.listenerCount})}return n.length>0&&(console.error("Leaks found!"),console.table(n)),n},e.prototype.startAnalysisForScopeLeaks=function(){var e=this,t=this.scopeDOMWalker.populateScopeInformation(document.documentElement);return function(){var r=e.scopeDOMWalker.populateScopeInformation(document.documentElement);return e.diffScopeListenerSnapshots(t,r)}},e.prototype.diffScopeListenerSnapshots=function(e,t){for(var r=_.intersectionBy(e,t,"xpath"),n=[],o=0;o<r.length;o++){var i=_.find(e,{xpath:r[o].xpath}),s=_.find(t,{xpath:r[o].xpath});s.listenerCount>i.listenerCount&&n.push({id:s.id,xpath:i.xpath,listenerSummaryBefore:i.listenerSummary,listenerSummaryAfter:s.listenerSummary,listenerCountDiff:s.listenerCount-i.listenerCount})}return n.length>0&&(console.error("Leaks found!"),console.table(n)),n},e.prototype.startAnalysisForServiceLeaks=function(e){var t=this,r=this.calculateTeamsAppModuleMemorySize(e);return function(){var n=t.calculateTeamsAppModuleMemorySize(e);return t.diffModuleMemorySnapshots(r,n)}},e.prototype.diffModuleMemorySnapshots=function(e,t){for(var r=_.intersectionWith(e,t,function(e,t){return e.provider===t.provider&&e.moduleName===t.moduleName&&e.providerMethod===t.providerMethod&&e.providerName===t.providerName}),n=[],o=0;o<r.length;o++){var i=_.find(e,{provider:r[o].provider,moduleName:r[o].moduleName,providerMethod:r[o].providerMethod,providerName:r[o].providerName}),s=_.find(t,{provider:r[o].provider,moduleName:r[o].moduleName,providerMethod:r[o].providerMethod,providerName:r[o].providerName}),a=this.diffSubscriptions(s.subscriptions,i.subscriptions);(s.sizeInMB-i.sizeInMB>0||a.length>0)&&n.push({provider:r[o].provider,moduleName:r[o].moduleName,providerMethod:r[o].providerMethod,providerName:r[o].providerName,sizeInMBBefore:i.sizeInMB,sizeInMBAfter:s.sizeInMB,sizeInMBDiff:s.sizeInMB-i.sizeInMB,subscriptionCountDiff:a})}return n.length>0&&(console.error("Leaks found in services"),console.table(n)),n},e.prototype.diffSubscriptions=function(e,t){var r=this.mapValues(_.values(e)),n=this.mapValues(_.values(t)),o=[];return r.forEach(function(e,t){n.has(t)?e-n.get(t)>0&&o.push({signature:t,signatureSource:"after",countDiff:e-n.get(t)}):o.push({signature:t,signatureSource:"after",countDiff:e})}),o},e.prototype.mapValues=function(e){var t=new Map;return _.values(e).forEach(function(e){if(t.has(e)){var r=t.get(e);r+=1,t.set(e,r)}else t.set(e,1)}),t},e}();t.MemoryAnalysisService=c,angular.module("teamspace.memoryAnalysisService",[]).service("memoryAnalysisService",c)},2126:function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,r){return e.call(this,t,r)||this}return n(t,e),t.prototype.enumerateProviderQueue=function(e){var t=[];_.forEach(e,function(e){t.push(e)});for(var r=[];t.length>0;){var n=t.pop();if(r.push(n),n[2].length>2){var o=n[2][1],i=o.slice(0,o.length-1);t.concat(i)}}return r},t.prototype.getSubscriberCount=function(e){return e instanceof SkypeX.Services.ObservableBase?_.mapValues(e._subsByNum,function(e){return e.callback.toString()}):e instanceof teamspace.services.stores.SingleStateStoreImpl||e instanceof teamspace.services.stores.MultiStateStoreImpl?_.mapValues(e.listeners,function(e){return e.onStateChanged.toString()}):{}},t.prototype.getMemorySizeOfProviders=function(e,t,r,n){var o=this,i=this.enumerateProviderQueue(t);return _.forEach(i,function(t){var i=t[0],s=t[1],a=t[2][0],u=e+":"+i+":"+s+":"+a;try{if(!r[u]&&o.$injector.has(a)){var c=o.$injector.get(a),p=n(c)/o.mBValue;r[u]={moduleName:e,provider:i,providerMethod:s,providerName:a,sizeInMB:p,subscriptions:o.getSubscriberCount(c)}}}catch(e){console.error(e),console.error("Unable to get injector for "+a)}}),r},t.prototype.getMemorySizeOfModule=function(e,t,r){return this.getMemorySizeOfProviders(e,angular.module(e)._invokeQueue,t,r)},t.prototype.calculateAngularModuleMemorySize=function(e,t,r){void 0===r&&(r=!1);var n=[];for(n.push(e);0!==n.length;){var o=n.shift();t.computedModules[o]=!0,console.log("calculating mem size of module BFS : "+o),t.memorySizeDictionary=this.getMemorySizeOfModule(o,t.memorySizeDictionary,r?function(){return 0}:this.sizeofProvider.bind(this)),_.forEach(angular.module(o).requires,function(e){t.computedModules[e]||n.push(e)})}return t},t}(r(84).MemoryCalculator);t.AngularModuleMemoryCalculator=o},2127:function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,r){return e.call(this,t,r)||this}return n(t,e),t.prototype.visit=function(e,t){t[e.$id]||(console.log("visiting scope : "+e.$id),t[e.$id]=this.sizeofScope(e)/this.mBValue)},t.prototype.traverseBFS=function(e,t){var r=[];for(r.push(e);0!==r.length;){var n=r.shift();this.visit(n,t),n.$$nextSibling&&r.push(n.$$nextSibling),n.$$childHead&&r.push(n.$$childHead)}},t.prototype.traverseAndMeasureScopes=function(e){var t={};return this.traverseBFS(e,t),t},t.prototype.sizeOfRootScopeInMB=function(){return this.sizeOfRootScope()/this.mBValue},t}(r(84).MemoryCalculator);t.ScopeMemoryCalculator=o},2128:function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,r){return e.call(this,t,r)||this}return n(t,e),t.prototype.windowSize=function(){var e={};for(var t in window)"object"==typeof window[t]&&(e[t]=this.sizeofProvider(window[t])/this.mBValue);return e.window=this.sizeofWindowReference(window)/this.mBValue,e},t}(r(84).MemoryCalculator);t.WindowMemoryCalculator=o},2129:function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return e.call(this)||this}return n(t,e),t.prototype.getAllEventListenersFromDocumentNode=function(){var e=document.documentElement;return this.getAllEventListenersFromNode(e)},t.prototype.getAllEventListenersFromNode=function(e){var t=this;return this.walkDomTree(e,function(e,r){if(e){var n=$._data(e,"events"),o=0;if(n&&Object.keys(n).forEach(function(e){o+=n[e].length}),o>0){var i=Object.keys(n).sort().map(function(e){return e+": "+n[e].length}).join("\n").trim(),s=t.getXpathTo(e);r.push({elementTag:e.tagName,listenerCount:o,xpath:s,eventSummary:i,eventList:n})}}},[])},t}(r(133).DOMTreeWalker);t.EventListenerDOMWalker=o},2130:function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t){var r=e.call(this)||this;return r.utilityService=t,r}return n(t,e),t.prototype.start=function(){this.setupSpy(),this.eventListenerCache={}},t.prototype.stop=function(){this.revertSpyForAddRemoveEventListener(),t.isSpying=!1,this.eventListenerCache=void 0},t.prototype.getRemovedElementsWithPendingEventsAttached=function(){var e={};for(var r in this.eventListenerCache){var n=this.eventListenerCache[r];if(n)for(var o in n){var i=n[o];if(i.handlers&&i.handlers.length){var s=$("["+t.listenerIdentifierAttributeName+"='"+o+"']");if(!(s&&s.length>0)){for(var a=[],u=0;u<i.handlers.length;u++)a.push(i.handlers[u].toString());var c=i.componentTagName?i.componentTagName:"UNKNOWN";e[c]||(e[c]=[]),e[c].push({listenerCount:i.handlers.length,xpath:i.xpath,tag:i.tag,eventName:r,class:i.class,handlers:a})}}}}return e},t.prototype.setupSpy=function(){t.isSpying||(t.isSpying=!0,this.setupSpyForAddRemoveEventListener())},t.prototype.setupSpyForAddRemoveEventListener=function(){var e=this;this.addEventListenerOriginal=Element.prototype.addEventListener,Element.prototype.addEventListener=function(t,r){e.addEventListenerSpy.call(e,this,t,r,arguments)},this.removeEventListenerOriginal=Element.prototype.removeEventListener,Element.prototype.removeEventListener=function(t,r){e.removeEventListenerSpy.call(e,this,t,r,arguments)}},t.prototype.revertSpyForAddRemoveEventListener=function(){Element.prototype.addEventListener=this.addEventListenerOriginal,this.addEventListenerOriginal=void 0,Element.prototype.removeEventListener=this.removeEventListenerOriginal,this.removeEventListenerOriginal=void 0},t.prototype.removeEventListenerSpy=function(e,r,n,o){var i=e.getAttribute(t.listenerIdentifierAttributeName);if(i){var s=this.eventListenerCache[r];if(s){var a=s[i];a&&_.remove(a.handlers,function(e){return e===n}),this.removeEventListenerOriginal.apply(e,o)}else this.removeEventListenerOriginal.apply(e,o)}else this.removeEventListenerOriginal.apply(e,o)},t.prototype.addEventListenerSpy=function(e,t,r,n){this.trackAddEventListener(e,t,r,n),this.addEventListenerOriginal.apply(e,n)},t.prototype.trackAddEventListener=function(e,r,n,o){var i=this.eventListenerCache[r];i||(i={},this.eventListenerCache[r]=i);var s=e.getAttribute(t.listenerIdentifierAttributeName);s||(s=this.utilityService.generateUUID(),e.setAttribute(t.listenerIdentifierAttributeName,s));var a=i[s],u=!0;if(!a){a={};try{var c;a.xpath=this.getXpathTo(e,!1,function(e){e&&e.tagName.indexOf("-")>0&&!c&&(c=e.tagName),e&&e.parentElement||(u=!1)}),a.componentTagName=c}catch(e){console.error("Error while getting xpath")}if(!u)return;a.class=e.className,a.tag=e.tagName,i[s]=a}a.handlers||(a.handlers=[]),_.some(a.handlers,function(e){return e===n})||a.handlers.push(n)},t.prototype.getElementIdentifier=function(e){var t=e.tagName;return e.className&&(t+="(class="+e.className+")"),t},t.listenerIdentifierAttributeName="elv2-id",t}(r(133).DOMTreeWalker);t.DetachedDomEventFinder=o},2131:function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return e.call(this)||this}return n(t,e),t.prototype.countListeners=function(e){var t=0;return _.each(e,function(e){e&&t++}),t},t.prototype.calculateScopeListenerCount=function(e){var t=this,r=0;return _.each(Object.keys(e.$$listeners),function(n){r+=t.countListeners(e.$$listeners[n])}),r},t.prototype.generateScopeListenerSummary=function(e){var t=this;return Object.keys(e.$$listeners).sort().map(function(r){return r+": "+t.countListeners(e.$$listeners[r])}).join("\n").trim()},t.prototype.populateScopeInformation=function(e){var t=this;return this.walkDomTree(e,function(e,r){if(e&&angular.element(e).isolateScope){var n=angular.element(e).isolateScope()||angular.element(e).scope();n&&!_.some(r,{id:n.$id})&&r.push({id:n.$id,xpath:t.getXpathTo(e),watchCount:n.$$watchersCount,listenerCount:t.calculateScopeListenerCount(n),listenerSummary:t.generateScopeListenerSummary(n)})}},[])},t.prototype.createScopeElementMap=function(){var e=this;return this.walkDomTree(document.documentElement,function(t,r){if(t&&angular.element(t).isolateScope){var n=angular.element(t).isolateScope()||angular.element(t).scope();n&&!r[n.$id]&&(r[n.$id]={id:n.$id,xpath:e.getXpathTo(t),watchCount:n.$$watchersCount})}},{})},t}(r(133).DOMTreeWalker);t.ScopeDOMWalker=o},2132:function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,r){return e.call(this,t,r)||this}return n(t,e),t.prototype.getQuerySize=function(e){return this.sizeofProvider(e)},t}(r(84).MemoryCalculator);t.QueryMemoryCalculator=o},84:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this.$rootScope=e,this.$injector=t,this.mBValue=1048576}return e.prototype.sizeofWindowReference=function(e){return this.sizeof(e,!1,!1,!1,!1,!0)},e.prototype.sizeOfRootScope=function(){return this.sizeof(this.$rootScope,!1,!0,!0,!0,!1)},e.prototype.sizeofScope=function(e){return this.sizeof(e,!1,!1,!0,!1,!1)},e.prototype.sizeofProvider=function(e){return this.sizeof(e,!1,!1,!1,!1,!1)},e.prototype.calcSize=function(e,t,r,n,o,i,s){var a=t.pop();if("boolean"==typeof a)e+=4;else if("string"==typeof a)e+=2*a.length;else if("number"==typeof a)e+=8;else if("object"==typeof a&&-1===r.indexOf(a)){r.push(a);for(var u in a)u.indexOf("wasmModule")>-1||!a.hasOwnProperty||!a.hasOwnProperty(u)||!n&&this.$injector.has(u.replace("_",""))||!o&&a[u]instanceof jQuery||!i&&a[u]instanceof this.$rootScope.constructor||!(s||"$$childHead"!==u&&"$$childTail"!==u&&"$$nextSibling"!==u&&"$$prevSibling"!==u&&"$root"!==u&&"$parent"!==u&&"$state"!==u)||t.push(a[u])}return[e,t,r]},e.prototype.sizeof=function(e,t,r,n,o,i){var s;void 0===t&&(t=!0),void 0===r&&(r=!0),void 0===n&&(n=!0),void 0===o&&(o=!0),void 0===i&&(i=!0);var a=[],u=[e],c=0;for(i||a.push(window);u.length;)c=(s=this.calcSize(c,u,a,t,r,n,o))[0],u=s[1],a=s[2];return c},e}();t.MemoryCalculator=n}},[2124]);