webpackJsonp([7],{135:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(2327),s=function(){function e(e,t,n,i,s,a,o,r,c,l,d,m,u,p,g,v){var h=this;this.$q=e,this.$scope=t,this.$timeout=n,this.$translate=i,this.analyticsService=s,this.ariaLiveService=a,this.constants=o,this.freemiumUtilities=r,this.identityService=c,this.loggingService=l,this.manageTenantService=d,this.resources=m,this.settingsService=u,this.tenantMembershipService=p,this.tenantService=g,this.utilityService=v,this._image="https://statics.teams.cdn.office.net/hashedassets/freemium_fre_invite_members-8b066e6.svg",this.defaultRowsToAdd=4,this.formInputSelector="div.invite-tenant-form-email-class input",this.inviteMemberDialogSendInviteTimeout=6e4,this.initialLoadTimeout=1e3,this.inviteSuccessStatus="success",this._isErrorBannerPending=!1,this._adminError=!1,this.closeFooterButton=void 0,this.sendFooterButton=void 0,this.panelRegions=teamspace.PanelRegion,this.memberList=[],this.hasReachedMemberLimit=!1,this.canShowSendInvitesButton=!1,this.sendingInvites=!1,this.isTenantAdmin=!1,this.isValidatingEmail=!1,this.isInitialLoadHappening=!0,this.isAnyAdded=!1,this.selectedTab="invitePeople";var b=this.defaultRowsToAdd;t.ngDialogData&&t.ngDialogData.isFre&&(this.isFre=t.ngDialogData.isFre);for(var f=0;f<b;f++)this.addMemberToList(!1);var _=e.defer();n(function(){return _.resolve()},this.initialLoadTimeout,!0),v.whenAllAllowFailures([_.promise]).then(function(){h.isInitialLoadHappening=!1,h.updateFooterButtons(),h.dialogHeader=i.instant(m.strings.freemium_invite_dialog_header),h.dialogTitle=i.instant(m.strings.freemium_invite_dialog_title)})}return e.$inject=["$q","$scope","$timeout","$translate","analyticsService","ariaLiveService","constants","freemiumUtilities","identityService","loggingService","manageTenantService","resources","settingsService","tenantMembershipService","tenantService","utilityService"],Object.defineProperty(e.prototype,"isErrorBannerPending",{get:function(){return this._isErrorBannerPending},set:function(e){this._isErrorBannerPending!==e&&(this._isErrorBannerPending=e)},enumerable:!0,configurable:!0}),e.prototype.calculateCanShowSendInvitesButton=function(){for(var e=!1,t=!1,n=0,i=this.memberList;n<i.length;n++){var s=i[n];s.emailAddress&&!s.isAdded&&(t=!0),s.error&&(e=!0)}this.canShowSendInvitesButton=!e&&t&&!this.hasReachedMemberLimit&&!this.sendingInvites,this.footerButtons.length>=2&&(this.footerButtons[1].disabled=!this.canShowSendInvitesButton)},e.prototype.close=function(){this.$scope.closeThisDialog()},Object.defineProperty(e.prototype,"image",{get:function(){return this._image},enumerable:!0,configurable:!0}),e.prototype.onUpgradeClick=function(){this.freemiumUtilities.openUpgradeTeamsUrl(),this.$scope.closeThisDialog()},Object.defineProperty(e.prototype,"adminError",{get:function(){return this._adminError},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"adminCountString",{get:function(){return this.$translate.instant(this.resources.strings.storage_exceeded_dialog_remaining_admins_text,{adminCount:this.admins.length})},enumerable:!0,configurable:!0}),e.prototype.addMemberToList=function(e){var t=this,n={userType:"member",emailAddress:"",displayName:""};this.memberList.push(new teamspace.components.TenantInvitationViewModel(this.constants,n)),e&&(this.$timeout(function(){var e=angular.element(t.formInputSelector);e&&e.length>0&&e[e.length-1].focus()},0,!1),_.defer(function(){var e={scenario:teamspace.components.PanelActionScenario.addMoreMemberFields.toString(),scenarioType:teamspace.components.PanelActionScenarioType.inviteMembers.toString(),moduleName:teamspace.components.PanelModuleName.addMore.toString(),summary:"Add more members"},n=t.getTelemetryDataModel(e);t.analyticsService.onPanelAction(t.$scope,n)}))},e.prototype.checkEmail=function(e){var t=e.emailAddress,n=e.displayName,i=t||n;return e.error=null,i?(this.isValidatingEmail=!0,t&&validator.isEmail(t)?this.isEmailAlreadyUsed(t)?(e.error=this.$translate.instant(this.resources.strings.freemium_invite_email_validation_already_used_error),void this.calculateCanShowSendInvitesButton()):void this.calculateCanShowSendInvitesButton():(e.error=this.$translate.instant(this.resources.strings.freemium_invite_email_validation_error),void this.calculateCanShowSendInvitesButton())):(e.error=null,void this.calculateCanShowSendInvitesButton())},e.prototype.isEmailAlreadyUsed=function(e){for(var t=!1,n=0,i=this.memberList;n<i.length;n++){var s=i[n];if(s.emailAddress&&s.emailAddress===e){if(t)return!0;t=!0}}return!1},e.prototype.getAdminsToShowErrors=function(){var e=this;return this.isTenantAdmin=this.identityService.isTenantAdmin(),this.isTenantAdmin||(this._isErrorBannerPending=!0,this.manageTenantService.getAllTenantAdmins().then(function(t){return e.updateAdminList(t)}).catch(function(){e._adminError=!0}).finally(function(){e._isErrorBannerPending=!1})),this.$q.resolve()},e.prototype.updateAdminList=function(e){e&&(this.admins=e,0==e.length&&(this._adminError=!0))},e.prototype.updateFooterButtons=function(){var e=this;if(this.closeFooterButton||(this.closeFooterButton={text:this.$translate.instant(this.resources.strings.modal_dialog_close_button),secondaryStyle:!0,func:function(){return e.close()},tid:"inviteMemberDialog-closeBtn",disabled:!1,type:teamspace.components.PanelModuleType.button,name:teamspace.components.PanelModuleName.addMemberClose,outcome:teamspace.components.PanelActionOutcome.select,scenario:teamspace.components.PanelActionScenario.addMemberClose,summary:"Close Invite Member",scenarioType:teamspace.components.PanelActionScenarioType.admin}),this.sendFooterButton){var t=!this.canShowSendInvitesButton||this.hasReachedMemberLimit||this.sendingInvites;if(t&&document.activeElement&&document.activeElement.getAttribute("data-tid")===this.sendFooterButton.tid){var n=angular.element("[data-tid='"+this.closeFooterButton.tid+"']");n&&n.focus()}this.sendFooterButton.text=this.$translate.instant(this.sendingInvites?this.resources.strings.freemium_invite_sending_invites_button_text:this.resources.strings.freemium_invite_dialog_submit_button),this.sendFooterButton.disabled=t}else this.sendFooterButton={text:this.$translate.instant(this.sendingInvites?this.resources.strings.freemium_invite_sending_invites_button_text:this.resources.strings.freemium_invite_dialog_submit_button),secondaryStyle:!1,func:function(){return e.sendInvitations()},tid:"inviteMemberDialog-doneBtn",disabled:!this.canShowSendInvitesButton||this.hasReachedMemberLimit||this.sendingInvites,type:teamspace.components.PanelModuleType.button,name:teamspace.components.PanelModuleName.sendInvites,outcome:teamspace.components.PanelActionOutcome.select,scenario:teamspace.components.PanelActionScenario.sendInvites,summary:"Send Invites",scenarioType:teamspace.components.PanelActionScenarioType.inviteMembers,dataBagFunc:function(){return e.getDomainsDataBag(e.memberList)}};var i=[this.closeFooterButton];"invitePeople"===this.selectedTab&&i.push(this.sendFooterButton),this.footerButtons=i},e.prototype.sendInvitations=function(){this.sendingInvites=!0,this.updateFooterButtons();var e=[];this.ariaLiveService.update(this.$translate.instant(this.resources.strings.freemium_invite_sending_invites_button_text),!0);for(var t=0,n=this.memberList;t<n.length;t++){var i=n[t];i.emailAddress&&!i.isAdded&&e.push({emailAddress:i.emailAddress,displayName:i.displayName,userType:i.model.userType})}this.processBatchInvitations(e)},e.prototype.sendInvitationsPromise=function(){this.sendingInvites=!0,this.updateFooterButtons();var e=[];this.ariaLiveService.update(this.$translate.instant(this.resources.strings.freemium_invite_sending_invites_button_text),!0);for(var t=0,n=this.memberList;t<n.length;t++){var i=n[t];i.emailAddress&&!i.isAdded&&e.push({emailAddress:i.emailAddress,displayName:i.displayName,userType:i.model.userType})}return this.processBatchInvitations(e)},e.prototype.processBatchInvitations=function(e){var t=this,n=0,i=0;if(e&&0!=e.length)return this.tenantMembershipService.inviteMembersToTenant(e).then(function(s){t.memberList.forEach(function(e){var a=s[i];if(e.emailAddress&&!e.isAdded){if(a)if(a.status&&a.status.toLowerCase()===t.inviteSuccessStatus&&!a.errorCode)e.isAdded=!0,t.isAnyAdded=!0;else{a.errorCode!==t.constants.freemium.errorCodes.resendInviteRateLimitExceeded&&n++,a.errorCode==t.constants.freemium.errorCodes.noAvailableLicenses&&(t.hasReachedMemberLimit=!0);var o=t.tenantMembershipService.getInviteErrorMessageFromErrorCode(a.errorCode);o&&o.isGeneric?t.sendInvitationsGenericError=o.errorMessage:o&&(e.error=o.errorMessage)}else n++,t.sendInvitationsGenericError=t.$translate.instant(t.resources.strings.freemium_invite_sending_generic_error_text);i++}}),t.postSendInvitationActions(n,e.length)}).catch(function(){n=e.length,t.sendInvitationsGenericError=t.$translate.instant(t.resources.strings.freemium_invite_sending_generic_error_text),t.postSendInvitationActions(n,e.length)})},e.prototype.postSendInvitationActions=function(e,t){var n=this,i=this.loggingService.newScenario(this.constants.scenarios.freemium.sendInvitations);if(this.hasReachedMemberLimit&&this.getAdminsToShowErrors(),this.sendingInvites=!1,this.calculateCanShowSendInvitesButton(),this.updateFooterButtons(),0==e)i.stop();else{i.fail({message:this.utilityService.format("Invitation dialog failed to invite all members with {0} failures out of {1} invitations",e,t)})}this.$timeout(function(){n.sendingInvites?n.sendInvitationsGenericError=n.$translate.instant(n.resources.strings.freemium_invite_sending_generic_error_text):n.sendInvitationsGenericError=null,n.sendingInvites=!1},this.inviteMemberDialogSendInviteTimeout,!1)},e.prototype.selectTab=function(e){this.selectedTab=e,this.updateFooterButtons()},e.prototype.getDomainsDataBag=function(e){for(var t={},n=0,i=0,s=0,a=e;s<a.length;s++){var o=a[s];if(o.emailAddress){var r=o.emailAddress.split("@").pop();n++,r in t?t[r]+=1:t[r]=1,o.displayName&&i++}}return{invitationsSent:n,invitationDisplayNames:i,invitationDomains:JSON.stringify(t)}},e.prototype.getTelemetryDataModel=function(e){return{panel:{type:this.isFre?teamspace.PanelType.inviteMembersDialogFRE:teamspace.PanelType.inviteMembersDialog},action:{gesture:teamspace.components.PanelActionGesture.click,outcome:teamspace.shared.AttributeHelper.tryGetEnum(teamspace.components.PanelActionOutcome.select.toString(),teamspace.components.PanelActionOutcome,this.logger),scenario:teamspace.shared.AttributeHelper.tryGetEnum(e.scenario,teamspace.components.PanelActionScenario,this.logger),scenarioType:teamspace.shared.AttributeHelper.tryGetEnum(e.scenarioType,teamspace.components.PanelActionScenarioType,this.logger)},module:{name:teamspace.shared.AttributeHelper.tryGetEnum(e.moduleName,teamspace.components.PanelModuleName,this.logger),type:teamspace.shared.AttributeHelper.tryGetEnum(teamspace.components.PanelModuleType.button.toString(),teamspace.components.PanelModuleType,this.logger),summary:e.summary}}},e}();t.InviteMembersDialogController=s,angular.module("teamspace.inviteMembers",["pascalprecht.translate","teamspace.analyticsService","teamspace.ariaLiveService","teamspace.authenticationService","teamspace.constants","teamspace.freemiumUtilities","teamspace.identityService","teamspace.locales","teamspace.loggingService","teamspace.manageTenantService","teamspace.settingsService","teamspace.tenantMembershipService","teamspace.tenantService","teamspace.utilityService"]).run(["constants","dialogService","$templateCache",function(e,t,n){n.put("components/freemium/invite-members-dialog/invite-members-dialog.html",i),t.register(e.dialogs.memberTenantInvitation,{template:"components/freemium/invite-members-dialog/invite-members-dialog.html",className:"ts-modal-dialog custom-width",closeByEscape:!0,closeByDocument:!1,controller:"InviteMembersDialogController",controllerAs:"imdc",ariaAuto:!1,ariaRole:"dialog",ariaLabelledById:"modalDialog-title"})}]).controller("InviteMembersDialogController",s)},2324:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(2325),n(2328),n(2330),n(2334),n(135),n(2336),n(2339),n(2341),n(55),n(2343),n(2345),n(2347),n(2351),n(2353),n(2355),n(304)},2325:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var s=n(2326),a=function(e){function t(t,n,i,s,a,o,r,c,l,d,m,u,p,g,v,h){var b=e.call(this,t,n,i,s,a,o,r,c,l,d,m,u,p,g,v,h)||this;return b.$q=t,b.$scope=n,b.$timeout=i,b.$translate=s,b.analyticsService=a,b.ariaLiveService=o,b.constants=r,b.freemiumUtilities=c,b.identityService=l,b.loggingService=d,b.manageTenantService=m,b.resources=u,b.settingsService=p,b.tenantMembershipService=g,b.tenantService=v,b.utilityService=h,b.context.sendInvitations=b.sendInvitations.bind(b),b.isFre=!0,b.sendButtonControl={type:"button",actionKey:r.growth.engagementSurfaces.actionKey.sendMemberInvites,resxKey:u.strings.freemium_invite_dialog_submit_button,isPrimary:!0,disabled:!b.canShowSendInvitesButton||b.hasReachedMemberLimit},b.closeButtonControl={type:"button",resxKey:u.strings.modal_dialog_close_button,isPrimary:!1,disabled:!1},b.context.dialogCtrl.updateButtonControls([b.closeButtonControl,b.sendButtonControl]),b}return i(t,e),t.$inject=["$q","$scope","$timeout","$translate","analyticsService","ariaLiveService","constants","freemiumUtilities","identityService","loggingService","manageTenantService","resources","settingsService","tenantMembershipService","tenantService","utilityService"],t.prototype.calculateCanShowSendInvitesButton=function(){var t=this;e.prototype.calculateCanShowSendInvitesButton.call(this),_(this.context.dialogCtrl.footerButtons).filter(function(e){return e.dataBag.isPrimary}).forEach(function(e){return e.disabled=!t.canShowSendInvitesButton})},t}(n(135).InviteMembersDialogController);t.EngagementSurfaceMemberInviteControl=a,angular.module("teamspace.engagementSurfaceMemberInviteControl",["pascalprecht.translate","teamspace.analyticsService","teamspace.ariaLiveService","teamspace.authenticationService","teamspace.constants","teamspace.dialogService","teamspace.freemiumUtilities","teamspace.identityService","teamspace.locales","teamspace.loggingService","teamspace.manageTenantService","teamspace.settingsService","teamspace.tenantMembershipService","teamspace.tenantService","teamspace.utilityService"]).component("engagementSurfaceUicontrolMemberInvite",{bindings:{context:"<"},template:s,controller:a})},2326:function(e,t){e.exports='<div class="es-member-invite">\n  <div ng-if="$ctrl.isInitialLoadHappening">\n    <div class="busy-animation-class">\n      <busy-animation size="medium"></busy-animation>\n    </div>\n  </div>\n\n  <div ng-if="!$ctrl.isInitialLoadHappening">\n    <span translate-once="{{::$ctrl.dialogHeader}}"></span>\n\n    \x3c!-- GENERIC ERROR BANNER --\x3e\n    <div class="form-field-error invite-tenant-form-field-generic-error" role="alert" ng-if="$ctrl.sendInvitationsGenericError" data-tid="inviteMember-error" aria-live="assertive">\n      <span ng-bind="$ctrl.sendInvitationsGenericError"></span>\n    </div>\n\n    \x3c!-- MEMBER LIMIT ERROR BANNER (NON ADMIN) --\x3e\n    <div class="ts-member-limit-banner invite-member-banner-errors" ng-if="$ctrl.hasReachedMemberLimit && !$ctrl.isTenantAdmin && !$ctrl.isErrorBannerPending" analytics-panel="{{::$ctrl.panelRegions.banner}}" analytics-panel-view="{ panel: {type: $root.trackConstants.panelType.memberLimitInMemberDialog }}">\n      <p ng-if="$ctrl.admins.length == 1" translate-with-html-params translate-id="invite_member_error_member_limit_member_text_single_admin" translate-values=\'{ "admin1": "<span class=\\"admin-name\\" person-card pc-mri=\\"$ctrl.admins[0].mri\\" pc-display-name=\\"$ctrl.admins[0].displayName\\" ng-bind=\\"$ctrl.admins[0].displayName\\" tabindex=\\"0\\" acc-role=\\"clickable\\" role=\\"button\\"></span>" }\'></p>\n      <p ng-if="$ctrl.admins.length > 1" translate-with-html-params translate-id="invite_member_error_member_limit_member_text_multiple_admin" translate-values=\'{ "adminsList": "<span class=\\"admin-name\\" person-card-list participant-list=\\"$ctrl.admins\\" is-person-img-displayed=\\"true\\" tabindex=\\"0\\" acc-role=\\"clickable\\" role=\\"button\\">{{$ctrl.adminCountString}}</span>" }\'></p>\n      <p ng-if="$ctrl.adminError" translate-once="{{::$root.resources.strings.invite_member_error_member_limit_member_text_generic}}"></p>\n    </div>\n\n    \x3c!-- MEMBER LIMIT ERROR BANNER (ADMIN) --\x3e\n    <div class="ts-member-limit-banner invite-member-limit-error-div-class" ng-if="$ctrl.hasReachedMemberLimit && $ctrl.isTenantAdmin && !$ctrl.isErrorBannerPending">\n      <span class="invite-member-limit-error-text-class" translate-once="{{::$root.resources.strings.invite_member_error_member_limit_admin_text}}"></span>\n      <button class="ts-btn ts-btn-primary admin-upgrade-button inset-border" type="button" translate-once="{{::$root.resources.strings.manage_tenant_upgrade_button_text}}" ng-click="$ctrl.onUpgradeClick()"></button>\n    </div>\n\n    <div class="scroll-container">\n      <div simple-scrollbar class="invite-tenant-form-container-class">\n        <div class="invite-tenant-scrollbar-class">\n          <div class="invite-tenant-div-input-class" ng-repeat="item in $ctrl.memberList track by $index">\n            <div class="invite-tenant-form-input-class">\n              <div class="invite-tenant-form-field-input">\n                <div class="invite-tenant-form-email-class">\n                  <input sanitized ng-model="item.model.emailAddress" ng-blur="$ctrl.checkEmail(item)" acc-role="focus-default" id="{{::$index}}" ng-disabled="$ctrl.hasReachedMemberLimit || item.isAdded" placeholder="{{::$root.resources.strings.freemium_invite_input_placeholder|translate}}" tabindex="0" class="form-control" data-tid="inviteMemberDialog-emailInput{{::$index}}"/>\n                  <div class="form-field-indicator" ng-if="item.error">\n                    <ng-include class="icons-input-invalid icon" src="\'svg/icons-call-alert.html\'"></ng-include>\n                  </div>\n                </div>\n              </div>\n              <input sanitized class="form-control invite-tenant-form-name-class" ng-model="item.model.displayName" ng-readonly="item.isAdded" maxlength="256" ng-disabled="$ctrl.hasReachedMemberLimit || item.isAdded" tabindex="0" placeholder="{{::$root.resources.strings.freemium_invite_input_name_placeholder|translate}}" data-tid="inviteMemberDialog-displayNameInput{{::$index}}"/>\n              <div ng-if="$ctrl.isAnyAdded" acc-role="table-content-cell clickable" title="{{::$root.resources.strings.aria_invite_members_added|translate}}">\n                <button class="invite-tenant-form-icon-class ts-sym icons-close" tab-index="0">\n                  <ng-include ng-if="item.isAdded" class="invite-tenant-icon-check" src="\'svg/icons-check.html\'"></ng-include>\n                </button>\n              </div>\n            </div>\n            <div class="form-field-error invite-tenant-form-field-error" role="alert" ng-if="item.error" data-tid="inviteMember-error" aria-live="assertive">\n              <span ng-bind="item.error"></span>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class="invite-tenant-add-more-class">\n        <button type="button" class="invite-members-add-more-container-item" ng-disabled="$ctrl.hasReachedMemberLimit" ng-click="$ctrl.addMemberToList(true)">\n          <ng-include class="icon" src="\'svg/icons-invite-person.html\'"></ng-include>\n          <span class="invite-members-addmore-button-text">{{::$root.resources.strings.freemium_invite_add_more_button|translate}}</span>\n        </button>\n      </div>\n    </div>\n  </div>\n</div>\n'},2327:function(e,t){e.exports='<div class="ts-invite-members-dialog-container">\n\n  <img class="image-container invite-members-dialog-fre-image-class" ng-src="{{::imdc.image}}" ng-show="!imdc.isInitialLoadHappening" alt="{{::imdc.dialogTitle}}"/>\n\n  <modal-dialog dialog-title="{{::imdc.dialogTitle}}" add-close-icon="false" suppress-default-button="true" footer-buttons="imdc.footerButtons" track-panel-type="{{imdc.isFre ? $root.trackConstants.panelType.inviteMembersDialogFRE : $root.trackConstants.panelType.inviteMembersDialog}}">\n\n    <div ng-if="imdc.isInitialLoadHappening">\n      <div class="busy-animation-class">\n        <busy-animation size="medium"></busy-animation>\n      </div>\n    </div>\n\n    <div ng-if="!imdc.isInitialLoadHappening">\n      <span translate-once="{{::imdc.dialogHeader}}"></span>\n\n      \x3c!-- GENERIC ERROR BANNER --\x3e\n      <div class="form-field-error invite-tenant-form-field-generic-error" role="alert" ng-if="imdc.sendInvitationsGenericError" data-tid="inviteMember-error" aria-live="assertive">\n        <span ng-bind="imdc.sendInvitationsGenericError"></span>\n      </div>\n\n      \x3c!-- MEMBER LIMIT ERROR BANNER (NON ADMIN) --\x3e\n      <div class="ts-member-limit-banner invite-member-banner-errors" ng-if="imdc.hasReachedMemberLimit && !imdc.isTenantAdmin && !imdc.isErrorBannerPending" analytics-panel="{{::imdc.panelRegions.banner}}" analytics-panel-view="{ panel: {type: $root.trackConstants.panelType.memberLimitInMemberDialog }}">\n        <p ng-if="imdc.admins.length == 1" translate-with-html-params translate-id="invite_member_error_member_limit_member_text_single_admin" translate-values=\'{ "admin1": "<span class=\\"admin-name\\" person-card pc-mri=\\"imdc.admins[0].mri\\" pc-display-name=\\"imdc.admins[0].displayName\\" ng-bind=\\"imdc.admins[0].displayName\\" tabindex=\\"0\\" acc-role=\\"clickable\\" role=\\"button\\"></span>" }\'></p>\n        <p ng-if="imdc.admins.length > 1" translate-with-html-params translate-id="invite_member_error_member_limit_member_text_multiple_admin" translate-values=\'{ "adminsList": "<span class=\\"admin-name\\" person-card-list participant-list=\\"imdc.admins\\" is-person-img-displayed=\\"true\\" tabindex=\\"0\\" acc-role=\\"clickable\\" role=\\"button\\">{{imdc.adminCountString}}</span>" }\'></p>\n        <p ng-if="imdc.adminError" translate-once="{{::$root.resources.strings.invite_member_error_member_limit_member_text_generic}}"></p>\n      </div>\n\n      \x3c!-- MEMBER LIMIT ERROR BANNER (ADMIN) --\x3e\n      <div class="ts-member-limit-banner invite-member-limit-error-div-class" ng-if="imdc.hasReachedMemberLimit && imdc.isTenantAdmin && !imdc.isErrorBannerPending">\n        <span class="invite-member-limit-error-text-class" translate-once="{{::$root.resources.strings.invite_member_error_member_limit_admin_text}}"></span>\n        <button class="ts-btn ts-btn-primary admin-upgrade-button inset-border" type="button" translate-once="{{::$root.resources.strings.manage_tenant_upgrade_button_text}}" ng-click="imdc.onUpgradeClick()"></button>\n      </div>\n\n      \x3c!-- TAB CONTENT --\x3e\n      <div class="invite-tenant-tab-content">\n          \x3c!-- INVITE PEOPLE TAB--\x3e\n          <div class="scroll-container" id="invite-tenant-invite-people-tab" ng-show="imdc.selectedTab === \'invitePeople\'" role="tabpanel">\n            <div simple-scrollbar class="invite-tenant-form-container-class">\n              <div class="invite-tenant-scrollbar-class">\n                <div class="invite-tenant-div-input-class" ng-repeat="item in imdc.memberList track by $index">\n                  <div class="invite-tenant-form-input-class">\n                    <div class="invite-tenant-form-field-input">\n                      <div class="invite-tenant-form-email-class">\n                        <input sanitized ng-model="item.model.emailAddress" ng-blur="imdc.checkEmail(item)" acc-role="focus-default" aria-required="{{$index==0}}" id="{{::$index}}" ng-disabled="imdc.hasReachedMemberLimit || item.isAdded" placeholder="{{::$root.resources.strings.freemium_invite_input_placeholder|translate}}" aria-label="{{::$root.resources.strings.freemium_invite_input_placeholder|translate}}" tabindex="0" set-focus="$index==0 && imdc.selectedTab === \'invitePeople\'" class="form-control" data-tid="inviteMemberDialog-emailInput{{::$index}}"/>\n                        <div class="form-field-indicator" ng-if="item.error">\n                          <ng-include class="icons-input-invalid icon" src="\'svg/icons-call-alert.html\'"></ng-include>\n                        </div>\n                      </div>\n                    </div>\n                    <input sanitized class="form-control invite-tenant-form-name-class" ng-model="item.model.displayName" ng-readonly="item.isAdded" maxlength="256" ng-disabled="imdc.hasReachedMemberLimit || item.isAdded" tabindex="0" placeholder="{{::$root.resources.strings.freemium_invite_input_name_placeholder|translate}}" aria-label="{{::$root.resources.strings.freemium_invite_input_name_placeholder|translate}}" data-tid="inviteMemberDialog-displayNameInput{{::$index}}"/>\n                    <div ng-if="imdc.isAnyAdded" acc-role="table-content-cell clickable" title="{{::$root.resources.strings.aria_invite_members_added|translate}}">\n                      <button class="invite-tenant-form-icon-class ts-sym icons-close" tab-index="0">\n                        <ng-include ng-if="item.isAdded" class="invite-tenant-icon-check" src="\'svg/icons-check.html\'"></ng-include>\n                      </button>\n                    </div>\n                  </div>\n                  <div class="form-field-error invite-tenant-form-field-error" role="alert" ng-if="item.error" data-tid="inviteMember-error" aria-live="assertive">\n                    <span ng-bind="item.error"></span>\n                  </div>\n                </div>\n              </div>\n            </div>\n            <div class="invite-tenant-add-more-class">\n              <button type="button" class="invite-members-add-more-container-item" ng-disabled="imdc.hasReachedMemberLimit" ng-click="imdc.addMemberToList(true)" data-tid="inviteMemberDialog-addMoreBtn">\n                <ng-include class="icon" src="\'svg/icons-invite-person.html\'"></ng-include>\n                <span class="invite-members-addmore-button-text">{{::$root.resources.strings.freemium_invite_add_more_button|translate}}</span>\n              </button>\n            </div>\n          </div>\n      </div>\n    </div>\n  </modal-dialog>\n</div>\n'},2328:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var s=n(2329),a=function(e){function t(t,n,i,s,a,o,r,c,l,d,m,u,p,g,v,h,b){var f=e.call(this,t,n,i,s,a,o,r,c,l,d,m,u,p,g,v,h)||this;f.$q=t,f.$scope=n,f.$timeout=i,f.$translate=s,f.analyticsService=a,f.ariaLiveService=o,f.constants=r,f.freemiumUtilities=c,f.identityService=l,f.loggingService=d,f.manageTenantService=m,f.resources=u,f.settingsService=p,f.tenantMembershipService=g,f.tenantService=v,f.utilityService=h,f.dialogService=b,f.context.sendInvitations=f.sendInvitations.bind(f),f.isFre=!0,f.copyLinkTitle=s.instant(u.strings.freemium_fre_invite_dialog_copy_invite_url_text);var _=p.valueFor(r.settings.names.freemiumFreInviteOption),y=teamspace.services.FreemiumFreInviteOption[_]||teamspace.services.FreemiumFreInviteOption.OptionalInvite;return f.showComfirmationDialog=y===teamspace.services.FreemiumFreInviteOption.SemiforcefulInvite,f.hideSkipOrCloseButton=y===teamspace.services.FreemiumFreInviteOption.MandatoryInvite,f.skipOrCloseButtonText=s.instant(f.showComfirmationDialog?u.strings.freemium_fre_invite_dialog_skip_button_text:u.strings.freemium_fre_invite_dialog_close_button_text),f.sendInvitationButtonText=s.instant(u.strings.freemium_fre_invite_dialog_invite_button_text),f.hasTriedInvite=!1,f.hideSkipOrCloseButton||m.getJoinTenantUrl().then(function(e){f.joinLink=e&&e.joinUrl}),f}return i(t,e),t.$inject=["$q","$scope","$timeout","$translate","analyticsService","ariaLiveService","constants","freemiumUtilities","identityService","loggingService","manageTenantService","resources","settingsService","tenantMembershipService","tenantService","utilityService","dialogService"],t.prototype.skipOrClose=function(){this.showComfirmationDialog?this.skip():this.close()},t.prototype.skip=function(){var e=this,t={okButtonText:this.$translate.instant(this.resources.strings.freemium_fre_invite_dialog_skip_confirmation_dialog_ok_button_text),closeButtonText:this.$translate.instant(this.resources.strings.freemium_fre_invite_dialog_skip_confirmation_dialog_close_button_text),confirmMessageTitle:this.$translate.instant(this.resources.strings.freemium_fre_invite_dialog_skip_confirmation_dialog_message_title),confirmMessageHtmlBody:this.$translate.instant(this.resources.strings.freemium_fre_invite_dialog_skip_confirmation_dialog_message_body),customClass:"freemium-fre-skip-invite-confirmation-dialog",closeModuleName:teamspace.components.PanelModuleName.skipAddMembers,closeModuleType:teamspace.components.PanelModuleType.button,closeActionScenario:teamspace.components.PanelActionScenario.skipAddMembers,closeActionScenarioType:teamspace.components.PanelActionScenarioType.fre,closeActionOutcome:teamspace.components.PanelActionOutcome.closeDialog,trackData:{id:this.context.id},moduleName:teamspace.components.PanelModuleName.skipAddMembers,moduleType:teamspace.components.PanelModuleType.button,actionScenario:teamspace.components.PanelActionScenario.skipAddMembers,actionScenarioType:teamspace.components.PanelActionScenarioType.fre,actionOutcome:teamspace.components.PanelActionOutcome.nav,dataBag:{id:this.context.id},callback:function(){},closeButtonCallback:function(){return e.close()}};this.dialogService.open(this.constants.dialogs.confirmDialog,t)},t.prototype.close=function(){this.context.dialogCtrl.close()},t.prototype.copyJoinUrl=function(){this.utilityService.copyToClipboard(this.joinLink),this.copyLinkTitle=this.$translate.instant(this.resources.strings.invitation_wizard_link_copied_text),this.ariaLiveService.update(this.copyLinkTitle),angular.element(".es-member-invite-v2 .copy-join-link-button").focus()},t.prototype.addMoreMembers=function(){this.addMemberToList(!0),this.addMemberToList(!1)},t.prototype.invite=function(){var e=this;this.sendInvitationButtonText=this.$translate.instant(this.resources.strings.freemium_invite_sending_invites_button_text),this.sendInvitationsPromise().finally(function(){e.hasTriedInvite||(e.hasTriedInvite=!0,e.showComfirmationDialog=!1,e.hideSkipOrCloseButton=!1,e.sendInvitationButtonText=e.$translate.instant(e.resources.strings.freemium_fre_invite_dialog_invite_button_text),e.skipOrCloseButtonText=e.$translate.instant(e.resources.strings.modal_dialog_close_button),angular.element(".es-member-invite-v2 .invite-footer-bottons button:first").focus())})},t}(n(135).InviteMembersDialogController);t.EngagementSurfaceMemberInviteV2Control=a,angular.module("teamspace.engagementSurfaceMemberInviteV2Control",["pascalprecht.translate","teamspace.analyticsService","teamspace.ariaLiveService","teamspace.authenticationService","teamspace.constants","teamspace.dialogService","teamspace.freemiumUtilities","teamspace.identityService","teamspace.locales","teamspace.loggingService","teamspace.manageTenantService","teamspace.settingsService","teamspace.tenantMembershipService","teamspace.tenantService","teamspace.utilityService"]).component("engagementSurfaceUicontrolMemberInviteV2",{bindings:{context:"<"},template:s,controller:a})},2329:function(e,t){e.exports='<div class="es-member-invite-v2">\n  <div role="heading" class="invite-member-heading" translate-once="{{::$root.resources.strings.freemium_fre_invite_dialog_title_v2}}" id="modalDialog-title"></div>\n\n  <div ng-if="$ctrl.isInitialLoadHappening">\n    <div class="busy-animation-class">\n      <busy-animation size="medium"></busy-animation>\n    </div>\n  </div>\n\n  <div ng-if="!$ctrl.isInitialLoadHappening">\n\n    \x3c!-- GENERIC ERROR BANNER --\x3e\n    <div class="form-field-error invite-tenant-form-field-generic-error" role="alert" ng-if="$ctrl.sendInvitationsGenericError" data-tid="inviteMember-error" aria-live="assertive">\n      <span ng-bind="$ctrl.sendInvitationsGenericError"></span>\n    </div>\n\n    \x3c!-- MEMBER LIMIT ERROR BANNER (NON ADMIN) --\x3e\n    <div class="ts-member-limit-banner invite-member-banner-errors" ng-if="$ctrl.hasReachedMemberLimit && !$ctrl.isTenantAdmin && !$ctrl.isErrorBannerPending" analytics-panel="{{::$ctrl.panelRegions.banner}}" analytics-panel-view="{ panel: {type: $root.trackConstants.panelType.memberLimitInMemberDialog }}">\n      <p ng-if="$ctrl.admins.length == 1" translate-with-html-params translate-id="invite_member_error_member_limit_member_text_single_admin" translate-values=\'{ "admin1": "<span class=\\"admin-name\\" person-card pc-mri=\\"$ctrl.admins[0].mri\\" pc-display-name=\\"$ctrl.admins[0].displayName\\" ng-bind=\\"$ctrl.admins[0].displayName\\" tabindex=\\"0\\" acc-role=\\"clickable\\" role=\\"button\\"></span>" }\'></p>\n      <p ng-if="$ctrl.admins.length > 1" translate-with-html-params translate-id="invite_member_error_member_limit_member_text_multiple_admin" translate-values=\'{ "adminsList": "<span class=\\"admin-name\\" person-card-list participant-list=\\"$ctrl.admins\\" is-person-img-displayed=\\"true\\" tabindex=\\"0\\" acc-role=\\"clickable\\" role=\\"button\\">{{$ctrl.adminCountString}}</span>" }\'></p>\n      <p ng-if="$ctrl.adminError" translate-once="{{::$root.resources.strings.invite_member_error_member_limit_member_text_generic}}"></p>\n    </div>\n\n    \x3c!-- MEMBER LIMIT ERROR BANNER (ADMIN) --\x3e\n    <div class="ts-member-limit-banner invite-member-limit-error-div-class" ng-if="$ctrl.hasReachedMemberLimit && $ctrl.isTenantAdmin && !$ctrl.isErrorBannerPending">\n      <span class="invite-member-limit-error-text-class" translate-once="{{::$root.resources.strings.invite_member_error_member_limit_admin_text}}"></span>\n      <button class="ts-btn ts-btn-primary admin-upgrade-button inset-border" type="button" translate-once="{{::$root.resources.strings.manage_tenant_upgrade_button_text}}" ng-click="$ctrl.onUpgradeClick()"></button>\n    </div>\n\n    <div class="scroll-container">\n      <div simple-scrollbar class="invite-tenant-form-container-class">\n        <div class="invite-tenant-scrollbar-class">\n          <div class="invite-members-input-container">\n            <div class="invite-tenant-div-input-class" ng-repeat="item in $ctrl.memberList track by $index">\n              <div class="invite-tenant-form-input-class">\n                <div class="invite-tenant-form-field-input">\n                  <div class="invite-tenant-form-email-class">\n                    <input sanitized ng-model="item.model.emailAddress" ng-blur="$ctrl.checkEmail(item)" acc-role="focus-default" role="textbox" id="{{::$index}}" ng-disabled="$ctrl.hasReachedMemberLimit || item.isAdded" placeholder="{{::$root.resources.strings.freemium_invite_input_placeholder|translate}}" class="form-control" data-tid="inviteMemberDialog-emailInput{{::$index}}"/>\n                    <div class="form-field-indicator" ng-if="item.error">\n                      <ng-include class="icons-input-invalid icon" src="\'svg/icons-call-alert.html\'"></ng-include>\n                    </div>\n                  </div>\n                </div>\n                <div ng-if="$ctrl.isAnyAdded" acc-role="table-content-cell clickable" title="{{::$root.resources.strings.aria_invite_members_added|translate}}" aria-label="{{::$root.resources.strings.aria_invite_members_added|translate}}">\n                  <button class="invite-tenant-form-icon-class ts-sym icons-close" tab-index="0">\n                    <ng-include ng-if="item.isAdded" class="invite-tenant-icon-check" src="\'svg/icons-check.html\'"></ng-include>\n                  </button>\n                </div>\n              </div>\n              <div class="form-field-error invite-tenant-form-field-error" role="alert" ng-if="item.error" data-tid="inviteMember-error" aria-live="assertive">\n                <span ng-bind="item.error"></span>\n              </div>\n            </div>\n          </div>\n          <div class="invite-tenant-add-more-class">\n            <button type="button" class="btn btn-link" ng-disabled="$ctrl.hasReachedMemberLimit" aria-label="{{::$root.resources.strings.freemium_invite_add_more_button|translate}}" ng-click="$ctrl.addMoreMembers()">\n              <span>&#43;</span>\n              <span class="invite-members-addmore-button-text">{{::$root.resources.strings.freemium_invite_add_more_button|translate}}</span>\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n  <div class="invite-footer">\n    <button ng-if="$ctrl.joinLink" class="btn btn-link copy-join-link-button" role="button" track-outcome="{{::$root.trackConstants.trackOutcome.submit}}" track-gesture="{{::$root.trackConstants.trackGesture.click}}" track-scenario="{{::$root.trackConstants.trackScenario.copyJoinUrl}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.fre}}" track-name="{{::$root.trackConstants.trackModuleName.inviteCoworkers}}" track-summary="copy join url link" track-type="{{::$root.trackConstants.trackType.button}}" track-data="{id: \'{{::$ctrl.context.id}}\'}" ng-click="$ctrl.copyJoinUrl()">\n      <span><ng-include src="\'svg/icons-link.html\'"></ng-include></span>\n      <span ng-bind="$ctrl.copyLinkTitle"></span>\n    </button>\n\n    <div class="invite-footer-bottons">\n      <button ng-if="!$ctrl.hideSkipOrCloseButton" class="ts-btn ts-btn-fluent ts-btn-fluent-secondary" role="button" data-tid="invite-member-skip-or-close-button" track-outcome="{{$ctrl.showComfirmationDialog ? $root.trackConstants.trackOutcome.openDialog : $root.trackConstants.trackOutcome.closeDialog}}" track-gesture="{{::$root.trackConstants.trackGesture.click}}" track-scenario="{{$ctrl.showComfirmationDialog ? $root.trackConstants.trackScenario.skipAddMembers : $root.trackConstants.trackScenario.addMemberClose}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.fre}}" track-name="{{::$root.trackConstants.trackModuleName.sendInvites}}" track-summary="{{$ctrl.showComfirmationDialog ? \'Skip Invite Member\' : \'Close Invite Member\'}}" track-type="{{::$root.trackConstants.trackType.button}}" track-data="{id: \'{{::$ctrl.context.id}}\'}" ng-click="$ctrl.skipOrClose()" ng-bind="$ctrl.skipOrCloseButtonText"></button>\n    <button class="ts-btn ts-btn-fluent ts-btn-fluent-primary" role="button" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-gesture="{{::$root.trackConstants.trackGesture.click}}" track-scenario="{{::$root.trackConstants.trackScenario.sendInvites}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.fre}}" track-name="{{::$root.trackConstants.trackModuleName.sendInvites}}" track-summary="Send Invites" track-type="{{::$root.trackConstants.trackType.button}}" ng-click="$ctrl.invite()" track-data="{id: \'{{::$ctrl.context.id}}\'}" ng-disabled="!$ctrl.canShowSendInvitesButton || $ctrl.hasReachedMemberLimit" ng-bind="$ctrl.sendInvitationButtonText">\n    </button>\n    </div>\n  </div>\n</div>\n'},2330:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var s=n(2331),a=function(e){function t(t,n,i,s,a,o,r,c,l,d){var m=e.call(this,t,n,i,s,a,o,r,c,l,d)||this;return m.$scope=t,m.$q=n,m.$translate=i,m.ariaLiveService=s,m.constants=a,m.dialogService=o,m.loggingService=r,m.resources=c,m.tenantMembershipService=l,m.utilityService=d,d.whenAllAllowFailures([m.fetchJoinRequestsPromise]).then(function(){m.context.openInvitationWizard=m.openInvitationWizard.bind(m),m.inviteMoreButtonControl={type:"button",actionKey:a.growth.engagementSurfaces.actionKey.openInvitationWizard,resxKey:c.strings.freemium_pending_join_requests_dialog_invite_more_button,isPrimary:!0,disabled:!1},m.context.dialogCtrl.updateButtonControls([m.inviteMoreButtonControl])}),m}return i(t,e),t.$inject=["$scope","$q","$translate","ariaLiveService","constants","dialogService","loggingService","resources","tenantMembershipService","utilityService"],t}(n(304).PendingTenantJoinRequestsDialogController);t.EngagementSurfacePendingJoinRequestsControl=a,angular.module("teamspace.engagementSurfacePendingJoinRequestsControl",["pascalprecht.translate","teamspace.analyticsService","teamspace.ariaLiveService","teamspace.authenticationService","teamspace.constants","teamspace.dialogService","teamspace.locales","teamspace.loggingService","teamspace.tenantMembershipService","teamspace.utilityService"]).component("engagementSurfaceUicontrolPendingJoinRequests",{bindings:{context:"<"},template:s,controller:a})},2331:function(e,t){e.exports='\n<div class="pending-requests-reminder-dialog ts-invite-members-dialog-container" acc-role="dialog">\n  <div class="pending-requests-tab" id="invite-tenant-join-requests-tab">\n    <div ng-if="$ctrl.joinRequestsBusy">\n      <div class="busy-animation-class">\n        <busy-animation size="medium"></busy-animation>\n      </div>\n    </div>\n    <div ng-if="$ctrl.joinRequestsList.length">\n      <div class="invite-tenant-resend-all-container">\n        <a ng-click="$ctrl.approveJoinRequests(null, true)" data-tid="joinRequestsDialog-approveAllBtn" tabindex="0" role="button" set-focus="true" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-gesture="{{::$root.trackConstants.trackGesture.click}}" track-scenario="{{::$root.trackConstants.trackScenario.approveAllRequests}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.joinTenantRequests}}" track-name="{{::$root.trackConstants.trackModuleName.approveAllRequests}}" track-type="{{::$root.trackConstants.trackType.button}}" track-data="{ numApproved: \'{{$ctrl.joinRequestsList.length}}\'}" track-summary="Approve all requests">{{::$root.resources.strings.freemium_pending_join_requests_approve_all_button|translate}}</a>\n      </div>\n      <invite-members-list members-list="$ctrl.joinRequestsList" prefix-data-tid="joinRequest" action-directive="join-request-action" action-directive-functions-context="::$ctrl.joinRequestsActionContext">\n      </invite-members-list>\n    </div>\n    <span ng-if="!$ctrl.joinRequestsList.length && !$ctrl.joinRequestsBusy && !$ctrl.joinRequestsError" role="alert" aria-live="assertive">{{::$root.resources.strings.freemium_no_pending_join_request_text|translate}}</span>\n    <div ng-if="$ctrl.joinRequestsError">\n      <div class="invite-tenant-pending-invites-generic-error">\n        <ng-include src="\'svg/icons-call-alert.html\'"></ng-include>\n        <span role="alert" aria-live="assertive">{{::$root.resources.strings.freemium_pending_join_requests_generic_error|translate}}</span>\n        <button class="invite-tenant-pending-invites-generic-error-retry" ng-click="$ctrl.getJoinRequests()" tabindex="-1" set-focus="true" aria-label="{{::$root.resources.strings.freemium_invite_dialog_pending_invites_retry_button|translate}}">\n          <ng-include src="\'svg/icons-refresh.html\'"></ng-include>\n          <span>{{::$root.resources.strings.freemium_pending_join_requests_retry_button|translate}}</span>\n        </button>\n      </div>\n      <span class="invite-tenant-pending-invites-generic-error-subtext">{{::$root.resources.strings.freemium_pending_join_requests_generic_error_subtext|translate}}</span>\n    </div>\n  </div>\n</div>\n'},2332:function(e,t){e.exports='<div class="ts-pending-join-requests-dialog-container ts-invite-members-dialog-container" acc-role="dialog">\n  <modal-dialog dialog-title="{{::ptjrc.dialogTitle}}" add-close-icon="true" suppress-default-button="true" footer-buttons="ptjrc.footerButtons">\n    \x3c!-- TAB BAR --\x3e\n    <div class="invite-tenant-tab-bar ts-tab-bar-wrapper">\n        <ul class="app-tabs" acc-role="list" role="tablist">\n          <li data-tid="joinRequestsDialog-joinRequestsTab" acc-role="list-item" role="tab" title="{{($root.resources.strings.freemium_pending_join_requests_tab_join_requests|translate:{value:ptjrc.joinRequestsList.length})}}" aria-controls="invite-tenant-join-requests-tab" aria-label="{{($root.resources.strings.freemium_pending_join_requests_tab_join_requests|translate:{value:ptjrc.joinRequestsList.length})}}" aria-selected="{{ptjrc.selectedTab === \'joinRequests\'}}" ng-if="ptjrc.shouldShowTabButtons()">\n            <div class="btn-group app-tabs-list-item" ng-class="{ \'app-tabs-selected\': ptjrc.selectedTab === \'joinRequests\' }">\n              <button class="btn btn-default" ng-class="{ \'app-tabs-selected\': ptjrc.selectedTab === \'joinRequests\' }" ng-click="ptjrc.selectTab(\'joinRequests\')" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-gesture="{{::$root.trackConstants.trackGesture.click}}" track-scenario="{{::$root.trackConstants.trackScenario.pendingJoinRequests}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.joinTenantRequests}}" track-type="{{::$root.trackConstants.trackType.tab}}" track-name="{{::$root.trackConstants.trackModuleName.joinRequestsTab}}" track-summary="Join requests tab">\n                <span class="tab-btn-container">\n                  <span class="tab-display-name">{{($root.resources.strings.freemium_pending_join_requests_tab_join_requests|translate:{value:ptjrc.joinRequestsList.length})}}</span>\n                </span>\n              </button>\n            </div>\n          </li>\n          <li acc-role="list-item" data-tid="joinRequestsDialog-pendingInvitesTab" role="tab" title="{{($root.resources.strings.freemium_invite_dialog_tab_pending_invites|translate:{numPending:ptjrc.pendingInvitesList.length})}}" aria-controls="invite-tenant-pending-invites-tab" aria-label="{{($root.resources.strings.freemium_invite_dialog_tab_pending_invites|translate:{numPending:ptjrc.pendingInvitesList.length})}}" aria-selected="{{ptjrc.selectedTab === \'pendingInvites\'}}" ng-if="ptjrc.shouldShowTabButtons()">\n            <div class="btn-group app-tabs-list-item" ng-class="{ \'app-tabs-selected\': ptjrc.selectedTab === \'pendingInvites\' }">\n              <button class="btn btn-default" ng-class="{ \'app-tabs-selected\': ptjrc.selectedTab === \'pendingInvites\' }" ng-click="ptjrc.selectTab(\'pendingInvites\')" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-gesture="{{::$root.trackConstants.trackGesture.click}}" track-scenario="{{::$root.trackConstants.trackScenario.pendingInvites}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.joinTenantRequests}}" track-type="{{::$root.trackConstants.trackType.tab}}" track-name="{{::$root.trackConstants.trackModuleName.pendingInvitesTab}}" track-summary="Pending invites tab">\n                <span class="tab-btn-container">\n                  <span class="tab-display-name">{{($root.resources.strings.freemium_invite_dialog_tab_pending_invites|translate:{numPending:ptjrc.pendingInvitesList.length})}}</span>\n                </span>\n              </button>\n            </div>\n          </li>\n        </ul>\n    </div>\n\n    \x3c!-- JOIN REQUESTS TAB --\x3e\n    <div class="pending-requests-tab" id="invite-tenant-join-requests-tab" ng-show="ptjrc.selectedTab === \'joinRequests\'" role="tabpanel">\n         <div ng-if="ptjrc.joinRequestsBusy">\n          <div class="busy-animation-class">\n            <busy-animation size="medium"></busy-animation>\n          </div>\n        </div>\n      <div ng-if="ptjrc.joinRequestsList.length">\n        <div class="invite-tenant-resend-all-container">\n          <a ng-click="ptjrc.approveJoinRequests(null, true)" data-tid="joinRequestsDialog-approveAllBtn" tabindex="0" role="button" set-focus="ptjrc.selectedTab === \'joinRequests\'" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-gesture="{{::$root.trackConstants.trackGesture.click}}" track-scenario="{{::$root.trackConstants.trackScenario.approveAllRequests}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.joinTenantRequests}}" track-name="{{::$root.trackConstants.trackModuleName.approveAllRequests}}" track-type="{{::$root.trackConstants.trackType.button}}" track-data="{ numApproved: \'{{ptjrc.joinRequestsList.length}}\'}" track-summary="Approve all requests">{{::$root.resources.strings.freemium_pending_join_requests_approve_all_button|translate}}</a>\n        </div>\n        <invite-members-list members-list="ptjrc.joinRequestsList" prefix-data-tid="joinRequest" action-directive="join-request-action" action-directive-functions-context="::ptjrc.joinRequestsActionContext">\n        </invite-members-list>\n      </div>\n      <span ng-if="!ptjrc.joinRequestsList.length && !ptjrc.joinRequestsBusy && !ptjrc.joinRequestsError" role="alert" aria-live="assertive">{{::$root.resources.strings.freemium_no_pending_join_request_text|translate}}</span>\n      <div ng-if="ptjrc.joinRequestsError">\n        <div class="invite-tenant-pending-invites-generic-error">\n          <ng-include src="\'svg/icons-call-alert.html\'"></ng-include>\n          <span role="alert" aria-live="assertive">{{::$root.resources.strings.freemium_pending_join_requests_generic_error|translate}}</span>\n          <button class="invite-tenant-pending-invites-generic-error-retry" ng-click="ptjrc.getJoinRequests()" tabindex="-1" set-focus="ptjrc.selectedTab === \'joinRequests\'" aria-label="{{::$root.resources.strings.freemium_invite_dialog_pending_invites_retry_button|translate}}">\n            <ng-include src="\'svg/icons-refresh.html\'"></ng-include>\n            <span>{{::$root.resources.strings.freemium_pending_join_requests_retry_button|translate}}</span>\n          </button>\n        </div>\n        <span class="invite-tenant-pending-invites-generic-error-subtext">{{::$root.resources.strings.freemium_pending_join_requests_generic_error_subtext|translate}}</span>\n      </div>\n    </div>\n\n    \x3c!-- PENDING INVITES TAB --\x3e\n    <div class="pending-requests-tab" id="invite-tenant-pending-invites-tab" ng-show="ptjrc.selectedTab === \'pendingInvites\'" role="tabpanel">\n      <div class="invite-tenant-pending-invites-retry-busy" ng-if="ptjrc.pendingInvitesBusy">\n        <busy-animation size="medium"></busy-animation>\n      </div>\n      <div ng-if="ptjrc.pendingInvitesList.length">\n        <div class="invite-tenant-resend-all-container">\n          <a ng-click="ptjrc.resendAllPendingInvites()" data-tid="joinRequestsDialog-resendAllBtn" tabindex="0" role="button" set-focus="ptjrc.selectedTab === \'pendingInvites\'" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-gesture="{{::$root.trackConstants.trackGesture.click}}" track-scenario="{{::$root.trackConstants.trackScenario.resendAllInvites}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.inviteMembers}}" track-name="{{::$root.trackConstants.trackModuleName.resendAllInvites}}" track-type="{{::$root.trackConstants.trackType.button}}" track-data="{ numResent: \'{{ptjrc.pendingInvitesList.length}}\'}" track-summary="Resend all invites">{{::$root.resources.strings.freemium_invite_dialog_resend_all_button|translate}}</a>\n        </div>\n        <invite-members-list members-list="ptjrc.pendingInvitesList" prefix-data-tid="pendingInvite" action-directive="invite-members-resend-action" action-directive-functions-context="::ptjrc.pendingInvitesResendActionContext">\n        </invite-members-list>\n      </div>\n      <span ng-if="!ptjrc.pendingInvitesList.length && !ptjrc.pendingInvitesBusy && !ptjrc.pendingInvitesError" role="alert" aria-live="assertive">{{::$root.resources.strings.freemium_invite_dialog_no_pending_invites_text|translate}}</span>\n      <div ng-if="ptjrc.pendingInvitesError">\n        <div class="invite-tenant-pending-invites-generic-error">\n          <ng-include src="\'svg/icons-call-alert.html\'"></ng-include>\n          <span role="alert" aria-live="assertive">{{::$root.resources.strings.freemium_invite_dialog_generic_pending_invites_error|translate}}</span>\n          <button class="invite-tenant-pending-invites-generic-error-retry" ng-click="ptjrc.refreshPendingInvites()" tabindex="-1" set-focus="ptjrc.selectedTab === \'pendingInvites\'" aria-label="{{::$root.resources.strings.freemium_invite_dialog_pending_invites_retry_button|translate}}">\n            <ng-include src="\'svg/icons-refresh.html\'"></ng-include>\n            <span>{{::$root.resources.strings.freemium_invite_dialog_pending_invites_retry_button|translate}}</span>\n          </button>\n        </div>\n        <span class="invite-tenant-pending-invites-generic-error-subtext">{{::$root.resources.strings.freemium_invite_dialog_generic_pending_invites_error_subtext|translate}}</span>\n      </div>\n    </div>\n  </modal-dialog>\n</div>\n'},2333:function(e,t){e.exports='<div class="scroll-container">\n  <div class="invite-members-list-container" data-tid="invite-members-list-container" ng-edge-scroll on-edge-callback="imlc.wrappedOnScrollEdge()" simple-scrollbar>\n    <div acc-role="table-keyboard" role="grid">\n      <div class="invite-member-container" ng-repeat="member in imlc.membersList track by $index" set-focus="{{::$first}}" data-tid="{{::imlc.prefixDataTid}}-{{::member.emailAddress}}" acc-role="table-content-row" role="row" aria-labelledby="memberEmail-{{::member.emailAddress}} memberDisplayName-{{::member.emailAddress}} memberState-{{::member.emailAddress}}">\n        <div class="invite-member">\n          <div class="profile-img-parent">\n            <profile-picture css-class="ts-profile-img" principal-name="::member.emailAddress" display-name="::member.displayName" source="power-bar"></profile-picture>\n          </div>\n          <div class="member-details" use-parentnode-for-keyboard="true">\n            <div class="invite-member-display-name" id="memberDisplayName-{{::member.emailAddress}}" title="{{::member.displayName}}">{{::member.displayName}}</div>\n            <div class="invite-member-email" id="memberEmail-{{::member.emailAddress}}" ng-class="{\'email-as-caption\': member.displayName}" title="{{::member.emailAddress}}">{{::member.emailAddress}}</div>\n          </div>\n           <div ts-load-directive use-parentnode-for-keyboard="true" directive-attrs="{\'use-parentnode-for-keyboard\': true}" directive="::imlc.actionDirective" context="::imlc.getActionDirectiveContext(member)">\n          </div>\n        </div>\n        <span class="form-field-error" ng-if="member.errorText.length > 0" role="alert" aria-live="assertive">{{member.errorText}}</span>\n      </div>\n    </div>\n  </div>\n</div>'},2334:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0});var s=n(2335),a=function(e){function t(t,n,i,s,a,o,r,c,l,d,m,u,p){var g=e.call(this,t,n,i,s,a,o,r,c,l,d,m,u,p)||this;return g.$q=t,g.$scope=n,g.$translate=i,g.authenticationService=s,g.constants=a,g.ariaLiveService=o,g.loggingService=r,g.peopleService=c,g.resources=l,g.utilityService=d,g.Upload=m,g.settingsService=u,g.analyticsService=p,g.context.onSave=g.onSave.bind(g),g.isFre=!0,g.saveButtonControl={type:"button",actionKey:a.growth.engagementSurfaces.actionKey.updateUserProfile,resxKey:l.strings.update_user_profile_fre_v2_next,isPrimary:!0,disabled:!c.isValidName(g.currentUserDisplayName)},g.skipButtonControl={type:"button",resxKey:l.strings.update_user_profile_skip,isPrimary:!1,disabled:!1},g.context.dialogCtrl.updateButtonControls([g.saveButtonControl]),g}return i(t,e),t.$inject=["$q","$scope","$translate","authenticationService","constants","ariaLiveService","loggingService","peopleService","resources","utilityService","Upload","settingsService","analyticsService"],Object.defineProperty(t.prototype,"uploadButtonText",{get:function(){return this.resources.strings.user_profile_picture_upload_fre},enumerable:!0,configurable:!0}),t.prototype.evaluateSaveBtnState=function(){var e=this;_(this.context.dialogCtrl.footerButtons).filter(function(e){return!e.secondaryStyle}).forEach(function(t){return t.disabled=!e.peopleService.isValidName(e.currentUserDisplayName)})},t.prototype.close=function(){this.userPictureContext.close(),this.context.dialogCtrl.close()},t.prototype.displaySkipAndSaveButton=function(){this.saveButtonControl&&this.skipButtonControl&&(this.saveButtonControl.resxKey=this.resources.strings.update_user_profile_fre_retry,this.context.dialogCtrl.updateButtonControls([this.skipButtonControl,this.saveButtonControl]))},t}(n(126).UpdateUserProfileController);t.EngagementSurfaceUpdateUserProfileV2Control=a,angular.module("teamspace.engagementSurfaceUpdateUserProfileV2Control",["ngFileUpload","pascalprecht.translate","teamspace.locales","teamspace.authenticationService","teamspace.constants","teamspace.loggingService","teamspace.peopleService","teamspace.dialogService","teamspace.utilityService","teamspace.settingsService","teamspace.ariaLiveService","teamspace.analyticsService"]).component("engagementSurfaceUicontrolUpdateUserProfileV2",{bindings:{context:"<"},template:s,controller:a})},2335:function(e,t){e.exports='<div class="es-update-user-profile-v2 update-user-profile-dialog">\n  <div class="update-profile-heading" role="heading" translate-once="{{::$root.resources.strings.update_user_profile_header_fre}}" id="modalDialog-title"></div>\n  <div class="update-profile-content">\n    <div class="update-user-profile-content" ng-if="::$ctrl.enableFreUploadPicture">\n        <div ng-if="!$ctrl.isUploadingPicture" class="image-container profile-img-parent">\n          <button class="btn btn-default app-icons-fill-focus action-button" data-tid="updateUserProfile-uploadPictureBtn" ngf-model-invalid="$ctrl.invalidFile" ngf-dimensions="{{::$ctrl.profilePictureNgfParams.dimensions}}" ngf-max-size="{{::$ctrl.profilePictureNgfParams.maxSize}}" ngf-select="$ctrl.uploadPhoto($file)" ng-model="$ctrl.newPhoto" ng-disabled="$ctrl.uploadButton.disabled" ngf-pattern="\'{{::$ctrl.profilePictureNgfParams.profilePicturePattern}}\'" accept="{{::$ctrl.profilePictureNgfParams.profilePictureAccept}}" aria-label="{{::$root.resources.strings.update_user_profile_upload_picture_aria_label | translate}}">\n            <div ng-if="!$ctrl.newPhoto" css-class="image-mask">\n                <ng-include class="change-picture-icon" src="\'https://statics.teams.cdn.office.net/hashedassets/svg/icons-camera-baf138f.html\'"></ng-include>\n              </div>\n              <div ngf-background="$ctrl.newPhoto" ng-if="$ctrl.newPhoto" class="image-mask medium-image-size">\n              </div>\n          </button>\n        </div>\n        <busy-animation class="change-picture" ng-if="$ctrl.isUploadingPicture" size="medium" context="upload-profile-picture"></busy-animation>\n    </div>\n    <div class="name-container">\n      <section class="name-input-field">\n        <div class="form-field-container">\n          <input sanitized type="text" id="displayname" aria-labelledby="uupcDisplayNameLabel" data-tid="updateUserProfile-displayNameInputField" ng-model="$ctrl.currentUserDisplayName" ng-change="$ctrl.evaluateSaveBtnState()" aria-label="{{::$root.resources.strings.update_user_profile_display_form_title | translate}}"/>\n          <busy-animation class="update-name-indicator update-name" ng-if="$ctrl.isUpdatingName" size="small" context="update-user-display-name"></busy-animation>\n          <ng-include class="update-name-indicator icon green-svg" ng-if="$ctrl.showDisplayNameChangeSuccess" src="\'svg/icons-accept.html\'"></ng-include>\n        </div>\n      </section>\n      <div class="error-container error-message-container" ng-if="$ctrl.uploadPictureErrorMessage" aria-live="assertive" role="alert">\n        {{$ctrl.uploadPictureErrorMessage}}\n      </div>\n      <div class="error-container" ng-if="$ctrl.updateNameErrorMessage" aria-live="assertive" role="alert">\n        {{$ctrl.updateNameErrorMessage}}\n      </div>\n    </div>\n  </div>\n</div>\n'},2336:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(2337),s=n(2338),a=function(){function e(t,n,i,s,a,o,r,c,l,d,m,u,p,g,v,h){this.$translate=t,this.$scope=n,this.$window=i,this.constants=s,this.dialogService=a,this.manageTenantService=o,this.resources=r,this.settingsService=c,this.utilityService=l,this.ariaLiveService=d,this.tooltipService=m,this.msaAuthenticationService=u,this.importMsaContactsService=p,this.loggingService=g,this.inviteLinksService=v,this.analyticsService=h,this.dialogBusy=!0,this.linkCopied=!1,this.logger=this.loggingService.newLogger(e.className),this.enableTFLInviteLink=c.valueAsBoolean(s.settings.names.enableTFLInviteLink),this.dialogTitle=this.enableTFLInviteLink?t.instant(r.strings.invitation_wizard_dialog_title_tfl):t.instant(r.strings.invitation_wizard_dialog_title,{tenantName:o.tenantName}),this.copyLinkTitle=t.instant(r.strings.invitation_wizard_link_copy_btn_text),this.copyLinkIcon="svg/icons-link.html",this.fetchJoinUrl(),this.joinLinkTooltipId=l.generateUUID()}return e.$inject=["$translate","$scope","$window","constants","dialogService","manageTenantService","resources","settingsService","utilityService","ariaLiveService","tooltipService","msaAuthenticationService","importMsaContactsService","loggingService","inviteLinksService","analyticsService"],e.prototype.fetchJoinUrl=function(){var e=this;this.manageTenantService.getJoinTenantUrl().then(function(t){e.copyLinkSubtitle=t&&t.joinUrl,e.enableTFLInviteLink&&e.copyLinkSubtitle&&e.sendDialogTelemetry(!1),e.joinLinkTooltipText=t&&t.autoApproveJoinRequestsEnabled?e.$translate.instant(e.resources.strings.invitation_wizard_link_tooltip_text_one_click_join_enabled):e.$translate.instant(e.resources.strings.invitation_wizard_link_tooltip_text_one_click_join_disabled)}).catch(function(){e.logger.error("InvitationWizardDialogController: Failed getJoinTenantUrl"),e.dialogTitle=e.$translate.instant(e.resources.strings.invitation_wizard_dialog_error_tfl)}).finally(function(){e.dialogBusy=!1})},e.prototype.close=function(){this.dialogService.close(this.constants.dialogs.invitationWizard),this.enableTFLInviteLink&&this.copyLinkSubtitle&&this.sendDialogTelemetry(!0)},e.prototype.copyLink=function(e){this.utilityService.copyToClipboard(this.copyLinkSubtitle),this.copyLinkTitle=this.$translate.instant(this.resources.strings.invitation_wizard_link_copied_text),this.copyLinkIcon="svg/icons-check.html",this.linkCopied=!0,this.ariaLiveService.update(this.copyLinkTitle,!0),this.inviteLinksService.sendUserBiTelemetryForCopyJoinLinkToClipboard(!0,this.copyLinkSubtitle,teamspace.PanelType.copyLinkModalDialog),angular.element(e.currentTarget).focus()},e.prototype.openInviteByEmailDialog=function(){this.dialogService.open(this.constants.dialogs.memberTenantInvitation),this.close()},e.prototype.openPendingJoinRequestsDialog=function(){this.dialogService.open(this.constants.dialogs.pendingJoinRequests,{source:teamspace.services.PendingJoinRequestsDialogSource.InvitationWizard}),this.close()},e.prototype.showContactsChooseProviderDialog=function(){return!!this.settingsService.valueAsBoolean(this.constants.settings.names.enableInviteFromGoogleContacts)&&(!this.$window.electronSafeIpc||this.settingsService.valueAsBoolean(this.constants.settings.names.enableDesktopInviteFromGoogleContacts))},e.prototype.openInviteContactsDialog=function(){if(this.showContactsChooseProviderDialog())this.dialogService.open(this.constants.dialogs.contactsChooseProviderDialog);else{var e={accountAuthenticationService:this.msaAuthenticationService,importContactsService:this.importMsaContactsService,emailProviderName:this.constants.freemium.inviteContacts.accounts.names.Microsoft,invitationScenario:teamspace.services.TenantInvitationScenario.ImportContactsMsa,allowAccountSignOut:!1};this.dialogService.open(this.constants.dialogs.contactsTenantInvitation,e)}this.close()},e.prototype.showJoinByUrlButton=function(){return this.copyLinkSubtitle},e.prototype.isOneClickJoinEcsEnabled=function(){return!this.enableTFLInviteLink&&this.settingsService.valueAsBoolean(this.constants.settings.names.enableOneClickJoin)},e.prototype.isTFLInviteLinkEnabled=function(){return this.enableTFLInviteLink},e.prototype.showJoinLinkInfoTooltip=function(e,t){if(t){var n={templateUrl:"components/freemium/invitation-wizard-dialog/invitation-wizard-dialog-join-link-tooltip.html",trigger:"manual",container:"body",placement:"right",autoClose:!0,scope:this.$scope,content:this.joinLinkTooltipText},i={sourceElement:angular.element(e.currentTarget),tooltipType:teamspace.services.TooltipType.Popover,options:n,tooltipId:this.joinLinkTooltipId};this.tooltipService.showTooltip(i)}else this.tooltipService.clearTooltip(teamspace.services.TooltipType.Popover,this.joinLinkTooltipId)},e.prototype.sendDialogTelemetry=function(e){var t=this,n=this.inviteLinksService.getJoinLinkDataBag(this.copyLinkSubtitle);e&&(n.wasShared=this.linkCopied,n.sharedBy=this.linkCopied?teamspace.services.SharedByType.copy:null);var i={action:{gesture:teamspace.components.PanelActionGesture.click,outcome:teamspace.shared.AttributeHelper.tryGetEnum(e?teamspace.components.PanelActionOutcome.closeDialog.toString():teamspace.components.PanelActionOutcome.openDialog.toString(),teamspace.components.PanelActionOutcome,this.loggingService),scenario:teamspace.shared.AttributeHelper.tryGetEnum(e?teamspace.components.PanelActionScenario.shareCharmCompleted.toString():teamspace.components.PanelActionScenario.shareCharmOpened.toString(),teamspace.components.PanelActionScenario,this.loggingService),scenarioType:teamspace.shared.AttributeHelper.tryGetEnum(e?teamspace.components.PanelActionScenarioType.closeDialog.toString():teamspace.components.PanelActionScenarioType.openDialog.toString(),teamspace.components.PanelActionScenarioType,this.loggingService)},panel:{type:teamspace.PanelType.chatList},module:{name:teamspace.shared.AttributeHelper.tryGetEnum(teamspace.components.PanelModuleName.invitePeopleButton.toString(),teamspace.components.PanelModuleName,this.loggingService),type:teamspace.shared.AttributeHelper.tryGetEnum(e?teamspace.components.PanelModuleType.closeDialog.toString():teamspace.components.PanelModuleType.openDialog.toString(),teamspace.components.PanelModuleType,this.loggingService),summary:"Invite friends dialog "+(e?"closed":"open")},dataBag:n};this.analyticsService.getAnalyticsPanelActionEventData(i).then(function(e){t.analyticsService.sendPanelAction(e)})},e.className="InvitationWizardDialogController",e}();t.InvitationWizardDialogController=a,angular.module("teamspace.invitationWizard",["pascalprecht.translate","teamspace.constants","teamspace.locales","teamspace.msaAuthenticationService","teamspace.importMsaContactsService","teamspace.manageTenantService","teamspace.settingsService","teamspace.utilityService","teamspace.dialogService","teamspace.ariaLiveService"]).run(["constants","dialogService","$templateCache",function(e,t,n){n.put("components/freemium/invitation-wizard-dialog/invitation-wizard-dialog.html",i),n.put("components/freemium/invitation-wizard-dialog/invitation-wizard-dialog-join-link-tooltip.html",s),t.register(e.dialogs.invitationWizard,{template:"components/freemium/invitation-wizard-dialog/invitation-wizard-dialog.html",className:"ts-modal-dialog custom-width",closeByEscape:!0,closeByDocument:!1,controller:"InvitationWizardDialogController",controllerAs:"iwdc",ariaAuto:!1,ariaRole:"dialog",ariaLabelledById:"modalDialog-title"})}]).controller("InvitationWizardDialogController",a)},2337:function(e,t){e.exports='<div class="ts-invitation-wizard-dialog-container" ng-class="{ \'tfl-invite-link\': iwdc.isTFLInviteLinkEnabled() }" acc-role="dialog">\n\n  <div ng-if="iwdc.dialogBusy">\n    <div class="busy-animation-class">\n      <busy-animation size="medium"></busy-animation>\n    </div>\n  </div>\n  <div ng-if="!iwdc.dialogBusy">\n    <img class="image-container invite-members-dialog-fre-image-class" src="https://statics.teams.cdn.office.net/hashedassets/freemium_fre_invite_members-8b066e6.svg" alt="{{::iwdc.dialogTitle}}"/>\n    <div class="close-container app-icons-fill-hover ng-scope">\n      <button class="btn btn-default inset-border inset-border-round inset-border-themed app-icons-fill-hover" aria-label="{{::$root.resources.strings.modal_dialog_close_button | translate}}" ng-click="iwdc.close()">\n        <ng-include class="icon icons-close modal-dialog-close ng-scope" src="\'svg/icons-close.html\'"></ng-include>\n      </button>\n    </div>\n    <modal-dialog dialog-title="{{::iwdc.dialogTitle}}" add-close-icon="false" suppress-default-button="true" skip-auto-focus="true">\n      <button class="pending-requests" translate-once="{{::$root.resources.strings.invitation_wizard_pending_requests_button}}" ng-click="iwdc.openPendingJoinRequestsDialog()" data-tid="invitationWizard-pendingJoinRequests" track-gesture="{{::$root.trackConstants.trackGesture.click}}" track-outcome="{{::$root.trackConstants.trackOutcome.submit}}" track-scenario="{{::$root.trackConstants.trackScenario.openPendingJoinRequestsDialog}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.freemium}}" track-name="{{::$root.trackConstants.trackModuleName.inviteCoworkers}}" track-type="{{::$root.trackConstants.trackType.button}}" track-summary="copy join url link" ng-if="::!iwdc.isTFLInviteLinkEnabled()"></button>\n      <div>\n        <div ng-if="::iwdc.showJoinByUrlButton()" role="button" set-focus="true" class="invite-options-button icons-filled" ng-class="{ \'tfl-invite-link-button\': iwdc.isTFLInviteLinkEnabled() }" ng-click="iwdc.copyLink($event)" data-tid="invitationWizard-copyJoinLink" track-gesture="{{::$root.trackConstants.trackGesture.click}}" track-outcome="{{::$root.trackConstants.trackOutcome.submit}}" track-scenario="{{::$root.trackConstants.trackScenario.copyJoinUrl}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.freemium}}" track-name="{{::$root.trackConstants.trackModuleName.inviteCoworkers}}" track-type="{{::$root.trackConstants.trackType.button}}" track-summary="copy join url link" aria-label="{{::iwdc.copyLinkTitle}}">\n          <ng-include class="icon icons-default-fill" src="iwdc.copyLinkIcon" ng-class="{ \'copied\': iwdc.linkCopied }" aria-hidden="true"/>\n          <div class="title-container">\n            <div class="invite-option-title">\n              {{iwdc.copyLinkTitle}}\n              <span class="tooltip-icon-container" ng-if="iwdc.isOneClickJoinEcsEnabled()" tabindex="0" ng-click="iwdc.showJoinLinkInfoTooltip($event, true)" ng-focus="iwdc.showJoinLinkInfoTooltip($event, true)" ng-blur="iwdc.showJoinLinkInfoTooltip($event, false)" ng-mouseenter="iwdc.showJoinLinkInfoTooltip($event, true)" ng-mouseleave="iwdc.showJoinLinkInfoTooltip($event, false)" data-prevent-refocus="true" role="text" aria-label="{{::iwdc.joinLinkTooltipText}}">\n                <ng-include class="icon" src="\'svg/icons-info.html\'"></ng-include>\n              </span>\n            </div>\n            <div class="invite-option-subtitle" aria-hidden="{{iwdc.linkCopied}}">{{iwdc.copyLinkSubtitle}}</div>\n          </div>\n        </div>\n        <div role="button" tabindex="0" class="invite-options-button icons-filled" ng-if="::!iwdc.isTFLInviteLinkEnabled()" ng-click="iwdc.openInviteContactsDialog()" data-tid="invitationWizard-inviteContacts" track-gesture="{{::$root.trackConstants.trackGesture.click}}" track-outcome="{{::$root.trackConstants.trackOutcome.openDialog}}" track-scenario="{{::$root.trackConstants.trackScenario.openInviteContactsDialog}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.freemium}}" track-name="{{::$root.trackConstants.trackModuleName.inviteCoworkers}}" track-type="{{::$root.trackConstants.trackType.button}}" track-summary="open invite contacts dialog" aria-label="{{::$root.resources.strings.invitation_wizard_invite_contacts_title | translate}}">\n          <ng-include class="icon icons-default-fill" src="\'svg/icons-add-participant.html\'" aria-hidden="true"/>\n          <div class="title-container">\n            <div class="invite-option-title" translate-once="{{::$root.resources.strings.invitation_wizard_invite_contacts_title}}"/>\n            <div class="invite-option-subtitle" translate-once="{{::$root.resources.strings.invitation_wizard_invite_contacts_subtitle}}"/>\n          </div>\n        </div>\n        <div class="invite-options-button icons-filled" role="button" tabindex="0" ng-click="iwdc.openInviteByEmailDialog()" data-tid="invitationWizard-openInviteByEmail" track-gesture="{{::$root.trackConstants.trackGesture.click}}" track-outcome="{{::$root.trackConstants.trackOutcome.openDialog}}" track-scenario="{{::$root.trackConstants.trackScenario.openInviteByEmailDialog}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.freemium}}" track-name="{{::$root.trackConstants.trackModuleName.inviteCoworkers}}" track-type="{{::$root.trackConstants.trackType.button}}" track-summary="open invite by email dialog" ng-if="::!iwdc.isTFLInviteLinkEnabled()" aria-label="{{::$root.resources.strings.invitation_wizard_invite_by_email_title | translate}}">\n          <ng-include class="icon icons-default-fill" src="\'svg/icons-email.html\'"/>\n          <div class="title-container">\n            <div class="invite-option-title" translate-once="{{::$root.resources.strings.invitation_wizard_invite_by_email_title}}"/>\n            <div class="invite-option-subtitle" translate-once="{{::$root.resources.strings.invitation_wizard_invite_by_email_subtitle}}"/>\n          </div>\n        </div>\n      </div>\n    </modal-dialog>\n  </div>\n</div>'},2338:function(e,t){e.exports='<div class="tooltip-container iwd-tooltip-right">\n  <div class="content-container">\n    <div class="tooltip-arrow-left"></div>\n    <span class="tooltip-content" ng-bind="content">\n    </span>\n  </div>\n</div>\n'},2339:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(2340),s=function(){function e(e,t,n,i,s,a,o,r,c){this.$translate=e,this.constants=t,this.dialogService=n,this.resources=i,this.settingsService=s,this.googleContactsAuthenticationService=a,this.msaAuthenticationService=o,this.importGoogleContactsService=r,this.importMsaContactsService=c,this.footerButtons=[],this.buttonOptions=[],this.init()}return e.$inject=["$translate","constants","dialogService","resources","settingsService","googleContactsAuthenticationService","msaAuthenticationService","importGoogleContactsService","importMsaContactsService"],e.prototype.init=function(){this.footerButtons.push(this.getBackFooterButton()),this.createContactsAccountsButtons()},e.prototype.createContactsAccountsButtons=function(){var e=this,t=this;this.settingsService.valueFor(this.constants.settings.names.inviteContactsAccountsConstants).accounts.forEach(function(n){var i=n.name;t.buttonOptions.push({text:i,iconPath:n.imgSrc,func:function(){return e.openInviteContactsDialogFromAccount(i)},id:"WizardBtn-"+i,tid:"wizardBtn-"+i,disabled:!1,type:teamspace.components.PanelModuleType.button,name:teamspace.components.PanelModuleName.selectInviteContactsAccount,outcome:teamspace.components.PanelActionOutcome.submit,scenario:teamspace.components.PanelActionScenario.selectInviteContactsAccount,summary:i+" account button selected on invite contacts accounts dialog",scenarioType:teamspace.components.PanelActionScenarioType.inviteContactsAccounts})})},e.prototype.getBackFooterButton=function(){var e=this;return{text:this.$translate.instant(this.resources.strings.freemium_invite_contacts_accounts_dialog_back_button),secondaryStyle:!0,func:function(){return e.openInvitationWizard()},id:"backButton",tid:"inviteContactsAccounts-backBtn",disabled:!1,type:teamspace.components.PanelModuleType.button,name:teamspace.components.PanelModuleName.backButton,outcome:teamspace.components.PanelActionOutcome.select,scenario:teamspace.components.PanelActionScenario.back,summary:"back button clicked on invite contacts accounts dialog",scenarioType:teamspace.components.PanelActionScenarioType.inviteContactsAccounts,icon:"svg/icons-chevron-left.html"}},e.prototype.openInvitationWizard=function(){this.dialogService.open(this.constants.dialogs.invitationWizard),this.dialogService.close(this.constants.dialogs.contactsChooseProviderDialog)},e.prototype.getDialogDataForAccount=function(e){var t,n=this.constants.freemium.inviteContacts.accounts.names,i=n.Microsoft,s=n.Google;switch(e){case i:default:t={accountAuthenticationService:this.msaAuthenticationService,importContactsService:this.importMsaContactsService,emailProviderName:e,allowAccountSignOut:!1,invitationScenario:teamspace.services.TenantInvitationScenario.ImportContactsMsa};break;case s:t={accountAuthenticationService:this.googleContactsAuthenticationService,importContactsService:this.importGoogleContactsService,emailProviderName:e,allowAccountSignOut:!0,invitationScenario:teamspace.services.TenantInvitationScenario.ImportContactsGoogle}}return t},e.prototype.openInviteContactsDialogFromAccount=function(e){this.dialogService.open(this.constants.dialogs.contactsTenantInvitation,this.getDialogDataForAccount(e)),this.close()},e.prototype.close=function(){this.dialogService.close(this.constants.dialogs.contactsChooseProviderDialog)},e}();t.InviteContactsAccountsDialogController=s,angular.module("teamspace.inviteContactsAccounts",["pascalprecht.translate","teamspace.constants","teamspace.googleContactsAuthenticationService","teamspace.msaAuthenticationService","teamspace.importMsaContactsService","teamspace.importGoogleContactsService","teamspace.locales","teamspace.manageTenantService","teamspace.settingsService","teamspace.dialogService"]).run(["constants","dialogService","$templateCache",function(e,t,n){n.put("components/freemium/invite-contacts-accounts-dialog/invite-contacts-accounts-dialog.html",i),t.register(e.dialogs.contactsChooseProviderDialog,{template:"components/freemium/invite-contacts-accounts-dialog/invite-contacts-accounts-dialog.html",className:"ts-modal-dialog custom-width",closeByEscape:!0,closeByDocument:!1,controller:"InviteContactsAccountsDialogController",controllerAs:"icadc",ariaAuto:!1,ariaRole:"dialog",ariaLabelledById:"modalDialog-title"})}]).controller("InviteContactsAccountsDialogController",s)},2340:function(e,t){e.exports='<div class="ts-invite-contacts-accounts-dialog-container" data-tid="invite-contacts-accounts-dialog-container">\n  <modal-dialog dialog-title="{{::($root.resources.strings.freemium_invite_contacts_accounts_dialog_title|translate)}}" add-close-icon="true" footer-buttons="icadc.footerButtons" suppress-default-button="true">\n    <div class="ts-invite-contacts-accounts-list-container" data-tid="ts-invite-contacts-accounts-list-container">\n       <wizard-btn-list button-options="icadc.buttonOptions"></wizard-btn-list>\n    </div>\n  </modal-dialog>\n</div>'},2341:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(2342),s=n(55),a=function(){function e(t,n,i,s,a,o,r,c,l,d,m){var u=this;if(this.$scope=t,this.$q=n,this.$window=i,this.$translate=s,this.constants=a,this.analyticsService=o,this.dialogService=r,this.loggingService=c,this.resources=l,this.settingsService=d,this.tenantMembershipService=m,this.distinctContacts=new Set,this.isLoadingContacts=!0,this.isLoadingContactsPagination=!1,this.showSignOutButton=!1,this.contactsInviteList=[],this.sendInvitesDisabled=!1,this.selectedContactsCount=0,this.invitesSent=0,this.overallInvitesSent=0,this.close=function(){u.sendBITelemetry(teamspace.components.PanelActionGesture.click,teamspace.components.PanelActionOutcome.closeDialog,teamspace.components.PanelActionScenario.closeInviteContactsDialog,teamspace.components.PanelActionScenarioType.closeDialog,teamspace.components.PanelModuleName.closeButton,teamspace.components.PanelModuleType.closeDialog,"Close invite contacts dialog",{overallInvitesSent:u.overallInvitesSent,selectedUnSentContactsCount:u.selectedContactsCount}),u.$scope.closeThisDialog(),u.dialogService.close(u.constants.dialogs.contactsTenantInvitation)},this.logger=c.newLogger(e.LOGGER_NAME),t.ngDialogData){var p=t.ngDialogData;this.accountAuthenticationService=p.accountAuthenticationService,this.importContactsService=p.importContactsService,this.emailProviderName=p.emailProviderName,this.invitationScenario=p.invitationScenario,this.allowAccountSignOut=p.allowAccountSignOut,this.dialogHeader=this.allowAccountSignOut?"":s.instant(l.strings.freemium_invite_contacts_dialog_header),this.updateDialogHeaderAndLoadContacts()}this.footerButtons=this.getFooterButtons(),this.selectContactActionContext={onSelectContact:function(e){return u.toggleContactSelection(e)}}}return e.$inject=["$scope","$q","$window","$translate","constants","analyticsService","dialogService","loggingService","resources","settingsService","tenantMembershipService"],e.prototype.getFooterButtons=function(){var e=this;return[{text:this.$translate.instant(this.resources.strings.freemium_invite_contacts_dialog_back_button),secondaryStyle:!0,func:function(){return e.backToPreviousWizard()},id:"backButton",tid:"inviteContacts-backBtn",disabled:!1,type:teamspace.components.PanelModuleType.button,name:teamspace.components.PanelModuleName.backButton,outcome:teamspace.components.PanelActionOutcome.select,scenario:teamspace.components.PanelActionScenario.back,summary:"Back button clicked on invite contacts dialog",scenarioType:teamspace.components.PanelActionScenarioType.inviteMembers,icon:"svg/icons-chevron-left.html",dataBagFunc:function(){return{overallInvitesSent:e.overallInvitesSent,selectedUnSentContactsCount:e.selectedContactsCount}}},{text:this.$translate.instant(this.resources.strings.freemium_invite_dialog_submit_button),secondaryStyle:!1,func:function(){return e.sendInvitations()},tid:"inviteContactsDialog-sendBtn",disabled:!0,type:teamspace.components.PanelModuleType.button,name:teamspace.components.PanelModuleName.sendInviteExternalContacts,outcome:teamspace.components.PanelActionOutcome.select,scenario:teamspace.components.PanelActionScenario.sendInviteExternalContacts,summary:"Send External Contacts Invite",scenarioType:teamspace.components.PanelActionScenarioType.inviteMembers,dataBagFunc:function(){return{invitesSent:e.invitesSent}}}]},e.prototype.showContactsChooseProviderDialog=function(){return!!this.settingsService.valueAsBoolean(this.constants.settings.names.enableInviteFromGoogleContacts)&&(!this.$window.electronSafeIpc||this.settingsService.valueAsBoolean(this.constants.settings.names.enableDesktopInviteFromGoogleContacts))},e.prototype.backToPreviousWizard=function(){this.close(),this.showContactsChooseProviderDialog()?this.dialogService.open(this.constants.dialogs.contactsChooseProviderDialog):this.dialogService.open(this.constants.dialogs.invitationWizard)},e.prototype.getContacts=function(e){var t=this;return this.importContactsService.fetchContacts(e).then(function(e){var n=[];if(e&&e.contactsList){t.paginationContext=e.paginationContext;for(var i=0;i<e.contactsList.length;i++){var a=JSON.stringify({emailAddress:e.contactsList[i].emailAddress.toLowerCase(),name:e.contactsList[i].name.toLowerCase()});t.distinctContacts.has(a)||(n.push({userType:"member",emailAddress:e.contactsList[i].emailAddress,displayName:e.contactsList[i].name,state:s.InviteMembersListInvitationState.Unsent,errorText:"",resendDisabled:!1,isSelected:!1}),t.distinctContacts.add(a))}}return t.$q.resolve(n)}).catch(function(e){return e&&e.errorMessage===t.constants.freemium.inviteContacts.errors.access_denied?t.getContactsError=t.$translate.instant(t.resources.strings.freemium_invite_contacts_error_access_denied):t.getContactsError=t.$translate.instant(t.resources.strings.freemium_invite_contacts_error_generic),t.logger.error("Failed to get Contacts"),t.$q.reject(e)})},e.prototype.updateDialogHeaderAndLoadContacts=function(){var e=this;if(this.allowAccountSignOut&&this.accountAuthenticationService.getExternalAccountUserBasicProfile){var t=this;this.accountAuthenticationService.getExternalAccountUserBasicProfile().then(function(e){t.dialogHeader=t.$translate.instant(t.resources.strings.freemium_invite_contacts_dialog_header_with_sign_out,{userEmail:e.email}),t.showSignOutButton=!0}).then(function(){return e.loadContacts()})}else this.loadContacts()},e.prototype.signOut=function(){var e=this;this.accountAuthenticationService.signOut&&this.accountAuthenticationService.signOut().then(function(){e.showSignOutButton=!1,e.backToPreviousWizard()})},e.prototype.loadContacts=function(){var e=this;this.isLoadingContacts=!0,this.getContactsError=null,this.getContacts().then(function(t){e.contactsInviteList=t,e.sendBITelemetry(teamspace.components.PanelActionGesture.auto,teamspace.components.PanelActionOutcome.read,teamspace.components.PanelActionScenario.loadContacts,teamspace.components.PanelActionScenarioType.inviteMembers,teamspace.components.PanelModuleName.listItem,teamspace.components.PanelModuleType.list,"Contacts loaded after auth",{contactsLoadedAfterAuth:t.length})}).finally(function(){e.isLoadingContacts=!1})},e.prototype.onScrollEdge=function(){var e=this;this.paginationContext&&!0!==this.isLoadingContactsPagination&&(this.isLoadingContactsPagination=!0,this.getContacts(this.paginationContext).then(function(t){e.contactsInviteList.push.apply(e.contactsInviteList,t),e.sendBITelemetry(teamspace.components.PanelActionGesture.scroll,teamspace.components.PanelActionOutcome.read,teamspace.components.PanelActionScenario.loadContacts,teamspace.components.PanelActionScenarioType.scroll,teamspace.components.PanelModuleName.inviteContactsScroll,teamspace.components.PanelModuleType.slider,"Scroll and load more contacts",{newContactsLoaded:t.length})}).finally(function(){e.isLoadingContactsPagination=!1}))},e.prototype.sendInvitations=function(){var e=this;if(this.sendInvitationsGenericError=null,this.contactsInviteList&&0!==this.contactsInviteList.length){for(var t=[],n=[],i=0,a=this.contactsInviteList;i<a.length;i++){var o=a[i];o.emailAddress&&o.isSelected&&!o.resendDisabled&&(t.push(o),o.state=s.InviteMembersListInvitationState.Sending,o.errorText=null,o.isSelected=!1,n.push(o))}if(0!=n.length){var r=this.loggingService.newScenario(this.constants.scenarios.freemium.contactsInvitations),c={invitesSuccessfullySent:0,totalInvites:n.length};this.tenantMembershipService.inviteMembersToTenant(n,this.invitationScenario).then(function(n){t.forEach(function(t){var i=_.find(n,function(e){return e.emailAddress.toLowerCase()===t.emailAddress.toLowerCase()});if(i)if(i.status&&"success"===i.status.toLowerCase()&&!i.errorCode)t.state=s.InviteMembersListInvitationState.Sent,e.invitesSent++;else{t.state=s.InviteMembersListInvitationState.Unsent;var a=e.tenantMembershipService.getInviteErrorMessageFromErrorCode(i.errorCode);a&&(t.errorText=a.errorMessage,t.resendDisabled=!0)}else t.errorText=e.$translate.instant(e.resources.strings.freemium_invite_sending_generic_error_text)}),e.overallInvitesSent+=e.invitesSent,c.invitesSuccessfullySent=e.invitesSent,r.stop({data:JSON.stringify(c)})}).catch(function(n){e.sendInvitationsGenericError=e.$translate.instant(e.resources.strings.freemium_invite_sending_generic_error_text),t.forEach(function(e){return e.state=s.InviteMembersListInvitationState.Unsent}),r.fail({data:JSON.stringify(c)})}),this.selectedContactsCount=0,this.footerButtons[1].disabled=!0}}},e.prototype.toggleContactSelection=function(e){this.invitesSent=0,e&&!0===e.isSelected?this.selectedContactsCount++:this.selectedContactsCount--,this.footerButtons[1].disabled=0===this.selectedContactsCount,this.sendInvitationsGenericError=null},e.prototype.sendBITelemetry=function(e,t,n,i,s,a,o,r){var c=this;void 0===e&&(e=null),void 0===t&&(t=null),void 0===n&&(n=null),void 0===i&&(i=null),void 0===s&&(s=null),void 0===a&&(a=null),void 0===o&&(o=null),void 0===r&&(r=null);var l={action:{gesture:e?teamspace.shared.AttributeHelper.tryGetEnum(e.toString(),teamspace.components.PanelActionGesture,this.logger):null,outcome:t?teamspace.shared.AttributeHelper.tryGetEnum(t.toString(),teamspace.components.PanelActionOutcome,this.logger):null,scenario:n?teamspace.shared.AttributeHelper.tryGetEnum(n.toString(),teamspace.components.PanelActionScenario,this.logger):null,scenarioType:i?teamspace.shared.AttributeHelper.tryGetEnum(i.toString(),teamspace.components.PanelActionScenarioType,this.logger):null},module:{name:s?teamspace.shared.AttributeHelper.tryGetEnum(s.toString(),teamspace.components.PanelModuleName,this.logger).toString():null,type:a?teamspace.shared.AttributeHelper.tryGetEnum(a.toString(),teamspace.components.PanelModuleType,this.logger):null,summary:o},dataBag:r};this.analyticsService.getAnalyticsPanelActionEventData(l).then(function(e){c.analyticsService.sendPanelAction(e)})},e.LOGGER_NAME="InviteContactsDialog",e}();t.InviteContactsDialogController=a,angular.module("teamspace.inviteContacts",["teamspace.constants","teamspace.locales","teamspace.analyticsService","teamspace.loggingService","teamspace.msaAuthenticationService","teamspace.settingsService","teamspace.tenantMembershipService","teamspace.dialogService"]).run(["constants","dialogService","$templateCache",function(e,t,n){n.put("components/freemium/invite-contacts-dialog/invite-contacts-dialog.html",i),t.register(e.dialogs.contactsTenantInvitation,{template:"components/freemium/invite-contacts-dialog/invite-contacts-dialog.html",className:"ts-modal-dialog custom-width",closeByEscape:!0,closeByDocument:!1,controller:"InviteContactsDialogController",controllerAs:"icdc",ariaAuto:!1,ariaRole:"dialog",ariaLabelledById:"modalDialog-title"})}]).controller("InviteContactsDialogController",a)},2342:function(e,t){e.exports='<div class="ts-invite-contacts-dialog-container" data-tid="invite-contacts-dialog-container">\n  <modal-dialog dialog-title="{{::($root.resources.strings.freemium_invite_contacts_dialog_title|translate:{providerName: icdc.emailProviderName})}}" add-close-icon="true" close-function="icdc.close" footer-buttons="icdc.footerButtons" suppress-default-button="true">\n\n    <div ng-if="icdc.allowAccountSignOut || icdc.isLoadingContacts || icdc.contactsInviteList.length > 0" class="dialog-header">\n         <span>{{icdc.dialogHeader}}</span>\n         <button ng-if="icdc.showSignOutButton" class="btn btn-link" translate-once="{{::$root.resources.strings.freemium_invite_contacts_dialog_current_account_sign_out}}" ng-click="icdc.signOut()">\n         </button>\n    </div>\n\n    <div ng-if="icdc.isLoadingContacts">\n      <div class="busy-animation-class">\n        <busy-animation size="medium"></busy-animation>\n      </div>\n    </div>\n\n    \x3c!-- error message for failure to get contacts --\x3e\n    <div ng-if="icdc.getContactsError" data-tid="inviteContacts-auth-error">\n      <div class="invite-tenant-pending-invites-generic-error">\n        <ng-include src="\'svg/icons-call-alert.html\'"></ng-include>\n        <span role="alert" aria-live="assertive" ng-bind="icdc.getContactsError"></span>\n        <button class="invite-tenant-pending-invites-generic-error-retry" ng-click="icdc.loadContacts()" tabindex="-1" set-focus="true" aria-label="{{::$root.resources.strings.freemium_invite_dialog_pending_invites_retry_button|translate}}">\n            <ng-include src="\'svg/icons-refresh.html\'"></ng-include>\n            <span>{{::$root.resources.strings.freemium_pending_join_requests_retry_button|translate}}</span>\n          </button>\n      </div>\n    </div>\n\n    <div ng-if="!icdc.isLoadingContacts">\n      <span ng-if="!icdc.getContactsError && icdc.contactsInviteList.length === 0">\n          {{::($root.resources.strings.freemium_invite_contacts_account_empty_contacts_message|translate:{providerName:icdc.emailProviderName})}}\n      </span>\n      <invite-members-list members-list="icdc.contactsInviteList" prefix-data-tid="inviteContacts" action-directive="invite-contacts-select-action" action-directive-functions-context="::icdc.selectContactActionContext" on-scroll-edge="icdc.onScrollEdge()">\n      </invite-members-list>\n\n      <div class="invite-contacts-message-container" aria-live="assertive">\n        <div ng-if="icdc.isLoadingContactsPagination" class="pagination-busy-animation">\n          <busy-animation size="small"></busy-animation>\n        </div>\n        <span class="invite-contacts-generic-error" role="alert" ng-if="icdc.sendInvitationsGenericError" ng-bind="icdc.sendInvitationsGenericError" data-tid="inviteContacts-get-contacts-error"></span>\n        <span class="selected-contacts-count" ng-if="icdc.invitesSent > 0">{{($root.resources.strings.freemium_invite_contacts_dialog_invites_sent_message|translate:{sentInvitesCount:icdc.invitesSent})}}</span>\n        <span class="selected-contacts-count" aria-live="polite" ng-if="icdc.selectedContactsCount > 0">{{($root.resources.strings.freemium_invite_contacts_dialog_selected_message|translate:{selectedCount:icdc.selectedContactsCount})}}</span>\n      </div>\n  </div>\n  </modal-dialog>\n</div>'},2343:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(2344),s=n(55),a=function(){function e(e,t){this.$translate=e,this.resources=t}return e.$inject=["$translate","resources"],e.prototype.resendPendingInvite=function(e){return this.context.functionsContext.resendPendingInvite(e)},e.prototype.getPendingInviteStateAriaLabel=function(e){var t;return e.errorText?t=e.errorText:e.state===s.InviteMembersListInvitationState.Unsent?t=this.$translate.instant(this.resources.strings.freemium_invite_dialog_resend_button):e.state===s.InviteMembersListInvitationState.Sent&&(t=this.$translate.instant(this.resources.strings.freemium_invite_dialog_sent_state)),t},e}();t.InviteMembersResendActionController=a,angular.module("teamspace.inviteMembersResendAction",["pascalprecht.translate","teamspace.locales"]).run(["constants","dialogService","$templateCache",function(e,t,n){n.put("components/freemium/invite-members-resend-action/invite-members-resend-action.html",i)}]).component("inviteMembersResendAction",{bindings:{context:"<"},controller:a,templateUrl:"components/freemium/invite-members-resend-action/invite-members-resend-action.html"})},2344:function(e,t){e.exports='<div class="invite-member-resend-action-container" id="pendingInviteAction-{{::$ctrl.context.member.emailAddress}}" acc-role="table-content-cell" aria-label="{{$ctrl.getPendingInviteStateAriaLabel($ctrl.context.member)}}">\n  <button class="ts-btn ts-btn-primary" ng-if="$ctrl.context.member.state === 0" ng-disabled="$ctrl.context.member.resendDisabled" ng-click="$ctrl.resendPendingInvite($ctrl.context.member)" tabindex="-1" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-gesture="{{::$root.trackConstants.trackGesture.click}}" track-scenario="{{::$root.trackConstants.trackScenario.resendInvite}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.inviteMembers}}" track-name="{{::$root.trackConstants.trackModuleName.resendInvite}}" track-type="{{::$root.trackConstants.trackType.button}}" track-summary="Resend invite">{{::$root.resources.strings.freemium_invite_dialog_resend_button|translate}}</button>\n  <busy-animation ng-if="$ctrl.context.member.state === 1" size="small"></busy-animation>\n  <div class="invite-tenant-pending-invite-sent-state" ng-if="$ctrl.context.member.state === 2">\n    <ng-include class="icon" src="\'svg/icons-accept.html\'"></ng-include>\n    <span>{{::$root.resources.strings.freemium_invite_dialog_sent_state|translate}}</span>\n  </div>\n</div>'},2345:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(2346),s=n(55),a=function(){function e(e,t){this.$translate=e,this.resources=t}return e.$inject=["$translate","resources"],e.prototype.onSelectContact=function(e){return this.context.functionsContext.onSelectContact(e)},e.prototype.getInvitationStateAriaLabel=function(e){var t;return e.errorText?t=e.errorText:e.state===s.InviteMembersListInvitationState.Unsent?t=e.isSelected?this.$translate.instant(this.resources.strings.freemium_invite_contacts_dialog_checkbox_selected_aria_label):this.$translate.instant(this.resources.strings.freemium_invite_contacts_dialog_checkbox_unselected_aria_label):e.state===s.InviteMembersListInvitationState.Sent&&(t=this.$translate.instant(this.resources.strings.freemium_invite_dialog_sent_state)),t},e.prototype.generateSelectActionTrackConstants=function(){return{trackScenario:teamspace.components.PanelActionScenario.selectExternalContact,trackOutcome:teamspace.components.PanelActionOutcome.select,trackScenarioType:teamspace.components.PanelActionScenarioType.inviteMembers,trackName:teamspace.components.PanelModuleName.selectExternalContact,trackType:teamspace.components.PanelModuleType.checkbox,trackSummary:"Select external contact"}},e}();t.InviteContactsSelectActionController=a,angular.module("teamspace.inviteContactsSelectAction",["pascalprecht.translate","teamspace.locales"]).run(["constants","dialogService","$templateCache",function(e,t,n){n.put("components/freemium/invite-contacts-select-action/invite-contacts-select-action.html",i)}]).component("inviteContactsSelectAction",{bindings:{context:"<"},controller:a,templateUrl:"components/freemium/invite-contacts-select-action/invite-contacts-select-action.html"})},2346:function(e,t){e.exports='<div class="invite-member-resend-action-container" id="memberState-{{::$ctrl.context.member.emailAddress}}" acc-role="table-content-cell" aria-label="{{$ctrl.getInvitationStateAriaLabel($ctrl.context.member)}}">\n  <teams-checkbox name="invite-checkbox" ng-if="$ctrl.context.member.state === 0" ng-model="$ctrl.context.member.isSelected" is-disabled="$ctrl.context.member.resendDisabled" on-click="$ctrl.onSelectContact($ctrl.context.member)" disable-keyboard-nav="true" narrator-text="{{::$ctrl.context.member.emailAddress}}" generate-track-constants-function="$ctrl.generateSelectActionTrackConstants()">\n  </teams-checkbox>\n  <busy-animation ng-if="$ctrl.context.member.state === 1" size="small"></busy-animation>\n  <div class="invite-member-sent-state" ng-if="$ctrl.context.member.state === 2">\n    <ng-include class="icon" src="\'svg/icons-accept.html\'"></ng-include>\n    <span>{{::$root.resources.strings.freemium_invite_dialog_sent_state|translate}}</span>\n  </div>\n</div>'},2347:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,s=n(2348),a=n(2349),o=n(2350);!function(e){e.ManageInvites="manageInvites",e.ManageLink="manageLink"}(i=t.ManageTenantSettingsTabSection||(t.ManageTenantSettingsTabSection={}));var r=function(){function e(t,n,s,a,o,r,c,l,d,m,u,p,g,v,h){var b=this;this.$q=t,this.$scope=n,this.$timeout=s,this.ariaLiveService=o,this.constants=r,this.dialogService=c,this.loggingService=l,this.manageTenantService=m,this.tenantMembershipService=u,this.tooltipService=p,this.utilityService=g,this.settingsService=v,this.analyticsService=h,this.oneClickJoinEnabled=!1,this.state={},this.networkErrorThreshold=e.NETWORK_ERROR_THRESHOLD,this.anyoneCanInvite=!1,this.anyoneCanInviteErrors=0,this.joinLinkEnabled=!1,this.joinLinkEnabledErrors=0,this.resetJoinLinkErrors=0,this.resetJoinLinkPending=!1,this.logger=l.newLogger(e.LOGGER_NAME),this.disableLinkDialogHeader=a.instant(d.strings.manage_tenant_manage_join_link_disable_confirmation_dialog_header),this.disableLinkDialogContent=a.instant(d.strings.manage_tenant_manage_join_link_disable_confirmation_dialog_content),this.disableLinkDialogConfirmButton=a.instant(d.strings.manage_tenant_manage_join_link_disable_confirmation_dialog_confirm_button_text),this.resetLinkDialogHeader=a.instant(d.strings.manage_tenant_manage_join_link_reset_confirmation_dialog_header),this.resetLinkDialogContent=a.instant(d.strings.manage_tenant_manage_join_link_reset_confirmation_dialog_content),this.resetLinkDialogConfirmButton=a.instant(d.strings.manage_tenant_manage_join_link_reset_confirmation_dialog_confirm_button_text),this.confirmDialogCancelButton=a.instant(d.strings.cancel),this.updateSettingErrorString=a.instant(d.strings.manage_tenant_manage_update_settings_error_text),this.resetLinkErrorString=a.instant(d.strings.manage_tenant_manage_join_link_reset_link_error_text),this.networkErrorString=a.instant(d.strings.manage_tenant_manage_network_error_text),this.linkCopiedText=a.instant(d.strings.manage_tenant_manage_join_link_copied_tooltip_text),this.linkCopiedTooltipId=g.generateUUID(),this.oneClickJoinTooltipText=a.instant(d.strings.manage_tenant_manage_join_link_autojoin_tooltip_text),this.oneClickJoinTooltipId=g.generateUUID(),this.getSettingValues(),Object.values(i).forEach(function(e){b.state[e]={expanded:!1}})}return e.$inject=["$q","$scope","$timeout","$translate","ariaLiveService","constants","dialogService","loggingService","resources","manageTenantService","tenantMembershipService","tooltipService","utilityService","settingsService","analyticsService"],e.prototype.$onInit=function(){if(this.context&&_.isString(this.context))try{var e=JSON.parse(atob(this.context));if(e&&e.state)for(var t in e.state)e.state.hasOwnProperty(t)&&this.state.hasOwnProperty(t)&&(this.state[t]=e.state[t],this.logger.info("parsed state for section '"+t+"' from context."))}catch(e){this.logger.error("could not parse json object from context.")}},e.prototype.isOneClickJoinEnabled=function(){return this.settingsService.valueAsBoolean(this.constants.settings.names.enableOneClickJoin)},e.prototype.toggleSectionExpanded=function(e){this.state[e].expanded=!this.state[e].expanded},e.prototype.isSectionExpanded=function(e){return this.state[e].expanded},e.prototype.anyoneCanInviteClicked=function(){var e=this;this.manageTenantService.setMembersCanInvite(this.anyoneCanInvite).then(function(){e.anyoneCanInviteErrors=0}).catch(function(){e.anyoneCanInvite=!e.anyoneCanInvite,e.anyoneCanInviteErrors++})},e.prototype.sendManageTenantSettingsTelemetry=function(e,t){var n=e?teamspace.components.PanelActionOutcome.disable.toString():teamspace.components.PanelActionOutcome.enable.toString(),i=teamspace.shared.AttributeHelper.tryGetEnum(t.toString(),teamspace.components.PanelModuleName,this.loggingService),s={action:{gesture:teamspace.components.PanelActionGesture.click,outcome:teamspace.shared.AttributeHelper.tryGetEnum(n,teamspace.components.PanelActionOutcome,this.loggingService),scenario:teamspace.shared.AttributeHelper.tryGetEnum(teamspace.components.PanelActionScenario.manageTenantSettings.toString(),teamspace.components.PanelActionScenario,this.loggingService),scenarioType:teamspace.shared.AttributeHelper.tryGetEnum(teamspace.components.PanelActionScenarioType.manageLink.toString(),teamspace.components.PanelActionScenarioType,this.loggingService)},module:{name:i,type:teamspace.shared.AttributeHelper.tryGetEnum(teamspace.components.PanelModuleType.toggle.toString(),teamspace.components.PanelModuleType,this.loggingService),summary:"toggleJoinTenantByUrl"==i?"Join tenant by url setting being toggled by user":"One click join setting being toggled by user"}};this.analyticsService.onPanelAction(this.$scope,s)},e.prototype.oneClickJoinEnabledClicked=function(){var e=this;this.oneClickJoinEnabled=!this.oneClickJoinEnabled,this.manageTenantService.setAutoApproveJoinRequestsEnabled(!this.oneClickJoinEnabled).then(function(){e.oneClickJoinEnabled=!e.oneClickJoinEnabled,e.joinLinkEnabledErrors=0,e.sendManageTenantSettingsTelemetry(!e.oneClickJoinEnabled,teamspace.components.PanelModuleName.toggleOneClickJoin)}).then(function(){e.oneClickJoinEnabled&&e.tenantMembershipService.getTenantJoinRequestCount()>0&&e.dialogService.open(e.constants.dialogs.pendingJoinRequests,{source:teamspace.services.PendingJoinRequestsDialogSource.ManageTenant})}).catch(function(){e.joinLinkEnabledErrors++})},e.prototype.joinLinkEnabledClicked=function(){var e=this;if(this.joinLinkEnabled)this.joinLinkEnabled=!1,this.manageTenantService.getJoinTenantUrl().then(function(t){return t&&t.joinUrl?e.$q.resolve(t):e.manageTenantService.generateJoinTenantUrl()}).then(function(t){e.joinLink=t&&t.joinUrl,e.oneClickJoinEnabled=t&&t.autoApproveJoinRequestsEnabled,e.updateJoinLinkEnabled(),e.joinLinkEnabledErrors=0,e.sendManageTenantSettingsTelemetry(!1,teamspace.components.PanelModuleName.toggleJoinTenantByUrl)}).catch(function(){e.joinLinkEnabledErrors++});else{this.joinLinkEnabled=!0;var t={confirmMessageTitle:this.disableLinkDialogHeader,confirmMessageHtmlBody:this.disableLinkDialogContent,okButtonText:this.disableLinkDialogConfirmButton,closeButtonText:this.confirmDialogCancelButton,preActiveElementIds:["mtst-join-link-toggle-button"],customClass:"mtst-confirm-dialog",callback:function(){e.manageTenantService.deleteJoinTenantUrl().then(function(){e.joinLink=null,e.updateJoinLinkEnabled(),e.joinLinkEnabledErrors=0,e.sendManageTenantSettingsTelemetry(!0,teamspace.components.PanelModuleName.toggleJoinTenantByUrl)}).catch(function(){e.joinLinkEnabledErrors++})}};this.dialogService.open(this.constants.dialogs.confirmDialog,t)}},e.prototype.resetJoinLink=function(){var e=this,t={confirmMessageTitle:this.resetLinkDialogHeader,confirmMessageHtmlBody:this.resetLinkDialogContent,okButtonText:this.resetLinkDialogConfirmButton,closeButtonText:this.confirmDialogCancelButton,preActiveElementIds:["mtst-join-link-reset-button"],customClass:"mtst-confirm-dialog",callback:function(){e.resetJoinLinkPending=!0,e.manageTenantService.getJoinTenantUrl().then(function(t){var n=t&&t.joinUrl;return n&&n!==e.joinLink?e.$q.resolve(t):e.manageTenantService.generateJoinTenantUrl()}).then(function(t){e.joinLink=t&&t.joinUrl,e.oneClickJoinEnabled=t&&t.autoApproveJoinRequestsEnabled,e.updateJoinLinkEnabled(),e.resetJoinLinkErrors=0}).catch(function(){e.resetJoinLinkErrors++}).finally(function(){e.resetJoinLinkPending=!1})}};this.dialogService.open(this.constants.dialogs.confirmDialog,t)},e.prototype.copyJoinLink=function(e){this.utilityService.copyToClipboard(this.joinLink),this.showLinkCopiedTooltip(e),e.target&&e.target.focus&&e.target.focus(),this.ariaLiveService.update(this.linkCopiedText)},e.prototype.getSettingValues=function(){var e=this;this.manageTenantService.getMembersCanInvite().then(function(t){e.anyoneCanInvite=t}),this.manageTenantService.getJoinTenantUrl().then(function(t){e.joinLink=t&&t.joinUrl,e.oneClickJoinEnabled=t&&t.autoApproveJoinRequestsEnabled,e.updateJoinLinkEnabled()})},e.prototype.updateJoinLinkEnabled=function(){this.joinLinkEnabled=this.joinLink&&this.joinLink.length>0},e.prototype.showLinkCopiedTooltip=function(t){var n=this;this.linkCopiedTooltipTimeoutPromise&&(this.$timeout.cancel(this.linkCopiedTooltipTimeoutPromise),this.linkCopiedTooltipTimeoutPromise=null);var i={templateUrl:"components/freemium/manage-tenant-settings-tab/manage-tenant-settings-tab-tooltip.html",trigger:"manual",container:"body",placement:"top",autoClose:!0,scope:this.$scope,content:this.linkCopiedText,id:"joinUrlCopyLinkTooltip"},s={sourceElement:angular.element(t.currentTarget),tooltipType:teamspace.services.TooltipType.Popover,options:i,tooltipId:this.linkCopiedTooltipId};this.tooltipService.showTooltip(s),this.linkCopiedTooltipTimeoutPromise=this.$timeout(function(){n.tooltipService.clearTooltip(teamspace.services.TooltipType.Popover,n.linkCopiedTooltipId),n.linkCopiedTooltipTimeoutPromise=null},e.LINK_COPIED_POPOVER_TIMEOUT_MS,!1)},e.prototype.showOneClickJoinInfoTooltip=function(e,t){if(t){var n={template:o,trigger:"manual",container:"body",placement:"right",autoClose:!0,scope:this.$scope,content:this.oneClickJoinTooltipText},i={sourceElement:angular.element(e.currentTarget),tooltipType:teamspace.services.TooltipType.Popover,options:n,tooltipId:this.oneClickJoinTooltipId};this.tooltipService.showTooltip(i)}else this.tooltipService.clearTooltip(teamspace.services.TooltipType.Popover,this.oneClickJoinTooltipId)},e.LOGGER_NAME="ManageTenantSettingsTabController",e.LINK_COPIED_POPOVER_TIMEOUT_MS=2e3,e.NETWORK_ERROR_THRESHOLD=2,e}();t.ManageTenantSettingsTabController=r,angular.module("teamspace.manageTenantSettingsTab",["pascalprecht.translate","teamspace.ariaLiveService","teamspace.constants","teamspace.dialogService","teamspace.locales","teamspace.loggingService","teamspace.manageTenantService","teamspace.tenantMembershipService","teamspace.tooltipService","teamspace.utilityService","teamspace.settingsService","teamspace.analyticsService"]).run(["$templateCache",function(e){e.put("components/freemium/manage-tenant-settings-tab/manage-tenant-settings-tab.html",s),e.put("components/freemium/manage-tenant-settings-tab/manage-tenant-settings-tab-tooltip.html",a)}]).component("manageTenantSettingsTab",{bindings:{context:"<"},controller:r,templateUrl:"components/freemium/manage-tenant-settings-tab/manage-tenant-settings-tab.html"})},2348:function(e,t){e.exports='<div class="manage-tenant-settings-tab-container">\n  \x3c!-- Member invites setting--\x3e\n  <div class="mtst-section">\n    <div class="mtst-section-header">\n      <button class="mtst-section-expand-collapse icons-gray-06-triangle-fill" ng-click="$ctrl.toggleSectionExpanded(\'manageInvites\')" aria-controls="mt-manage-invites-settings-details" aria-expanded="{{$ctrl.isSectionExpanded(\'manageInvites\')}}">\n        <ng-include ng-show="$ctrl.isSectionExpanded(\'manageInvites\')" src="\'svg/icons-triangle-down-small.html\'"></ng-include>\n        <ng-include ng-hide="$ctrl.isSectionExpanded(\'manageInvites\')" src="\'svg/icons-triangle-right-small.html\'"></ng-include>\n        <span>{{::$root.resources.strings.manage_tenant_manage_invites_header|translate}}</span>\n      </button>\n      <span class="mtst-section-description">{{::$root.resources.strings.manage_tenant_manage_invites_description|translate}}</span>\n    </div>\n    <div class="mtst-section-details" ng-class="{\'expanded\': $ctrl.isSectionExpanded(\'manageInvites\') }" id="mt-manage-invites-settings-details">\n      <teams-checkbox ng-model="$ctrl.anyoneCanInvite" on-click="$ctrl.anyoneCanInviteClicked()" label-text="{{::$root.resources.strings.manage_tenant_manage_invites_checkbox_label|translate}}" narrator-text="{{::$root.resources.strings.manage_tenant_manage_invites_checkbox_label|translate}}" flush-left="true"></teams-checkbox>\n      <div class="mtst-error-container" ng-if="$ctrl.anyoneCanInviteErrors">\n        <ng-include class="error-icon" aria-hidden="true" src="\'svg/icons-error.html\'"></ng-include>\n        <span class="mtst-error-text" role="alert" aria-live="assertive">{{$ctrl.anyoneCanInviteErrors > $ctrl.networkErrorThreshold ? $ctrl.networkErrorString : $ctrl.updateSettingErrorString}}</span>\n      </div>\n    </div>\n  </div>\n\n  \x3c!-- Manage link setting--\x3e\n  <div class="mtst-section">\n    <div class="mtst-section-header">\n      <button class="mtst-section-expand-collapse icons-gray-06-triangle-fill" ng-click="$ctrl.toggleSectionExpanded(\'manageLink\')" data-tid="manageTenantSettings-manageLink" aria-controls="mt-manage-link-settings-details" aria-expanded="{{$ctrl.isSectionExpanded(\'manageLink\')}}" track-outcome="{{::$root.trackConstants.trackOutcome.inspect}}" track-gesture="{{::$root.trackConstants.trackGesture.click}}" track-scenario="{{::$root.trackConstants.trackScenario.manageTenantSettings}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.manageLink}}" track-name="{{::$root.trackConstants.trackModuleName.manageLinkSection}}" track-type="{{::$root.trackConstants.trackType.button}}" track-data="{ isSectionExpanded: \'$ctrl.isSectionExpanded(\'manageLink\')\'}" track-summary="Expand and collapse manage join tenant url settings">\n        <ng-include ng-show="$ctrl.isSectionExpanded(\'manageLink\')" src="\'svg/icons-triangle-down-small.html\'"></ng-include>\n        <ng-include ng-hide="$ctrl.isSectionExpanded(\'manageLink\')" src="\'svg/icons-triangle-right-small.html\'"></ng-include>\n        <span>{{::$root.resources.strings.manage_tenant_manage_join_link_header|translate}}</span>\n      </button>\n      <span class="mtst-section-description">{{::$root.resources.strings.manage_tenant_manage_join_link_description|translate}}</span>\n    </div>\n    <div class="mtst-section-details" ng-class="{\'expanded\': $ctrl.isSectionExpanded(\'manageLink\') }" id="mt-manage-link-settings-details">\n      <div class="mtst-join-link-labels-container">\n        <label class="mtst-join-link-toggle app-checkbox--label">\n          <input id="mtst-join-link-toggle-button" class="app-checkbox--input" type="checkbox" ng-model="$ctrl.joinLinkEnabled" ng-click="$ctrl.joinLinkEnabledClicked()"/>\n          <ng-include class="icons-checkbox-common icons-checkbox--unselected" aria-hidden="true" src="\'svg/toggle-off.html\'"></ng-include>\n          <ng-include class="icons-checkbox-common icons-checkbox--selected" aria-hidden="true" src="\'svg/toggle-on.html\'"></ng-include>\n          <span class="app-checkbox--labelText">{{::$root.resources.strings.manage_tenant_manage_join_link_toggle_label|translate}}</span>\n        </label>\n        <span class="mtst-join-link-label-container" ng-if="$ctrl.joinLinkEnabled && $ctrl.isOneClickJoinEnabled()">\n          <label class="mtst-join-link-toggle app-checkbox--label">\n            <input id="mtst-join-link-toggle-auto-join-button" class="app-checkbox--input" type="checkbox" ng-model="$ctrl.oneClickJoinEnabled" ng-click="$ctrl.oneClickJoinEnabledClicked()"/>\n            <ng-include class="icons-checkbox-common icons-checkbox--unselected" aria-hidden="true" src="\'svg/toggle-off.html\'"></ng-include>\n            <ng-include class="icons-checkbox-common icons-checkbox--selected" aria-hidden="true" src="\'svg/toggle-on.html\'"></ng-include>\n            <span class="app-checkbox--labelText">{{::$root.resources.strings.manage_tenant_manage_join_link_toggle_autojoin_label|translate}}</span>\n          </label>\n          <span id="mtst-join-link-info" tabindex="0" ng-click="$ctrl.showOneClickJoinInfoTooltip($event, true)" ng-focus="$ctrl.showOneClickJoinInfoTooltip($event, true)" ng-blur="$ctrl.showOneClickJoinInfoTooltip($event, false)" ng-mouseenter="$ctrl.showOneClickJoinInfoTooltip($event, true)" ng-mouseleave="$ctrl.showOneClickJoinInfoTooltip($event, false)" data-prevent-refocus="true" role="text" aria-label="{{::$ctrl.oneClickJoinTooltipText}}">\n              <ng-include class="icon" src="\'svg/icons-info.html\'"></ng-include>\n          </span>\n        </span>\n      </div>\n      <div class="mtst-error-container" ng-if="$ctrl.joinLinkEnabledErrors">\n        <ng-include class="error-icon" aria-hidden="true" src="\'svg/icons-error.html\'"></ng-include>\n        <span class="mtst-error-text" role="alert" aria-live="assertive">{{$ctrl.joinLinkEnabledErrors > $ctrl.networkErrorThreshold ? $ctrl.networkErrorString : $ctrl.updateSettingErrorString}}</span>\n      </div>\n      <div class="mtst-join-link-details" ng-if="$ctrl.joinLinkEnabled">\n        <p class="mtst-join-link-label">{{::$root.resources.strings.manage_tenant_manage_join_link_label|translate}}</p>\n        <p class="mtst-join-link" ng-class="{ \'unselectable\': $ctrl.resetJoinLinkPending }">{{$ctrl.joinLink}}</p>\n        <div class="msts-join-link-buttons-container">\n          <button id="mtst-join-link-reset-button" class="button-command focus-round-border" ng-click="$ctrl.resetJoinLink()" track-outcome="{{::$root.trackConstants.trackOutcome.submit}}" track-gesture="{{::$root.trackConstants.trackGesture.click}}" track-scenario="{{::$root.trackConstants.trackScenario.manageTenantSettings}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.manageLink}}" track-name="{{::$root.trackConstants.trackModuleName.resetJoinTenantUrl}}" track-type="{{::$root.trackConstants.trackType.button}}" track-summary="Admin clicked to reset the join url">\n            <ng-include class="icon" src="\'svg/icons-refresh.html\'"></ng-include>\n            <span class="button-command--text-with-icon">{{::$root.resources.strings.manage_tenant_manage_join_link_reset_button_text|translate}}</span>\n          </button>\n          <button class="button-command focus-round-border" ng-click="$ctrl.copyJoinLink($event)" id="mtst-join-link-copy-button" ng-disabled="$ctrl.resetJoinLinkPending" track-gesture="{{::$root.trackConstants.trackGesture.click}}" track-outcome="{{::$root.trackConstants.trackOutcome.submit}}" track-scenario="{{::$root.trackConstants.trackScenario.manageTenantSettings}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.manageLink}}" track-name="{{::$root.trackConstants.trackModuleName.copyJoinTenantUrl}}" track-type="{{::$root.trackConstants.trackType.button}}" track-summary="copy join url link">\n            <ng-include class="icon" src="\'svg/icons-copy.html\'"></ng-include>\n            <span class="button-command--text-with-icon">{{::$root.resources.strings.manage_tenant_manage_join_link_copy_button_text|translate}}</span>\n          </button>\n        </div>\n        <div class="mtst-error-container" ng-if="$ctrl.resetJoinLinkErrors">\n          <ng-include class="error-icon" aria-hidden="true" src="\'svg/icons-error.html\'"></ng-include>\n          <span class="mtst-error-text" role="alert" aria-live="assertive">{{$ctrl.resetJoinLinkErrors > $ctrl.networkErrorThreshold ? $ctrl.networkErrorString : $ctrl.resetLinkErrorString}}</span>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>'},2349:function(e,t){e.exports='<div class="popover mtst-tooltip" data-tid="joinLinkCopied">\n  <div class="tooltip-inner" ng-bind="content"></div>\n  <div class="tooltip-arrow"></div>\n</div>'},2350:function(e,t){e.exports='<div class="tooltip-container mtst-tooltip-right" id="auto-join-link-info-tooltip">\n  <div class="content-container">\n    <div class="tooltip-arrow-left"></div>\n    <span class="tooltip-content" ng-bind="content">\n    </span>\n  </div>\n</div>\n'},2351:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(2352),s=function(){function e(e,t,n,i,s,a,o,r,c){this.$q=e,this.$scope=t,this.$timeout=n,this.constants=i,this.retryService=s,this.aggregatedSettingsStore=a,this.loggingService=o,this.dialogHeading="",this.logger=o.newLogger("FreemiumSetupDialogController"),this.ensureSettingsInitialized(),this.dialogHeading=r.instant(c.strings.freemium_setup_dialog_heading)}return e.$inject=["$q","$scope","$timeout","constants","retryService","aggregatedSettingsStore","loggingService","$translate","resources"],e.prototype.getSettingsToFetch=function(){var e=this.aggregatedSettingsStore.getSettings(),t=[];return e&&e.userResourcesSettings&&e.userResourcesSettings.value||t.push(SkypeX.Services.AggregatesettingsStorageKey.userResourcesSettings),e&&e.tenantSettingsV2&&e.tenantSettingsV2.value||t.push(SkypeX.Services.AggregatesettingsStorageKey.tenantSettings),e&&e.userPropertiesSettings&&e.userPropertiesSettings.value||t.push(SkypeX.Services.AggregatesettingsStorageKey.userPropertiesSettings),e&&e.tenantProperties&&e.tenantProperties.value||t.push(SkypeX.Services.AggregatesettingsStorageKey.tenantProperties),t},e.prototype.ensureSettingsInitialized=function(){var e=this,t=this.getSettingsToFetch();if(!t||t.length<1)return this.logger.info("All settings ready, nothing to fetch"),void this.$timeout(function(){return e.close()},100,!1);var n=this.loggingService.newScenario(this.constants.scenarios.freemium.setup),i={forever:!1,retryIntervals:this.constants.freemium.bootstrap.retryIntervals};this.retryService.retry("fetchSettingsPromise",function(){return e.aggregatedSettingsStore.startup(t).toNgPromise(e.$q).then(function(){var t=e.getSettingsToFetch();return t&&t.length>0?(e.logger.warn("Missing properties! \n"+JSON.stringify(t)),e.$q.reject({missingSettings:t})):(e.logger.info("All settings are ready"),e.$q.resolve())})},i).promise.then(n.stop).catch(function(t){var i="Could not get missing settings. "+(t&&t.missingSettings?t.missingSettings:"");e.logger.error(i),n.fail({errorMessage:i})}).finally(function(){return e.close()})},e.prototype.close=function(){this.$scope.closeThisDialog()},e}();t.FreemiumSetupDialogController=s,angular.module("teamspace.freemiumSetup",["teamspace.authenticationService","teamspace.identityService","skypeX.aggregatedSettingsStore","teamspace.constants","teamspace.retryService","teamspace.loggingService"]).run(["constants","dialogService","$templateCache",function(e,t,n){n.put("components/freemium/setup-dialog/freemium-setup-dialog.html",i);t.register(e.dialogs.freemiumSetup,function(e,t,n){return{template:"components/freemium/setup-dialog/freemium-setup-dialog.html",className:"ts-modal-dialog custom-width update-user-profile-dialog",isPersistent:t,closeByEscape:e,closeByDocument:e,controller:"FreemiumSetupDialogController",controllerAs:"fsdc",ariaAuto:!0,ariaRole:"dialog",ariaDescribedById:"modalDialog-title",width:n}}(!1,!0,null))}]).controller("FreemiumSetupDialogController",s)},2352:function(e,t){e.exports='<div class="freemium-setup" data-tid="freemium-setup">\n  <modal-dialog aria-labelledby="freemium-setup-heading" suppress-default-button="true" suppress-header="true">\n    <img class="update-user-profile-fre-img" ng-src="https://statics.teams.cdn.office.net/hashedassets/freemium_fre_update_user_profile-0e6c8c5.svg"/>\n    <div class="freemium-setup-heading" data-tid="freemium-setup-heading" ng-bind="::fsdc.dialogHeading">\n    </div>\n    <div class="setup-dialog-busy-container">\n      <busy-animation class="loading-spinner" size="large"></busy-animation>\n      </div>\n  </modal-dialog>\n</div>'},2353:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(2354),s=function(){function e(e,t,n,i,s,a,o,r,c,l){var d=this;if(this.$scope=e,this.$translate=t,this.ariaLiveService=i,this.resources=r,this.freemiumUtilities=l,this.maxInlineAdminCount=3,this._pending=!1,this._adminError=!1,this.isTenantAdmin=!1,this.logger=a.newLogger("FreemiumStorageExceededDialogController"),c.valueAsBoolean(n.settings.names.enableFreemium)&&s.isFreemiumTenant()||(this.logger.error("dialog not supported on this tenant."),e.closeThisDialog()),this.isTenantAdmin=s.isTenantAdmin(),this.isTenantAdmin){var m={disabled:!1,isFocusDefault:!0,func:function(){return d.onUpgradeClick()},tid:"freemiumStorageExceeded-upgradeStoryAction",text:t.instant(r.strings.storage_exceeded_dialog_upgrade),outcome:teamspace.components.PanelActionOutcome.nav,scenario:teamspace.components.PanelActionScenario.filesUpgradeDialog,scenarioType:teamspace.components.PanelActionScenarioType.upgrade,name:teamspace.components.PanelModuleName.filesUpgradeDialog,summary:"Freemium Upgrade",type:teamspace.components.PanelModuleType.button};this._footerButtons=[m]}else this._pending=!0,o.getAllTenantAdmins().then(function(e){return d.updateAdminLists(e)}).catch(function(){d._adminError=!0}).finally(function(){d._pending=!1,d.narrateForMembers()});this.closeButtonTelemetryProperties={outcome:teamspace.components.PanelActionOutcome.closeDialog,scenario:teamspace.components.PanelActionScenario.filesUpgradeDialog,scenarioType:teamspace.components.PanelActionScenarioType.quitUpgrade,name:teamspace.components.PanelModuleName.filesUpgradeDialog,summary:"Freemium Upgrade",type:teamspace.components.PanelModuleType.button}}return e.$inject=["$scope","$translate","constants","ariaLiveService","identityService","loggingService","manageTenantService","resources","settingsService","freemiumUtilities"],Object.defineProperty(e.prototype,"footerButtons",{get:function(){return this._footerButtons},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inlineAdminList",{get:function(){return this._inlineAdminList},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"overflowAdminList",{get:function(){return this._overflowAdminsList},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"adminCountString",{get:function(){return this.$translate.instant(this.resources.strings.storage_exceeded_dialog_remaining_admins_text,{adminCount:this.overflowAdminList.length})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pending",{get:function(){return this._pending},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"adminError",{get:function(){return this._adminError},enumerable:!0,configurable:!0}),e.prototype.onUpgradeClick=function(){this.freemiumUtilities.openUpgradeTeamsUrl(),this.$scope.closeThisDialog()},e.prototype.updateAdminLists=function(e){var t=_.sortBy(e,[function(e){return e.surname},function(e){return e.givenName},function(e){return e.displayName}]);if(t.length>0){var n=void 0;n=t.length<=this.maxInlineAdminCount?t.length:this.maxInlineAdminCount-1,this._inlineAdminList=_.take(t,n),this._overflowAdminsList=_.drop(t,n)}else this._adminError=!0},e.prototype.narrateForMembers=function(){var e,t=this.$translate.instant(this.resources.strings.storage_exceeded_dialog_title);if(this._adminError)e=this.$translate.instant(this.resources.strings.storage_exceeded_dialog_member_generic_text);else{for(var n={},i=0;i<this._inlineAdminList.length;i++)n["admin"+(i+1)]=this._inlineAdminList[i].displayName;this._overflowAdminsList&&this._overflowAdminsList.length>0?(n.remainingAdmins=this.$translate.instant(this.resources.strings.storage_exceeded_dialog_remaining_admins_text,{adminCount:this._overflowAdminsList.length}),e=this.$translate.instant(this.resources.strings.storage_exceeded_dialog_member_many_admins_text,n)):e=this.$translate.instant(this.resources.strings["storage_exceeded_dialog_member_"+this._inlineAdminList.length+"_admins_text"],n)}this.ariaLiveService.update(t+" "+e,!0)},e}();t.FreemiumStorageExceededDialogController=s,angular.module("teamspace.freemiumStorageExceededDialog",["pascalprecht.translate","teamspace.ariaLiveService","teamspace.constants","teamspace.dialogService","teamspace.identityService","teamspace.locales","teamspace.loggingService","teamspace.settingsService","teamspace.freemiumUtilities"]).run(["constants","dialogService","$templateCache",function(e,t,n){t.register(e.dialogs.freemiumStorageExceededDialog,{template:"components/freemium/storage-exceeded-dialog/freemium-storage-exceeded-dialog.html",className:"ts-modal-dialog custom-width",closeByEscape:!0,closeByDocument:!1,controller:"FreemiumStorageExceededDialogController",controllerAs:"ctrl",ariaAuto:!1,ariaRole:"dialog",ariaLabelledById:"freemiumStorageDialog-heading",isPersistent:!0}),n.put("components/freemium/storage-exceeded-dialog/freemium-storage-exceeded-dialog.html",i)}]).controller("FreemiumStorageExceededDialogController",s)},2354:function(e,t){e.exports='<div class="container-fluid storage-exceeded-dialog">\n  <modal-dialog add-close-icon="true" footer-buttons="ctrl.footerButtons" right-align-buttons="true" suppress-default-button="true" suppress-default-footer="!ctrl.footerButtons" track-panel-type="{{::$root.trackConstants.panelType.fileUpgradeDialog}}" track-data="{{::$ctrl.closeButtonTelemetryProperties}}" skip-auto-focus="true">\n    <img class="storage-exceeded-dialog-img" ng-if="::!ctrl.isTenantAdmin" ng-src="https://statics.teams.cdn.office.net/hashedassets/freemium_storage_exceeded-daf3317.svg"/>\n    <p id="freemiumStorageDialog-heading" data-tid="freemiumStorageDialog-heading" class="storage-exceeded-dialog-heading" translate-once="{{::$root.resources.strings.storage_exceeded_dialog_title}}"></p>\n    <div ng-if="::ctrl.isTenantAdmin" class="storage-exceeded-admin-content">\n      <p translate-once="{{::$root.resources.strings.storage_exceeded_dialog_admin_text}}"></p>\n      <ul>\n        <li>\n          <ng-include class="icon-container" src="\'svg/icons-document.html\'"/>\n          <span translate-once="{{::$root.resources.strings.storage_exceeded_dialog_upgrade_benefit_more_space}}"></span>\n        </li>\n        <li>\n          <ng-include class="icon-container" src="\'svg/icons-msft-office.html\'"/>\n          <span translate-with-html-params translate-id="storage_exceeded_dialog_upgrade_benefit_office_services"></span>\n        </li>\n        <li>\n          <div class="office-icon-container">\n            <ng-include class="icon-container" src="\'svg/icons-msft-outlook.html\'"/>\n            <ng-include class="icon-container" src="\'svg/icons-msft-word.html\'"/>\n            <ng-include class="icon-container" src="\'svg/icons-msft-xl.html\'"/>\n            <ng-include class="icon-container" src="\'svg/icons-msft-ppt.html\'"/>\n            <ng-include class="icon-container" src="\'svg/icons-msft-onenote.html\'"/>\n            <ng-include class="icon-container" src="\'svg/icons-msft-exchange.html\'"/>\n          </div>\n        </li>\n      </ul>\n    </div>\n    <div ng-if="::!ctrl.isTenantAdmin" class="storage-exceeded-member-content">\n      <div ng-if="!ctrl.pending">\n        <p ng-if="ctrl.inlineAdminList.length == 1" translate-with-html-params translate-id="storage_exceeded_dialog_member_1_admins_text" translate-values=\'{ "admin1": "<span class=\\"admin-name\\" person-card pc-mri=\\"ctrl.inlineAdminList[0].mri\\" pc-display-name=\\"ctrl.inlineAdminList[0].displayName\\" ng-bind=\\"ctrl.inlineAdminList[0].displayName\\" tabindex=\\"0\\" acc-role=\\"clickable\\" role=\\"button\\"></span>" }\'></p>\n        <p ng-if="ctrl.inlineAdminList.length == 2 && !ctrl.overflowAdminList.length" translate-with-html-params translate-id="storage_exceeded_dialog_member_2_admins_text" translate-values=\'{ "admin1": "<span class=\\"admin-name\\" person-card pc-mri=\\"ctrl.inlineAdminList[0].mri\\" pc-display-name=\\"ctrl.inlineAdminList[0].displayName\\" ng-bind=\\"ctrl.inlineAdminList[0].displayName\\" tabindex=\\"0\\" acc-role=\\"clickable\\" role=\\"button\\"></span>", "admin2": "<span class=\\"admin-name\\" person-card pc-mri=\\"ctrl.inlineAdminList[1].mri\\" pc-display-name=\\"ctrl.inlineAdminList[1].displayName\\" ng-bind=\\"ctrl.inlineAdminList[1].displayName\\" tabindex=\\"0\\" acc-role=\\"clickable\\" role=\\"button\\"></span>" }\'></p>\n        <p ng-if="ctrl.inlineAdminList.length == 3" translate-with-html-params translate-id="storage_exceeded_dialog_member_3_admins_text" translate-values=\'{ "admin1": "<span class=\\"admin-name\\" person-card pc-mri=\\"ctrl.inlineAdminList[0].mri\\" pc-display-name=\\"ctrl.inlineAdminList[0].displayName\\" ng-bind=\\"ctrl.inlineAdminList[0].displayName\\" tabindex=\\"0\\" acc-role=\\"clickable\\" role=\\"button\\"></span>", "admin2": "<span class=\\"admin-name\\" person-card pc-mri=\\"ctrl.inlineAdminList[1].mri\\" pc-display-name=\\"ctrl.inlineAdminList[1].displayName\\" ng-bind=\\"ctrl.inlineAdminList[1].displayName\\" tabindex=\\"0\\" acc-role=\\"clickable\\" role=\\"button\\"></span>", "admin3": "<span class=\\"admin-name\\" person-card pc-mri=\\"ctrl.inlineAdminList[2].mri\\" pc-display-name=\\"ctrl.inlineAdminList[2].displayName\\" ng-bind=\\"ctrl.inlineAdminList[2].displayName\\" tabindex=\\"0\\" acc-role=\\"clickable\\" role=\\"button\\"></span>" }\'></p>\n        <p ng-if="ctrl.overflowAdminList.length" translate-with-html-params translate-id="storage_exceeded_dialog_member_many_admins_text" translate-values=\'{ "admin1": "<span class=\\"admin-name\\" person-card pc-mri=\\"ctrl.inlineAdminList[0].mri\\" pc-display-name=\\"ctrl.inlineAdminList[0].displayName\\" ng-bind=\\"ctrl.inlineAdminList[0].displayName\\" tabindex=\\"0\\" acc-role=\\"clickable\\" role=\\"button\\"></span>", "admin2": "<span class=\\"admin-name\\" person-card pc-mri=\\"ctrl.inlineAdminList[1].mri\\" pc-display-name=\\"ctrl.inlineAdminList[1].displayName\\" ng-bind=\\"ctrl.inlineAdminList[1].displayName\\" tabindex=\\"0\\" acc-role=\\"clickable\\" role=\\"button\\"></span>", "remainingAdmins": "<span class=\\"admin-name\\" person-card-list participant-list=\\"ctrl.overflowAdminList\\" is-person-img-displayed=\\"true\\" tabindex=\\"0\\" acc-role=\\"clickable\\" role=\\"button\\">{{ctrl.adminCountString}}</span>" }\'></p>\n        <p ng-if="ctrl.adminError" translate-once="{{::$root.resources.strings.storage_exceeded_dialog_member_generic_text}}"></p>\n      </div>\n    </div>\n  </modal-dialog>\n</div>'},2355:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(2356),s=function(){function e(){}return e.prototype.denyJoinRequest=function(e){return this.context.functionsContext.denyJoinRequests([e],!1)},e.prototype.approveJoinRequest=function(e){return this.context.functionsContext.approveJoinRequests([e],!1)},e}();t.JoinRequestActionController=s,angular.module("teamspace.joinRequestAction",[]).run(["$templateCache",function(e){e.put("components/freemium/join-request-action/join-request-action.html",i)}]).component("joinRequestAction",{bindings:{context:"<"},controller:s,templateUrl:"components/freemium/join-request-action/join-request-action.html"})},2356:function(e,t){e.exports='<div class="invite-member-resend-action-container" use-parentnode-for-keyboard="true">\n  \x3c!-- deny request button--\x3e\n  <div acc-role="table-content-cell">\n    <button class="ts-btn ts-btn-secondary" data-tid="joinRequest-denyAction" ng-if="$ctrl.context.member.state === \'unprocessed\'" ng-click="$ctrl.denyJoinRequest($ctrl.context.member)" id="denyRequestAction-{{::$ctrl.context.member.emailAddress}}" tabindex="-1" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-gesture="{{::$root.trackConstants.trackGesture.click}}" track-scenario="{{::$root.trackConstants.trackScenario.denyJoinRequest}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.joinTenantRequests}}" track-name="{{::$root.trackConstants.trackModuleName.denyJoinRequest}}" track-type="{{::$root.trackConstants.trackType.button}}" track-summary="Deny join request">{{::$root.resources.strings.freemium_pending_request_dialog_deny_button|translate}}</button>\n    \x3c!-- state shown as text when request is denied--\x3e\n    <div class="invite-tenant-pending-invite-sent-state denied" ng-if="$ctrl.context.member.state === \'denied\'">\n      <ng-include class="icon" src="\'svg/icons-close.html\'"></ng-include>\n      <span>{{::$root.resources.strings.freemium_pending_join_requests_denied_state|translate}}</span>\n    </div>\n  </div>\n\n\n  \x3c!-- approve request button--\x3e\n  <div acc-role="table-content-cell">\n    <button class="ts-btn ts-btn-primary" ng-if="$ctrl.context.member.state === \'unprocessed\'" data-tid="joinRequest-approveAction" ng-click="$ctrl.approveJoinRequest($ctrl.context.member)" id="approveRequestAction-{{::$ctrl.context.member.emailAddress}}" tabindex="-1" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-gesture="{{::$root.trackConstants.trackGesture.click}}" track-scenario="{{::$root.trackConstants.trackScenario.approveJoinRequest}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.joinTenantRequests}}" track-name="{{::$root.trackConstants.trackModuleName.approveJoinRequest}}" track-type="{{::$root.trackConstants.trackType.button}}" track-summary="Approve join request">{{::$root.resources.strings.freemium_pending_request_dialog_approve_button|translate}}</button>\n    \x3c!-- state shown as text when request is approved--\x3e\n    <div class="invite-tenant-pending-invite-sent-state approved" ng-if="$ctrl.context.member.state === \'approved\'">\n      <ng-include class="icon" src="\'svg/icons-accept.html\'"></ng-include>\n      <span>{{::$root.resources.strings.freemium_pending_join_requests_approved_state|translate}}</span>\n    </div>\n  </div>\n\n  \x3c!-- spinner when request is being processed--\x3e\n  <busy-animation ng-if="$ctrl.context.member.state === \'processing\'" size="small"></busy-animation>\n</div>'},304:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(2332),s=n(55),a=function(){function e(e,t,n,i,s,a,o,r,c,l){var d=this;this.$scope=e,this.$q=t,this.$translate=n,this.ariaLiveService=i,this.constants=s,this.dialogService=a,this.loggingService=o,this.resources=r,this.tenantMembershipService=c,this.utilityService=l,this.selectedTab="joinRequests",this.pendingInvitesBusy=!1,this.pendingInvitesError=!1,this.pendingInvitesList=[],this.joinRequestsBusy=!1,this.joinRequestsError=!1,this.joinRequestsList=[],this.footerButtons=[],this.approveSuccessStatus="success",this.joinRequestMapKey="emailAddress",this._joinRequestsMap={},this.dialogTitle=n.instant(r.strings.freemium_pending_join_requests_dialog_title),this.pendingInvitesResendActionContext={resendPendingInvite:function(e,t){return d.resendPendingInvite(e,t)}},this.joinRequestsActionContext={denyJoinRequests:function(e,t){return d.denyJoinRequests(e,t)},approveJoinRequests:function(e){return d.approveJoinRequests(e)}},this.selectedTab="joinRequests",this.shouldShowTabButtons()&&this.refreshPendingInvites(),this.getJoinRequests(),!e.ngDialogData||e.ngDialogData.source!==teamspace.services.PendingJoinRequestsDialogSource.ManageTenant&&e.ngDialogData.source!==teamspace.services.PendingJoinRequestsDialogSource.OneClickJoinCoachmark?(this.footerButtons.push(this.getInviteMorePeopleFooterButton()),e.ngDialogData&&e.ngDialogData.source===teamspace.services.PendingJoinRequestsDialogSource.InvitationWizard&&this.footerButtons.push(this.getBackFooterButton())):(this.dialogTitle=n.instant(r.strings.freemium_pending_join_requests_dialog_title_enabling_one_click_join),this.footerButtons.push(this.getDoneFooterButton()))}return e.$inject=["$scope","$q","$translate","ariaLiveService","constants","dialogService","loggingService","resources","tenantMembershipService","utilityService"],e.prototype.getInviteMorePeopleFooterButton=function(){var e=this;return{text:this.$translate.instant(this.resources.strings.freemium_pending_join_requests_dialog_invite_more_button),secondaryStyle:!0,func:function(){return e.openInvitationWizard()},tid:"pendingJoinRequests-inviteMoreBtn",disabled:!1,type:teamspace.components.PanelModuleType.button,name:teamspace.components.PanelModuleName.joinRequestsTab,outcome:teamspace.components.PanelActionOutcome.select,scenario:teamspace.components.PanelActionScenario.invitePeople,summary:"invite more clicked on pending join requests dialog",scenarioType:teamspace.components.PanelActionScenarioType.joinTenantRequests}},e.prototype.getBackFooterButton=function(){var e=this;return{text:this.$translate.instant(this.resources.strings.freemium_pending_join_requests_dialog_back_button),secondaryStyle:!0,func:function(){return e.openInvitationWizard()},id:"backButton",tid:"pendingJoinRequests-backBtn",disabled:!1,type:teamspace.components.PanelModuleType.button,name:teamspace.components.PanelModuleName.backButton,outcome:teamspace.components.PanelActionOutcome.select,scenario:teamspace.components.PanelActionScenario.back,summary:"back button clicked on pending join requests dialog",scenarioType:teamspace.components.PanelActionScenarioType.joinTenantRequests,icon:"svg/icons-chevron-left.html"}},e.prototype.getDoneFooterButton=function(){var e=this;return{text:this.$translate.instant(this.resources.strings.freemium_pending_join_requests_dialog_done_button),secondaryStyle:!0,func:function(){return e.dialogService.close(e.constants.dialogs.pendingJoinRequests)},tid:"pendingJoinRequests-doneBtn",disabled:!1}},e.prototype.shouldShowTabButtons=function(){return!(this.$scope.ngDialogData&&(this.$scope.ngDialogData.source==teamspace.services.PendingJoinRequestsDialogSource.ManageTenant||this.$scope.ngDialogData.source==teamspace.services.PendingJoinRequestsDialogSource.OneClickJoinCoachmark))},e.prototype.denyJoinRequests=function(e,t){var n=this;void 0===t&&(t=!1);var i=this.loggingService.newScenario(this.constants.scenarios.freemium.pendingRequestDialogDenyRequest);if(this.ariaLiveService.update(this.$translate.instant(this.resources.strings.freemium_pending_request_dialog_request_status_update_aria),!0),!0===t&&(e=this.joinRequestsList.filter(function(e){return e.state===s.JoinRequestState.Unprocessed})),e&&0!==e.length){var a=e.length,o=_.map(e,function(e){return n._joinRequestsMap[e.emailAddress].state=s.JoinRequestState.Processing,{emailId:e.emailAddress,displayName:e.displayName}});this.tenantMembershipService.denyTenantJoinRequests(o).then(function(e){var t=0,o=0;e.forEach(function(e){if(e&&e.joinRequest){var i=e.joinRequest.emailId;"DeniedRequestDeletedFromList"===e.status&&n._joinRequestsMap[i]?(n._joinRequestsMap[i].state=s.JoinRequestState.Denied,t++):"DeniedRequestNotPresentInList"===e.status&&n._joinRequestsMap[i]&&(n._joinRequestsMap[i].state=s.JoinRequestState.Unprocessed,n._joinRequestsMap[i].errorText=n.$translate.instant(n.resources.strings.freemium_pending_join_requests_deny_error_text),o++)}}),t>0&&0==o?i.stop({message:t+" requests denied out of "+a+" requests"}):0==t&&o>0?i.fail({message:o+" requests failed to be denied out of "+a+" requests"}):i.incomplete({message:t+" requests denied and "+o+" failed out of "+a+" requests"}),n.ariaLiveService.update(n.$translate.instant(n.resources.strings.freemium_pending_join_requests_denied_status_aria_mf,{count:t},n.constants.translation.interpolationIds.messageformat),!0)}).catch(function(){e.forEach(function(e){n._joinRequestsMap[e.emailAddress].state=s.JoinRequestState.Unprocessed,n._joinRequestsMap[e.emailAddress].errorText=n.$translate.instant(n.resources.strings.freemium_pending_join_requests_generic_error)}),i.fail({message:"failed to process deny join requests call. Total requests: "+a})})}else i.fail({message:"zero join requests to deny"})},e.prototype.approveJoinRequests=function(e,t){var n=this;void 0===t&&(t=!1);var i=this.loggingService.newScenario(this.constants.scenarios.freemium.pendingRequestDialogApproveRequest);if(this.ariaLiveService.update(this.$translate.instant(this.resources.strings.freemium_pending_request_dialog_request_status_update_aria),!0),!0===t&&(e=this.joinRequestsList.filter(function(e){return e.state===s.JoinRequestState.Unprocessed})),e&&0!==e.length){var a=e.length,o=_.map(e,function(e){return n._joinRequestsMap[e.emailAddress].state=s.JoinRequestState.Processing,{emailId:e.emailAddress,displayName:e.displayName}});this.tenantMembershipService.approveTenantJoinRequests(o).then(function(e){var t=0,o=0;e.forEach(function(e){var i=e.emailAddress;if(e.status&&e.status.toLowerCase()===n.approveSuccessStatus&&!e.errorCode&&n._joinRequestsMap[i])n._joinRequestsMap[i].state=s.JoinRequestState.Approved,t++;else if(n._joinRequestsMap[i]){n._joinRequestsMap[i].state=s.JoinRequestState.Unprocessed;var a=n.tenantMembershipService.getInviteErrorMessageFromErrorCode(e.errorCode);n._joinRequestsMap[i].errorText=a.errorMessage,o++}}),n.shouldShowTabButtons()&&n.refreshPendingInvites(),t>0&&0==o?i.stop({message:t+" requests approved out of "+a+" requests"}):0==t&&o>0?i.fail({message:o+" requests failed to be approved out of "+a+" requests"}):i.incomplete({message:t+" requests approved and "+o+" failed out of "+a+" requests"}),n.ariaLiveService.update(n.$translate.instant(n.resources.strings.freemium_pending_join_requests_approve_status_aria_mf,{count:t},n.constants.translation.interpolationIds.messageformat),!0)}).catch(function(){e.forEach(function(e){n._joinRequestsMap[e.emailAddress].state=s.JoinRequestState.Unprocessed,n._joinRequestsMap[e.emailAddress].errorText=n.$translate.instant(n.resources.strings.freemium_pending_join_requests_generic_error)}),i.fail({message:"failed to process approve join requests call. Total requests: "+a})})}else i.fail({message:"zero join requests to approve"})},e.prototype.openInvitationWizard=function(){this.dialogService.open(this.constants.dialogs.invitationWizard),this.dialogService.close(this.constants.dialogs.pendingJoinRequests)},e.prototype.selectTab=function(e){this.selectedTab=e},e.prototype.getJoinRequests=function(){var e=this;this.joinRequestsError=!1,this.joinRequestsBusy=!0;var t=this.$q.defer();this.fetchJoinRequestsPromise=t.promise,this.tenantMembershipService.getTenantJoinRequests().then(function(n){return e._joinRequestsMap=_.chain(n).map(function(e){return{state:s.JoinRequestState.Unprocessed,errorText:null,emailAddress:e.emailId,displayName:e.displayName}}).keyBy(e.joinRequestMapKey).value(),e.joinRequestsList=Object.values(e._joinRequestsMap),e.tenantMembershipService.setBadgeStatus(!1),t.resolve()}).catch(function(){return e.joinRequestsError=!0,t.reject()}).finally(function(){e.joinRequestsBusy=!1})},e.prototype.refreshPendingInvites=function(){var e=this;return this.pendingInvitesBusy=!0,this.pendingInvitesError=!1,this.tenantMembershipService.getPendingInvites().then(function(t){e.pendingInvitesList=_.map(t,function(e){return _.extend({state:s.InviteMembersListInvitationState.Unsent,resendDisabled:!1,isSelected:!1},e)})}).catch(function(){e.pendingInvitesError=!0}).finally(function(){e.pendingInvitesBusy=!1})},e.prototype.resendAllPendingInvites=function(){var e=this,t=this.loggingService.newScenario(this.constants.scenarios.freemium.resendAllInvitations),n=[];return _.forEach(this.pendingInvitesList,function(t){return n.push(e.resendPendingInvite(t,!0))}),this.utilityService.whenAllAllowFailures(n).then(function(e){var n=_.find(e,function(e){return e.wasResolved}),i=_.find(e,function(e){return!e.wasResolved});n&&!i?t.stop():!n&&i?t.fail():t.incomplete()})},e.prototype.resendPendingInvite=function(e,t){var n=this;if(!e||e.state===s.InviteMembersListInvitationState.Sending||e.state===s.InviteMembersListInvitationState.Sent||e.resendDisabled)return this.$q.resolve();var i=this.loggingService.newScenario(this.constants.scenarios.freemium.resendInvitation);return e.state=s.InviteMembersListInvitationState.Sending,e.errorText=null,this.tenantMembershipService.inviteMemberToTenant(e.emailAddress,e.displayName,e.userType).then(function(){t||n.ariaLiveService.update(n.$translate.instant(n.resources.strings.freemium_invite_dialog_sent_state),!0),e.state=s.InviteMembersListInvitationState.Sent,i.stop()}).catch(function(t){e.state=s.InviteMembersListInvitationState.Unsent,t&&t.errorCode===n.constants.freemium.errorCodes.resendInviteRateLimitExceeded?(e.resendDisabled=!0,e.errorText=n.$translate.instant(n.resources.strings.freemium_invite_sending_rate_limit_error_text)):e.errorText=n.$translate.instant(n.resources.strings.freemium_invite_sending_generic_error_text),i.fail()})},e}();t.PendingTenantJoinRequestsDialogController=a,angular.module("teamspace.pendingJoinRequestsDialog",["pascalprecht.translate","teamspace.constants","teamspace.locales","teamspace.manageTenantService","teamspace.settingsService","teamspace.tenantMembershipService","teamspace.utilityService","teamspace.dialogService"]).run(["constants","dialogService","$templateCache",function(e,t,n){n.put("components/freemium/pending-tenant-join-requests/pending-tenant-join-requests.html",i),t.register(e.dialogs.pendingJoinRequests,{template:"components/freemium/pending-tenant-join-requests/pending-tenant-join-requests.html",className:"ts-modal-dialog custom-width",closeByEscape:!0,closeByDocument:!1,controller:"PendingTenantJoinRequestsDialogController",controllerAs:"ptjrc",ariaAuto:!1,ariaRole:"dialog",ariaLabelledById:"modalDialog-title"})}]).controller("PendingTenantJoinRequestsDialogController",a)},55:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(2333);!function(e){e[e.Unsent=0]="Unsent",e[e.Sending=1]="Sending",e[e.Sent=2]="Sent"}(t.InviteMembersListInvitationState||(t.InviteMembersListInvitationState={}));!function(e){e.Unprocessed="unprocessed",e.Processing="processing",e.Denied="denied",e.Approved="approved"}(t.JoinRequestState||(t.JoinRequestState={}));var s=function(){function e(e){this.$timeout=e,this.memberToFunctionsContextMap=new Map}return e.$inject=["$timeout"],e.prototype.wrappedOnScrollEdge=function(){var e=this;this.onScrollEdge&&this.$timeout(function(){return e.onScrollEdge()})},e.prototype.getActionDirectiveContext=function(e){if(this.memberToFunctionsContextMap.has(e))return this.memberToFunctionsContextMap.get(e);var t={member:e,functionsContext:this.actionDirectiveFunctionsContext};return this.memberToFunctionsContextMap.set(e,t),t},e}();t.InviteMembersListController=s,angular.module("teamspace.inviteMembersList",[]).run(["$templateCache",function(e){e.put("components/freemium/invite-members-list/invite-members-list.html",i)}]).component("inviteMembersList",{bindings:{membersList:"=",prefixDataTid:"@",actionDirective:"@",actionDirectiveFunctionsContext:"<",onScrollEdge:"&"},controller:s,controllerAs:"imlc",templateUrl:"components/freemium/invite-members-list/invite-members-list.html"})}},[2324]);