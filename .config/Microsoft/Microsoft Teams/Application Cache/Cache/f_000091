(window.webPackBridgeJsonp=window.webPackBridgeJsonp||[]).push([[12],{"01e9cd72f63f0c70ab1c":function(e,t,r){"use strict";r.d(t,"b",function(){return i}),r.d(t,"a",function(){return o});var a=r("447964f318fe44ff3682"),n=r("022addba5cf25ce091fb"),i=new a.a("updateItemRating"),o=Object(n.e)({operationTypeFacet:i})},"0be8895c37c7580fa8d6":function(e,t,r){"use strict";r.d(t,"a",function(){return s}),r.d(t,"b",function(){return l}),r.d(t,"c",function(){return c});var a=r("447964f318fe44ff3682"),n=r("022addba5cf25ce091fb"),i=r("f5df325953ebb7f1143d"),o=r("959d5e23f32a2e71cc99"),s=new a.a("editPinnedItem"),l=new o.a("editPinnedItemProgressItem",{itemKey:Object(o.f)(),editType:Object(o.e)()}),c=new i.a("editPinnedItemProgress",function(e,t){var r=Object.keys(t.itemEditTypeMap)[0],a=t.itemEditTypeMap[r].editType;return l.serialize({itemKey:r,editType:a})});Object(n.e)({operationTypeFacet:s})},"14430bb116eaf260acb8":function(e,t,r){"use strict";r.d(t,"b",function(){return i}),r.d(t,"a",function(){return o});var a=r("447964f318fe44ff3682"),n=r("f5df325953ebb7f1143d"),i=new a.a("updatePublishState"),o=new n.a("publish")},"24c83cd16592ec8f1822":function(e,t,r){"use strict";r.r(t);var a=r("64328bb588b46459132d"),n=r("ee92087a6ec1d0e9ecc9"),i=r("65da65eb66805e3724ff"),o=r("5abe0a4e18e69c009f41"),s=r("ba9b9c401d4d91d63e29"),l=r("6578506114fc52cc91d3");function c(e){var t=e.webAbsoluteUrl,r=e.listFullUrl,a=e.fieldInternalName,n=e.viewId,i=e.rootFolder,c=e.excludeFieldFilteringHtml,u=e.filterParams,d=Object(l.getListApiUrl)({webAbsoluteUrl:t,listFullUrl:r}).segment("RenderListFilterData").parameter("FieldInternalName",a||"");if(n&&(d=d.parameter("ViewId",n)),i&&(d=d.parameter("RootFolder",{raw:Object(o.encodeURIComponent)(i)})),c&&(d=d.parameter("ExcludeFieldFilteringHtml",!0)),u){var b=s.a.getFilterParams(u,!0);d=d.rawParameter(b)}return d.toString()}var u=r("b81c06e530b532b544de"),d=r("a4060cda3c9c24220a4a"),b=r("291bfd7ca3e0ca52b70d"),f=r("680b7ac74280293b48f0"),m=r("578e5017557fc66bb247"),p=r("5f6c4af8cb56376acb4d"),v=r("3d240143e32215cc23a5"),h=r("cdb9a7d2db44c7a9f4dd");r.d(t,"getSPFilterOptionSetHandler",function(){return g});var g=Object(f.e)({maxParallelOperationCount:8})(function(e){var t=this,r=e.itemKey,o=d.p.deserialize(r);return function(e){return a.__awaiter(t,void 0,void 0,function(){var t,s,l,f,g;return a.__generator(this,function(y){switch(y.label){case 0:return s=e(function(e){var t=e.itemSetKey,r=e.fieldKey;return function(e){var a=e(Object(v.a)({spDataSourceConfiguration:n.Yb})).spDataSourceConfiguration,i=a&&a.ensureAuthToken,o=d.D.serialize(t),s=e(Object(m.a)({folderPath:n.R},o)),l=e(Object(m.a)({internalName:n.cb,mappedColumnFieldType:n.sb,isCalculated:n.eb},d.o.serialize(r))),c=s&&s.folderPath,u=l&&l.internalName&&l.internalName,f=l&&l.mappedColumnFieldType===b.a.Taxonomy,p=l&&l.isCalculated,g=d.Q.serialize({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl}),y=e(Object(m.a)({pageContext:n.qc},g)).pageContext,U=t.viewKey&&t.viewKey.viewId,w=U===h.default.Empty?y&&y.viewId:U;return{webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl,rootFolder:c,ensureAuthToken:i,fieldInternalName:u,isCalculatedField:p,filterParams:t.filterParams,excludeFieldFilteringHtml:f,viewId:w}}}({itemSetKey:o.itemSetKey,fieldKey:o.fieldKey})),[4,e((U=s,function(e){return e(Object(i.b)({webAbsoluteUrl:U.webAbsoluteUrl,listFullUrl:U.listFullUrl,method:"POST",url:c(U),parseResponse:function(e){return e},qosName:"getFilterData",noRedirect:!0}))}))];case 1:return l=y.sent(),f=u.default.getFilterData(l,s.fieldInternalName||"",s.isCalculatedField),(g=new p.a).resolveItems({items:(t={},t[r]=a.__assign({},n.Q.pack(f)),t)}),e(g.execute()),[2]}var U})})}})},"26f8bf003c836a7116db":function(e,t,r){"use strict";r.r(t);var a,n=r("680b7ac74280293b48f0"),i=r("022addba5cf25ce091fb"),o=r("95da7825c4969f34e250"),s=r("a4060cda3c9c24220a4a"),l=r("e87bb409a9007bb8123c"),c=r("64328bb588b46459132d"),u=r("ee92087a6ec1d0e9ecc9"),d=r("65da65eb66805e3724ff"),b=r("abb5ebf715fcba560443");!function(e){e[e.Recycle=2]="Recycle",e[e.PermanantDelete=3]="PermanantDelete",e[e.MoveToSecondStage=4]="MoveToSecondStage"}(a||(a={}));var f=a,m=r("b2dbb7eef606ed6d52ff"),p=r("cdb9a7d2db44c7a9f4dd"),v=r("56aac858adc5742217b8"),h=r("5fef64b3561abb2ebffa"),g=r("a9dd204dd0bee7467912"),y=r("eef09ec91afb2fd77b66"),U=r("2852e19dad7ee30e33c6"),w=r("6578506114fc52cc91d3"),I=r("5f6c4af8cb56376acb4d"),_=r("06bd4399cef6e6b5593c"),F=r("6d69c5cabadd78126515"),O=r("3d240143e32215cc23a5"),S=r("8f82bcae1278ea3e0808"),A=r("fdbcb7664c17b5b4e4d9"),j=r("cc08c169973ba8efeefa"),k=r("3560af8f1e8ae6e7a04f"),C=Object(k.a)(function(e){return{}}),T=r("6ec26682283706c9cee5"),D=r("b421a7d74d9df5c18287"),P=Object(n.c)()(function(e){var t=e.items;return function(e){return c.__awaiter(void 0,void 0,void 0,function(){var r,a,i,o,l,w,k,P,K,R,E,L,z,q,B,M,V,W,G,H,Q,J,X,Y,$,Z,ee,te,re;return c.__generator(this,function(ae){switch(ae.label){case 0:for(o=void 0,l=void 0,w=void 0,k=void 0,P=e(C),K={},R=function(e){for(var t=[],r=0,a=e;r<a.length;r++){var n=a[r],i=K[n];i&&i.id&&t.push(i.id)}t.length&&T.a.raise(P,D.SPGridEvents.deleteCompletedEventName,{itemIds:t})},E=function(r){k=t[r].currentItemSetKey;var a=e(Object(y.a)(function(e){return e.demandItem({key:s.D,folder:h.folderFacet,uniqueId:u.zc,folderPath:u.R,oneNote:U.c,itemId:u.pb},r)}));if(a&&a.key&&a.folderPath){if(l=a.key.webAbsoluteUrl,w=a.key.listFullUrl,!o){var n=s.K.serialize({webAbsoluteUrl:l,listFullUrl:w}),i=e(Object(y.a)(function(e){return e.demandItemFacet(u.nb,n)}));o={webAbsoluteUrl:l,listFullUrl:w,items:[],deletionType:f.Recycle,listId:i&&i.id}}var c={key:r,serverRelativeItemUrl:a.folderPath,id:a.itemId,uniqueId:a.uniqueId,isFolder:!!a.folder||!!a.oneNote};o.items.push(c),K[c.key]=c}},L=0,z=Object.keys(t);L<z.length;L++)q=z[L],E(q);return M=[],(B=o)&&B.items.length?(V=e(Object(O.a)({enableOverrideDeleteFileLocks:F.enableOverrideDeleteFileLocksFacet})).enableOverrideDeleteFileLocks,1!==B.items.length?[3,2]:(W=B.items[0],G=x({webAbsoluteUrl:B.webAbsoluteUrl,listFullUrl:B.listFullUrl,deletionType:B.deletionType,listId:B.listId,serverRelativeItemUrl:W.serverRelativeItemUrl,uniqueId:W.uniqueId,isFolder:!!W.isFolder,itemId:W.id}),H={},B.deletionType===f.PermanantDelete&&(H["X-HTTP-Method"]="DELETE"),ee=t[Object.keys(t)[0]],(Q=!!ee.breakLock)&&(H.Prefer="bypass-shared-lock"),[4,e(Object(d.b)({webAbsoluteUrl:B.webAbsoluteUrl,listFullUrl:w||"",url:G,body:void 0,method:"POST",additionalHeaders:H,qosName:"deleteSingleItem",qosHandler:function(e){return e.status===v.b||V&&e.code&&e.code.indexOf("-2130575306")>-1?{resultType:_.b.expectedFailure}:{resultType:_.b.failure}}})).then(function(){M.push(W.key),R(M)}).catch(function(t){if(t instanceof b.a){if(t.code&&t.code.indexOf("-2130575306")>-1)throw V&&e(Object(S.a)({name:"DeleteOperationFileLockedWithForcedDeleteEnabled",isIntentional:!1,extraData:{errorCode:t.code,overrideFileLocksEnabled:V,isBatch:!1}})),new v.a({innerError:t,facets:c.__assign({},g.e.pack({}))});if(Q&&e(Object(S.a)({name:"DeleteOperationOverrideFilelockedFailed",isIntentional:!1,extraData:{errorCode:t.code,overrideFileLocksEnabled:V,isBatch:!1}})),t.errorData.status===v.b)throw new v.a({innerError:t,facets:c.__assign({},g.m.pack({}))})}throw t})])):[3,5];case 1:return ae.sent(),[3,4];case 2:return B.items.length>1?(J=p.default.generate(),X="multipart/mixed; boundary=batch_"+J,[4,e(Object(d.b)({webAbsoluteUrl:B.webAbsoluteUrl,listFullUrl:w||"",url:m.a.getBatchOperationUrl(B.webAbsoluteUrl),body:N(B,J),method:"POST",additionalHeaders:void 0,contentType:X,parseResponse:function(e){return m.a.processBatchResponse(e,B.items)},qosName:"deleteMultipleItems"})).then(function(t){for(var r=0,a=t.items;r<a.length;r++){!(l=a[r]).error&&l.key&&M.push(l.key)}if(R(M),t.hasError){for(var i={items:{}},o=0,s=t.items;o<s.length;o++){var l;if((l=s[o]).error&&l.key){var u=l.error.code&&"-2130575306"===l.error.code.toString();V&&e(Object(S.a)({name:"DeleteOperationFileLockedInBatchWithForcedDeleteEnabled",isIntentional:!1,extraData:{errorCode:l.error.code,overrideFileLocksEnabled:V,isBatch:!0}})),i.items[l.key]=new v.a({message:l.error.message,facets:u?c.__assign({},g.e.pack({})):void 0})}}throw new n.a(i)}return Promise.resolve({data:t})})]):[3,4];case 3:ae.sent(),ae.label=4;case 4:for(Y=new I.a,$=0,Z=B.items;$<Z.length;$++)ee=Z[$],Y.invalidateItems({items:(r={},r[ee.key]=[h.deletedFacet],r)}),Y.resolveItems({items:(a={},a[ee.key]=h.deletedFacet.pack({}),a)});te=e(Object(y.a)(function(e){return l&&w&&e.demandItemFacet(u.qc,s.Q.serialize({webAbsoluteUrl:l,listFullUrl:w}))})),(!te||!Object(j.getKillSwitch)(te).isActivated("C5C6F559-B975-4336-BEFB-0483A5A24929","02/14/2020","Resolve remaining items for current itemSet after delete to avoid going back to first page for current itemSet."))&&k&&M.length&&(re=e(Object(y.a)(function(e){var t=e.demandItemFacet(A.a,k);if(t&&t.itemKeys){for(var r=[],a=0,n=t.itemKeys;a<n.length;a++){var i=n[a],o=e.demandItemFacet(s.D,i),l=o&&s.D.serialize(o)||i;M.indexOf(l)<0&&r.push(i)}if(r.length+M.length===t.itemKeys.length)return r}})))&&Y.resolveItems({items:(i={},i[k]=A.a.pack({itemKeys:re}),i)}),e(Y.execute()),ae.label=5;case 5:return[2]}})})}});function x(e){var t=e.webAbsoluteUrl,r=e.listFullUrl,a=e.serverRelativeItemUrl,n=e.deletionType,i=e.uniqueId,o=e.isFolder,s=e.listId,l=e.itemId,c=Object(w.getWebApiUrl)({webAbsoluteUrl:t,listOrItemFullUrl:r});return c=o?i?c.method("GetFolderById",i):c.methodWithAliases("GetFolderByServerRelativePath",{DecodedUrl:a}):s&&l?c.method("Lists",s).method("GetItemById",l):c.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:a}),n===f.Recycle&&(c=c.segment("recycle")),c.toString()}function N(e,t){var r=e.items,a=e.deletionType===f.PermanantDelete?"DELETE":"POST",n=e.deletionType===f.PermanantDelete?"If-Match: *":m.a.defaultBatchRequestPostData,i=r.map(function(t){return x({webAbsoluteUrl:e.webAbsoluteUrl,listFullUrl:e.listFullUrl,deletionType:e.deletionType,serverRelativeItemUrl:t.serverRelativeItemUrl,uniqueId:t.uniqueId,isFolder:t.isFolder,listId:e.listId,itemId:t.id})});return m.a.getBatchContentExtended(t,i,a,n)}var K=r("63aeb04d7e4744f15272"),R=r("5e76ddf6bb30811ee697"),E=r("fcf654cc44d7ec457fe0"),L=r("ec569ac9f2e5cb113534"),z=r("d27387ede93a2620cbf6"),q=r("4e318b84c4772f9f58b9"),B=Object(n.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options.names;return function(e){return c.__awaiter(void 0,void 0,void 0,function(){var a,n,i,o,l,f,m,p,U,I,F,O,S,A,j,k,C,T,D,P,x,N;return c.__generator(this,function(K){switch(K.label){case 0:if(i=Object.keys(r)[0],o=r[i].newName,l=e(Object(y.a)(function(e){return e.demandItem({existingFileName:h.fileNameFacet,spItemKey:s.D,listItemId:u.pb,isFolder:h.folderFacet},t)})),f=l.existingFileName,m=l.spItemKey,p=l.listItemId,U=l.isFolder,I=m||s.D.deserialize(t),!(F=p||I.itemId))throw new Error("Cannot find itemId for itemKey: "+t);return O=I.rootFolder||new E.SimpleUri(I.listFullUrl).path,S=new R.a({context:{webAbsoluteUrl:I.webAbsoluteUrl,listUrl:I.listFullUrl}}),A=S.getUrlParts({path:O}),j=S.getUrlParts({path:I.webAbsoluteUrl}),k=function(e){var t=e.webAbsoluteUrl,r=e.listFullUrl,a=e.itemId;return Object(w.getListApiUrl)({webAbsoluteUrl:t,listFullUrl:r}).method("Items",a).toString()}({webAbsoluteUrl:I.webAbsoluteUrl,listFullUrl:I.listFullUrl,itemId:F}),C={},(T=j.serverRelativeItemUrl)?[3,2]:[4,e(Object(d.b)({webAbsoluteUrl:I.webAbsoluteUrl,listFullUrl:I.listFullUrl,url:(B={webAbsoluteUrl:I.webAbsoluteUrl,listFullUrl:I.listFullUrl},M=B.webAbsoluteUrl,V=B.listFullUrl,W=Object(w.getListApiUrl)({webAbsoluteUrl:M,listFullUrl:V}).segment("ParentWeb").segment("ServerRelativeUrl"),W.toString()),method:"POST",qosName:"GetWebUrl",noRedirect:!0})).then(function(e){T=e.d.ServerRelativeUrl})];case 1:K.sent(),K.label=2;case 2:return!T&&A.serverRelativeListUrl&&((D=A.serverRelativeListUrl.indexOf("/lists/"))<0&&(D=A.serverRelativeListUrl.lastIndexOf("/")),D>=0&&(T=A.serverRelativeListUrl.substring(0,D))),(P=A.serverRelativeListUrl)&&(C.__metadata={type:Object(L.c)(P,T)}),x=f&&f.extension?o+f.extension:o,C.FileLeafRef=x,U&&(C.Title=x),(N={})["X-HTTP-Method"]="MERGE",N["If-Match"]="*",N.Prefer="bypass-shared-lock",[4,e(Object(d.b)({webAbsoluteUrl:I.webAbsoluteUrl,listFullUrl:I.listFullUrl,url:k,method:"POST",body:JSON.stringify(C),additionalHeaders:N,qosName:"renameItem",qosHandler:function(e){return e.status===v.b?{resultType:_.b.expectedFailure}:e.code&&e.code.indexOf("-2130575257")>-1?{resultType:_.b.expectedFailure}:{resultType:_.b.failure}}})).catch(function(e){if(e instanceof b.a&&e.errorData.status===v.b)throw new v.a({facets:c.__assign({},g.m.pack({})),innerError:e});throw e})];case 3:return K.sent(),e(Object(z.b)({items:(a={},a[t]=[h.displayNameFacet],a)})),e(Object(q.a)({items:(n={},n[t]=c.__assign({},h.displayNameFacet.pack(f&&f.extension?o+f.extension:o),h.fileNameFacet.pack({name:o,extension:f&&f.extension||""})),n)})),[2]}var B,M,V,W})})}});var M=r("e008263a4c0e246e4f4f"),V=r("3c88ca8e24c9c99ad593"),W=r("4986dedaa57d766e48bb")._dyjnt3SdKkvQeou8Lavmyg,G=r("cfef2ab49d0d7bc1e869"),H=Object(o.a)()(function(){return function(e){return function(e,t){var r=t.itemKey,a=e.demandItem({key:s.D,permissions:u.Gb,isCheckedOut:h.isCheckedOutFacet,isFolder:h.folderFacet,rowData:u.Ob},r),n=a.key,i=a.permissions,o=a.isCheckedOut,l=a.isFolder,d=a.rowData,b=n&&e.demandItemFacet(u.qc,s.Q.serialize({webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl})),f=n&&e.demandItemFacet(u.nb,s.K.serialize({webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl})),m=!(!b||b.isAnonymousGuestUser||!V.a.hasItemPermission({permissions:i},V.a.editListItems)||!V.a.hasItemPermission({permissions:i},V.a.deleteListItems)),p=d&&b&&o&&!!o.byOther,v=G.a;!b||b.supportPoundStorePath&&b.supportPercentStorePath||(v=G.b);var g={};return p?(g.lockedWarningMessage=W.FileCheckedoutOrLockedWarning,g.title=W.FileCheckedoutOrLockedWarningTitle):f&&f.isForceCheckout&&o&&!o.byYou&&(g.lockedWarningMessage=W.CheckoutRequired,g.title=W.Error),c.__assign({isAvailable:m,validator:v,isFolder:!!l},g)}}});var Q=r("2c440e638bb16e83d44e"),J=r("275976081ce1abf67779"),X=r("455751f14e5c7456742c"),Y=r("00620f24248a4f158ff6");function $(e){var t=e.serverRelativeItemUrl,r=e.dataRequestor,a=e.webApiUrl,n=e.duration,i=void 0===n?1:n,o=e.authToken,s=a;return s=(s=s.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:t})).method("GetPreAuthorizedAccessUrl",i),r.getData({url:s.toString(),method:"GET",authToken:o,qosName:"ItemDataSource.getDownloadUrl"}).then(function(e){return e.d.GetPreAuthorizedAccessUrl})}var Z=r("df0590cb07119b259360"),ee=r("c42c356815f80924f647"),te=r("aa112348dbd293212a65"),re=r("b32a03546c11ac251a10"),ae=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return c.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.defaultRender,r=c.__rest(e,["defaultRender"]);return t?J.createElement(t,c.__assign({},r,{preferOpenInBrowser:!0})):null},t}(J.PureComponent),ne=Object(o.a)()(function(){return function(e){return function(e,t){var r=t.itemKeys,a=r[0],n=e.demandItemFacet(h.folderFacet,a),i=e.demandItemFacet(U.c,a);return 1!==r.length||n||i?r.length>0?function(e,t){var r=t.itemKeys,a=e.demandItemFacet(s.D,r[0]);if(!a||!a.webAbsoluteUrl||!a.listFullUrl)return{};var n=a.webAbsoluteUrl,i=a.listFullUrl,o=s.K.serialize({webAbsoluteUrl:n,listFullUrl:i}),l=e.demandItem({listFacets:u.nb,downloadZipApiUrl:Z.a},o),b=l.listFacets,f=l.downloadZipApiUrl;if(!b||!f||b.templateType===Y.ListTemplateType.webPageLibrary)return{};for(var m=[],v=Object(te.a)(e,{enableOAuthTokenInDownload:u.D}).enableOAuthTokenInDownload,g=void 0!==v&&v,y=!1,w=0,I=r;w<I.length;w++){var _=I[w],F=e.demandItem({name:h.displayNameFacet,size:h.fileSizeFacet,itemUrl:h.vroomUrlFacet,folder:h.folderFacet,permissions:u.Gb,itemComplianceStatus:ee.a,isOneNote:U.c,mountPoint:u.wb},_),O=F.name,S=F.size,A=F.itemUrl,j=F.folder,k=F.permissions,C=F.itemComplianceStatus,T=F.isOneNote,D=F.mountPoint;if(T)return{isAvailable:!1};var P=void 0,x=void 0;if(D)P=void 0,x=new E.SimpleUri(D.siteUrl).authority+"/_api/v2.1/drives/"+D.driveId+"/items/"+D.itemId,y=!0;else{if(!A)return{};P=e.demandItemFacet(Z.b,o),x=Object(X.getItemUrlWithToken)(A,(P?P.accessToken:void 0)||"")}if(x){var N=!!j;3!==C&&4!==C&&V.a.hasItemPermission({permissions:k},V.a.openItems)&&m.push({name:O||"",size:S||0,docId:x,isFolder:N})}}if(0===m.length)return{};return{isAvailable:!0,getDownloadData:function(){return function(e){var t=this,r=e.zipApiUrl,a=e.itemsData,n=e.useOAuthToken;return function(e){return c.__awaiter(t,void 0,void 0,function(){var t,i,o;return c.__generator(this,function(s){switch(s.label){case 0:return t=void 0,n?[4,e(Object(d.a)({url:new E.SimpleUri(r).authority}))]:[3,2];case 1:t=s.sent(),s.label=2;case 2:return i=a&&1===a.length?a[0].name+".zip":"OneDrive_"+ ++ie+"_"+(new Date).toLocaleDateString().replace(/\//g,"-").replace(/[^ -~]/g,"")+".zip",o=p.default.generate(),[2,{url:r,method:"POST",postData:{zipFileName:i,guid:o,provider:"spo",files:JSON.stringify({items:a}),oAuthToken:t||""}}]}})})}}({zipApiUrl:f,itemsData:m,useOAuthToken:g||y})}}}(e,{itemKeys:r}):{}:function(e,t){var r=t.itemKey,a=e.demandItem({spItem:s.D,permissions:u.Gb,folderPath:u.R,uniqueId:u.zc,itemComplianceStatus:ee.a,isBFile:u.db},t.itemKey),n=a.spItem,i=a.permissions,o=a.folderPath,l=a.uniqueId,b=a.itemComplianceStatus,f=a.isBFile,m=e.demandItemFacet(h.malwareDetectedFacet,t.itemKey),p=n&&s.Q.serialize(n),v=e.demandItemFacet(u.qc,p);if(!v||!n||f)return{};var g=n.webAbsoluteUrl,y=n.listFullUrl,U=s.K.serialize(n),I=e.demandItemFacet(u.nb,U);if(I&&I.templateType===Y.ListTemplateType.webPageLibrary)return{};if(3===b||4===b||!V.a.hasItemPermission({permissions:i},V.a.openItems))return{};var _=Object(te.a)(e,{spCookieDomainConfiguration:u.Vb,enableMalwareDownloadInNewWindow:u.y}),F=_.spCookieDomainConfiguration,O=_.enableMalwareDownloadInNewWindow;if(m){if(!v.allowInfectedDownload)return{};var S=e.demandItemFacet(h.canonicalUrlFacet,r);return S?O?{isAvailable:!0,downloader:ae,getDownloadData:function(){return oe({canconicalUrl:S})}}:F?new E.SimpleUri(F).authority!==new E.SimpleUri(S).authority?{}:{isAvailable:!0,getDownloadData:function(){return oe({canconicalUrl:S})}}:{}:{}}if(!o)return{};var A=v.layoutsUrl;if(!A)return{};return{isAvailable:!0,getDownloadData:function(){return F&&l?function(e){var t=this,r=e.webAbsoluteUrl,a=e.layoutsUrl,n=e.uniqueId;return function(e){return c.__awaiter(t,void 0,void 0,function(){return c.__generator(this,function(e){return[2,{url:r+"/"+a+"/download.aspx?"+Object(re.serializeQuery)({UniqueId:n}),method:"GET"}]})})}}({webAbsoluteUrl:g,uniqueId:l,layoutsUrl:A}):function(e){var t=this,r=e.webAbsoluteUrl,a=e.listFullUrl,n=e.folderPath;return function(e){return c.__awaiter(t,void 0,void 0,function(){var t,i,o,s,l,u;return c.__generator(this,function(c){switch(c.label){case 0:return t=e(Object(d.c)({webAbsoluteUrl:r,listFullUrl:a})),i=t.dataRequestor,o=t.hasDigest,t.hasTokenProvider?(l=void 0,[3,3]):[3,1];case 1:return[4,e(Object(d.a)({url:r||a,disallowCookies:!o}))];case 2:l=c.sent(),c.label=3;case 3:return s=l,u=Object(w.getWebApiUrl)({webAbsoluteUrl:r,listOrItemFullUrl:a}),[4,$({dataRequestor:i,authToken:s,serverRelativeItemUrl:n,webApiUrl:u})];case 4:return[2,{url:c.sent(),method:"GET"}]}})})}}({webAbsoluteUrl:g,listFullUrl:y,folderPath:o,layoutsUrl:A})}}}(e,{itemKey:a})}}});var ie=0;function oe(e){var t=this;return function(r){return c.__awaiter(t,void 0,void 0,function(){var t;return c.__generator(this,function(r){return(t=e.canconicalUrl)&&(-1===t.indexOf("?")?t+="?avcmd=1":t+="&avcmd=1"),[2,{url:t,method:"GET"}]})})}}var se=r("64b1e6e25051aaaf0681"),le=Object(o.a)()(function(){return function(e){return function(e,t){var r=t.itemKey,a=e.demandItem({permissions:u.Gb},r).permissions;return{isAvailable:V.a.hasItemPermission({permissions:a},V.a.deleteListItems)}}}});r.d(t,"sharePointBasicActionsAddonDeferred",function(){return ce});var ce=Object(n.b)(function(){return function(e){e(Object(i.g)(s.D,l.b)(P)),e(Object(i.g)(s.D,K.b)(B)),e(Object(o.c)(s.D,M.a)(H)),e(Object(o.c)(s.D,Q.a)(ne)),e(Object(o.c)(s.D,se.b)(le))}})},"2abad5c842761f84fba3":function(e,t,r){"use strict";r.d(t,"b",function(){return i}),r.d(t,"a",function(){return o});var a=r("447964f318fe44ff3682"),n=r("022addba5cf25ce091fb"),i=new a.a("updateItemLikes"),o=Object(n.e)({operationTypeFacet:i})},"2e3b8084858f7c52bbcc":function(e,t,r){"use strict";r.r(t),r.d(t,"ItemUpdateLikesExectuor",function(){return u});var a=r("64328bb588b46459132d"),n=r("2abad5c842761f84fba3"),i=r("958db96f3e5e5318cd6e"),o=r("44e6ed3c2eaab3f422db"),s=r("4e318b84c4772f9f58b9"),l=r("5fef64b3561abb2ebffa"),c=r("800956ab6ff71efe3834"),u=Object(i.connectToItemCache)(function(e,t){var r=t.itemKey,i=e.demandItemFacet(l.likesCountFacet,r)||0,o=e.demandItemFacet(l.hasUserLikedFacet,r)||!1,u=o?i-1:i+1,d=e.dispatch;return a.__assign({isAvailable:!0},Object(c.getItemActionEngagement)(e,{itemKey:r,engagement:{name:"UpdateLikes",isIntentional:!0}}),{onExecute:function(){return a.__awaiter(void 0,void 0,void 0,function(){var e,t;return a.__generator(this,function(i){switch(i.label){case 0:return d(Object(s.a)({items:(e={},e[r]=a.__assign({},l.likesCountFacet.pack(u),l.hasUserLikedFacet.pack(!o)),e)})),[4,d(Object(n.a)({items:(t={},t[r]={liked:!o},t)}))];case 1:return i.sent(),[2]}})})}})})(o.a)},"31c533de2caeaf8e942c":function(e,t,r){"use strict";r.d(t,"a",function(){return l});var a=r("64328bb588b46459132d"),n=r("a4060cda3c9c24220a4a"),i=r("ee92087a6ec1d0e9ecc9"),o=r("c70c28d41140929c0281"),s=r("eef09ec91afb2fd77b66");function l(e){var t=this;return function(r){return a.__awaiter(t,void 0,void 0,function(){var t,l,c;return a.__generator(this,function(a){switch(a.label){case 0:return t=r(Object(s.a)(function(t){return t.demandItemFacet(n.D,e)})),[4,r(Object(o.demandItems)(function(t){return t.demandItem({listItemId:i.pb},e)}))];case 1:if(l=a.sent().listItemId,!t)throw new Error("Cannot get spItemKeyFacet for itemKey: "+e);if(!(c=l||t.itemId))throw new Error("Cannot find itemId for itemKey: "+e);return[2,{key:t,itemId:c}]}})})}}},"390bac1530ab6cf4e614":function(e,t,r){"use strict";var a=r("64328bb588b46459132d"),n=r("65da65eb66805e3724ff"),i=r("5e76ddf6bb30811ee697"),o=r("fcf654cc44d7ec457fe0"),s=r("5f37f5ec04a007134c18"),l=r("1adfad17f632aad72441"),c=r("680b7ac74280293b48f0"),u=r("4e318b84c4772f9f58b9"),d=r("5fef64b3561abb2ebffa"),b=r("d27387ede93a2620cbf6"),f=r("fdbcb7664c17b5b4e4d9"),m=r("2852e19dad7ee30e33c6"),p=r("9ba97cc998d0be4df04a"),v=r("ee92087a6ec1d0e9ecc9"),h=r("1bdba4333337067e8d37"),g=r("90e9dbb8f74ee9c49c51"),y=r("6578506114fc52cc91d3"),U=r("a3886a89b418632a97c5"),w=r("6631b0451e9f577f414d"),I=r("578e5017557fc66bb247"),_=r("6d69c5cabadd78126515"),F=r("a4060cda3c9c24220a4a"),O=r("022addba5cf25ce091fb"),S=r("809072ae40093b380229"),A=Object(O.e)({operationTypeFacet:S.a}),j=r("5004fc2f3329649ad54d"),k=r("eef09ec91afb2fd77b66");r.d(t,"c",function(){return P}),r.d(t,"b",function(){return x}),r.d(t,"a",function(){return N});var C={ODB:1561},T={ODB:1234},D=!1,P=Object(c.e)({mergeForSameItemKey:!1,maxParallelOperationCount:4})(function(e){var t=this,r=e.itemKey,s=e.options,c=s.documentType,O=s.fileName,S=s.newDocumentKey,P=s.templateItemKey,R=s.targetWindow;return function(e){return a.__awaiter(t,void 0,void 0,function(){var t,s,E,L,z,q,B,M,V,W,G,H,Q,J,X,Y,$,Z,ee,te,re,ae,ne,ie,oe,se,le,ce,ue,de,be,fe;return a.__generator(this,function(me){switch(me.label){case 0:return z=F.D.deserialize(r),q=z.rootFolder||new o.SimpleUri(z.listFullUrl).path,B=new i.a({context:{webAbsoluteUrl:z.webAbsoluteUrl,listUrl:z.listFullUrl}}),M=B.getUrlParts({path:q}),V=new w.default(null),W=e(Object(I.a)({createDocumentFormDigest:v.Wb,spCookieDomainConfiguration:v.Vb},_.configurationItemKey)),G=W.createDocumentFormDigest,H=W.spCookieDomainConfiguration,Q=!H||new o.SimpleUri(H).authority!==new o.SimpleUri(z.webAbsoluteUrl).authority,D=e(Object(k.a)(function(e){return Object(j.a)(e,{feature:T})})),P||!G||Q||!(c===l.a.Word||c===l.a.PowerPoint||c===l.a.Bohemia||c===l.a.Prague||c===l.a.Visio&&D)?[3,5]:("_layouts/15",J=c===l.a.Prague?"prague":"doc",X=z.webAbsoluteUrl+"/_layouts/15/"+J+".aspx",e(Object(k.a)(function(e){return Object(j.a)(e,{feature:C})}))?(Y=e(Object(I.a)({folderUniqueId:v.zc},r)).folderUniqueId,[4,U.createDocumentByDocAspxWithItemUrlParts(c,X,z.webAbsoluteUrl,V,R,O,M,void 0,Y)]):[3,2]);case 1:return me.sent(),[3,4];case 2:return[4,U.createDocumentByDocAspxWithItemUrlParts(c,X,z.webAbsoluteUrl,V,R,O,M)];case 3:me.sent(),me.label=4;case 4:return e(Object(b.b)({items:(t={},t[r]=[f.b],t)})),[3,11];case 5:return $="",Z=void 0,(ee=e(Object(k.a)(function(e){return e.demandItemFacet(F.N,P)})))&&((te=e(Object(I.a)({documentTemplate:v.zb},P)).documentTemplate)&&te.url?(Z=te,$=te.url):$=ee.templateUrl),re=N({webAbsoluteUrl:z.webAbsoluteUrl,listFullUrl:z.listFullUrl,parentFolderPath:M.listRelativeItemUrl||"",docType:c,docName:O,templateUrl:$}),[4,e(Object(n.b)({webAbsoluteUrl:z.webAbsoluteUrl,listFullUrl:z.listFullUrl,url:re,method:"POST",parseResponse:function(e){return e},qosName:"createDocument",noRedirect:!0}))];case 6:return ae=me.sent(),ne=x({responseText:ae,documentType:c,fileName:O}),ie=ne.redirectUrl,(oe=ne.originalEditLink)?(se=p.deserializeQuery(p.getQueryStringFromUrl(oe.toLowerCase())),le=se.sourcedoc,ce=le&&Object(h.normalizeLower)(le),ue=Object(g.getDocExtension)(c),(de=Z)&&de.url?(be=function(e){var t=e.listFullUrl,r=e.uniqueId,a=e.webAbsoluteUrl;return Object(y.getListApiUrl)({webAbsoluteUrl:a,listFullUrl:t}).methodWithAliases("GetItemByUniqueId",{uniqueId:r}).toString()}({listFullUrl:z.listFullUrl,webAbsoluteUrl:z.webAbsoluteUrl,uniqueId:ce}),[4,e(Object(n.b)({listFullUrl:z.listFullUrl,webAbsoluteUrl:z.webAbsoluteUrl,url:be,method:"POST",parseResponse:K,qosName:"getItemByUniqueId",noRedirect:!0}))]):[3,9]):[3,10];case 7:return(fe=me.sent())?[4,e(A({items:(s={},s[F.D.serialize({itemId:fe,listFullUrl:z.listFullUrl,webAbsoluteUrl:z.webAbsoluteUrl})]={formValues:[{FieldName:"ContentTypeId",FieldValue:de.contentTypeId||""}],qosName:"updateTemplateDocContentType"},s)}))]:[3,9];case 8:me.sent(),me.label=9;case 9:e(Object(u.a)({items:(E={},E[S]=a.__assign({},ie?d.openUrlFacet.pack(ie):{},d.fileNameFacet.pack({name:O||"",extension:ue}),ce?v.zc.pack(ce):{},m.c.pack(c===l.a.OneNote?{}:void 0),f.e.pack({itemKey:r})),E)})),me.label=10;case 10:e(Object(b.b)({items:(L={},L[r]=[f.b],L)})),me.label=11;case 11:return[2]}})})}});function x(e){var t=e.responseText,r=e.documentType,a=e.fileName,n="",i="";if(null!=t){var o=JSON.parse(t);if(null!==o&&null!==o.d&&null!==o.d.CreateDocumentAndGetEditLink)i=o.d.CreateDocumentAndGetEditLink,n=Object(s.b)(i,r,a||"",!1);else try{i=(new DOMParser).parseFromString(t,"text/xml").getElementsByTagName("d:CreateDocumentAndGetEditLink")[0].textContent||"",n=Object(s.b)(i,r,a||"",!1)}catch(e){}}return{originalEditLink:i,redirectUrl:n}}function N(e){var t=l.a.Visio,r=e.webAbsoluteUrl,a=e.listFullUrl,n=e.parentFolderPath,i=e.templateUrl,o=e.docName,s=e.docType;if(null!==s&&s>=l.a.Word&&s<=t&&s!==l.a.Text){if(s!==l.a.OneNote||o){if(o){o+=Object(g.getDocExtension)(s)}}else o="Notebook"+Math.floor(100*Math.random())+1;return o||(o=""),s===l.a.ExcelForm&&(s=l.a.ExcelSurvey),Object(y.getListApiUrl)({webAbsoluteUrl:r,listFullUrl:a}).methodWithAliases("CreateDocumentAndGetEditLink",{fileName:o,folderPath:n,documentTemplateType:s,templateUrl:i||""}).toString()}throw new Error("document type is not valid, here are the valid type: 1 - Word, 2 - Excel,\n    3 - PowerPoint, 4 - OneNote, 5 - Excel Survey, 7 - ExcelForm, 8 - Visio")}function K(e){if(e)try{var t=JSON.parse(e);if(t&&t.d&&t.d.Id)return t.d.Id}catch(e){}return""}},"3d92c7f3fb145bfb9378":function(e,t,r){"use strict";r.d(t,"b",function(){return i}),r.d(t,"a",function(){return o});var a=r("0b8514f932f40951d460"),n=r("e9d155a6651c0bf6c9b0");function i(e,t){if(t)return!0;if("javascript:LaunchApp("===e.substring(0,21)&&");"===e.substring(e.length-2)){var r=s(e);try{return JSON.parse(r),!0}catch(e){return!1}}return!1}function o(e,t){var r=s(e);try{var i=JSON.parse(r);return function(e){var t=e.pageContext,r=e.appInstanceId,a=e.appOAuthId,i=e.launchUrl,o=e.isTenantApp,s=n.default.escapeUrlForCallback(t.webAbsoluteUrl),l=n.default.escapeUrlForCallback(t.layoutsUrl),c=s+"/"+l+"/appredirect.aspx";if(a&&i)c+="?client_id="+n.default.encodeURIComponent(a)+"&redirect_uri="+n.default.encodeURIComponent(i);else{if(!r)throw"appOAuthId, launchUrl, appInstanceId are null";c+="?instance_id="+n.default.encodeURIComponent(r)}o&&(c+="&tsapp=1");window.location.href=c}({pageContext:t,appInstanceId:i[0],appOAuthId:i[1],launchUrl:i[2],isTenantApp:i[4]}),a.default.wrap()}catch(e){return a.default.wrapError(e)}}function s(e){return e.replace("javascript:LaunchApp(","[").replace(");","]").replace(/'/g,'"').replace(/(width|height|title):/g,'"$1":')}},"4cf6b25e4dacf118cb22":function(e,t,r){"use strict";r.d(t,"b",function(){return i}),r.d(t,"a",function(){return o});var a=r("447964f318fe44ff3682"),n=r("022addba5cf25ce091fb"),i=new a.a("refreshItemsInSet"),o=Object(n.e)({operationTypeFacet:i})},"51544a23f67b5dfbf4ba":function(e,t,r){"use strict";r.d(t,"e",function(){return f}),r.d(t,"b",function(){return m}),r.d(t,"d",function(){return p}),r.d(t,"c",function(){return v}),r.d(t,"a",function(){return g});var a=r("64328bb588b46459132d"),n=r("65da65eb66805e3724ff"),i=r("3d240143e32215cc23a5"),o=r("8bcc52c340fdae8e02d4"),s=r("6578506114fc52cc91d3"),l=r("eba1a54870ffae1e61c2"),c=r("dccf0341ea4deb985b9e"),u=r("ee92087a6ec1d0e9ecc9"),d=r("7f44f3b6edbad81cb558"),b=r("655c29c4569d728dbf1e");r("db7b01b1853a9a275b02");function f(e){return function(t){var r=t(Object(i.a)({spHostPageWebAbsoluteUrl:u.kc})).spHostPageWebAbsoluteUrl,a=new o.default(e.webAbsoluteUrl).authority,l=Object(s.getStaticApiUrl)({webAbsoluteUrl:r||a}).segment("SP.Web.GetDocumentLibraries").parameter("webFullUrl",e.webAbsoluteUrl);return t(Object(n.d)({webAbsoluteUrl:r||a,method:"POST",url:l.toString(),qosName:"getDocumentLibraries",noRedirect:!0}))}}function m(e){return function(t){var r=t(Object(i.a)({spHomeDataSourceConfiguration:u.hc})).spHomeDataSourceConfiguration,a=r&&r.contextAcquiresAuthToken;return t(Object(n.d)({webAbsoluteUrl:e.tenantRootUrl,listFullUrl:e.tenantRootUrl,method:"GET",url:h(e),qosName:"getSPHomeContext",parseResponse:function(e){var t=JSON.parse(e).d;return{payloadHeader:t.Payload,resource:t.Urls&&t.Urls.results&&t.Urls.results.length>0&&t.Urls.results[0]||"",accessToken:t.Token&&t.Token.access_token||""}},noRedirect:!0,skipAuth:a,crossSiteCollectionCall:a,needsRequestDigest:!a,ignoreDiskCacheWhenOnline:!0}))}}function p(e,t,r){var n=this;return void 0===r&&(r=8),function(o){return a.__awaiter(n,void 0,void 0,function(){var n,s,l,c,d,b;return a.__generator(this,function(a){switch(a.label){case 0:return n=o(Object(i.a)({spFrequentSitesConfiguration:u.fc,enableFilesWeightedFrequentSitesConfiguration:u.t})),s=n.spFrequentSitesConfiguration,l=n.enableFilesWeightedFrequentSitesConfiguration,s&&s.getExternalData?[4,s.getExternalData()]:[3,2];case 1:if(c=a.sent())return[2,c];a.label=2;case 2:return!t&&s&&s.getCacheContext?[4,s.getCacheContext()]:[3,4];case 3:(d=a.sent())&&(t=JSON.stringify(d)),a.label=4;case 4:return[4,o(m({tenantRootUrl:e}))];case 5:return b=a.sent(),[2,o(g({path:"api/v1/sites/feed?acronyms=true&start=0&count="+r,method:"GET",qosName:"getSPHomeFrequentSites",context:b,clientType:l?"ODBWeb":void 0,cacheContext:t}))]}})})}}function v(e){var t=this;return function(r){return a.__awaiter(t,void 0,void 0,function(){var t,n,o;return a.__generator(this,function(a){switch(a.label){case 0:return(t=r(Object(i.a)({spFollowedSitesConfiguration:u.ec})).spFollowedSitesConfiguration)&&t.getExternalData?[4,t.getExternalData()]:[3,2];case 1:if(n=a.sent())return[2,n];a.label=2;case 2:return[4,r(m({tenantRootUrl:e}))];case 3:return o=a.sent(),[2,r(g({path:"api/v1/sites/followed?acronyms=true&fillsitedata=true&mostRecentFirst=true&start=0&count=36",method:"GET",qosName:"getSPHomeFollowedSites",context:o}))]}})})}}function h(e){var t=e.tenantRootUrl;return Object(s.getStaticApiUrl)({webAbsoluteUrl:t}).segment("sphomeservice").segment("context").oDataParameter("$expand","Token,Payload").toString()}function g(e){var t=this,r=e.method,i=e.path,o=e.context,s=e.qosName,u=e.clientType,f=e.contentType,m=void 0===f?"application/json;odata=verbose":f,p=e.body,v=e.cacheContext,h=s?"getData."+s:"getData";return function(e){return a.__awaiter(t,void 0,void 0,function(){var t,s,f,g,y,U,w,I,_,F=this;return a.__generator(this,function(O){switch(O.label){case 0:return t=new Headers,(f=o.accessToken)?[3,2]:[4,e(Object(n.a)({url:o.resource}))];case 1:f=O.sent(),O.label=2;case 2:return(s=f)&&t.set("Authorization","Bearer "+s),o.payloadHeader&&t.set("SPHome-ApiContext",o.payloadHeader),v&&t.set("SPHome-CacheContext",v),t.set("SPHome-ClientType",u||"ODSPDocLibsWeb"),t.set("Content-Type",m),g={headers:t,credentials:"omit",method:r,mode:"cors",cache:"default",body:p},y=e(Object(l.a)({name:h})),U=o.resource+"/"+i+"__"+r,[4,e(Object(d.b)(U))];case 3:return w=O.sent(),I=fetch(o.resource+"/"+i,g).then(function(t){return a.__awaiter(F,void 0,void 0,function(){var r;return a.__generator(this,function(a){switch(a.label){case 0:return t.ok?(e(y({resultType:c.ResultTypeEnum.Success})),204===t.status?[2,{}]:[4,t.json()]):[3,2];case 1:return r=a.sent(),e(Object(d.d)(U,r)),[2,r];case 2:throw new b.ApiError({code:""+t.status,message:t.statusText})}})})}).catch(function(t){throw e(y({resultType:c.ResultTypeEnum.Failure,resultCode:t instanceof b.ApiError?t.code:t.name,error:t&&JSON.stringify(t)})),t}),(_=w)?[3,5]:[4,I];case 4:_=O.sent(),O.label=5;case 5:return[2,_]}})})}}},"5730cedeedcb5640bb56":function(e,t,r){"use strict";var a,n,i=r("64328bb588b46459132d");!function(e){e[e.ContextMenu=0]="ContextMenu",e[e.RibbonDocuments=1]="RibbonDocuments",e[e.RibbonList=2]="RibbonList"}(a||(a={})),function(e){e[e.None=0]="None",e[e.List=1]="List",e[e.ContentType=2]="ContentType",e[e.ProgId=3]="ProgId",e[e.FileType=4]="FileType"}(n||(n={}));var o={Prefix:"ClientSideExtension",CommandSet:"ClientSideExtension.ListViewCommandSet",ContextMenu:"ClientSideExtension.ListViewCommandSet.ContextMenu",CommandBar:"ClientSideExtension.ListViewCommandSet.CommandBar"},s=r("3c88ca8e24c9c99ad593"),l=r("c4e199bc4bcd0fb7cb54"),c=r("3d92c7f3fb145bfb9378"),u=r("cdb9a7d2db44c7a9f4dd"),d=r("0a3e1b609e40999fd831"),b=r("e9d155a6651c0bf6c9b0");function f(e,t){var r=[],a=[],s=[];if("undefined"==typeof DOMParser)throw new Error("Cannot parse custom actions on this platform");for(var c=new DOMParser,b=function(e){var b=e.Location,f=e.RegistrationType;if(b&&0===b.lastIndexOf(o.CommandSet,0)){if(!f||f!==n.List)return"continue";var m=b===o.CommandSet,p=b===o.ContextMenu||m,v=b===o.CommandBar||m,w={text:e.Title,isEnabled:function(){return _({registrationId:e.RegistrationId,registrationType:e.RegistrationType,requireSiteAdministrator:e.RequireSiteAdministrator,rights:e.Rights},t)},allowMultiSelect:!0,clientSideComponentId:e.ClientSideComponentId,clientSideComponentProperties:e.ClientSideComponentProperties};p&&s.push(w),v&&(t.isDocumentLibrary?r.push(i.__assign({},w)):a.push(i.__assign({},w)))}else{if(!h(e.UrlAction))return"continue";if(e.CommandUIExtension&&d.doesStringStartWith(e.Location,"CommandUI.Ribbon")&&e.UrlAction){var F=g(e,t,!0),O=g(e,t,!1),S=void 0;try{S=c.parseFromString(e.CommandUIExtension,l.b.doctype)}catch(e){}if(!S)return"continue";var A=S.getElementsByTagName("Tab");if(A&&0!==A.length||(A=S.getElementsByTagName("Group")),A&&A.length>0){var j=y(A,!0),k=y(A,!1),C={};if(j||k)for(var T=0,D=S.getElementsByTagName("CommandUIHandlers");T<D.length;T++)for(var P=D[T].firstElementChild;P;)C[P.getAttribute("Command")]=P.getAttribute("CommandAction"),P=P.nextElementSibling;if(j){var x=U(j,C,e,F);r.push(x)}if(k){x=U(k,C,e,O);a.push(x)}}else{var N=S.getElementsByTagName("Button"),K=I(N,!0,e,F);K&&r.push(K);var R=I(N,!1,e,O);R&&a.push(R)}}else if("EditControlBlock"===e.Location&&e.Title){var E={text:e.Title,isEnabled:g(e,t),allowMultiSelect:!!e.CommandUIExtension&&!e.EnabledScript,action:e.UrlAction,clientSideComponentId:u.default.Empty,clientSideComponentProperties:""};s.push(E)}}},f=0,m=e;f<m.length;f++){b(m[f])}return{"Ribbon.Documents":r,"Ribbon.List":a,ContextMenu:s}}function m(e,t){var r=[];return e.forEach(function(e,a){var i={registrationId:e.registrationId,registrationType:n[e.registrationType],requireSiteAdministrator:!1,rights:{High:Number(e.rightsHigh),Low:Number(e.rightsLow)}};h(e.action)&&r.push({text:e.title,iconUrl:e.imageUrl,isEnabled:_(i,t),action:e.action})}),r}function p(e){return"children"in e}function v(e,t,r){var a=r.webAbsoluteUrl+"/",n=r.layoutsUrl+"/",i=""+a+n,o=r.siteAbsoluteUrl+"/",s=""+o+n,l="",c=r.listId,u=r.listUrl;if(0===e.toLowerCase().lastIndexOf("javascript:launchapp(",0)&&(c=c.replace(/{/g,"%7B").replace(/-/g,"%2D").replace(/}/g,"%7D")),l=e.replace(/{SiteUrl}/g,a).replace(/~site\//g,a).replace(/~layouts\//g,n).replace(/~siteLayouts\//g,i).replace(/~siteCollection\//g,o).replace(/~siteCollectionLayouts\//g,s).replace(/{ListId}/g,c).replace(/{SelectedListId}/g,c).replace(/{ListUrlDir}/g,u).replace(/{Source}/g,b.default.encodeURIComponent(window.location.href)).replace(/{ModernUX}/g,"true"),t.length>0){var d=t.map(function(e){return e.id}).join(","),f=t[0].id,m=t[0].url;l=l.replace(/{ItemUrl}/g,b.default.encodeURIComponent(m)).replace(/{ItemId}/g,f).replace(/{SelectedItemId}/g,d)}else l=l.replace(/{ItemUrl}/g,null).replace(/{ItemId}/g,null).replace(/{SelectedItemId}/g,null);return l}function h(e){return!e||("javascript:"!==e.substring(0,11).toLowerCase()||Object(c.b)(e,!1))}function g(e,t,r){var a=void 0===r||r===t.isDocumentLibrary;if(e.CommandUIExtension&&e.EnabledScript)return a||!0;var n=_({registrationId:e.RegistrationId,registrationType:e.RegistrationType,requireSiteAdministrator:e.RequireSiteAdministrator,rights:{High:Number(e.Rights.High),Low:Number(e.Rights.Low)}},t);return!!n&&("function"==typeof n?"function"==typeof a?function(e){return n(e)&&a}:n:a)}function y(e,t){for(var r=0,a=e.length;r<a;r++){var n=e[r],i=n.getAttribute("Id");if(!i)return n;if((t||!d.doesStringStartWith(i,"Ribbon.Documents"))&&!(t&&d.doesStringStartWith(i,"Ribbon.List")||d.doesStringStartWith(i,"Ribbon.Calendar")))return n}return null}function U(e,t,r,a){for(var n=[],i=e.getElementsByTagName("Button"),o=0,s=i.length;o<s;o++){var l=i[o],c=l.getAttribute("Command"),d=c&&t[c]||r.UrlAction;if(h(d)){var b={text:l.getAttribute("LabelText"),iconUrl:w(l),isEnabled:a,allowMultiSelect:!r.EnabledScript,action:d,clientSideComponentId:u.default.Empty,clientSideComponentProperties:""};n.push(b)}}return{text:e.getAttribute("Title"),tooltip:e.getAttribute("Description"),children:n}}function w(e){return e.getAttribute("Image32by32")||e.getAttribute("Image16by16")}function I(e,t,r,a){var n;if(("boolean"!=typeof a||a)&&(e&&e.length>0&&(n=y(e,t)),n)){var i=n.getAttribute("LabelText")||r.Title;if(i){var o={text:i,allowMultiSelect:!r.EnabledScript,action:r.UrlAction,isEnabled:a,clientSideComponentId:u.default.Empty,clientSideComponentProperties:""},s=w(e[0]);return s&&(o.iconUrl=s),o}}}function _(e,t){var r=function(e,t){return e.requireSiteAdministrator?t.currentUserIsSiteAdmin:function(t){return s.a.hasItemPermission(t,e.rights)}}(e,t),a=function(e,t){var r=e.registrationType,a=e.registrationId;if(!a)return r===n.List;switch(r){case n.List:var i=parseInt(a,10);return i===t.listTemplate||a===t.listId;case n.FileType:var o="."+a;return function(e){return d.equalsCaseInsensitive(e.extension,o)};case n.ContentType:return function(e){var t="contentTypeId"in e&&e.contentTypeId||"properties"in e&&e.properties.ContentTypeId;return t&&d.doesStringStartWith(t,a)};case n.ProgId:return function(e){var t="progId"in e&&e.progId||"properties"in e&&e.properties.ProgId;return t===a}}return!1}(e,t);return!(!r||!a)&&function(e){return!!e&&(!("function"==typeof r&&!r({permissions:e.permissions}))&&!("function"==typeof a&&!a(e)))}}r.d(t,"b",function(){return f}),r.d(t,"c",function(){return m}),r.d(t,"a",function(){return p}),r.d(t,"d",function(){return v})},"5abe0a4e18e69c009f41":function(e,t,r){"use strict";function a(e,t,r,a){var n="",i=0;if(!e)return"";var o=e.length;for(i=0;i<o;i++){var s=e.charCodeAt(i),l=e.charAt(i);if(t&&("#"===l||"?"===l)){n+=e.substr(i);break}if(r&&"&"===l)n+=l;else if(s<=127)a?n+=l:s>=97&&s<=122||s>=65&&s<=90||s>=48&&s<=57||t&&s>=32&&s<=95&&" \"%<>'&".indexOf(l)<0?n+=l:s<=15?n+="%0"+s.toString(16).toUpperCase():s<=127&&(n+="%"+s.toString(16).toUpperCase());else if(s<=2047)n+="%"+(192|s>>6).toString(16).toUpperCase(),n+="%"+(128|63&s).toString(16).toUpperCase();else if(55296!=(64512&s))n+="%"+(224|s>>12).toString(16).toUpperCase(),n+="%"+(128|(4032&s)>>6).toString(16).toUpperCase(),n+="%"+(128|63&s).toString(16).toUpperCase();else if(i<e.length-1){s=(1023&s)<<10,i++,s|=1023&e.charCodeAt(i),n+="%"+(240|(s+=65536)>>18).toString(16).toUpperCase(),n+="%"+(128|(258048&s)>>12).toString(16).toUpperCase(),n+="%"+(128|(4032&s)>>6).toString(16).toUpperCase(),n+="%"+(128|63&s).toString(16).toUpperCase()}}return n}Object.defineProperty(t,"__esModule",{value:!0}),t.encodeURIComponent=a,t.escapeUrlForCallback=function(e){var t=e.indexOf("#"),r=e.indexOf("?");if(t>0&&(-1===r||t<r)){var n=e.substr(0,t);r>0&&(n+=e.substr(r)),e=n}return a(e,!0,!1,!0)},t.encodeRestUriStringToken=function(e){return e&&(e=a(e=(e=e.replace(/'/g,"''")).replace(/%27/g,"%27%27"))),e}},"5c10251521fdf1911fd8":function(e,t,r){"use strict";var a,n=r("022addba5cf25ce091fb"),i=r("f5df325953ebb7f1143d"),o=r("64328bb588b46459132d"),s=r("d6e6a1e726db94fe6759"),l=r("4986dedaa57d766e48bb")["_5CoIJg/6Hl4qwvkQ8ev5+w"],c=r("6c29d4d64a53c3f12405"),u=r("680b7ac74280293b48f0"),d=r("95da7825c4969f34e250"),b=r("9c98f89a0e31dc353072"),f=r("7c35367aa9ac1c882ae5"),m=r("fdbcb7664c17b5b4e4d9"),p=r("3da5d317c00adfe8f79c"),v=r("5fef64b3561abb2ebffa"),h=((a={})[p.d.started]=function(e,t){return Object(s.format)(Object(s.getLocalizedCountValue)(l.assignToGroupStartedItemsTitle,l.assignToGroupTitleIntervals,e)||"",e,t)},a[p.d.completed]=function(e,t){return Object(s.format)(Object(s.getLocalizedCountValue)(l.assignToGroupCompletedItemsTitle,l.assignToGroupTitleIntervals,e)||"",e,t)},a[p.d.failed]=function(e,t){return Object(s.format)(Object(s.getLocalizedCountValue)(l.assignToGroupFailedItemsTitle,l.assignToGroupTitleIntervals,e)||"",e,t)},a[p.d.canceled]=function(e,t){return Object(s.format)(Object(s.getLocalizedCountValue)(l.assignToGroupFailedItemsTitle,l.assignToGroupTitleIntervals,e)||"",e,t)},a),g=Object(u.b)(function(){return function(e){e(Object(d.c)(c.b,b.a)(Object(d.a)()(U))),e(Object(d.c)(c.b,f.c)(Object(d.a)()(y)))}});function y(){return function(e){return function(e,t){return{reportMode:f.a.pin}}}}function U(){return function(e){return w}}function w(e,t){var r=t.itemKey,a=Object(i.e)(e,t),n=a.phase,s=a.count,l=h,u=e.demandItemFacet(m.a,r),d=u&&u.itemKeys,b="",f="";if(d&&d.length>0){var p=e.demandItemFacet(c.a,d[0]),g=p&&p.groupKey;g&&(b=e.demandItemFacet(v.displayNameFacet,g)||""),f=l[n](s,b)}else{var y=e.demandItemFacet(c.b,r);if(y){var U=y.taskKey,w=U&&e.demandItemFacet(v.displayNameFacet,U);w&&(f=w)}}return o.__assign({},f?{title:f}:{})}r.d(t,"a",function(){return I}),r.d(t,"b",function(){return _});var I=Object(n.e)({operationTypeFacet:c.a}),_=Object(i.f)({operationTypeFacet:c.a,progressKeyFacet:c.b,initializeBatch:function(){return g}})},"5cf28e236c4257d408f7":function(e,t,r){"use strict";r.d(t,"c",function(){return i}),r.d(t,"a",function(){return o}),r.d(t,"b",function(){return s});var a=r("447964f318fe44ff3682"),n=r("f5df325953ebb7f1143d"),i=new a.a("removeItemsFromSharedList"),o=new n.a("removeItemsFromSharedList"),s=Object(n.f)({operationTypeFacet:i,progressKeyFacet:o})},"5f37f5ec04a007134c18":function(e,t,r){"use strict";var a=r("e2ea1f13f9b3e771ed24"),n=r("0a3e1b609e40999fd831"),i="forms.officeppe.com",o="forms.office.com",s="&action=edit";function l(e,t,r){var a=e.replace(s,""),n=r?i:o,l="Action=Create&Host=OneDrive&XlWorkbookId="+encodeURIComponent(a)+"&Title="+encodeURIComponent(t);return"https://"+n+"/Pages/DesignPage.aspx?Action=Create&Fragment="+encodeURIComponent(l)}function c(e,t,r){var a=void 0;return"string"==typeof e?0===(e=e.trim()).length?a=t.emptyNameError:/["\*:<>\?\/\\\|]/.test(e)&&(a=n.format(r?t.invalidNameError2:t.invalidNameError,e)):a=t.emptyNameError,a}function u(e,t,r,n){var i="";return null!==e&&""!==e&&(i=t===a.DocumentType.ExcelSurvey?e.replace("action=edit","action=formedit"):t===a.DocumentType.ExcelForm?l(e,r,n):e.replace("action=edit","action=editnew")),i}r.d(t,"a",function(){return c}),r.d(t,"b",function(){return u})},"664990b3cc9463570172":function(e,t,r){"use strict";r.d(t,"a",function(){return a});var a=new(r("264a40ebead766e0e784").ControlFacet)("getDefaultShareLinkActionControl")},"6c29d4d64a53c3f12405":function(e,t,r){"use strict";r.d(t,"a",function(){return i}),r.d(t,"b",function(){return o});var a=r("447964f318fe44ff3682"),n=r("f5df325953ebb7f1143d"),i=new a.a("assignItemToGroup"),o=new n.a("assignToGroup")},"7a458e85783b71176e85":function(e,t,r){"use strict";r.d(t,"a",function(){return a});var a=new(r("264a40ebead766e0e784").ControlFacet)("permissionInviteActionControl")},"7f692fb6d738ed67a546":function(e,t,r){"use strict";r.r(t);var a=r("95da7825c4969f34e250"),n=r("5f37f5ec04a007134c18"),i=r("4986dedaa57d766e48bb")["_Ir4UJ8vtfSG/bHHiBUNj4Q"];var o=r("7ac3ab87caf33903810b");r.d(t,"spItemDocumentCreatorControlHandler",function(){return s});var s=Object(a.a)()(function(){return function(e){return function(e,t){var r=t.itemKey,a=Object(o.a)(e,r),s=!(!a||!a.isAnonymousGuestUser),l=function(e,t){return Object(n.a)(t,i,e)}.bind(void 0,!!a&&!!a.supportPoundStorePath);return{validator:l,askForFileName:s}}}})},"7fa9594be33133790955":function(e,t,r){"use strict";r.d(t,"b",function(){return O}),r.d(t,"a",function(){return S});var a=r("64328bb588b46459132d"),n=r("fcf654cc44d7ec457fe0"),i=r("a4060cda3c9c24220a4a"),o=r("ee92087a6ec1d0e9ecc9"),s=r("65da65eb66805e3724ff"),l=r("abb5ebf715fcba560443"),c=r("56aac858adc5742217b8"),u=r("578e5017557fc66bb247"),d=r("4e318b84c4772f9f58b9"),b=r("d27387ede93a2620cbf6"),f=r("680b7ac74280293b48f0"),m=r("3da5d317c00adfe8f79c"),p=r("fdbcb7664c17b5b4e4d9"),v=r("5fef64b3561abb2ebffa"),h=r("6578506114fc52cc91d3"),g=r("a9dd204dd0bee7467912"),y=r("06bd4399cef6e6b5593c"),U=-2147023080,w=-2130575282,I="-2130575257",_="-2130575245",F="-2130247139",O=Object(f.e)({mergeForSameItemKey:!1,maxParallelOperationCount:8})(function(e){var t=this,r=e.itemKey,f=e.options.folders;return function(e){return a.__awaiter(t,void 0,void 0,function(){var t,h,g,U,w,O,j,k,C,T,D;return a.__generator(this,function(P){switch(P.label){case 0:return g=Object.keys(f)[0],U=i.D.deserialize(r),w=U.rootFolder||new n.SimpleUri(U.listFullUrl).path,O=i.K.serialize({webAbsoluteUrl:U.webAbsoluteUrl,listFullUrl:U.listFullUrl}),j=e(Object(u.a)({list:o.nb},O)),k=S({webAbsoluteUrl:U.webAbsoluteUrl,listFullUrl:U.listFullUrl,parentFolderPath:w,isDocLib:!!j&&!!j.list&&j.list.isDocumentLibrary,folderName:g,needItemDetails:!1}),[4,e(Object(s.b)({webAbsoluteUrl:U.webAbsoluteUrl,listFullUrl:U.listFullUrl,url:k,method:"POST",qosName:"createFolder",qosHandler:function(e){var t=e.code;return t&&(t.indexOf(I)>-1||t.indexOf(_)>-1||t.indexOf(F)>-1)?{resultType:y.b.expectedFailure}:{resultType:y.b.failure}}})).catch(function(e){if(e instanceof l.a&&e.message&&w){var t=w;"/"===t[0]&&(t=t.substr(1)),"/"!==t[t.length-1]&&(t+="/"),e.message=e.message.replace(t,"")}throw new c.a({innerError:e,facets:A(e)})})];case 1:return P.sent(),(C=f[g].progressItemKey)&&(T=w+"/"+g,D=i.D.serialize({webAbsoluteUrl:U.webAbsoluteUrl,listFullUrl:U.listFullUrl,rootFolder:T}),e(Object(d.a)({items:(t={},t[C]=a.__assign({},m.f.pack({itemKey:D})),t[D]=a.__assign({},o.R.pack(T),v.parentFolderItemFacet.pack({itemKey:r})),t)}))),e(Object(b.b)({items:(h={},h[r]=[p.b],h)})),[2]}})})}});function S(e){var t=e.webAbsoluteUrl,r=e.listFullUrl,a=e.parentFolderPath,n=e.isDocLib,i=void 0===n||n,o=e.needItemDetails,s=void 0!==o&&o,l=e.folderName,c=Object(h.getWebApiUrl)({webAbsoluteUrl:t,listOrItemFullUrl:r}),u=l?l.trim():"";return i?(c=(c=c.segment("folders")).methodWithAliases("AddUsingPath",{DecodedUrl:a+"/"+u,overwrite:!1}),s&&(c=c.oDataParameter("$Expand","ListItemAllFields"))):c=c.methodWithAliases("GetFolderByServerRelativePath",{DecodedUrl:a}).methodWithAliases("AddSubFolderUsingPath",{DecodedUrl:u||"Folder"+(Math.floor(100*Math.random())+1)}),c.toString()}function A(e){if(e instanceof l.a)switch(function(e){var t=e.errorData.code;return(void 0===t?"":t).split(",").map(function(e){return Number(e)})[0]}(e)){case U:case w:return g.n.pack({})}}},"809072ae40093b380229":function(e,t,r){"use strict";r.d(t,"a",function(){return a});var a=new(r("447964f318fe44ff3682").a)("updateItem")},"83f2d47bcced97f0a85c":function(e,t,r){"use strict";r.d(t,"a",function(){return a});var a=new(r("264a40ebead766e0e784").ControlFacet)("getDriveItemFullUrlControl")},"841f56ac50e8881a27e3":function(e,t,r){"use strict";r.d(t,"b",function(){return i}),r.d(t,"a",function(){return o});var a=r("9ba97cc998d0be4df04a"),n=r("b32a03546c11ac251a10");function i(e,t){var r=Object(a.deserializeQuery)(e).id;return t&&t.urlParts&&(r===t.urlParts.fullListUrl||r===t.urlParts.serverRelativeListUrl)&&(r=void 0),r}function o(e,t){var r=e;return 0!==r.indexOf("id")&&(r=Object(n.serializeQuery)({id:e,listurl:t})),r}},"90e9dbb8f74ee9c49c51":function(e,t,r){"use strict";r.r(t),r.d(t,"getDocExtension",function(){return n}),r.d(t,"getDialogTitle",function(){return i});var a=r("1adfad17f632aad72441");function n(e){switch(e){case a.a.Word:return".docx";case a.a.Excel:case a.a.ExcelSurvey:case a.a.ExcelForm:return".xlsx";case a.a.PowerPoint:return".pptx";case a.a.OneNote:return"";case a.a.Text:return".txt";case a.a.Visio:return".vsdx";case a.a.Bohemia:return".b";case a.a.Prague:return".prague"}}function i(e,t){var r="";switch(e){case a.a.Word:r=t.CreateWord;break;case a.a.Excel:r=t.CreateExcel;break;case a.a.PowerPoint:r=t.CreatePowerPoint;break;case a.a.OneNote:r=t.CreateOneNote;break;case a.a.ExcelSurvey:r=t.CreateExcelSurvey;break;case a.a.Text:r=t.CreateText;break;case a.a.ExcelForm:r=t.CreateFormForExcel;break;case a.a.Visio:r=t.CreateVisio;break;case a.a.Bohemia:r=t.CreateBohemia;break;case a.a.Prague:r=t.CreatePrague}return r}},"91cddda488609bc98b32":function(e,t,r){"use strict";r.d(t,"a",function(){return i}),r.d(t,"b",function(){return o});var a=r("fdbcb7664c17b5b4e4d9"),n=r("578e5017557fc66bb247");function i(e,t){return function(r){var i=r(Object(n.a)({schema:a.f},t)).schema,o=i&&i.columnKeys,s=[];if(o)for(var l=0,c=o;l<c.length;l++){var u=c[l],d=r(Object(n.a)(e,u));s.push(d)}return s}}function o(e,t){var r=t.mapping,n=t.itemSetKey,i=e.demandItemFacet(a.f,n),o=i&&i.columnKeys,s=[];if(o)for(var l=0,c=o;l<c.length;l++){var u=c[l],d=e.demandItem(r,u);s.push(d)}return s}},a3886a89b418632a97c5:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("64328bb588b46459132d"),n=r("cd86271a21b3a4d18be3"),i=r("1c8f7532950b71f6d754"),o=r("e2ea1f13f9b3e771ed24"),s=r("ad8edfa16f4c343f7dce"),l=r("d8376f4535401b5bd67a"),c=r("87e95cd1ff4b249d307f"),u=r("4e087ea06522888b2152"),d=r("d0af51c98de7406fa9c5"),b=r("c1a09d7dd35e11297e15"),f=r("67e255264eb84e65a5f6");t.isAvailableBasic=f.isAvailableBasic;var m={ODB:1234};function p(e,t,r,a,n){var i=r.fullItemUrl;return n&&(i=r.fullListUrl),g(t,i,e,n)}function v(e,t,r,a,n){return g(a,r.getItemUrlParts(e).fullItemUrl,t)}function h(e,t,r,n,i){return a.__awaiter(this,void 0,void 0,function(){var o,f,m,p,v;return a.__generator(this,function(a){switch(a.label){case 0:return o=(new Date).getTime().toString(),t=s.WopiHelper.AddWopiPerfMarkToTargetUrl(o,"DocLib",t),f=new b.default,i?t&&(r.setImmediate(function(){var e;return d.navigateViaPost({postdata:(e={},e.access_token=i,e),url:t,document:n.document})}),f.complete()):(void 0,p=function(e){var t,r=e.getErrorResponseText();return t="string"==typeof r?r:JSON.stringify(r),c.default.logError("CreateDocumentByDocAspxCore: "+t),f.error(),{resultType:u.ResultTypeEnum.Failure}},v=function(e){return m=e,t&&r.setImmediate(function(){var e;return d.navigateViaPost({postdata:(e={},e.__REQUESTDIGEST=m,e),url:t,document:n.document})}),f.complete(),{resultType:u.ResultTypeEnum.Success}},new l.default({webAbsoluteUrl:e}).ensureRequestDigest(v,p)),[4,f.getPromise()];case 1:return a.sent(),[2]}})})}function g(e,t,r,a){if(null!==r&&(r===o.DocumentType.Word||r===o.DocumentType.PowerPoint||r===o.DocumentType.Prague||r===o.DocumentType.Bohemia||r===o.DocumentType.Visio&&function(e){return n.isSPFeatureEnabled(m,e.ExpFeatures)})){var s=new i.default(e);return s.setQueryParameter("docliburl",encodeURI(t)),s.setQueryParameter("doctype",r.toString()),s.setQueryParameter("action","editnew"),s.setQueryParameter("odsp","1"),a&&s.setQueryParameter("folderGuid",a),s.toString()}throw new Error("document type is not valid, doc.aspx createNew only support type: 1 - Word, 3 - PowerPoint, 8 - Visio, 9-Bohemia, 10 - Prague for the time being.")}function y(e){return!!(e&&e.properties&&e.properties.commandsSupported&&e.properties.commandsSupported.canShareLinkForNewDocument)}a.__exportStar(r("f805b591e29f83f7dfba"),t),t.isAvailable=function(e,t,r,n,i,o,s){var l=a.__assign({},r,{canShareLinkForNewDocument:y(t)});return f.isAvailableBasic(e,l,n,i,o,s)},t.isSupported=function(e,t,r,a,n,i){if(t===o.DocumentType.ExcelForm)return f.getCanCreateMsForm(r)?(i(),!1):(a&&a.getShareByLinkInfo().then(function(t){Boolean(t)&&t.isExternalSharingTipEnabled&&y(e)?i():n()},function(e){n()}),!1);return t!==o.DocumentType.Visio||f.getCanCreateVisioDrawing(r)},t.shouldCreateInOfficeClient=function(e,t,r){return!(!t||e!==o.DocumentType.Word||"dot"!==r)},t.getCreateDocumentByDocAspxUrlWithItemUrlParts=p,t.getCreateDocumentByDocAspxUrl=v,t.createDocumentByDocAspx=function(e,t,r,a,n,i,o){return h(n,v(e,t,r,a),i,window.open("","_blank"))},t.createDocumentByDocAspxWithItemUrlParts=function(e,t,r,n,i,o,s,l,c){return a.__awaiter(this,void 0,void 0,function(){var o;return a.__generator(this,function(a){switch(a.label){case 0:return o=p(e,t,s,0,c),[4,h(r,o,n,i,l)];case 1:return a.sent(),[2]}})})}},a6863df67c52b2d32415:function(e,t,r){"use strict";var a=r("4986dedaa57d766e48bb")._mbDabxjGbDpso2fDZQAQog;t.a=a},aa420188fc5b81d114ba:function(e,t,r){"use strict";r.d(t,"a",function(){return h});var a=r("64328bb588b46459132d"),n=r("a4060cda3c9c24220a4a"),i=r("e7d0f86dd5b257f52558"),o=r("680b7ac74280293b48f0"),s=r("578e5017557fc66bb247"),l=r("c21819129ba64362c121"),c=r("447964f318fe44ff3682"),u=r("3da5d317c00adfe8f79c"),d=r("fdbcb7664c17b5b4e4d9"),b=r("5f6c4af8cb56376acb4d"),f=r("bb1d3dd843cb19bcdb5a"),m=r("fcf654cc44d7ec457fe0"),p=r("3d240143e32215cc23a5"),v=r("ee92087a6ec1d0e9ecc9"),h=Object(o.e)({mergeForSameItemKey:!1,maxParallelOperationCount:3,timeout:864e5})(function(e){var t=this,r=e.itemKey,o=e.options.sourceEntries,h=n.D.deserialize(r),g=h.webAbsoluteUrl,y=h.listFullUrl,U=Object.keys(o)[0],w=o[U].progressItemKey;return function(o){return a.__awaiter(t,void 0,void 0,function(){var t,I,_,F,O,S,A,j,k,C;return a.__generator(this,function(T){switch(T.label){case 0:return F=o(Object(s.a)({sourceFile:l.b},U)).sourceFile,O=o(Object(p.a)({listItemUploader:v.qb})).listItemUploader,S=void 0===O?i.a:O,[4,o(S(e))];case 1:return A=T.sent().itemKey,j=new b.a,w&&F&&j.resolveItems({items:(t={},t[w]=a.__assign({},u.f.pack({itemKey:A}),Object(c.d)({progressSize:u.r},{progressSize:{current:F.size}})),t)}),j.invalidateItems({items:(I={},I[r]=[d.b],I)}),h.listFullUrl&&(k=new m.SimpleUri(h.listFullUrl+"/Forms").path,h.rootFolder&&(h.rootFolder+"/").slice(0,k.length+1)===k+"/"&&(C=n.K.serialize({webAbsoluteUrl:g,listFullUrl:y}),o(Object(f.a)({items:(_={},_[C]={childItemKey:A},_)})))),o(j.execute()),[2]}})})}})},ad8edfa16f4c343f7dce:function(e,t,r){"use strict";r.r(t);var a=r("79e915d08705ece7df42");r.d(t,"WopiHelper",function(){return a.a})},ad8efa7bc4029814972d:function(e,t,r){"use strict";var a;r.d(t,"a",function(){return a}),function(e){e[e.Publish=0]="Publish",e[e.Republish=1]="Republish",e[e.PostNews=2]="PostNews",e[e.UpdateNews=3]="UpdateNews",e[e.SubmitForApproval=4]="SubmitForApproval",e[e.CancelApproval=5]="CancelApproval",e[e.SchedulePublish=6]="SchedulePublish"}(a||(a={}))},b2dbb7eef606ed6d52ff:function(e,t,r){"use strict";r.d(t,"a",function(){return o});var a=r("cdb9a7d2db44c7a9f4dd"),n=r("c0ec8ed08a9b4b107886"),i=r("37b99d1e7f0c88452ea0"),o=function(){function e(){}return e.getBatchOperationUrl=function(e,t){return new n.ApiUrlHelperBasic({webAbsoluteUrl:!e&&t?new i.a(t).authority:e}).build().segment("$batch").toString()},e.processErrorResponse=function(e,t){var r={id:t};if((e=e.error?e.error:e)&&e.code){var a=e.code?e.code.split(","):e.error.code.split(","),n=Number(a[0]),i=e.message.value;r.error={code:n,message:i}}return{items:[r]}},e.getBatchResponseText=function(e){var t,r,a,n=[];if(e.split("\n").length>0&&(t=e.split("\n")[0]),t){r=(e=e.replace(t.trim()+"--","")).split(t);for(var i=1;i<r.length;i++)(a=r[i].split("\n\r")).length>2&&n.push(a[2])}return n},e.processBatchResponse=function(e,t,r){var a,n,i,o,s=[],l=!1;if(e.split("\n").length>0&&(a=e.split("\n")[0]),a){n=(e=e.replace(a.trim()+"--","")).split(a);for(var c=1;c<n.length;c++)if((i=n[c].split("\n\r")).length>2){try{o=JSON.parse(i[2])}catch(e){o=i[2]}var u=t&&t[c-1],d=u?{key:u.key,id:u.id,newId:r?r+"/"+u.name:null}:{};if((o=o.error?o.error:o)&&o.code){var b=o.code?o.code.split(","):o.error.code.split(","),f=Number(b[0]),m=o.message.value;d.error={code:f,message:m},l=!0}s.push(d)}}return{items:s,hasError:l}},e.getBatchContent=function(e,t,r,n){for(var i=[],o=0;o<t.length;o++){for(var s=t[o],l=a.default.generate(),c=[],u=0;u<s.length;u++){var d=s[u];c.push("--changeset_"+l),c.push("Content-Type: application/http"),c.push("Content-Transfer-Encoding: binary"),c.push(""),c.push(r+" "+d+" HTTP/1.1"),c.push(n),c.push("")}c.push("--changeset_"+l+"--");var b=c.join("\r\n");i.push("--batch_"+e),i.push('Content-Type: multipart/mixed; boundary="changeset_'+l+'"'),i.push("Content-Length: "+b.length),i.push("Content-Transfer-Encoding: binary"),i.push(""),i.push(b),i.push("")}return i.push("--batch_"+e+"--"),i.join("\r\n")},e.getBatchContentExtended=function(e,t,r,n,i,o,s){var l=a.default.generate(),c=[];i&&i.length!==t.length&&(i=null);for(var u=0;u<t.length;u++){var d=t[u];c.push("--changeset_"+l),c.push("Content-Type: application/http"),c.push("Content-Transfer-Encoding: binary"),c.push(""),s?c.push(s[u]+" "+d+" HTTP/1.1"):c.push(r+" "+d+" HTTP/1.1"),c.push(n),o&&c.push(o),i&&(c.push(""),c.push(i[u])),c.push("")}c.push("--changeset_"+l+"--");var b=c.join("\r\n");return(c=[]).push("--batch_"+e),c.push('Content-Type: multipart/mixed; boundary="changeset_'+l+'"'),c.push("Content-Length: "+b.length),c.push("Content-Transfer-Encoding: binary"),c.push(""),c.push(b),c.push(""),c.push("--batch_"+e+"--"),c.join("\r\n")},e.defaultBatchRequestPostData="Content-Type: application/json;odata=verbose",e.defaultBatchAcceptData="accept: application/json;odata=verbose",e}();t.b=o},b421a7d74d9df5c18287:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){}return e.startExitingQuickEditEventName="startExitingQuickEdit",e.quickEditWriteChangesToListEventName="quickEditWriteChangesToList",e.deleteCompletedEventName="quickEditDeleteCompleted",e}();t.SPGridEvents=a,t.default=a},b5db9256ae40e35e1f53:function(e,t,r){"use strict";r.r(t),r.d(t,"ItemUpdateRatingExecutor",function(){return l});var a=r("64328bb588b46459132d"),n=r("01e9cd72f63f0c70ab1c"),i=r("958db96f3e5e5318cd6e"),o=r("44e6ed3c2eaab3f422db"),s=r("800956ab6ff71efe3834"),l=Object(i.connectToItemCache)(function(e,t){var r=t.itemKey,i=t.currentRating,o=e.dispatch;return a.__assign({onExecute:function(){return a.__awaiter(void 0,void 0,void 0,function(){var e;return a.__generator(this,function(t){switch(t.label){case 0:return[4,o(Object(n.a)({items:(e={},e[r]={userNewRating:i},e)}))];case 1:return t.sent(),[2]}})})},isAvailable:!0},Object(s.getItemActionEngagement)(e,{itemKey:r,engagement:{name:"UpdateRating",isIntentional:!0}}))})(o.a)},b81c06e530b532b544de:function(e,t,r){"use strict";r.r(t);var a,n=r("ba9b9c401d4d91d63e29");!function(e){e.getFilterData=function(e,t,a){var i=[];e=e.split("<br>")[0];var o=document.createElement("DIV");o.innerHTML=e;var s=o.querySelector("#diidFilter"+t);if(null!=s)for(var l=s.childNodes.length,c=s.childNodes,u=1;u<l;u++){var d=n.a.getText(c[u]),b=c[u].value.toString(),f={display:d,value:b};if(a){var m=r(b);m.filterType&&(f.value=m.value,f.calculatedFieldOriginFilterValue=b,f.calculatedFieldFilterType=m.filterType,i.push(f))}else i.push(f)}for(var p={},v=0,h=i;v<h.length;v++)(U=h[v]).display in p?p[U.display]++:p[U.display]=1;for(var g=0,y=i;g<y.length;g++){var U;p[(U=y[g]).display]>1&&(U.display=U.value)}return i};var t=["Text","Text","Text","Text","Text","Number","Text","DateTime","Text","Text","Error","Boolean"];function r(e){var r=e.indexOf("_"),a=e,n=void 0;if(r>0){a=e.substring(r+1);var i=Number(e.substring(0,r));!isNaN(i)&&i<t.length&&(n=t[i])}return{value:a,filterType:n}}e.getCalculatedFieldFilterValueAndType=r}(a||(a={})),t.default=a},bb1d3dd843cb19bcdb5a:function(e,t,r){"use strict";r.d(t,"b",function(){return i}),r.d(t,"a",function(){return o});var a=r("447964f318fe44ff3682"),n=r("022addba5cf25ce091fb"),i=new a.a("saveUploadedTemplateToView"),o=Object(n.e)({operationTypeFacet:i})},bb35b6a9f7d825abb325:function(e,t,r){"use strict";var a=function(){function e(e){if(this._features=new Map,!e)throw new Error("Cannot create SPFeatureInfo object, incoming data is undefined.");for(var t in e)if(void 0!==t){var r=e[t];this._features.set(t,{version:r.Version,enabled:r.Enabled})}}return e.prototype._serialize=function(){var e={};return this._features.forEach(function(t,r){e[r]={Version:t.version,Enabled:t.enabled}}),e},e.prototype.get=function(e){if(!e||e&&0===e.length)throw new Error("Cannot get feature, featureName input is empty or undefined");return this._features.get(e)},e}();t.a=a},c21819129ba64362c121:function(e,t,r){"use strict";r.d(t,"a",function(){return n}),r.d(t,"b",function(){return i});var a=r("447964f318fe44ff3682"),n=new a.a("entryBatch"),i=new a.a("sourceFile")},c317bf72559990179c22:function(e,t,r){"use strict";r.r(t);var a,n=r("64328bb588b46459132d"),i=r("680b7ac74280293b48f0"),o=r("022addba5cf25ce091fb"),s=r("6187b1a01125644c0b13"),l=r("be9ddcf0ec56bc42b1b1"),c=r("c8af1cc43f0b61ba9a17"),u=r("a4060cda3c9c24220a4a"),d=r("0be8895c37c7580fa8d6"),b=r("c89079fccee5039e5e63"),f=r("14430bb116eaf260acb8"),m=r("01e9cd72f63f0c70ab1c"),p=r("2abad5c842761f84fba3"),v=r("6c29d4d64a53c3f12405"),h=r("6946c0f0887243183999"),g=r("a083584f8eeab8771a10"),y=r("bd2835d22f85a2b6d99d"),U=r("95da7825c4969f34e250"),w=r("c88e7380c3f2d1910abe"),I=r("447964f318fe44ff3682");!function(e){e[e.preview=0]="preview",e[e.save=1]="save"}(a||(a={}));var _=new I.a("updateColumnFormatter"),F=(Object(o.e)({operationTypeFacet:_}),r("4e318b84c4772f9f58b9")),O=r("894f2391cc313a7da701"),S=r("5fef64b3561abb2ebffa"),A=r("fdbcb7664c17b5b4e4d9"),j=r("ee92087a6ec1d0e9ecc9"),k=r("51544a23f67b5dfbf4ba"),C=r("5f6c4af8cb56376acb4d");function T(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,a,i,o;return n.__generator(this,function(s){switch(s.label){case 0:return a=u.A.deserialize(e.itemKey).tenantRootUrl,i=new C.a,[4,r(Object(k.b)({tenantRootUrl:a}))];case 1:return o=s.sent(),i.resolveItems({items:(t={},t[e.itemKey]=n.__assign({},j.jc.pack(o.resource),j.ic.pack(o.payloadHeader)),t)}),r(i.execute()),[2]}})})}}var D=r("52ea8189ec1bd7bba704"),P=r("a6863df67c52b2d32415");function x(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,a,i,o,s,l;return n.__generator(this,function(c){return a=u.k.deserialize(e.itemKey).tenantRootUrl,i=new C.a,o=u.y.serialize({tenantRootUrl:a}),s=u.x.serialize({tenantRootUrl:a}),l=[o,s],i.resolveItems({items:(t={},t[o]=n.__assign({},D.f.pack(!0),S.displayNameFacet.pack(P.a.frequent),j.Fb.pack({itemKey:e.itemKey})),t[s]=n.__assign({},D.f.pack(!0),S.displayNameFacet.pack(P.a.followed),j.Fb.pack({itemKey:e.itemKey})),t[e.itemKey]=n.__assign({},S.displayNameFacet.pack(P.a.sites),D.f.pack(!0),A.a.pack({itemKeys:l})),t)}),r(i.execute()),[2]})})}}var N=r("db7b01b1853a9a275b02"),K=r("d27387ede93a2620cbf6"),R=r("3d240143e32215cc23a5");function E(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,a,i,o,s,l,c,d;return n.__generator(this,function(b){switch(b.label){case 0:return a=u.y.deserialize(e.itemKey).tenantRootUrl,i=new C.a,[4,r(L(a))];case 1:return o=b.sent(),s=[],l=u.k.serialize({tenantRootUrl:a}),c=void 0,d=void 0,o&&o.Items&&o.Items.forEach(function(t,r){var a,b=u.Y.serialize({webAbsoluteUrl:t.Url}),f=u.I.serialize({webAbsoluteUrl:t.Url}),m=t.ItemReference||{},p=m.SiteId,v=void 0===p?void 0:p,h=m.WebId,g=void 0===h?void 0:h,y=m.GroupId,U=void 0===y?void 0:y,w=u.i.serialize({rootItemKey:l,itemKey:b});c=o.Items[r-1]&&o.Items[r-1].PinOrder,d=o.Items[r+1]&&o.Items[r+1].PinOrder,i.resolveItems({items:(a={},a[b]=n.__assign({},S.displayNameFacet.pack(t.Title),j.a.pack(t.Acronym),j.c.pack(t.BannerColor),j.d.pack(t.BannerImageUrl),j.ib.pack(!0),S.folderFacet.pack({}),j.Sb.pack(t.Weight),u.Y.pack({webAbsoluteUrl:t.Url}),j.Rb.pack(v),j.Cc.pack(g),j.Y.pack(U),A.b.pack({itemKey:f})),a[w]=n.__assign({},j.Kb.pack(c),j.Hb.pack(t.PinOrder),j.Cb.pack(d),Object(K.a)().forFacet(j.Hb).thenInvalidate(e.itemKey,A.a).pack()),a[f]=n.__assign({},A.e.pack({itemKey:b})),a)}),s.push(b)}),i.resolveItems({items:(t={},t[e.itemKey]=n.__assign({},S.displayNameFacet.pack(P.a.frequent),A.a.pack({itemKeys:s}),j.Fb.pack({itemKey:l})),t)}),r(i.execute()),[2]}})})}}function L(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,a;return n.__generator(this,function(n){switch(n.label){case 0:return t=r(Object(R.a)({enableSitePinningConfiguration:j.J})).enableSitePinningConfiguration,a=t?N.b:N.a,[4,r(Object(k.d)(e,void 0,a))];case 1:return[2,n.sent()]}})})}}function z(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,a,i,o;return n.__generator(this,function(s){return a=u.Y.deserialize(e.itemKey).webAbsoluteUrl,i=new C.a,o=u.I.serialize({webAbsoluteUrl:a}),i.resolveItems({items:(t={},t[e.itemKey]=n.__assign({},A.b.pack({itemKey:o})),t)}),r(i.execute()),[2]})})}}var q=r("5e76ddf6bb30811ee697"),B=r("7f44f3b6edbad81cb558"),M=r("843ee82c211d203b19c9");function V(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,a,i,o,s,l,c,d,b,f,m,p,v,h,g;return n.__generator(this,function(y){switch(y.label){case 0:return i=u.I.deserialize(e.itemKey).webAbsoluteUrl,o=u.Y.serialize({webAbsoluteUrl:i}),s=new C.a,[4,r(Object(k.e)({webAbsoluteUrl:i}))];case 1:for(l=y.sent(),c=[],d=0,b=l.d.GetDocumentLibraries.results;d<b.length;d++)f=b[d],m=new q.a({context:{webAbsoluteUrl:i}}),p=m.getUrlParts({webUrl:i,listUrl:f.AbsoluteUrl,path:f.AbsoluteUrl}),v={webAbsoluteUrl:i,listFullUrl:p.fullListUrl||"",rootFolder:""},h=u.D.serialize(v),g=u.s.serialize({webAbsoluteUrl:i,listFullUrl:p.fullListUrl||"",rootFolder:""}),s.merge(r(Object(M.a)({itemKey:h,spItem:v})).itemResolver),s.resolveItems({items:(t={},t[h]=n.__assign({},S.displayNameFacet.pack(f.Title)),t[g]=n.__assign({},A.e.pack({itemKey:h})),t)}),c.push(h);return s.resolveItems({items:(a={},a[e.itemKey]=n.__assign({},A.a.pack({itemKeys:c}),Object(K.a)().forFacet(A.a).thenInvalidate(B.a).pack(),u.Y.pack({webAbsoluteUrl:i}),A.e.pack({itemKey:o})),a)}),r(s.execute()),[2]}})})}}var W=r("e17f546ab8812a549d96"),G=Object(W.forModuleExport)(Object(W.asModuleWithRetries)(function(){return r.e(22).then(r.bind(null,"3c62924e412c49098f54"))},{chunkName:"sphomeaddondataonlydeferred"}),"getSPFollowedSitesItemSet"),H=Object(i.b)(function(){return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var t=this;return n.__generator(this,function(r){return e(Object(F.b)({keyFacet:u.Y,facets:[S.displayNameFacet,A.b]})),e(Object(F.b)({keyFacet:u.x,facets:[u.x,A.a]})),e(Object(F.b)({keyFacet:u.y,facets:[u.y,A.a]})),e(Object(F.b)({keyFacet:u.I,facets:[u.I,A.a,A.b]})),e(Object(o.g)(u.A,l.a)(Object(i.e)({maxParallelOperationCount:4})(T))),e(Object(o.g)(u.k,l.a)(Object(i.e)()(x))),e(Object(o.g)(u.y,l.a)(Object(i.e)()(E))),e(Object(o.g)(u.Y,l.a)(Object(i.e)({maxParallelOperationCount:4})(z))),e(Object(o.g)(u.I,l.a)(Object(i.e)({maxParallelOperationCount:8})(V))),e(Object(o.g)(u.x,l.a)(Object(i.d)(function(){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,e(Object(O.h)())];case 1:return t.sent(),[4,G()];case 2:return[2,t.sent()]}})})}))),[2]})})}}),Q=Object(i.e)()(function(e){var t=this,r=e.itemKey,a=u.a.deserialize(r).tenantRootUrl;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,i;return n.__generator(this,function(o){return(i=new C.a).resolveItems({items:(t={},t[r]=n.__assign({},A.a.pack({itemKeys:[u.h.serialize({tenantRootUrl:a}),u.k.serialize({tenantRootUrl:a})]})),t)}),e(i.execute()),[2]})})}});var J=r("c70c28d41140929c0281"),X=r("eef09ec91afb2fd77b66"),Y=r("2852e19dad7ee30e33c6"),$=r("6d69c5cabadd78126515"),Z=r("3bf2a7a98948db65e3cd"),ee=r("1cd056c2adb66ad46336"),te=r("fe8b4b32c8cba14e51b0"),re=r("319d5d68379b759dd907"),ae=r("a505b70e22ed4009b15b"),ne=r("8f99e6f92d80fbcf38ae"),ie=Object(i.e)()(function(e){var t=this,r=e.itemKey,a=u.h.deserialize(r).tenantRootUrl;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,i,o,s,l,c,d,b,f,m,p,v,h,g,y,U,w,I,_,F,O;return n.__generator(this,function(k){switch(k.label){case 0:return o=new C.a,[4,e(Object(J.demandItems)(function(e){var t=u.O.serialize({tenantRootUrl:a});return e.demandItemFacet(u.D,t,{suppressGetItems:!1})}))];case 1:return(s=k.sent())?[4,e(Object(J.demandItems)(function(e){return e.demandItemFacet(j.qc,u.Q.serialize({webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl}))}))]:[2];case 2:for(l=k.sent(),c=e(Object(X.a)(function(e){var t=e.demandItemFacet($.enableFollowItemConfigurationFacet,$.configurationItemKey),r=!!e.demandItemFacet(ne.i,$.configurationItemKey);return{isSavedForLaterEnabled:t,isSharedWithMeEnabled:r}})),d=c.isSavedForLaterEnabled,b=c.isSharedWithMeEnabled,f={},m=l&&l.userDisplayName,p=u.D.serialize(s),f[p]={icon:"FabricFolder",displayName:ae.a.files},v=ee.a.serialize({endpoint:a+"/_api/v2.0"}),f[v]={icon:"History",displayName:Z.a.recentTitle},h=te.a.serialize({endpoint:a+"/_api/v2.0"}),f[h]={icon:"SingleBookmark",displayName:Z.a.saved},g=re.a.serialize({endpoint:""+a}),f[g]={icon:"People",displayName:Z.a.sharedWithMe},y=[p,v].concat(b?[g]:[],d?[h]:[]),U=0,w=y;U<w.length;U++)I=w[U],_=f[I],F=_.icon,O=_.displayName,o.resolveItems({items:(t={},t[I]=n.__assign({},Y.b.pack(F),S.displayNameFacet.pack(O),S.folderFacet.pack({})),t)});return o.resolveItems({items:(i={},i[r]=n.__assign({},A.a.pack({itemKeys:y}),S.displayNameFacet.pack(m)),i)}),e(o.execute()),[2]}})})}});var oe=r("b32a03546c11ac251a10"),se=Object(i.e)({mergeForSameItemKey:!1})(function(e){var t=this,r=Object.keys(e.options),a=e.itemKey,i=r[0],o=e.options[i],s=o.type,l=o.reorderPinInfo,c=u.i.serialize({itemKey:i,rootItemKey:a});return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,r,o,d,b,f,m,p,v;return n.__generator(this,function(h){switch(h.label){case 0:return o=e(Object(X.a)(function(e){return e.demandItem({siteId:j.Rb,webId:j.Cc,groupId:j.Y},i)})),d=o.siteId,b=o.webId,f=o.groupId,m=new C.a,p=function(e,t){switch(e){case"pin":return ce();case"unpin":return;case"reorderPin":if(t){var r=t.nextPinOrder,a=t.prevPinOrder;if(r||a)return a?r?(a+r)/2:a/2:ce()}return;default:return}}(s,l),m.resolveItems({items:(t={},t[c]=n.__assign({},j.Hb.pack(p)),t)}),e(m.execute()),(v=u.k.deserialize(a).tenantRootUrl)?[4,e(le(v,{siteId:d||"",webId:b||"",groupId:f},s,l))]:[3,2];case 1:h.sent(),(m=new C.a).invalidateItems({items:(r={},r[c]=[j.Hb],r)}),e(m.execute()),h.label=2;case 2:return[2]}})})}});function le(e,t,r,a){var i=this;return function(o){return n.__awaiter(i,void 0,void 0,function(){var i,s,l,c,u;return n.__generator(this,function(n){switch(n.label){case 0:if("pin"===r)i="api/v1/sites/pinned/add",s="pinSite";else if("unpin"===r)i="api/v1/sites/pinned/remove",s="unpinSite";else{if("reorderPin"!==r)return[2];if(!a)return[2];l=Object(oe.serializeQuery)({PreviousPinOrder:a.prevPinOrder||"",NextPinOrder:a.nextPinOrder||""},void 0,!0),i="api/v1/sites/pinned/update?"+l,s="reorderSite"}return[4,o(Object(k.b)({tenantRootUrl:e}))];case 1:return c=n.sent(),u="",t&&(u=JSON.stringify({Title:t.title,Acronym:t.acronym,BannerColor:t.color,Url:t.url,Type:"Site",ItemReference:{Type:t.groupId?"GroupReference":"SiteReference",SiteId:t.siteId,WebId:t.webId,GroupId:t.groupId}})),[4,o(Object(k.a)({path:i,method:"POST",qosName:s,context:c,body:u}))];case 2:return n.sent(),[2]}})})}}function ce(e){void 0===e&&(e=new Date);return 621355968e9+1e4*e.getTime()}var ue=new I.a("pinSite"),de=(Object(o.e)({operationTypeFacet:ue}),r("56aac858adc5742217b8")),be=r("65da65eb66805e3724ff"),fe=r("6f13f8350c84cf96896e"),me=r("6578506114fc52cc91d3"),pe=r("a9dd204dd0bee7467912"),ve=Object(i.e)({maxParallelOperationCount:4})(function(e){var t=this,r=e.itemKey,a=u.O.deserialize(r).tenantRootUrl;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,i,o,s,l,c,d,b;return n.__generator(this,function(f){switch(f.label){case 0:return o=Object(me.getStaticApiUrl)({webAbsoluteUrl:a}).segments("SP.Directory.DirectorySession","me").rawParameter("$select=mySite"),[4,r(Object(be.b)({url:o.toString(),qosName:"GetMyOneDriveUrl",method:"POST",webAbsoluteUrl:a,noRedirect:!0}))];case 1:if(!((s=f.sent())&&s.d&&s.d.mySite))throw new de.a({facets:n.__assign({},pe.j.pack({}))});return l=s.d.mySite.replace(/\/$/,""),c={webAbsoluteUrl:l,listFullUrl:l+"/Documents",rootFolder:""},d=u.D.serialize(c),(b=new C.a).mapKeys({mappings:(t={},t[e.itemKey]=d,t)}),b.merge(r(Object(M.a)({itemKey:d,spItem:c})).itemResolver),b.resolveItems({items:(i={},i[d]=n.__assign({},fe.e.pack(u.D)),i)}),r(b.execute()),[2]}})})}});var he=Object(i.b)(function(){return function(e){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){return e(Object(o.g)(u.O,l.a)(ve)),e(Object(o.g)(u.a,l.a)(Q)),e(Object(o.g)(u.h,l.a)(ie)),e(Object(o.g)(u.k,ue)(se)),[2]})})}}),ge=Object(i.e)({maxParallelOperationCount:4})(function(e){var t=this,r=e.itemKey,a=u.W.deserialize(r).tenantRootUrl;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,i,o,s,l,c,d,b,f,m,p,v;return n.__generator(this,function(h){switch(h.label){case 0:return i=u.Z.serialize({webAbsoluteUrl:a}),[4,r(Object(J.demandItems)(function(e){return e.demandItemFacet(j.qc,i)}))];case 1:return o=h.sent(),s=r(Object(X.a)(function(e){return e.demandItemFacet($.localeFacet,$.configurationItemKey)})),l=o&&o.isSPO,d=s&&s.language||"en-US",b=Object(oe.serializeQuery)({Locale:d,v:2,msajax:1,cv:2}),c=l?a+"/_layouts/15/online/handlers/SpoSuiteLinks.ashx?"+b:Object(me.getStaticApiUrl)({webAbsoluteUrl:a}).segments("Microsoft.SharePoint.Portal.SuiteNavData.GetSuiteNavData").parameters({v:2,Locale:d}),[4,r(Object(be.b)({url:c.toString(),qosName:"LoadData",method:"POST",webAbsoluteUrl:a,noRedirect:!0}))];case 2:return f=h.sent(),m=l?f:JSON.parse(f.d.GetSuiteNavData),p=!(!m.NavBarData||!m.NavBarData.AdminLink)||!1,(v=new C.a).resolveItems({items:(t={},t[e.itemKey]=n.__assign({},u.W.pack({tenantRootUrl:a}),j.wc.pack(p)),t)}),r(v.execute()),[2]}})})}});var ye,Ue=Object(i.b)(function(){return function(e){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){return e(Object(o.g)(u.W,l.a)(ge)),[2]})})}});!function(e){e[e.previewColumnFormatter=0]="previewColumnFormatter",e[e.saveColumnFormatter=1]="saveColumnFormatter",e[e.previewViewFormatter=2]="previewViewFormatter",e[e.saveViewFormatter=3]="saveViewFormatter"}(ye||(ye={}));var we=new I.a("updateFormatter"),Ie=(Object(o.e)({operationTypeFacet:we}),r("7e384a9151b866bdf37f")),_e=r("e45a813de720285432ba"),Fe=Object(i.e)({mergeForSameItemKey:!1})(function(e){var t=e.options.formatterMap;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var r,a,i,o,s,l;return n.__generator(this,function(c){switch(c.label){case 0:return i=Object.keys(t)[0],o=t[i],s=o.updateType,l=o.formatter,0!==s?[3,1]:[2,e(Object(F.a)({items:(r={},r[i]=n.__assign({},j.k.pack(l)),r)}))];case 1:return 2!==s?[3,3]:[4,e(Object(J.demandItems)(function(e){e.demandItemFacet(_e.a,_e.b.serialize({}))}))];case 2:return c.sent(),[2,e(Object(F.a)({items:(a={},a[i]=n.__assign({},j.Bc.pack(Object(Ie.a)({formatter:l}))),a)}))];case 3:return[2]}})})}}),Oe=new I.a("modifyFieldProperties"),Se=(Object(o.e)({operationTypeFacet:Oe}),r("578e5017557fc66bb247")),Ae=r("08bf0219777f111bb2c9"),je=Object(i.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options.fields;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var a,i,o,s,l,c,d,b,f;return n.__generator(this,function(m){return a=Object.keys(r)[0],i=r[a],o=i.displayName,s=i.fieldDescription,l=i.showInFiltersPane,(c=e(Object(Se.a)({setKey:u.s},t)).setKey)&&a&&(d=e(Object(Se.a)({id:j.O},a)).id)?(b={__metadata:{type:"SP.Field"},Title:o,SchemaXml:s,ShowInFiltersPane:l},f=Object(me.getListApiUrl)({webAbsoluteUrl:c.webAbsoluteUrl,listFullUrl:c.listFullUrl}).method("Fields",d).toString(),[2,e(Object(be.b)({webAbsoluteUrl:c.webAbsoluteUrl,listFullUrl:c.listFullUrl,url:f,qosName:"modifyFieldProperties",body:JSON.stringify(b),method:"POST",additionalHeaders:{"X-HTTP-Method":"MERGE"}})).then(function(){var t;return e(Object(F.a)({items:(t={},t[a]=n.__assign({},void 0!==l?Ae.c.pack(l):{},void 0!==o?S.displayNameFacet.pack(o):{}),t)}))})]):[2]})})}}),ke=r("dea1b9d7d476fd78f2d7"),Ce=r("5e2d26706bb97efeb013"),Te=Object(i.e)()(function(e){var t=this,r=e.itemKey,a=u.M.deserialize(r),i={webAbsoluteUrl:a.webAbsoluteUrl,listFullUrl:a.listFullUrl,rootFolder:"",viewKey:{viewId:u.g}};return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,a,o;return n.__generator(this,function(n){switch(n.label){case 0:return t=e(Object(ke.c)({itemSetKey:i})),[4,e(Object(ke.b)({itemSetKey:i,contentTypes:t,qosName:"getNeedsAttentionFlag"}))];case 1:a=n.sent(),n.label=2;case 2:return n.trys.push([2,5,,7]),[4,e(Object(Ce.a)(a))];case 3:return o=n.sent(),[4,e(De(o,r))];case 4:return n.sent(),[3,7];case 5:return n.sent(),[4,e(De(void 0,r))];case 6:return n.sent(),[3,7];case 7:return[2]}})})}});function De(e,t){var r=this;return function(a){return n.__awaiter(r,void 0,void 0,function(){var r,i,o,s;return n.__generator(this,function(l){return i=!1,(o=e&&e.ListData&&e.ListData.Row)&&o.length>0&&o[0]&&(i=!0),(s=new C.a).resolveItems({items:(r={},r[t]=n.__assign({},S.missingMetadataFacet.pack(i)),r)}),a(s.execute()),[2]})})}}var Pe=r("24c83cd16592ec8f1822"),xe=r("06bd4399cef6e6b5593c"),Ne=r("cdb9a7d2db44c7a9f4dd"),Ke=r("b2dbb7eef606ed6d52ff"),Re=Object(i.c)()(function(e){var t=e.items;return function(r){return n.__awaiter(void 0,void 0,void 0,function(){var a,o,s,l,c,d,b,f,m,p,v,h,g,y,U,w,I,_,O,A,k,T,D,P,x;return n.__generator(this,function(N){switch(N.label){case 0:for(s=void 0,l=void 0,c=0,d=Object.keys(t);c<d.length;c++)g=d[c],b=r(Object(Se.a)({key:u.D,folderPath:j.R},g)),f=e.items[g],b&&b.key&&b.folderPath&&(s||(l=b.key.listFullUrl,s={webAbsoluteUrl:b.key.webAbsoluteUrl,items:[],checkInOutType:f.checkInOutType,checkInText:f.checkInText,checkInVersionType:f.checkInVersionType},l=b.key.listFullUrl),s.items.push({key:g,itemFullUrl:b.folderPath}));return(m=s)&&m.items.length?(p=m.items.length>1,v=void 0,v="checkIn"===m.checkInOutType?p?"batchCheckInItems":"CheckInItem":"checkOut"===m.checkInOutType?p?"batchCheckOutItems":"CheckOutItem":p?"batchUndoCheckOutItems":"UndoCheckOutItem",h="checkOut"===m.checkInOutType,p?[3,2]:(g=m.items[0].key,y=Ee(m.webAbsoluteUrl,m.items[0].itemFullUrl,m.checkInOutType,m.checkInText,m.checkInVersionType),[4,r(Object(be.b)({webAbsoluteUrl:m.webAbsoluteUrl,listFullUrl:l,url:y,method:"POST",qosName:v}))])):[3,4];case 1:return N.sent(),r(Object(F.a)({items:(a={},a[g]=n.__assign({},S.isCheckedOutFacet.pack({byYou:!!h,byOther:void 0})),a)})),[3,4];case 2:return U=Ne.default.generate(),w="multipart/mixed; boundary=batch_"+U,[4,r(Object(be.b)({webAbsoluteUrl:m.webAbsoluteUrl,listFullUrl:l,url:Ke.b.getBatchOperationUrl(m.webAbsoluteUrl),body:Le(m,U),method:"POST",additionalHeaders:void 0,contentType:w,parseResponse:function(e){return Ke.b.processBatchResponse(e,m.items)},qosName:"batch",successQosHandler:function(e){return{resultType:e.hasError?xe.b.failure:xe.b.success}}}))];case 3:if((I=N.sent()).hasError){for(T={items:{}},D=0,P=I.items;D<P.length;D++)(x=P[D]).error&&x.key&&(T.items[x.key]=new de.a({message:x.error.message}));throw new i.a(T)}for(_=new C.a,O=0,A=m.items;O<A.length;O++)k=A[O],_.resolveItems({items:(o={},o[k.key]=n.__assign({},S.isCheckedOutFacet.pack({byYou:!!h,byOther:void 0})),o)});r(_.execute()),N.label=4;case 4:return[2]}})})}});function Ee(e,t,r,a,n){var i;i="checkIn"===r?"CheckIn":"undoCheckOut"===r?"UndoCheckOut":"CheckOut";var o=Object(me.getWebApiUrl)({webAbsoluteUrl:e,listOrItemFullUrl:t}).methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:t});return(o="checkIn"===r?o.methodWithAliases("CheckIn",{comment:a,checkintype:n||0}):o.segment(i)).toString()}function Le(e,t){var r=e.items,a=Ke.b.defaultBatchRequestPostData,n=r.map(function(t){return Ee(e.webAbsoluteUrl,t.itemFullUrl,e.checkInOutType,e.checkInText,e.checkInVersionType)});return Ke.b.getBatchContentExtended(t,n,"POST",a)}var ze=r("ad8efa7bc4029814972d"),qe=r("c365986aa0ec8ad83727"),Be=Object(i.c)()(function(e){var t=e.items;return function(r){return n.__awaiter(void 0,void 0,void 0,function(){var a,i,o,s,l,c,d,b,f,m,p,v,h,g,y,U,w,I,_,O,S;return n.__generator(this,function(A){switch(A.label){case 0:for(i=void 0,o=void 0,s="",l=!0,c=0,d=Object.keys(t);c<d.length;c++)_=d[c],b=r(Object(Se.a)({key:u.D,folderPath:j.R},_)),f=r(Object(Se.a)({key:u.D,uiVersion:j.yc,contentTypeId:j.h},_)),m=f.uiVersion,p=f.contentTypeId,s=qe.a(m),l=qe.e(p),v=e.items[_],h=r(Object(Se.a)({listItemId:j.pb},_)).listItemId,b&&b.key&&b.folderPath&&(i||(o=b.key.listFullUrl,i={webAbsoluteUrl:b.key.webAbsoluteUrl,items:[],publishActionType:v.publishActionType,publishText:v.publishText},o=b.key.listFullUrl),i.items.push({key:_,itemFullUrl:b.folderPath,listItemId:h}));if(!(g=i)||!g.items.length)return[3,4];y=g.publishActionType===ze.a.SchedulePublish,U=y?"ScheduleItem":"PublishItem",w=0,A.label=1;case 1:return w<g.items.length?(I=g.items[w],_=I.key,O=l&&g.publishActionType!==ze.a.CancelApproval,S=O?function(e,t,r){return e+"/_api/sitepages/pages("+t+")/"+(r?"schedulepublish":"publish")}(g.webAbsoluteUrl,I.listItemId,y):function(e,t,r){var a="Publish";r&&r===ze.a.CancelApproval&&(a="UnPublish");var n=Object(me.getWebApiUrl)({webAbsoluteUrl:e,listOrItemFullUrl:t}).methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:t});return(n=n.segment(a)).toString()}(g.webAbsoluteUrl,g.items[0].itemFullUrl,g.publishActionType),[4,r(Object(be.b)({webAbsoluteUrl:g.webAbsoluteUrl,listFullUrl:o,url:S,body:!y&&O?'{"__metadata":{"type":"SP.Publishing.SitePage"}}':"",method:"POST",qosName:U}))]):[3,4];case 2:A.sent(),""!==s&&r(Object(F.a)({items:(a={},a[_]=n.__assign({},j.yc.pack(s)),a)})),A.label=3;case 3:return w++,[3,1];case 4:return[2]}})})}});var Me=r("31c533de2caeaf8e942c"),Ve=Object(i.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var a,i,o,s,l,c,d,b;return n.__generator(this,function(n){switch(n.label){case 0:return[4,e(Object(Me.a)(t))];case 1:return i=n.sent(),o=i.key,s=i.itemId,l=o.webAbsoluteUrl,c=o.listFullUrl,d=u.K.serialize({webAbsoluteUrl:l,listFullUrl:c}),(b=e(Object(X.a)(function(e){return e.demandItemFacet(j.nb,d)})))&&b.id&&s?[4,e(Object(be.b)({webAbsoluteUrl:l,listFullUrl:c,url:Object(me.getStaticApiUrl)({webAbsoluteUrl:l}).methodWithAliases("Microsoft.Office.Server.ReputationModel.Reputation.SetRating",{listID:b.id,itemID:s,rating:r.userNewRating}).toString(),method:"POST",qosName:"updateRating"}))]:[3,3];case 2:n.sent(),e(Object(K.b)({items:(a={},a[t]=[S.displayNameFacet],a)})),n.label=3;case 3:return[2]}})})}}),We=Object(i.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var a,i,o,s,l,c,d,b;return n.__generator(this,function(n){switch(n.label){case 0:return[4,e(Object(Me.a)(t))];case 1:return i=n.sent(),o=i.key,s=i.itemId,l=o.webAbsoluteUrl,c=o.listFullUrl,d=u.K.serialize({webAbsoluteUrl:l,listFullUrl:c}),(b=e(Object(X.a)(function(e){return e.demandItemFacet(j.nb,d)})))&&b.id&&s?[4,e(Object(be.b)({webAbsoluteUrl:l,listFullUrl:c,url:Object(me.getStaticApiUrl)({webAbsoluteUrl:l}).methodWithAliases("Microsoft.Office.Server.ReputationModel.Reputation.SetLike",{listID:b.id,itemID:s,like:r.liked}).toString(),method:"POST",qosName:"updateLikes"}))]:[3,3];case 2:n.sent(),e(Object(K.b)({items:(a={},a[t]=[S.displayNameFacet],a)})),n.label=3;case 3:return[2]}})})}}),Ge=r("fcf654cc44d7ec457fe0"),He=r.n(Ge),Qe=Object(i.e)({maxParallelOperationCount:4})(function(e){var t=this,r=e.itemKey,a=e.options,i=a.newDocumentKey,o=a.extension;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,a,s,l,c;return n.__generator(this,function(d){switch(d.label){case 0:return t=u.D.deserialize(r),a=t.rootFolder||new Ge.SimpleUri(t.listFullUrl).path,s=new q.a({context:{webAbsoluteUrl:t.webAbsoluteUrl,listUrl:t.listFullUrl}}),l=s.getUrlParts({path:a}),c=l.fullItemUrl,[4,e(Object(be.b)({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl,url:Je({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl,parentFolderPath:l.listRelativeItemUrl||"",extension:o}),method:"POST",parseResponse:function(e){return JSON.parse(e)},qosName:"createCustomDocument",noRedirect:!0})).then(function(t){var a,o,s=t&&t.d&&t.d.CreateDocumentWithDefaultName;if(!s)throw"Fail to create custom document";var l=c+"/"+s;e(Object(F.a)({items:(a={},a[i]=n.__assign({},S.displayNameFacet.pack(s),S.canonicalUrlFacet.pack(l)),a)})),e(Object(K.b)({items:(o={},o[r]=[A.b],o)}))})];case 1:return d.sent(),[2]}})})}});function Je(e){var t=e.webAbsoluteUrl,r=e.listFullUrl,a=e.extension,n=e.parentFolderPath;if(!a)throw new Error("document extension is not valid");return Object(me.getListApiUrl)({webAbsoluteUrl:t,listFullUrl:r}).methodWithAliases("CreateDocumentWithDefaultName",{folderPath:n,extension:a}).toString()}var Xe=r("ea854ccf8505a6610cbf"),Ye=r("dafd9db62310f1337c17"),$e=r("2f47541efad2ac2f992e"),Ze=r("3e9477666d09125bf1bf");function et(e){var t=e.sourceView,r=e.deserializedItemSetKey,a=e.appliedFilters,n=new Ye.a(t.getEffectiveViewXml());if(r.sortFieldKey&&n.updateSort({fieldName:r.sortFieldKey,isAscending:r.sortAscending},{overwriteAll:!0}),r.groupByFieldKey&&n.updateGroupBy({group1:{fieldName:r.groupByFieldKey,isAscending:!0}}),a)for(var i in a)if(a.hasOwnProperty(i)){var o=a[i];$e.a(n,o)}try{var s=Object(Ze.a)(t.id,!0);s&&(n.updateColumnWidths(s),Object(Ze.b)(t.id))}catch(e){}return n}var tt=Object(i.e)({mergeForSameItemKey:!1,maxParallelOperationCount:4})(function(e){var t=e.itemKey,r=e.options.views;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var a,i,o,s,l,c,d,b,f,m,p,v,g,y,U,w,I,_,F;return n.__generator(this,function(O){return a=u.L.deserialize(t),i=Object.keys(r)[0],o=r[i],s=o.sourceView,l=o.isPublic,c=o.itemSetKey,d=o.progressItemKey,s&&a?(b=e(Object(Se.a)({deserializedItemSetKey:u.s,filterableSet:j.bc,childItems:A.a,parentItem:A.e,schema:A.f},c)),f=b.deserializedItemSetKey,m=b.filterableSet,p=b.childItems,v=b.parentItem,g=b.schema,(y=f?et({sourceView:s,deserializedItemSetKey:f,appliedFilters:m&&m.appliedFilters}):s).prepareForSaving(),U=Object(me.getListApiUrl)({webAbsoluteUrl:a.webAbsoluteUrl,listFullUrl:a.listFullUrl}).segment("Views").segment("Add"),F=s.getEffectiveAggregatesFieldXml(),[2,e(Object(be.b)({webAbsoluteUrl:a.webAbsoluteUrl,listFullUrl:a.listFullUrl,url:U.toString(),method:"POST",body:JSON.stringify({parameters:{__metadata:{type:"SP.ViewCreationInformation"},Title:i,ViewFields:{__metadata:{type:"Collection(Edm.String)"},results:s.getEffectiveFieldNames()},Query:y.getEffectiveQueryXml(!1),Paged:!0,PersonalView:!l,RowLimit:s.rowLimit}}),qosName:"addView",noRedirect:!0})).then(function(t){var r,a,i;if(!t||!t.d)throw new Error("No view returned by /Views/Add");var o=t.d;I={viewId:Ne.default.normalizeLower(o.Id,!1)},w=new Ye.a(t.d),Object(Ze.c)(w);var s=new C.a;return s.resolveItems({items:(r={},r[u.X.serialize(I)]=n.__assign({},u.X.pack(I),j.Pb.pack(o),j.j.pack(w),j.Qb.pack(!1)),r)}),f&&(_=u.s.serialize(n.__assign({},f,{filterParams:void 0,sortFieldKey:void 0,sortAscending:void 0,groupByFieldKey:void 0,viewKey:I})),s.resolveItems({items:(a={},a[_]=n.__assign({},p?A.a.pack(p):{},v?A.e.pack(v):{},g?A.f.pack(g):{}),a)})),d&&s.resolveItems({items:(i={},i[d]=n.__assign({},u.X.pack(I)),i)}),e(s.execute())}).then(function(){var r,a;if(s.scope||F){var i={};return s.scope&&(i.scope=s.scope),e(Object(R.a)({enableModernColumnTotalsSettings:j.B})).enableModernColumnTotalsSettings&&F&&(i.aggregations=F),e(Object(h.a)({items:(r={},r[t]={views:(a={},a[w.id]=n.__assign({},i),a)},r)}))}}).then(function(){var r,a;return e(Object(K.b)({items:n.__assign((r={},r[t]=[A.a],r),F?(a={},a[u.X.serialize(I)]=[j.Tb],a):{})}))})]):[2]})})}}),rt=Object(i.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options.views,a=u.L.deserialize(t),i=Object.keys(r)[0];return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var o,s,l;return n.__generator(this,function(c){return a&&i?(o=r[i],s=Object(me.getListApiUrl)({webAbsoluteUrl:a.webAbsoluteUrl,listFullUrl:a.listFullUrl}).method("Views",i),l={__metadata:{type:"SP.View"},DefaultView:o.isDefault,Title:o.title},"number"==typeof o.scope&&(l.Scope=o.scope),o.aggregations&&(l.Aggregations=o.aggregations,l.AggregationsStatus="On"),[2,e(Object(be.b)({webAbsoluteUrl:a.webAbsoluteUrl,listFullUrl:a.listFullUrl,url:s.toString(),method:"POST",body:JSON.stringify(l),additionalHeaders:{"X-HTTP-Method":"PATCH"},qosName:"modifyView"})).then(function(){var r,a,s=e(Object(Se.a)({childItems:A.a},t)).childItems;if(s){for(var l=new C.a,c=u.X.serialize({viewId:i}),d=void 0,b=void 0,f=void 0,m=0,p=s.itemKeys;m<p.length;m++){var v=p[m],h=e(Object(Se.a)({view:j.j},v)).view;h&&(h.isDefault&&(d=h,b=v),v===c&&(f=h))}return"boolean"==typeof o.isDefault&&(o.isDefault&&d&&b&&(d.isDefault=!1,l.resolveItems({items:(r={},r[b]=n.__assign({},j.j.pack(d)),r)})),f&&c&&(f.isDefault=o.isDefault,l.resolveItems({items:(a={},a[c]=n.__assign({},j.j.pack(f)),a)}))),e(l.execute())}})]):[2]})})}}),at=r("98da34addf7164483ddc"),nt={key:u.S,displayName:S.displayNameFacet,email:at.emailFacet,picture:at.pictureFacet},it=Object(i.e)()(function(e){var t=this,r=e.itemKey,a=u.f.deserialize(r),i=a&&a.spItem,o=i.webAbsoluteUrl,s=i.listFullUrl,l=i.itemId;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,a,i,c,d,b,f;return n.__generator(this,function(m){switch(m.label){case 0:return a=l&&Object(me.getListApiUrl)({webAbsoluteUrl:o,listFullUrl:s}).method("GetItemById",l).segment("likedByInformation"),i=new C.a,(d=a)?[4,e(Object(be.d)({url:a.toString()+"&$expand=likedby&$top=10",method:"GET",qosName:"likedByInformation",webAbsoluteUrl:o,listFullUrl:s}))]:[3,2];case 1:d=m.sent(),m.label=2;case 2:return b=[],(f=(c=d)&&c.d&&c.d.likedBy&&c.d.likedBy.results)&&f.forEach(function(e){var t,r=e.email,a=u.S.serialize({id:String(r)});i.resolveItems({items:(t={},t[a]=Object(I.d)(nt,{key:{id:String(r)},displayName:e.name,email:r,picture:r}),t)}),b.push(a)}),i.resolveItems({items:(t={},t[r]=n.__assign({},S.likedByPeopleFacet.pack({personKeys:b})),t)}),e(i.execute()),[2]}})})}});var ot=Object(i.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options,a=r.views,i=r.qosName;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var r,o,s,l,c,d,b,f,m,p,v,h,g,y,U,w;return n.__generator(this,function(n){return r=u.L.deserialize(t),o=Object.keys(a)[0],r&&o&&(s=a[o],l=s.itemSetKey,c=s.shouldSaveViewFieldsOnly,d=s.newDocumentTemplatesJsonString,b=s.shouldSaveAggregationsOnly,f=e(Object(Se.a)({deserializedViewKey:u.X,currentDerivedView:j.j},o)),m=f.deserializedViewKey,p=f.currentDerivedView,v=m&&m.viewId,p&&v&&(h=void 0,c||d||b?p.baseViewXml&&(h=new Ye.a(p.baseViewXml),c?h.replaceFields(p.getEffectiveFieldNames()):d?h.updateNewDocumentTemplates(d):b&&h.replaceAggregates(p.getEffectiveAggregatesData())):(g=e(Object(Se.a)({deserializedItemSetKey:u.s,filterableSet:j.bc},l)),y=g.deserializedItemSetKey,U=g.filterableSet,y&&(h=et({sourceView:p,deserializedItemSetKey:y,appliedFilters:U&&U.appliedFilters}))),h&&(h.prepareForSaving(),p.isDirty()||h.isDirty())))?(w=Object(me.getListApiUrl)({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl}).method("Views",v).method("SetViewXml"),[2,e(Object(be.b)({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl,url:w.toString(),method:"POST",body:JSON.stringify({viewXml:h.getEffectiveViewXml()}),qosName:i||"saveView"}))]):[2]})})}}),st=r("5004fc2f3329649ad54d"),lt=r("87e95cd1ff4b249d307f"),ct=Object(i.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options.columnModifyTypeMap;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var a,i,o,s,l,c,d,b,f,m,p,v,h,y,U,w,I,_,F,O;return n.__generator(this,function(S){switch(S.label){case 0:if(!(l=e(Object(Se.a)({setKey:u.s},t)).setKey))return[3,3];if(c=Object.keys(r)[0],d=r[c],b=d.modifyType,f=d.targetIndex,!(m=l.viewKey?u.X.serialize(l.viewKey):void 0))return[3,3];if(!(p=e(Object(Se.a)({currentDerivedView:j.j},m)).currentDerivedView))return[3,3];if(v=p.getEffectiveFieldNames(),!(h=e(Object(Se.a)({internalName:j.cb},c)).internalName))return[3,3];if((y=v.indexOf(h))<0||1===b&&0===y||2===b&&y===v.length-1)return[2];switch(U=p.isDirty(),b){case 0:p.updateField(h);break;case 1:p.updateField(h,y-1);break;case 2:p.updateField(h,y+1);break;case 3:p.updateField(h,f)}return w={ODB:1318},I=e(Object(X.a)(function(e){return e.demandItemFacet(j.qc,u.Q.serialize({webAbsoluteUrl:l.webAbsoluteUrl,listFullUrl:l.listFullUrl}))})),_=e(Object(X.a)(function(e){return Object(st.a)(e,{feature:w,pageContext:I})})),F=!1,_?[4,e(Object(g.a)({items:(a={},a[u.L.serialize({webAbsoluteUrl:l.webAbsoluteUrl,listFullUrl:l.listFullUrl})]={views:(i={},i[m]={shouldSaveViewFieldsOnly:!0},i),qosName:"autoSaveModifyColumn"},a)})).then(function(){U||(p.baseViewXml=p.getEffectiveViewXml()),F=!0},function(e){throw lt.default.logError(e,{eventName:"ModifyColumn",feature:"ColumnFieldsAutoSave",columnFieldName:h,modifyType:b,errorCode:e.errorData.code,correlationId:e.errorData.correlationId,status:e.errorData.status}),e})]:[3,2];case 1:S.sent(),S.label=2;case 2:O=new C.a,_&&F||O.resolveItems({items:(o={},o[m]=n.__assign({},j.Qb.pack(!0)),o)}),O.invalidateItems({items:(s={},s[t]=[A.a],s[m]=[j.j],s)}),e(O.execute()),S.label=3;case 3:return[2]}})})}}),ut=Object(i.e)({mergeForSameItemKey:!1})(function(e){var t=e.options.columnFormatterMap;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var r,a,i,o,s;return n.__generator(this,function(l){return a=Object.keys(t)[0],i=t[a],o=i.updateType,s=i.formatter,0===o?[2,e(Object(F.a)({items:(r={},r[a]=n.__assign({},j.k.pack(s)),r)}))]:[2]})})}}),dt=r("5c10251521fdf1911fd8"),bt=r("e7d0f86dd5b257f52558"),ft=r("c21819129ba64362c121"),mt=r("3da5d317c00adfe8f79c"),pt=Object(i.e)({mergeForSameItemKey:!1,maxParallelOperationCount:3,timeout:864e5})(function(e){var t=this,r=e.itemKey,a=e.options.sourceEntries,i=u.C.deserialize(r),o=i&&i.itemSetKey,s=o.webAbsoluteUrl,l=o.listFullUrl,c=o.rootFolder,d=u.D.serialize({webAbsoluteUrl:s,listFullUrl:l,rootFolder:c}),b=Object.keys(a)[0],f=a[b].progressItemKey;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,i,o,s,l,c,u;return n.__generator(this,function(m){switch(m.label){case 0:return s=e(Object(Se.a)({sourceFile:ft.b},b)).sourceFile,l=e(Object(R.a)({listItemUploader:j.qb})).listItemUploader,c=void 0===l?bt.a:l,[4,e(c({itemKey:d,options:{sourceEntries:a}}))];case 1:u=m.sent().itemKey,m.label=2;case 2:return m.trys.push([2,4,,5]),[4,e(Object(dt.a)({items:(t={},t[u]={groupKey:r},t)}))];case 3:return m.sent(),[3,5];case 4:return m.sent(),[3,5];case 5:return e(Object(K.b)({items:(i={},i[d]=[A.b],i)})),f&&s&&e(Object(F.a)({items:(o={},o[f]=n.__assign({},mt.f.pack({itemKey:u}),Object(I.d)({progressSize:mt.r},{progressSize:{current:s.size}})),o)})),[2]}})})}});var vt=r("85bfca0cd3bb87373c39"),ht=Object(i.e)({maxParallelOperationCount:8})(function(e){var t=this,r=e.itemKey,a=u.L.deserialize(r),i=a.webAbsoluteUrl,o=a.listFullUrl;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,s,l,c,d,b,f,m,p,v,h,g,y;return n.__generator(this,function(U){switch(U.label){case 0:return c=[],d=new C.a,b=e(Object(Se.a)({pageContext:j.qc},u.Q.serialize({webAbsoluteUrl:i,listFullUrl:o}))),f=u.K.serialize({webAbsoluteUrl:a.webAbsoluteUrl,listFullUrl:a.listFullUrl}),m=e(Object(Se.a)({list:j.nb},f)),p=e(Object(R.a)({localeConfiguration:$.localeFacet})).localeConfiguration,[4,e(Object(vt.a)({webAbsoluteUrl:i,listFullUrl:o,listTemplate:m.list&&m.list.templateType,preferredLanguage:p&&p.language}))];case 1:return v=U.sent(),h={},g=void 0,y=[],v.filter(function(e){return!!e.view}).map(function(e){var t,r,a,s=e.serverView,l=e.view,f=l.id,p={viewId:f},v=u.X.serialize(p);if(b&&b.pageContext&&m&&m.list&&m.list.id&&(a=function(e){var t=e.webAbsoluteUrl,r=e.layoutsUrl,a=e.viewId,n=e.listId,i=e.sourceUrl;return t+"/"+r+"/ViewEdit.aspx?"+Object(oe.serializeQuery)({View:Ne.default.normalizeUpper(a,!0),List:Ne.default.normalizeUpper(n,!0),Source:i})}({webAbsoluteUrl:i,layoutsUrl:b.pageContext.layoutsUrl,viewId:f,listId:m.list.id,sourceUrl:s.ServerRelativeUrl})),l.isDefault){g=v;var U=l.getDomParts().newDocumentTemplates;if(U&&U.textContent)try{var w=(y=JSON.parse(U.textContent)).map(function(e){return e.url});if((y=y.filter(function(e,t){return!e.url||w.indexOf(e.url)===t})).length)for(var I=0,_=y;I<_.length;I++){var F=_[I];if(F.url){var O=u.N.serialize({templateUrl:F.url,listKey:{webAbsoluteUrl:i,listFullUrl:o}});d.resolveItems({items:(t={},t[O]=n.__assign({},j.zb.pack(F)),t)})}F.templateId||(F.isUpload?F.templateId=F.title:F.isContentType&&F.contentTypeId&&(F.templateId=F.contentTypeId))}}catch(e){}}h[v]=l,Object(Ze.c)(l),d.resolveItems({items:(r={},r[v]=n.__assign({},u.X.pack(p),j.Pb.pack(s),j.j.pack(l),j.Qb.pack(!1),a?S.openUrlFacet.pack(a):{}),r)}),c.push(v)}),d.resolveItems({items:(t={},t[f]=n.__assign({},j.Ab.pack(y)),t)}),c.sort(function(e,t){return h[e].compareTo(h[t])}),d.resolveItems({items:(s={},s[r]=n.__assign({},u.L.pack(a),A.a.pack({itemKeys:c})),s)}),g&&d.resolveItems({items:(l={},l[f]=n.__assign({},j.n.pack({viewKey:g})),l)}),e(d.execute()),[2]}})})}});var gt=r("5f5048d493ea2dbbba13"),yt=r("f553bf0f97ddfedc1f32"),Ut=r("4d934992108cb28aa92f"),wt=r("5730cedeedcb5640bb56"),It=r("5abe0a4e18e69c009f41"),_t=r("843110fa06f12b102717");function Ft(e,t,r){var a=Object(me.getListApiUrl)({webAbsoluteUrl:e,listFullUrl:t}).segment("CustomActionElements");return function(n){return n(Object(be.d)({webAbsoluteUrl:e,listFullUrl:t,method:"POST",url:a.toString(),qosName:"getLegacyCustomActions",noRedirect:!0})).then(function(e){return function(e,t){return Object(wt.b)(e,t)}(e.d.CustomActionElements.Items.results,r)})}}function Ot(e,t){var r=It.escapeUrlForCallback(e)+"/_layouts/15/tenantappinfo.ashx?etag=0&lcid="+_t.Locale.lcid;return function(a){return a(Object(be.b)({webAbsoluteUrl:e,listFullUrl:"",method:"POST",url:r,qosName:"getTenantAppCustomAction",noRedirect:!0})).then(function(e){return e.apps?function(e,t){var r=[];return e.forEach(function(e,a){e.customActions&&(r=r.concat(Object(wt.c)(e.customActions,t)))}),r}(e.apps,t):[]})}}var St=r("00620f24248a4f158ff6"),At=r("bffb0e7cd108ce57e381"),jt=r("de961921ff36ea23aa69"),kt={Prefix:"ClientSideExtension",CommandSet:"ClientSideExtension.ListViewCommandSet",ContextMenu:"ClientSideExtension.ListViewCommandSet.ContextMenu",CommandBar:"ClientSideExtension.ListViewCommandSet.CommandBar"},Ct=Object(i.e)()(function(e){var t=this,r=e.itemKey,a=u.e.deserialize(r),i=a.webAbsoluteUrl,o=a.listFullUrl,s=a.spfxLoaded,l=a.itemsScopeItemKey,c=u.b.serialize({webAbsoluteUrl:i,listFullUrl:o});return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,a,d,b,f,m,p,v,h,g,y,U,w;return n.__generator(this,function(I){switch(I.label){case 0:return a=e(Nt({webAbsoluteUrl:i,listFullUrl:o})),d=u.K.serialize({webAbsoluteUrl:i,listFullUrl:o}),[4,e(Object(J.demandItems)(function(e){return{listViewAdapter:e.demandItemFacet(Ut.g,d)}}))];case 1:return b=I.sent().listViewAdapter,f=new C.a,!b&&s&&l?(m=e(Object(X.a)(At.a)))?[4,m()]:[3,5]:[3,5];case 2:return p=I.sent(),v=!1,p?(b=p.createListViewAdapter(),f.resolveItems({items:(t={},t[d]=n.__assign({},b?Ut.g.pack(b):{}),t)}),[4,e(Object(J.demandItems)(function(e){var t=Object(jt.a)(e,l);if(t&&b){var r=e.demandItemFacet(A.a,t),a=r&&r.itemKeys,i=function(t){var r,a=e.isItemFacetResolved(j.Ob,t)?e.demandItemFacet(j.Ob,t):void 0;if(a&&b){var o=b.createRowAdapter({values:a});f.resolveItems({items:(r={},r[t]=n.__assign({},o?Ut.h.pack(o):{}),r)})}else if(e.demandItemFacet(u.C,t)){var s=e.isItemFacetResolved(A.a,t)?e.demandItemFacet(A.a,t):void 0;if(s)for(var l=0,c=s.itemKeys;l<c.length;l++){var d=c[l];i(d)}}};if(a)for(var o=0,s=a;o<s.length;o++){var c=s[o];i(c)}var d=e.demandItemFacet(A.f,t),m=d&&d.columnKeys||[];if(m&&b)for(var p=function(t){var r,a=e.demandItem({fieldId:j.O,internalName:j.cb,realFieldName:j.Mb,fieldType:j.N,isRequired:gt.d,displayName:S.displayNameFacet,clientSideComponentId:Ut.a,clientSideComponentProperties:Ut.b},t),n=a.fieldId,i=a.internalName,o=a.realFieldName,s=a.fieldType,l=a.isRequired,c=a.displayName,d=a.clientSideComponentId,m=a.clientSideComponentProperties;if(n&&i){v=!0;var p={internalName:i},h={id:n,internalName:o||i,fieldType:s||"Text",isRequired:l||!1,isVisible:!0,displayName:c||"",clientSideComponentId:d||Ne.default.Empty,clientSideComponentProperties:m||"",onSetVisible:function(e){return console.log("ISpfxAdapter.IColumn.onSetVisible not implemented")},onFieldCustomizerError:function(e){console.log("Fail to load customizer for column: "+i+",\n                        componentId: "+d+", error: "+e.message)}},g=b.addColumnAdapter(h);if(d&&d!==Ne.default.Empty){var y=u.l.serialize(p);f.resolveItems({items:(r={},r[y]=Ut.c.pack(g),r[t]=Ut.d.pack(y),r)})}}},h=0,g=m;h<g.length;h++){var y=g[h];p(y)}}}))]):[3,5];case 3:return I.sent(),v?[4,b.loadFieldCustomizers()]:[3,5];case 4:I.sent(),I.label=5;case 5:return[4,e(Ft(i,o,a))];case 6:return h=I.sent(),[4,e(Object(J.demandItems)(function(e){return{enableDebugClientSideExtensions:e.demandItemFacet(j.r,$.configurationItemKey)}}))];case 7:return(g=I.sent().enableDebugClientSideExtensions)&&g.customActions&&function(e,t){if(!t)return;var r=e.ContextMenu||[],a=e["Ribbon.Documents"]||[],i=e["Ribbon.List"]||[],o={"ClientSideExtension.ListViewCommandSet.ContextMenu":"ContextMenu:","ClientSideExtension.ListViewCommandSet.CommandBar":"CommandBar:"};try{var s=JSON.parse(t);if(s)for(var l=0,c=Object.keys(s);l<c.length;l++){var u=c[l];try{var d=s[u],b=d.location,f=d.properties,m={text:o[b],action:"",allowMultiSelect:!0,isEnabled:!0,clientSideComponentId:u,clientSideComponentProperties:"object"==typeof f?JSON.stringify(f):""},p=b===kt.CommandSet,v=b===kt.ContextMenu||p,h=b===kt.CommandBar||p;v&&r.push(m),h&&(a.push(n.__assign({},m)),i.push(n.__assign({},m)))}catch(e){console.log("Error processing query parameter for "+u)}}}catch(e){console.log("error in parsing query parameter for custom actions")}}(h,g.customActions),y=a.isDocumentLibrary,[4,Pt({setKey:r,actions:h[y?"Ribbon.Documents":"Ribbon.List"],listViewAdapter:b})];case 8:return U=I.sent().itemResolver,[4,Pt({setKey:c,actions:h.ContextMenu,listViewAdapter:b})];case 9:return w=I.sent().itemResolver,f.merge(w),f.merge(U),e(f.execute()),[2]}})})}}),Tt=Object(i.e)()(function(e){var t=this,r=e.itemKey,a=u.ab.deserialize(r),i=a.webAbsoluteUrl,o=a.listFullUrl;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,a,s;return n.__generator(this,function(n){switch(n.label){case 0:return t=e(Nt({webAbsoluteUrl:i,listFullUrl:o})),[4,e(Ot(i,t))];case 1:return a=n.sent(),[4,Pt({setKey:r,actions:a})];case 2:return s=n.sent().itemResolver,e(s.execute()),[2]}})})}}),Dt=Object(i.e)()(function(e){var t=this,r=e.itemKey,a=u.d.deserialize(r);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,i,o,s;return n.__generator(this,function(l){return i=new C.a,o=u.e.serialize(a),s=u.ab.serialize(a),i.resolveItems({items:(t={},t[r]=n.__assign({},D.f.pack(!0),A.a.pack({itemKeys:[o,s]})),t)}),e(i.execute()),[2]})})}});function Pt(e){return n.__awaiter(this,void 0,void 0,function(){var t,r,a,i,o,s,l,c,d,b,f;return n.__generator(this,function(m){switch(m.label){case 0:r=e.setKey,a=e.actions,i=e.listViewAdapter,o=new C.a,s=[],l=0,c=function(e){var t,r,a,c,d,b,f,m,p,v,h,g,y,U,w,I;return n.__generator(this,function(_){switch(_.label){case 0:if(a=[],!Object(wt.a)(e))return[3,6];c=e.children,d=0,b=0,f=c,_.label=1;case 1:return b<f.length?(m=f[b],p=m.id?m.id:m.text+l+"."+d,v=u.c.serialize({actionId:p}),Kt(m)?[3,2]:(o.resolveItems({items:(t={},t[v]=n.__assign({},S.displayNameFacet.pack(m.text),S.openUrlFacet.pack(m.action),yt.a.pack(m.allowMultiSelect),yt.c.pack(m.isEnabled||!1),yt.b.pack(m.iconUrl)),t)}),[3,4])):[3,6];case 2:return i?[4,xt({action:m,listViewAdapter:i})]:[3,4];case 3:h=_.sent(),U=h.actionKeys,y=h.itemResolver,o.merge(y),U.forEach(function(e){a.push(e)}),_.label=4;case 4:a.push(v),d++,_.label=5;case 5:return b++,[3,1];case 6:return!Object(wt.a)(e)&&Kt(e)&&i?[4,xt({action:e,listViewAdapter:i})]:[3,8];case 7:return g=_.sent(),y=g.itemResolver,U=g.actionKeys,o.merge(y),s=s.concat(U),[3,9];case 8:!Object(wt.a)(e)&&Kt(e)||(w=e.id?e.id:e.text+l.toString(),I=u.c.serialize({actionId:w}),o.resolveItems({items:(r={},r[I]=n.__assign({},S.displayNameFacet.pack(e.text),A.a.pack({itemKeys:a}),S.openUrlFacet.pack(Object(wt.a)(e)?"":e.action),Object(wt.a)(e)?{}:yt.a.pack(e.allowMultiSelect),Object(wt.a)(e)?{}:yt.c.pack(e.isEnabled||!1),Object(wt.a)(e)?{}:yt.b.pack(e.iconUrl)),r)}),s.push(I)),_.label=9;case 9:return l++,[2]}})},d=0,b=a,m.label=1;case 1:return d<b.length?(f=b[d],[5,c(f)]):[3,4];case 2:m.sent(),m.label=3;case 3:return d++,[3,1];case 4:return o.resolveItems({items:(t={},t[r]=n.__assign({},D.f.pack(!0),A.a.pack({itemKeys:s})),t)}),[2,{itemResolver:o}]}})})}function xt(e){return n.__awaiter(this,void 0,void 0,function(){var t,r,a,i,o,s,l;return n.__generator(this,function(c){switch(c.label){case 0:return t=e.action,r=e.listViewAdapter,a=new C.a,i=[],o=t.clientSideComponentId&&t.clientSideComponentId.toString()||"",s=t.clientSideComponentProperties||"",o&&o!==Ne.default.Empty?[4,r.loadCommandSet(o,s).catch(function(){})]:[2,{itemResolver:a,actionKeys:[]}];case 1:return(l=c.sent())&&l.commandAdapters&&l.commandAdapters.forEach(function(e){var r,o=t.clientSideComponentId+"."+e.commandId,s=u.c.serialize({actionId:o});a.resolveItems({items:(r={},r[s]=n.__assign({},S.displayNameFacet.pack(e.title),S.openUrlFacet.pack(t.action),yt.a.pack(t.allowMultiSelect),yt.c.pack(t.isEnabled||!1),yt.b.pack(e.iconUrl||t.iconUrl),Ut.e.pack(e)),r)}),i.push(s)}),[2,{itemResolver:a,actionKeys:i}]}})})}function Nt(e){var t=e.webAbsoluteUrl,r=e.listFullUrl;return function(e){var a=e(Object(Se.a)({pageContext:j.qc},u.Q.serialize({webAbsoluteUrl:t,listFullUrl:r}))),n=e(Object(Se.a)({list:j.nb},u.K.serialize({webAbsoluteUrl:t,listFullUrl:r})));return{currentUserIsSiteAdmin:a.pageContext&&a.pageContext.isSiteAdmin||!1,listTemplate:n.list&&n.list.templateType||St.ListTemplateType.invalidType,listId:n.list&&n.list.id||"",isDocumentLibrary:n.list&&n.list.isDocumentLibrary||!1}}}function Kt(e){return e&&(!!e.clientSideCommandAdapter||e.clientSideComponentId&&e.clientSideComponentId!==Ne.default.Empty)||!1}var Rt=Object(i.e)({maxParallelOperationCount:4})(function(e){var t=this,r=e.itemKey,a=u.Z.deserialize(r).webAbsoluteUrl;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,i,o,s,l;return n.__generator(this,function(c){switch(c.label){case 0:return i=Object(me.getStaticApiUrl)({webAbsoluteUrl:a}).segments("ComponentContextInfo"),[4,r(Object(be.b)({url:i.toString(),qosName:"GetWebPageContext",method:"GET",webAbsoluteUrl:a,noRedirect:!0}))];case 1:return o=c.sent(),s=JSON.parse(o.d.SerializedData),(l=new C.a).resolveItems({items:(t={},t[e.itemKey]=n.__assign({},u.Z.pack({webAbsoluteUrl:a}),j.qc.pack(s)),t)}),r(l.execute()),[2]}})})}});var Et=r("ba9b9c401d4d91d63e29"),Lt=r("9e7274a6a80450887587"),zt=r("4cf6b25e4dacf118cb22"),qt=Object(i.c)()(function(e){var t=e.items,r=Object.keys(t),a=t[r[0]].groupKey;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var t,i,o,s,l,c,d,b,f,m,p,v,h,g,y,U,w,I,_,F;return n.__generator(this,function(n){switch(n.label){case 0:if(l=e(Object(X.a)(function(e){return e.demandItemFacet(u.C,a)})),!(c=l&&l.itemSetKey&&u.s.serialize(l.itemSetKey))||r.length<1||!a)return[2];if(d=e(Object(Se.a)({spGroupField:j.gc,groupValue:j.ab,parentGroupKey:j.Fb,defaultCollapsed:D.b},a)),b=d.spGroupField,f=d.groupValue,m=d.parentGroupKey,p=d.defaultCollapsed,v=[],b&&b.internalName&&f&&v.push({FieldName:b.internalName,FieldValue:f}),m&&m.itemKey&&(h=e(Object(Se.a)({parentGroupField:j.gc,parentGroupValue:j.ab},m.itemKey)),g=h.parentGroupField,y=h.parentGroupValue,g&&g.internalName&&y&&v.push({FieldName:g.internalName,FieldValue:y})),l&&l.itemSetKey&&l.itemSetKey.filterParams&&(U=Et.a.getFilterList(l.itemSetKey.filterParams,void 0,!0)).length>0)for(w=0;w<U.length;w++)I=U[w],_=e(Object(Se.a)({isReadOnly:j.gb},u.o.serialize({internalName:I.fieldName}))).isReadOnly,1===I.values.length&&!1===_&&v.push({FieldName:I.fieldName,FieldValue:I.values[0]});return[4,e(Object(Lt.a)({items:(t={},t[c]={itemKeys:r,formValues:v,qosName:"AssignItemsToGroup"},t)}))];case 1:return n.sent(),F={},r.forEach(function(e){F[e]={}}),[4,e(Object(zt.a)({items:(i={},i[c]=F,i)}))];case 2:return n.sent(),e(p?Object(K.b)({items:(o={},o[a]=[A.a],o)}):Object(K.b)({items:(s={},s[c]=[A.a],s)})),[2]}})})}}),Bt=r("664990b3cc9463570172"),Mt=r("fe00c914fafa817f5120"),Vt=r("37b99d1e7f0c88452ea0"),Wt=Object(U.a)()(function(){return function(e){return Gt}});function Gt(e,t){var r=t.itemKey,a=e.demandItem({driveItem:u.D,canonicalLinkUrl:S.canonicalUrlFacet},r),i=a.driveItem,o=a.canonicalLinkUrl;return{isAvailable:!0,getShareLink:function(){return function(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,a,i,o,s,l,c,u,d,b,f;return n.__generator(this,function(n){switch(n.label){case 0:if(t=e.driveItem,a=e.canonicalLinkUrl,t&&a)return[3,1];throw new Error("Unable to obtain default share URL");case 1:if(i=void 0,a){for(o=new Vt.a(a),s=o.authority,l=0,c=o.segments;l<c.length;l++)""!==(u=c[l])&&(s=s+"/"+encodeURIComponent(u));d=Object(Mt.a)(s.toString()),i="u!"+d.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-")}return b=new Vt.a(t.webAbsoluteUrl).authority,[4,r(Object(be.b)({webAbsoluteUrl:b,listFullUrl:void 0,url:b+"/_api/v2.0/shares/"+i+"/driveItem/invite",body:void 0,method:"POST",additionalHeaders:{prefer:"getDefaultLink","Content-type":"application/json",Accept:"application/json"},qosName:"getDefaultShareLink",noRedirect:!0}))];case 2:return[2,{url:(f=n.sent()).value[0].link.webUrl,scope:f.value[0].link.scope}]}})})}}({driveItem:i,canonicalLinkUrl:o})}}}var Ht=r("809072ae40093b380229"),Qt=Object(i.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options,a=r.bNewDocumentUpdate,i=r.checkInComment,o=r.formValues,s=r.qosName;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var r,l,c,u,d;return n.__generator(this,function(n){switch(n.label){case 0:return o.length>0?[4,e(Object(Me.a)(t))]:[3,3];case 1:return r=n.sent(),l=r.key,c=r.itemId,u=function(e){var t=e.webAbsoluteUrl,r=e.listFullUrl,a=e.itemId;return Object(me.getListApiUrl)({webAbsoluteUrl:t,listFullUrl:r}).method("Items",a).method("ValidateUpdateListItem").toString()}({webAbsoluteUrl:l.webAbsoluteUrl,listFullUrl:l.listFullUrl,itemId:c||l.itemId||""}),(d={}).formValues=o,d.bNewDocumentUpdate=a,d.checkInComment=i,[4,e(Object(be.b)({body:JSON.stringify(d),listFullUrl:l.listFullUrl,method:"POST",qosName:s,url:u,webAbsoluteUrl:l.webAbsoluteUrl,noRedirect:!0})).then(function(e){var t=e.d.ValidateUpdateListItem.results[0];if(t.HasException)throw new Error(t.ErrorMessage||void 0)})];case 2:n.sent(),n.label=3;case 3:return[2]}})})}});var Jt=r("dc969c026d388e81ff0e"),Xt=r("91cddda488609bc98b32"),Yt=r("7ac3ab87caf33903810b");var $t=r("85b502035ba6002afa5a"),Zt=r("5ba092dc16072e3940b3"),er=Object(i.e)()(function(e){var t=e.itemKey;return function(r){return n.__awaiter(void 0,void 0,void 0,function(){var a,i,o,s,l,c;return n.__generator(this,function(d){switch(d.label){case 0:return a=u.s.deserialize(t),i=r(Object(ke.c)({itemSetKey:a})),o=Object.keys(e.options),[4,r((b={itemSetKey:t,itemKeys:o},function(e){for(var t=b.itemSetKey,r=b.itemKeys,a=e(Object(X.a)(function(e){var r=e.demandItemFacet(u.s,t)||u.s.deserialize(t);return n.__assign({},r,{pageContext:Object(Yt.a)(e,u.D.serialize(r))})})),i=a.webAbsoluteUrl,o=a.listFullUrl,s=a.pageContext,l=[],c=0,d=r;c<d.length;c++){var f=d[c],m=u.D.deserialize(f).itemId;m||(m=e(Object(Se.a)({listItemId:j.pb},f)).listItemId),m&&l.push(m)}var p=e(Object(Xt.a)({internalName:j.cb},t)),v=["Modified"];if(p)for(var h=0,g=p;h<g.length;h++){var y=g[h];y.internalName&&"Modified"!==y.internalName&&v.push(y.internalName)}return{webAbsoluteUrl:i,listFullUrl:o,currentPageContext:s,qosName:"refreshItemsInSet",viewXml:Object(Jt.getViewXml)({itemIds:l,recurseInFolders:!0,pageSize:r.length,fieldNames:v.length>0?v:void 0}),postDataContext:{needsSchema:!0}}}))];case 1:return s=d.sent(),[4,r(Object(Ce.a)(s))];case 2:return l=d.sent(),c=r(Object($t.b)({serverData:l,itemSetKey:a,currentPageContext:s.currentPageContext,contentTypes:i,isItemSetRequest:!0})).itemResolver,r(c.execute()),r(Object(Zt.a)({itemSetKey:t,serverData:l,isItemSetRequest:!0})),[2]}var b})})}}),tr=r("7a458e85783b71176e85"),rr=Object(U.a)()(function(){return function(e){return ar}});function ar(e,t){var r=t.itemKey,a=t.link,i=t.recipients,o=e.demandItem({driveItem:u.D},r).driveItem;return{isAvailable:!0,permissionInvite:function(){return function(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,a,i,o,s,l,c,u,d,b;return n.__generator(this,function(n){switch(n.label){case 0:return t=e.driveItem,a=e.link,i=e.recipients,t?(o=void 0,s=Object(Mt.a)(a),o="u!"+s.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-"),l=i.map(function(e){return{email:e}}),c={recipients:l,roles:["read"]},u=new Vt.a(t.webAbsoluteUrl).authority,[4,r(Object(be.b)({webAbsoluteUrl:u,listFullUrl:void 0,url:u+"/_api/v2.0/shares/"+o+"/permission/invite",body:JSON.stringify(c),method:"POST",additionalHeaders:{"Content-type":"application/json",Accept:"application/json"},qosName:"permissionInvite",noRedirect:!0}))]):[3,2];case 1:return d=n.sent(),b=d.value[0].grantedToIdentities.map(function(e){return{email:e.user.email}}),[2,{recipients:b}];case 2:throw new Error("Unable to set permissions on the sharing URL")}})})}}({driveItem:o,link:a,recipients:i})}}}var nr=r("661b65dcf8351e92fe44"),ir=Object(U.a)()(function(){return function(e){return function(e,t){var r=t.itemKey,a=e.demandItemFacet(u.D,r);if(!a)return{};var n={webAbsoluteUrl:a.webAbsoluteUrl,listFullUrl:a.listFullUrl},i=e.demandItemFacet(j.nb,u.K.serialize(n)),o=e.demandItemFacet(j.qc,u.Q.serialize(n));if(!o)return{};var s=i&&i.templateType===St.ListTemplateType.mySiteDocumentLibrary||!1;return{sharedPostData:{cultureName:o.currentUICultureName||o.currentCultureName||"en-US",client:s?"OneDrive":"SharePoint",domainHint:"organizations",userId:o.userLoginName}}}}});var or=r("83f2d47bcced97f0a85c"),sr=r("4fab54035bc77294dc42"),lr=r("6dec44e5485412f70439"),cr=r("7f8b22b90e1fa57005a6"),ur=Object(U.a)()(function(){return function(e){return function(e,t){var r=t.itemKey,a=void 0,n=e.demandItem({key:u.D,driveItemKey:sr.a},r),i=n.key,o=n.driveItemKey;if(o)return{driveItemFullUrl:Object(lr.c)(o)};if(i){var s={webAbsoluteUrl:i.webAbsoluteUrl,listFullUrl:i.listFullUrl},l=e.demandItem({listMediaFacets:cr.b},u.K.serialize(s)).listMediaFacets;if(l&&l[".driveUrl"]){var c=l[".driveUrl"],d=i.rootFolder||"",b="";if(d){var f=new q.a({context:{webAbsoluteUrl:i.webAbsoluteUrl,listUrl:i.listFullUrl}}),m=f.getUrlParts();m.serverRelativeListUrl&&"/"!==(b=d.replace(m.serverRelativeListUrl,"")).charAt(0)&&(b="/"+b)}return{driveItemFullUrl:a=c+"/items/root"+(b?":":"")+b}}}return{driveItemFullUrl:a}}}});var dr=r("9478e86dcd48357093ed"),br=Object(i.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options,a=r.aggregateType,i=r.columnKey;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var r,o,s,l,c,d,b,f,m,p,v,h,y;return n.__generator(this,function(n){switch(n.label){case 0:return(s=e(Object(Se.a)({setKey:u.s},t)).setKey)&&((l=s.viewKey?u.X.serialize(s.viewKey):void 0)&&(c=e(Object(Se.a)({currentDerivedView:j.j},l)).currentDerivedView))?(d=e(Object(Se.a)({internalName:j.cb,fieldType:j.P,fieldFieldType:j.N},i)),b=d.internalName,f=d.fieldType,m=d.fieldFieldType,b?(p=e(Object(Se.a)({spFolderAggregates:j.f},t)).spFolderAggregates,v=c.isDirty(),!(h=p&&p[i]?p[i].aggregateFunctionType:void 0)&&0===a||h===dr.a[a]?[2]:(y=0===a?void 0:dr.a[a],c.updateColumnAggregateType(b,y),[4,e(Object(g.a)({items:(r={},r[u.L.serialize({webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl})]={views:(o={},o[l]={shouldSaveAggregationsOnly:!0},o),qosName:"SaveModifyColumnAggregateType"},r)})).then(function(){var r,a=c.getEffectiveViewXml(),n=new Ye.a(c.baseViewXml||"");n.replaceAggregates(c.getEffectiveAggregatesData()),c.baseViewXml=n.getEffectiveViewXml(),c.setDom(a),c.setIsDirty(v);var i=new C.a;i.invalidateItems({items:(r={},r[t]=[A.a],r[l]=[j.Tb],r)}),e(i.execute())},function(e){throw lt.default.logError(e.errorData,{eventName:"ModifyColumnAggregateType",feature:"ModernColumnTotalsSettings",fieldType:f,fieldFieldType:m,currentAggregateType:h||"None",newAggregateType:y||"None",errorCode:e.errorData.code,correlationId:e.errorData.correlationId,status:e.errorData.status}),c.updateColumnAggregateType(b,h),c.setIsDirty(v),e})])):[3,2]):[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}})})}}),fr=r("f594c3c93ec9f3598a3f"),mr=Object(i.e)()(function(e){var t=e.itemKey,r=e.options,a=r.itemKeys,i=r.bNewDocumentUpdate,o=r.checkInComment,s=r.formValues,l=r.qosName;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var r,c,d,b,f,m,p,v,h,g,y,U,w,I,_;return n.__generator(this,function(n){switch(n.label){case 0:if(!(s&&s.length&&a&&a.length))return[2];r=u.s.deserialize(t),c=r.viewKey,d=r.rootFolder,b=r.webAbsoluteUrl,f=r.listFullUrl,m=d||"",c&&(!(p=e(Object(Se.a)({currentDerivedView:j.j},u.X.serialize(c))).currentDerivedView)||1!==p.scope&&2!==p.scope||(m="")),v=[],h={},g=0,y=a,n.label=1;case 1:return g<y.length?(U=y[g],[4,e(Object(Me.a)(U))]):[3,4];case 2:w=n.sent().itemId,v.push(parseInt(w,10)),h[w]=U,n.label=3;case 3:return g++,[3,1];case 4:return I=Object(me.getListApiUrl)({webAbsoluteUrl:b,listFullUrl:f}).method("BulkValidateUpdateListItems").toString(),_={itemIds:v,formValues:s,folderPath:m,bNewDocumentUpdate:i,checkInComment:o},[4,e(Object(be.b)({body:JSON.stringify(_),listFullUrl:f,method:"POST",qosName:l,url:I,webAbsoluteUrl:b,noRedirect:!0})).then(function(r){for(var a,n="",i={},o=0,s=r.d.BulkValidateUpdateListItems.results;o<s.length;o++){var l=s[o];if(l.HasException)n=l.ErrorMessage+"\n"+n;else h[l.ItemId]&&(i[h[l.ItemId]]={})}if(Object.keys(i).length>0&&e(Object(zt.a)({items:(a={},a[t]=i,a)})),n)throw new Error(n)})];case 5:return n.sent(),[2]}})})}}),pr=r("aa420188fc5b81d114ba"),vr=r("7fa9594be33133790955"),hr=r("390bac1530ab6cf4e614"),gr=r("45f20a17936fcb32edb1"),yr=r("5cf28e236c4257d408f7"),Ur=r("3cc6038ccd9dbc34d9e7"),wr=r("de455e56c423b6481855"),Ir=Object(i.c)()(function(e){var t=e.items,r=t[Object.keys(t)[0]].itemSetKey;return function(e){return n.__awaiter(void 0,void 0,void 0,function(){var a,i,o,s,l,c,u,d,b,f,m,p,v;return n.__generator(this,function(n){switch(n.label){case 0:return i=[],[4,e(_r({itemSetKey:r}))];case 1:for(s=n.sent(),l=function(t){var r=e(Object(X.a)(function(e){return e.demandItemFacet(S.canonicalUrlFacet,t)}))||"",a={DecodedUrl:decodeURIComponent(r)};a&&i.push(a)},c=0,u=Object.keys(t);c<u.length;c++)d=u[c],l(d);return o=JSON.stringify({itemPaths:i}),b="RemoveItemsFromSharedWithMeViewByPath",f=Object(me.getStaticApiUrl)({webAbsoluteUrl:s}).segment("SP.Sharing.DocumentSharingManager."+b),[4,e(Object(be.b)({url:f.toString(),qosName:"RemoveFromSharedList",method:"POST",webAbsoluteUrl:s,body:o,noRedirect:!0}))];case 2:if((m=n.sent())&&m.d&&m.d[b]&&m.d[b].results){if((p=m.d[b].results).length<1)throw new de.a({message:Ur.a.DefaultTitle});p.forEach(function(e){if(!e.Success&&-3!==e.ErrorCode)throw new de.a({message:e.ErrorMessage||void 0})})}return(v=new C.a).invalidateItems({items:(a={},a[r]=[A.a],a)}),e(v.execute()),[2]}})})}});function _r(e){var t=this,r=e.itemSetKey;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,a,i;return n.__generator(this,function(n){switch(n.label){case 0:return"",t=e(Object(X.a)(function(e){return e.demandItemFacet(wr.a,r)})),a=t&&t.driveItemKey.endpoint||"",[4,e(Object(J.demandItems)(function(e){return e.demandItemFacet(u.D,u.O.serialize({tenantRootUrl:new He.a(a).authority}))}))];case 1:return i=n.sent(),[2,i&&i.webAbsoluteUrl||""]}})})}}var Fr=r("26f8bf003c836a7116db"),Or=r("e3ddf89896588320f98a");r.d(t,"spDataOnlyAddonDeferred",function(){return Sr}),r.d(t,"spItemUploadItemsOperationHandler",function(){return pr.a}),r.d(t,"spItemCreateFolderOperationHandler",function(){return vr.b}),r.d(t,"spItemCreateDocumentOperationHandler",function(){return hr.c}),r.d(t,"getSPFilterOptionSetHandler",function(){return Pe.getSPFilterOptionSetHandler});var Sr=Object(i.b)(function(){return function(e){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){return e(Object(o.g)(u.M,l.a)(Te)),e(Object(o.g)(u.D,b.b)(Re)),e(Object(o.g)(u.D,f.b)(Be)),e(Object(o.g)(u.D,m.b)(Ve)),e(Object(o.g)(u.D,p.b)(We)),e(Fr.sharePointBasicActionsAddonDeferred),e(Object(o.g)(u.D,c.b)(Qe)),e(Object(o.g)(u.T,d.a)(Xe.c)),e(Object(o.g)(u.D,v.a)(qt)),e(Object(o.g)(u.L,y.b)(tt)),e(Object(o.g)(u.L,h.b)(rt)),e(Object(o.g)(u.L,g.b)(ot)),e(Object(o.g)(u.s,w.b)(ct)),e(Object(o.g)(u.s,fr.b)(br)),e(Object(o.g)(u.s,_)(ut)),e(Object(o.g)(u.s,zt.b)(er)),e(Object(o.g)(u.s,Lt.b)(mr)),e(Object(o.g)(u.C,s.b)(pt)),e(Object(o.g)(u.f,l.a)(it)),e(Object(o.g)(u.L,l.a)(ht)),e(Object(o.g)(u.e,l.a)(Ct)),e(Object(o.g)(u.ab,l.a)(Tt)),e(Object(o.g)(u.d,l.a)(Dt)),e(Object(o.g)(u.Z,l.a)(Rt)),e(Object(o.g)(u.s,we)(Fe)),e(Object(o.g)(u.s,Oe)(je)),e(Object(U.c)(u.D,nr.a)(ir)),e(Object(U.c)(u.D,or.a)(ur)),e(Or.sharePointBasicItemDataAddonDeferred),e(gr.a),e(H),e(he),e(Ue),e(Object(U.c)(u.D,Bt.a)(Wt)),e(Object(o.g)(u.D,Ht.a)(Qt)),e(Object(U.c)(u.D,tr.a)(rr)),e(Object(o.g)(u.D,yr.c)(Ir)),[2]})})}})},c365986aa0ec8ad83727:function(e,t,r){"use strict";r.d(t,"d",function(){return g}),r.d(t,"a",function(){return y}),r.d(t,"e",function(){return U}),r.d(t,"c",function(){return w}),r.d(t,"b",function(){return I});var a=r("ee92087a6ec1d0e9ecc9"),n=r("5fef64b3561abb2ebffa"),i=r("3c88ca8e24c9c99ad593"),o=r("0f6d58c9a774fb3ed0ba"),s=r("ad8efa7bc4029814972d"),l=r("57950c2178a5f149fb82"),c=r("a4060cda3c9c24220a4a"),u=r("2127d710ab2cb3c5c173"),d=r("7d7998698e963a7c3ea4"),b=r("bb35b6a9f7d825abb325"),f=r("7ac3ab87caf33903810b"),m=r("cc08c169973ba8efeefa"),p="0x0101009D1CB255DA76424F860D91F20E6C4118",v="50f5cc3a-f77a-4639-be24-da426a341e56";function h(e,t){var r=t.itemKey,n=t.listFacets,i=e.demandItem({moderationStatusType:a.vb},r).moderationStatusType;if(n&&n.isModerated)return"number"==typeof i&&i!==o.a.draft&&i!==o.a.denied&&i!==o.a.pending;var s=w(e,{itemKey:r});return 0===s.minor&&0!==s.major}function g(e,t){var r=t.itemKey,o=t.listFacets,s=e.demandItem({permissions:a.Gb,checkoutInfo:n.isCheckedOutFacet},r),l=s.permissions,c=s.checkoutInfo,d=e.demandItemFacet(a.Ob,r),b=_(e,r)&&function(e){if(!e)return!1;return e._ScheduledVersion===e.owshiddenversion}(d),f=!!c&&!!c.byOther,m=!!o&&!!o.enableMinorVersions,p=!!o&&!!o.isDocumentLibrary;return i.a.hasItemPermission({permissions:l},i.a.editListItems)&&m&&p&&!f&&!b&&!h(e,{itemKey:r,listFacets:o})&&!u.b(e,{itemKey:r,includeOneNote:!0})}function y(e){return e?""+512*(Math.floor(Number(e)/512)+1):""}function U(e){return!!e&&0===e.indexOf(p)}function w(e,t){var r=t.itemKey,n=e.demandItem({uiVersion:a.yc},r).uiVersion;return Object(d.b)(n)}function I(e,t){var r=t.itemKey,n=e.demandItem({moderationStatusType:a.vb},r).moderationStatusType,i=e.demandItem({firstItemKey:c.D},r).firstItemKey,u={actionType:s.a.Publish,buttonLabel:l.a.Publish};if(i){var d=e.demandItemFacet(a.nb,c.K.serialize({webAbsoluteUrl:i.webAbsoluteUrl,listFullUrl:i.listFullUrl})),b=w(e,{itemKey:r});if(!!d&&!!d.isModerated)return n&&n===o.a.pending?{actionType:s.a.CancelApproval,buttonLabel:l.a.CancelApproval}:{actionType:s.a.SubmitForApproval,buttonLabel:l.a.SubmitForApproval};if(_(e,r))if(function(e){if(!e)return!1;var t=e["_PublishStartDate."];if(!t)return!1;var r=new Date(t),a=new Date;return r.getTime()>a.getTime()}(e.demandItemFacet(a.Ob,r)))return 0===b.major?{actionType:s.a.SchedulePublish,buttonLabel:l.a.PublishLater}:{actionType:s.a.SchedulePublish,buttonLabel:l.a.RepublishLater};return 0===b.major?u:{actionType:s.a.Republish,buttonLabel:l.a.Republish}}return u}function _(e,t){if(!t)return!1;if(!m.Killswitch.isActivated(v,"1/7/2020","Scheduling pages for publish in the future")){var r=Object(f.a)(e,t);if(!r||!r.featureInfo)return!1;var a=new b.a(r.featureInfo);if(a){var n=a.get("SitePagesScheduling");return!!n&&n.enabled}}return!1}},c89079fccee5039e5e63:function(e,t,r){"use strict";r.d(t,"b",function(){return i}),r.d(t,"a",function(){return o});var a=r("447964f318fe44ff3682"),n=r("f5df325953ebb7f1143d"),i=new a.a("updateCheckoutState"),o=new n.a("checkout");Object(n.f)({operationTypeFacet:i,progressKeyFacet:o})},cfef2ab49d0d7bc1e869:function(e,t,r){"use strict";var a,n=r("d6e6a1e726db94fe6759"),i=r("4986dedaa57d766e48bb")._Qr9VWNQuRRaLzAyN3mwy4A;function o(e){return function(t){return function(e,t){switch(e){case a.InvalidCharacters:return n.format(i.invalidNameError,t.invalidCharacters);case a.InvalidStart:return n.format(i.invalidNameStartError,t.cannotStartWith);case a.InvalidEnd:return n.format(i.invalidNameEndError,t.cannotEndWith);case a.Empty:return i.emptyNameError;case void 0:return}}(function(e,t){var r=e.trim();return 0===r.length?a.Empty:t.invalidCharactersRegex.test(r)?a.InvalidCharacters:t.cannotStartWithRegex&&t.cannotStartWithRegex.test(r)?a.InvalidStart:t.cannotEndWithRegex&&t.cannotEndWithRegex.test(r)?a.InvalidEnd:void 0}(t,e),e)}}r.d(t,"a",function(){return s}),r.d(t,"b",function(){return l}),function(e){e[e.InvalidStart=0]="InvalidStart",e[e.InvalidEnd=1]="InvalidEnd",e[e.InvalidCharacters=2]="InvalidCharacters",e[e.Empty=3]="Empty"}(a||(a={}));var s=o({invalidCharactersRegex:/["\*:<>\?\/\\\|]/,invalidCharacters:'" * : < > ? / \\ |'}),l=o({invalidCharactersRegex:/["\*:<>\?\/\\\|#%]/,invalidCharacters:'" * : < > ? / \\ # %|'})},d0af51c98de7406fa9c5:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.navigateViaPost=function(e){var t=e.document;t.body||t.createElement("body");var r=t.createElement("form");r.action=e.url,r.method="POST",r.style.visibility="hidden",r.target="_self";var a=e.postdata;for(var n in a)if(a.hasOwnProperty(n)){var i=t.createElement("input");i.type="hidden",i.name=n,i.value=a[n],r.appendChild(i)}t.body.appendChild(r),r.submit()}},db7b01b1853a9a275b02:function(e,t,r){"use strict";r.d(t,"b",function(){return a}),r.d(t,"a",function(){return n});var a=50,n=8},e3ddf89896588320f98a:function(e,t,r){"use strict";r.r(t);var a=r("680b7ac74280293b48f0"),n=r("64328bb588b46459132d"),i=r("022addba5cf25ce091fb"),o=r("5f6c4af8cb56376acb4d"),s=r("fcf654cc44d7ec457fe0"),l=r("6f13f8350c84cf96896e"),c=r("db4d7f5ad0e1e93cea48"),u=r("bfb8194d4dce098111b8"),d=r("cc08c169973ba8efeefa"),b=r("a4060cda3c9c24220a4a"),f=r("4e318b84c4772f9f58b9"),m=r("be9ddcf0ec56bc42b1b1"),p=r("6e62786e04351f279fc3"),v=r("ee92087a6ec1d0e9ecc9"),h=r("5fef64b3561abb2ebffa"),g=r("fdbcb7664c17b5b4e4d9"),y=r("5e2d26706bb97efeb013"),U=r("85b502035ba6002afa5a"),w=r("dc969c026d388e81ff0e"),I=r("578e5017557fc66bb247"),_=r("7f8b22b90e1fa57005a6"),F=r("796938beaf14a90a25ec"),O=r("5ba092dc16072e3940b3"),S=Object(a.b)(function(){return function(e){return n.__awaiter(void 0,void 0,void 0,function(){return n.__generator(this,function(t){return e(Object(f.b)({keyFacet:b.B,facets:[b.D,h.displayNameFacet,h.fileNameFacet,v.zc,h.folderFacet,v.R,g.b,v.tb,_.a,_.b,v.Gb,h.canonicalUrlFacet]})),e(Object(i.g)(b.B,m.a)(Object(a.e)({maxParallelOperationCount:8})(A))),[2]})})}});function A(e){var t=this,r=e.itemKey,a=b.B.deserialize(r);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,i,f,m,h,_,S,A,j,k,C,T,D,P,x,N,K,R,E,L;return n.__generator(this,function(z){switch(z.label){case 0:return f=new o.a,m=!1,h=new s.SimpleUri(a.itemFullUrl),_=e(function(e,t,r){return function(a){var n,i,o=e.itemFullUrl,l=new s.SimpleUri(o);i=d.Killswitch.isActivated("ca2adcfe-ec7f-4e6b-a8ca-7023c151d026","1/8/2020","Adding more fields to GetListDataAsStream")?["File_x0020_Type","FileRef","FileLeafRef"]:["File_x0020_Type","FileRef","FileLeafRef","_ip_UnifiedCompliancePolicyUIAction","_ComplianceFlags","CheckoutUser","CheckedOutUserId","Created_x0020_Date.ifnew"],n=[l.path];var c=a(Object(I.a)({contentTypeId:v.h},b.B.serialize(e)));if(t&&t.length>0&&c&&c.contentTypeId)for(var u=0,f=t;u<f.length;u++){var m=f[u];if(m.contentTypeId===c.contentTypeId&&m.Fields)for(var p=m.Fields.split(","),h=0,g=p;h<g.length;h++){var y=g[h];"Modified_x0020_By"===y?i.push("Editor"):"Created_x0020_By"===y?i.push("Author"):i.push(y)}}var U=Object(w.getViewXml)({itemRefs:n,recurseInFolders:!0,pageSize:1,fieldNames:i});return{webAbsoluteUrl:"",listFullUrl:o,currentPageContext:void 0,qosName:r,viewXml:U,rootFolder:void 0,postDataContext:{needUpdatePageContext:!0,needsSchema:!0}}}}(a,void 0,"getSPItemByFullUrl")),[4,e(Object(y.a)(_))];case 1:return S=z.sent(),A=S.WebUrl||p.getSharePointPath(decodeURIComponent(S.HttpRoot||""))||h.authority,j=""+new s.SimpleUri(A).authority+(S.ListUrl||decodeURIComponent(S.listUrlDir||"")),k={webAbsoluteUrl:A,listFullUrl:j,rootFolder:""},C=e(Object(U.b)({serverData:S,itemSetKey:k,currentPageContext:_.currentPageContext,contentTypes:void 0,isItemSetRequest:m})),T=C.itemResolver,D=C.childKeys,P=C.pageContext,x=D[0],N=b.s.serialize(k),x&&f.mapKeys({mappings:(t={},t[x]=b.B.serialize(a),t)}),P&&(K=b.Q.serialize({webAbsoluteUrl:A,listFullUrl:j}),e(Object(I.a)({pageContext:v.qc},K)).pageContext||e(Object(c.a)({itemKey:K,options:{pageContext:P}}))),f.merge(T),b.D.matches(x)&&(R=b.D.deserialize(x),(E=Object(F.b)(R))&&f.merge(e(Object(F.a)({parentKey:E,serverData:S})).itemResolver)),L=b.K.serialize({webAbsoluteUrl:A,listFullUrl:j}),f.resolveItems({items:(i={},i[b.D.serialize(k)]=n.__assign({},g.b.pack({itemKey:N})),i[r]=n.__assign({},l.e.pack(b.D)),i[L]=n.__assign({},Object(u.a)(S,P)),i)}),e(f.execute()),e(Object(O.a)({itemSetKey:N,serverData:S,isItemSetRequest:m})),[2]}})})}}r.d(t,"sharePointBasicItemDataAddonDeferred",function(){return j});var j=Object(a.b)(function(){return function(e){e(S)}})},e7d0f86dd5b257f52558:function(e,t,r){"use strict";var a,n,i=r("64328bb588b46459132d"),o=r("a4060cda3c9c24220a4a"),s=r("0b8514f932f40951d460"),l=r("6631b0451e9f577f414d"),c=r("c1a09d7dd35e11297e15"),u=function(){function e(e){this.concurrency=e||1,this._running=0,this._queue=[],this._promiseComplete=this._promiseComplete.bind(this)}return e.prototype.enqueue=function(e){var t;if(this._running<this.concurrency)this._running++,(t=e()).then(this._promiseComplete,this._promiseComplete);else{var r={callback:e,signal:null,canceled:!1,result:null};r.signal=new c.default(function(){r.canceled=!0,s.default.is(r.result)&&r.result.cancel()}),this._queue.push(r),t=r.signal.getPromise()}return s.default.resolve(t)},e.prototype._promiseComplete=function(){var e=this;if(this._running--,this._running<this.concurrency&&this._queue.length){for(var t=this._queue.shift();t&&t.canceled;)t=this._queue.length?this._queue.shift():null;t&&(this._running++,t.result=t.callback(),t.result.then(function(r){t.signal.complete(r),e._promiseComplete()},function(r){t.signal.error(r),e._promiseComplete()}))}},e}(),d=r("cdb9a7d2db44c7a9f4dd"),b=r("e9d155a6651c0bf6c9b0"),f=r("f698cfbaff8a2434ab85"),m=r("62a856fb51e24a703bd6");!function(e){e[e.queued=0]="queued",e[e.started=1]="started",e[e.completed=2]="completed",e[e.aborted=3]="aborted",e[e.failed=4]="failed",e[e.none=5]="none"}(a||(a={})),function(e){e[e.none=0]="none",e[e.other=1]="other",e[e.general=2]="general",e[e.conflict=3]="conflict",e[e.invalidName=4]="invalidName",e[e.fileSize=5]="fileSize",e[e.emptyFileOrFolder=6]="emptyFileOrFolder",e[e.emptyFileOrFolderForDocLib=7]="emptyFileOrFolderForDocLib",e[e.overQuota=8]="overQuota",e[e.accessDenied=9]="accessDenied",e[e.lockMismatch=10]="lockMismatch",e[e.overQuotaSharedFolder=11]="overQuotaSharedFolder",e[e.folderUploadNotSupported=12]="folderUploadNotSupported",e[e.versionMismatch=13]="versionMismatch",e[e.authFailure=14]="authFailure",e[e.targetFolderMissing=15]="targetFolderMissing",e[e.itemNotFound=16]="itemNotFound",e[e.malwareDetected=17]="malwareDetected",e[e.throttled=18]="throttled",e[e.pathTooLong=19]="pathTooLong",e[e.disconnected=20]="disconnected",e[e.unlockRequired=21]="unlockRequired",e[e.insufficientVaultQuota=22]="insufficientVaultQuota"}(n||(n={}));var p=r("c1d76209a7f2fe28e159"),v=r("00620f24248a4f158ff6"),h=r("841f56ac50e8881a27e3"),g=function(e){function t(t){var r=e.call(this,i.__assign({},t,{isExpected:y(t.errorType)}))||this;return r.message=t.message,r.errorType=t.errorType||n.other,r.maxSizeInBytes=t.maxSizeInBytes,r.allowRename=t.allowRename||!1,r.allowMerge=t.allowMerge||!1,r.extraData=t.extraData,r.libraryName=t.libraryName,r.isFolder=t.isFolder,r.fixItUrl=t.fixItUrl,r}return i.__extends(t,e),t}(r("c0864826ef536ba1020d").ApiError);function y(e){switch(e){case n.conflict:case n.emptyFileOrFolder:case n.emptyFileOrFolderForDocLib:case n.fileSize:case n.folderUploadNotSupported:case n.insufficientVaultQuota:case n.invalidName:case n.lockMismatch:case n.malwareDetected:case n.overQuota:case n.overQuotaSharedFolder:case n.pathTooLong:case n.targetFolderMissing:case n.throttled:case n.unlockRequired:case n.versionMismatch:return!0;case n.accessDenied:case n.itemNotFound:case n.disconnected:case n.authFailure:case n.general:return!1;case n.none:case n.other:return}}var U=r("8e315e7d1c81f1fe46e0"),w=r("256c2b1df06b9b785912"),I=function(){function e(){var e=this.scope=new w.default;this._events=e.attach(new U.default(this))}return e.prototype.start=function(){},e.prototype.abort=function(){},e.prototype.dispose=function(){this.scope.dispose()},e.prototype.updateState=function(e){e!==this.state&&(this.state=e,this._events.raise("upload_state_change",e))},e}(),_=r("cc08c169973ba8efeefa"),F=8388608,O=262144e3,S=new u(3),A=function(e){function t(t){var r=this,a=t.fileUpload;return(r=e.call(this)||this)._fileUpload=a,r._authToken=t.authToken,r._uploadId=null,r._chunkNumber=0,r._streamingChunkNumber=0,r._currentChunkSize=F,r._currentStreamingChunkSize=O,r._onProgress=t.onProgress,r._dataRequestor=t.dataRequestor,r._async=r.scope.attach(new l.default(r)),r.totalBytes=a.size,r.uploadedBytes=0,r.fileName=a.name,r.iconName=t.iconName,r.state=0,r.error=null,r.nameConflictBehavior=0,r.allowRename=!1,r._expandAllItemFields=t.expandAllItemFields,r._uniqueId=t.uniqueId,r._parentItemKey=t.parentItemKey,r._targetItemKey=t.targetItemKey,r._serverRelativeItemUrl=t.serverRelativeItemUrl,r._webApiUrl=t.webApiUrl,r}return i.__extends(t,e),t.prototype.start=function(){var e=this;this.updateState(0);var t=S.enqueue(function(){return e.error=void 0,e.updateState(1),e._upload().then(function(){e.updateState(2)},function(t){var r;return r=t instanceof g?t:new g({message:t&&t.message||"",errorType:n.general}),e.error=r,e.updateState(4),s.default.reject(t)})});return this._uploadPromise=t,t},t.prototype.abort=function(){var e=this;if(2!==this.state){this.error=null,this.updateState(3);var t=this._uploadPromise;this._uploadPromise=void 0,t&&(t.cancel(),t.then(function(){},function(){}).done(function(){return e._cancelChunkUpload()}))}},t.prototype.restart=function(){var e,t=this,r=this._uploadPromise;this._uploadPromise=void 0,r?(r.cancel(),e=r.catch(function(){return t._cancelChunkUpload().catch(function(){})})):e=s.default.resolve(),e.done(function(){t.start()})},t.prototype._upload=function(){var e,t=this;this.uploadedBytes=0;var r=this._fileUpload.size;return r<=25165824?e=this._sendSingleRequestUpload():(this._maxUploadRequestDuration=15e4,e=this._sendStreamingUpload()),e.then(function(e){t.uploadedBytes=r,t.item=e})},t.prototype._createUploadError=function(e){var t,r,a,i;switch("string"==typeof e?a=String(e):(t=this._getErrorCode(e),r=e.status,a="string"==typeof e.message?String(e.message):e.message.value),t){case-2130575257:i=n.conflict;break;case-1:i=n.disconnected;break;case-2130575245:i=n.invalidName;break;case-2130246326:i=n.versionMismatch;break;case-2147023080:case-2130575282:i=n.overQuota;break;default:switch(r){case 401:i=n.authFailure;break;case 404:i=n.targetFolderMissing;break;case 403:case 429:i=n.accessDenied;break;case 409:i=n.conflict;break;case 412:i=n.versionMismatch;break;case 415:i=n.emptyFileOrFolder;break;case 423:i=n.lockMismatch;break;case 507:i=n.overQuota;break;default:a?i||(i=n.other):i=n.general}}return new g({message:a,errorType:i,allowRename:this.allowRename})},t.prototype._getErrorCode=function(e){var t=e.code;return(void 0===t?"":t).split(",").map(function(e){return Number(e)})[0]},t.prototype._getUploadFileUrl=function(){var e=this._uniqueId,t=this._serverRelativeItemUrl,r=this._webApiUrl;r=e?r.method("GetFolderById",e):j(r,{serverRelativeItemUrl:t,isFolder:!0});var a=this._fileUpload.name,n=1===this.nameConflictBehavior;r=r.segment("Files"),r=_.Killswitch.isActivated("BE901A1A-3518-425D-B67D-7AE0021E433B","9/25/2019","Add AutoCheckoutOnInvalidData param for uploading file")?r.methodWithAliases("AddUsingPath",{DecodedUrl:a,overwrite:n}):r.methodWithAliases("AddUsingPath",{DecodedUrl:a,overwrite:n,AutoCheckoutOnInvalidData:!0});var i="ListItemAllFields";return this._expandAllItemFields&&(i+="/ContentType/Fields"),i&&(r=r.oDataParameter("$Expand",i)),r.toString()},t.prototype._isConflictFile=function(){var e=this;if(1===this.nameConflictBehavior)return s.default.resolve(!1);var t=this._serverRelativeItemUrl,r=this._webApiUrl;return r=(r=j(r,{serverRelativeItemUrl:t,isFolder:!0})).segment("Files").oDataParameter("$filter","Name eq '"+b.default.encodeRestUriStringToken(this._fileUpload.name)+"'"),this._dataRequestor.getData({url:r.toString(),qosName:"SingleFileUploader.GetFile",authToken:this._authToken,parseResponse:function(t){var r=JSON.parse(t);return!!(r&&r.d&&r.d.results&&r.d.results.length>0)&&!(r.d.results[0].Exists&&e._streamingChunkNumber>0)}}).then(function(e){return e},function(e){return!!s.default.isCanceled(e)&&s.default.reject(e)})},t.prototype._processUploadCompleteResponse=function(e){return this._getItemFromResponse(e)},t.prototype._getItemFromResponse=function(e){var t;try{var r=JSON.parse(e).d,a=this._targetItemKey,n=void 0;r.ListItemAllFields&&r.ListItemAllFields.Id&&(n=String(r.ListItemAllFields.Id));var i=!1;if(r.ListItemAllFields&&r.ListItemAllFields.ContentType&&r.ListItemAllFields.ContentType.Fields&&r.ListItemAllFields.ContentType.Fields.results){var o=r.ListItemAllFields.ContentType.Fields.results.filter(function(e){return e.Required});if(o.length>0)for(var s=0,l=o;s<l.length;s++){var c=l[s];if(!r.ListItemAllFields[c.InternalName]){i=!0;break}}}var u=void 0;r.UniqueId&&(u=d.default.normalizeLower(r.UniqueId));var b=r.Name,p=m.b(b);t={key:a,parentKey:this._parentItemKey,type:f.default.File,id:r.ServerRelativeUrl,name:b,displayName:b,extension:p,properties:{ID:n,uniqueId:u},itemFromServer:r,hasMissingMetadata:i}}catch(e){}return t},t.prototype._generateChunkPostUrl=function(e,t){var r,a=this._fileUpload,n=this._uniqueId,o=a.size<=t,s=this._serverRelativeItemUrl,l=this._webApiUrl,c={uploadId:{guid:this._uploadId}};return 0===this._chunkNumber&&0===this._streamingChunkNumber?(r="StartUpload",l=(l=n?l.method("GetFolderById",n):j(l,{serverRelativeItemUrl:s,isFolder:!0})).segment("Files"),l=1===this.nameConflictBehavior?l.methodWithAliases("GetByPathOrAddStub",{DecodedUrl:a.name}):l.methodWithAliases("AddStubUsingPath",{DecodedUrl:a.name})):(r=o?"FinishUpload":"ContinueUpload",l=j(l,{serverRelativeItemUrl:s+"/"+a.name,isFolder:!1}),c=i.__assign({},c,{fileOffset:e})),(l=l.methodWithAliases(r,c)).toString()},t.prototype._getUploadStatus=function(){var e=this._fileUpload,t=this._uploadId,r=this._serverRelativeItemUrl,a=this._webApiUrl;return a=a.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:r+"/"+e.name}).methodWithAliases("GetUploadStatus",{uploadId:{guid:t}}),this._dataRequestor.getData({url:a.toString(),authToken:this._authToken,qosName:"SingleFileUploader.GetUploadStatus",method:"GET"}).then(function(e){return e.d&&e.d.ExpectedContentRange?parseInt(e.d.ExpectedContentRange.split("-")[0],10):s.default.reject(new Error("No expected range from server response."))})},t.prototype._uploadFragment=function(e,t){var r=this;void 0===e&&(e=0),void 0===t&&(t=3);var a=this._fileUpload.size,n=Math.min(this._currentChunkSize+e,a);this._uploadId||(this._uploadId=d.default.generate());var i=Date.now();return this._sendFileData({url:this._generateChunkPostUrl(e,n),qosName:"SingleFileUploader.SendFileRequest",data:this._fileUpload.slice(e,n),offset:e,length:n-e}).then(function(e){return r.uploadedBytes=n,n<a?(r._chunkNumber++,Date.now()-i<6e4&&(r._currentChunkSize=Math.min(Math.floor(r._currentChunkSize*Math.pow(2,.25)),62914560)),r._uploadFragment(n)):r._processUploadCompleteResponse(e)},function(a){if(s.default.isCanceled(a))return s.default.reject(a);if(-2===r._getErrorCode(a)){if(r._currentChunkSize>262144){r._currentChunkSize=Math.max(Math.floor(r._currentChunkSize/2),262144);var n=void 0;return 0===r._chunkNumber&&(n=r._cancelChunkUpload()),s.default.resolve(n).then(function(){return r._uploadFragment(e)})}}else if(t>0&&r._canRetry(a)){var i,o=new c.default(function(){i&&r._async.clearTimeout(i)});return i=r._async.setTimeout(function(){return o.complete()},1e3),o.getPromise().then(function(){return r._uploadFragment(e,t-1)})}return s.default.reject(r._createUploadError(a))})},t.prototype._sendSingleRequestUpload=function(){var e=this;return this._isConflictFile().then(function(t){if(t){var r=new g({message:"",errorType:n.conflict});return s.default.reject(r)}return e._fileUpload.slice(0,e._fileUpload.size)}).then(function(t){return e._sendFileData({url:e._getUploadFileUrl(),qosName:"SingleFileUploader.UploadFile",data:t,offset:0,length:t.size}).then(function(t){return e._processUploadCompleteResponse(t)}).then(function(e){return e},function(t){return s.default.isCanceled(t)?s.default.reject(t):-2===e._getErrorCode(t)?(e.nameConflictBehavior=1,e._uploadFragment()):s.default.reject(e._createUploadError(t))})})},t.prototype._sendStreamingUpload=function(e,t){var r=this;void 0===e&&(e=0),void 0===t&&(t=3),this._uploadId||(this._uploadId=d.default.generate());var a=this._fileUpload.size,i=this._streamingChunkNumber>0?Math.min(this._currentStreamingChunkSize+e,a):0;return this._isConflictFile().then(function(t){if(t){var a=new g({message:"",errorType:n.conflict});return s.default.reject(a)}return r._fileUpload.slice(e,i)}).then(function(n){return r._sendFileData({url:r._generateChunkPostUrl(e,i),qosName:"SingleFileUploader.SendFileRequest",data:n,offset:e,length:n.size}).then(function(e){return r.uploadedBytes=i,i<a?(r._streamingChunkNumber++,r._sendStreamingUpload(i,t)):r._processUploadCompleteResponse(e)},function(e){if(s.default.isCanceled(e))return s.default.reject(e);if(-2===r._getErrorCode(e)){if(r._currentStreamingChunkSize<=1048576)return s.default.reject(r._createUploadError(e));r._currentStreamingChunkSize=r._currentStreamingChunkSize/2}return r._getUploadStatus().then(function(e){return r._sendStreamingUpload(e,3)},function(a){if(t>0&&r._canRetry(e)){var n,i=new c.default(function(){n&&r._async.clearTimeout(n)});return n=r._async.setTimeout(function(){return i.complete()},1e3),i.getPromise().then(function(){return r._sendStreamingUpload(0,t-1)})}return s.default.reject(r._createUploadError(e))})})})},t.prototype._canRetry=function(e){var t;switch(this._getErrorCode(e)){case-2130575257:case-2130575142:t=!1;break;default:t=!0}return t},t.prototype._cancelChunkUpload=function(){var e=this._uploadId;if(this._uploadId=void 0,this._chunkNumber=0,e){var t=this._fileUpload,r=this._serverRelativeItemUrl,a=this._webApiUrl;return a=(a=j(a,{serverRelativeItemUrl:r+"/"+t.name,isFolder:!1})).methodWithAliases("CancelUpload",{uploadId:{guid:e}}),this._dataRequestor.getData({url:a.toString(),authToken:this._authToken,qosName:"SingleFileUploader.CancelUploadSession"}).then(function(){})}return s.default.resolve()},t.prototype._sendFileData=function(e){var t,r,a,n=this,i=e.url,o=e.qosName,s=e.data,l=e.offset,u=e.length,d=new c.default(function(){t.cancel()}),b=function(e){var t=n._chunkNumber>0&&l+u>=n._fileUpload.size?3e5:1e4,a=Math.max(.08*e,t);r&&n._async.clearTimeout(r),e&&(r=n._async.setTimeout(function(){d.error({code:"-1",message:""})},a))},f=Date.now(),m=Date.now(),p=0,v=0,h=0,g=this._async.debounce(function(e){e>n.uploadedBytes&&(n.uploadedBytes=e,n._onProgress&&n._onProgress(e))},100,{leading:!1});t=this._dataRequestor.getData({url:i,authToken:this._authToken,qosName:o,parseResponse:function(e){return e},contentType:"application/octet-stream",additionalPostData:s,onUploadProgress:function(e){if(e.lengthComputable){var t=Date.now();v+=(e.loaded-p)/(t-m),h++,a=e.loaded/(t-f),m=t,p=e.loaded,g(l+e.loaded),b(u-e.loaded)}}}),b(u);var y=this._async.setInterval(function(){h&&(Date.now()-f+(u-p)/((v+a)/(h+1))>n._maxUploadRequestDuration&&p<u&&d.error({code:"-2",message:""}))},1e4);return t.done(function(e){d.complete(e)},function(e){d.error(e)}),d.getPromise().done(function(){r&&n._async.clearTimeout(r),y&&n._async.clearInterval(y)},function(){t.cancel(),r&&n._async.clearTimeout(r),y&&n._async.clearInterval(y)}),d.getPromise()},t}(I);!function(e){function t(t,r){var a=t.parentItem,n=t.fileUpload,i=r.listContext,o=r.itemUrlHelper,s=r.apiUrlHelper,l=i&&i.contentTypesEnabled&&i.listTemplateType!==v.default.mySiteDocumentLibrary,c=o.getItemUrlParts(a.key),u=a.properties&&a.properties.uniqueId,d=a.key,b=function(e,t,r){var a=e.getItemUrlParts(t),n=a.serverRelativeItemUrl,i=a.normalizedListUrl,o=n+"/"+r;return Object(h.a)(o,i)}(o,d,n.name),f=c.serverRelativeItemUrl,m=s.build().webByItemUrl(c),g=new p.default({pageContext:r.pageContext,qosName:"SingleFileUploader"});return e.call(this,{uniqueId:u,expandAllItemFields:l,dataRequestor:g,parentItemKey:d,targetItemKey:b,serverRelativeItemUrl:f,webApiUrl:m,iconName:n.iconName,fileUpload:n})||this}i.__extends(t,e)}(A);function j(e,t){var r=t.serverRelativeItemUrl,a=t.isFolder;return e=e.methodWithAliases(a?"GetFolderByServerRelativePath":"GetFileByServerRelativePath",{DecodedUrl:r})}var k=r("65da65eb66805e3724ff"),C=r("ee92087a6ec1d0e9ecc9"),T=r("2be4cdf0880f45f00879"),D=r("6187b1a01125644c0b13"),P=r("578e5017557fc66bb247"),x=r("c21819129ba64362c121"),N=r("4e318b84c4772f9f58b9"),K=r("447964f318fe44ff3682"),R=r("3da5d317c00adfe8f79c"),E=r("6578506114fc52cc91d3"),L=r("eef09ec91afb2fd77b66"),z=r("a5db57338f8274c3300c"),q=r("a9dd204dd0bee7467912");var B=r("5fef64b3561abb2ebffa");function M(e){var t=this,r=e.itemKey,a=e.options.sourceEntries,n=o.D.deserialize(r),l=n.webAbsoluteUrl,c=n.listFullUrl,u=Object.keys(a)[0],d=a[u],b=d.progressItemKey,f=d.conflictResolution;return function(e){return i.__awaiter(t,void 0,void 0,function(){var t,a,d,m,p,h,y,U,w,I,_,F,O,S,j,M,W,G,H,Q,J,X,Y,$,Z;return i.__generator(this,function(ee){switch(ee.label){case 0:return d=e(Object(k.c)({webAbsoluteUrl:l,listFullUrl:c})),m=d.dataRequestor,p=d.hasDigest,d.hasTokenProvider?(y=void 0,[3,3]):[3,1];case 1:return[4,e(Object(k.a)({url:l||c,disallowCookies:!p}))];case 2:y=ee.sent(),ee.label=3;case 3:if(h=y,U=e(Object(P.a)({sourceFile:x.b},u)).sourceFile,w=e(Object(P.a)({folderPath:C.R},r)).folderPath,I=void 0===w?n.rootFolder:w,!U)throw new Error("No source file for upload.");if(!I)throw new Error("No path information for target folder.");_=Object(E.getWebApiUrl)({webAbsoluteUrl:l,listOrItemFullUrl:c}),F=new T.a(void 0),O=F.debounce(function(t){var r;b&&e(Object(N.a)({items:(r={},r[b]=Object(K.d)({progressSize:R.r},{progressSize:{current:t}}),r)}))},300,{leading:!1}),S=e(Object(L.a)(function(e){return e.demandItemFacet(C.nb,o.K.serialize({webAbsoluteUrl:l,listFullUrl:c}))})),j=S&&S.contentTypesEnabled&&S.templateType!==v.ListTemplateType.mySiteDocumentLibrary,(M=new A({authToken:h,dataRequestor:m,parentItemKey:"",targetItemKey:"",fileUpload:U,iconName:"",serverRelativeItemUrl:I,webApiUrl:_,onProgress:O,expandAllItemFields:j})).nameConflictBehavior="replace"===f?1:0,b&&e(Object(N.a)({items:(t={},t[b]=i.__assign({},R.r.pack({total:U.size,current:0})),t)})),W=M.start(),G=e(Object(L.a)(function(e){return e.demandItemFacet(R.e,b)})),H=G?G.token.subscribe(function(){M.abort()}):void 0,ee.label=4;case 4:return ee.trys.push([4,6,7,8]),[4,W];case 5:return ee.sent(),[3,8];case 6:if(Q=ee.sent(),M.abort(),s.default.isCanceled(Q))throw new z.CancelError;if(Q instanceof g)throw new D.a({facets:V(Q),innerError:Q});if((re=Q)&&("status"in re||re.message&&"object"==typeof re.message))throw new D.a({facets:i.__assign({},"-2130575257"===Q.code?i.__assign({},q.c.pack({supportsRename:!1})):i.__assign({},q.o.pack({})),C.Zb.pack(Q)),message:(te=Q,te&&te.message&&("object"==typeof te.message?te.message.value:te.message.toString())||"")});throw Q;case 7:return H&&H(),M.dispose(),[7];case 8:return J=M.item,X=J.properties,Y=X&&X.ID||J.id,$=X&&X.uniqueId,Z=o.D.serialize({webAbsoluteUrl:l,listFullUrl:c,itemId:Y}),e(Object(N.a)({items:(a={},a[Z]=i.__assign({},B.displayNameFacet.pack(J.displayName),$?C.zc.pack($):{},B.parentFolderItemFacet.pack({itemKey:r})),a)})),[2,{itemKey:Z}]}var te,re})})}}function V(e){switch(e.errorType){case n.conflict:return i.__assign({},q.c.pack({supportsRename:!1}));case n.accessDenied:return i.__assign({},q.a.pack({}));case n.disconnected:return i.__assign({},q.m.pack({}));case n.emptyFileOrFolder:case n.emptyFileOrFolderForDocLib:return i.__assign({},q.d.pack({}));case n.folderUploadNotSupported:return i.__assign({},q.g.pack({}));case n.invalidName:return i.__assign({},q.i.pack({}));case n.lockMismatch:return i.__assign({},q.k.pack({}));case n.malwareDetected:return i.__assign({},q.l.pack({}));case n.overQuota:return i.__assign({},q.n.pack({}));case n.targetFolderMissing:return i.__assign({},q.p.pack({}));case n.throttled:return i.__assign({},q.q.pack({}));case n.versionMismatch:return i.__assign({},q.r.pack({}))}return i.__assign({},q.o.pack({}))}r.d(t,"a",function(){return M})},ea854ccf8505a6610cbf:function(e,t,r){"use strict";var a,n,i=r("64328bb588b46459132d"),o=r("a4060cda3c9c24220a4a"),s=r("6578506114fc52cc91d3");!function(e){e[e.pin=0]="pin",e[e.unpin=1]="unpin",e[e.movePrevious=2]="movePrevious",e[e.moveNext=3]="moveNext"}(a||(a={})),function(e){e[e.success=0]="success",e[e.folderDoesNotExist=1]="folderDoesNotExist",e[e.itemDoesNotExist=2]="itemDoesNotExist",e[e.tooManyItems=3]="tooManyItems",e[e.itemNotInSpotlight=4]="itemNotInSpotlight",e[e.invalidArgument=5]="invalidArgument",e[e.serverError=6]="serverError",e[e.invalidServerJSON=7]="invalidServerJSON",e[e.unknownServerResult=8]="unknownServerResult"}(n||(n={}));var l=r("65da65eb66805e3724ff"),c=r("fcf654cc44d7ec457fe0"),u=r("655c29c4569d728dbf1e"),d=r("680b7ac74280293b48f0"),b=r("fdbcb7664c17b5b4e4d9"),f=r("4e318b84c4772f9f58b9"),m=r("ee92087a6ec1d0e9ecc9"),p=r("eef09ec91afb2fd77b66"),v=r("31c533de2caeaf8e942c"),h=r("638c4a826f3cd38b4e52"),g=r("d27387ede93a2620cbf6"),y=r("5fef64b3561abb2ebffa");r.d(t,"b",function(){return U}),r.d(t,"a",function(){return w}),r.d(t,"c",function(){return I});var U=3,w=function(e){function t(t){void 0===t&&(t={});var r=e.call(this,t)||this,a=t.resultType,n=void 0===a?8:a;return r.resultType=n,r}return i.__extends(t,e),t}(u.CustomError),I=Object(d.e)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,r=e.options.itemEditTypeMap;return function(e){return i.__awaiter(void 0,void 0,void 0,function(){var a,n,u,d,I,_,F,O,S,A,j,k,C,T,D,P,x,N,K,R,E,L;return i.__generator(this,function(z){switch(z.label){case 0:return u=Object.keys(r)[0],d=r[u].editType,[4,e(Object(v.a)(u))];case 1:if(I=z.sent(),_=I.key,F=I.itemId,O=e(Object(p.a)(function(e){return e.demandItem({deserializedPinnedItemSetKey:o.T,pinnedItems:b.a},t)})),S=O.deserializedPinnedItemSetKey,A=O.pinnedItems,S||(S=o.T.deserialize(t)),!_||!S||!F)throw new w({resultType:5});return _&&S&&F?(j="","",S.viewKey&&(j=S.viewKey.viewId),k=S.parentItemKey.rootFolder||new c.SimpleUri(S.parentItemKey.listFullUrl).path,C=void 0,(T=A&&A.itemKeys||[])&&(D=T.indexOf(u))>-1&&(2===d&&D>=2?C=T[D-2]:3===d&&D<T.length-1&&(C=T[D+1])),P=void 0,C&&(P=e(Object(p.a)(function(e){return e.demandItemFacet(m.pb,C)}))),x={webAbsoluteUrl:_.webAbsoluteUrl,listFullUrl:_.listFullUrl,itemId:F,editType:d,viewId:j,rootFolder:k,afterItemId:P},t&&(N=function(e,t,r,a){var n=a.editType,i=[];(0===n||void 0===r&&1!==n)&&i.push(e);for(var o=0,s=t;o<s.length;o++){var l=s[o];l!==e&&i.push(l),l===r&&i.push(e)}return i}(u,T,C,x)).length<=U&&e(Object(f.a)({items:i.__assign((a={},a[t]=i.__assign({},b.a.pack({itemKeys:N})),a),Object(h.a)(N,function(){return i.__assign({},Object(g.a)().forFacet(y.deletedFacet).thenInvalidate(t,b.a).pack())}))})),(K=function(e){var t=e.webAbsoluteUrl,r=e.listFullUrl,a=e.viewId,n=e.editType,i=e.itemId,o=e.afterItemId,l=e.rootFolder,c=Object(s.getListApiUrl)({webAbsoluteUrl:t,listFullUrl:r});if(a&&(c=c.methodWithAliases("GetView",{viewGuid:a})),1!==n){var u=o?parseInt(o,10):-1;isNaN(u)&&(u=-1),c=c.methodWithAliases("AddToSpotlight",{itemId:i,folderPath:l||"",afterItemId:u})}else c=c.methodWithAliases("RemoveFromSpotlight",{itemId:i,folderPath:l||""});return c.toString()}(x))?[4,e(Object(l.b)({webAbsoluteUrl:_.webAbsoluteUrl,listFullUrl:_.listFullUrl,url:K,method:"POST",additionalHeaders:void 0,qosName:"editPinnedItem",noRedirect:!0}))]:[3,3]):[3,3];case 2:if(R=z.sent(),0!==(E=function(e){try{if(e.d){var t=e.d.Order?e.d.Order.results:void 0;return{resultType:e.d.ResultCode,order:t}}return{resultType:8,order:void 0}}catch(e){return{resultType:7,order:void 0}}}(R)).resultType)throw L=function(e,t){var r=[];if(e.order)for(var a=0,n=e.order;a<n.length;a++){var s=n[a];r.push(o.D.serialize(i.__assign({},t,{itemId:s.toString()})))}return r}(E,_),e(Object(f.a)({items:i.__assign((n={},n[t]=i.__assign({},b.a.pack({itemKeys:L})),n),Object(h.a)(L,function(){return i.__assign({},Object(g.a)().forFacet(y.deletedFacet).thenInvalidate(t,b.a).pack())}))})),new w({resultType:E.resultType});z.label=3;case 3:return[2]}})})}})},f553bf0f97ddfedc1f32:function(e,t,r){"use strict";r.d(t,"a",function(){return n}),r.d(t,"c",function(){return i}),r.d(t,"b",function(){return o});var a=r("447964f318fe44ff3682"),n=new a.a("enabledForMultipleItems"),i=new a.a("isEnabledFunction"),o=new a.a("iconUrl")},f805b591e29f83f7dfba:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r("64328bb588b46459132d").__exportStar(r("90e9dbb8f74ee9c49c51"),t)}}]);