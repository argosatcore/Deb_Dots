(window.webPackBridgeJsonp=window.webPackBridgeJsonp||[]).push([[30],{"162aa6fc967bdc23b04b":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i("a8c7165f33a4dc07ab0d").loadStyles([{rawString:".od-ItemActivity-item{max-width:100%}.od-ItemActivity-item-nameText{font-weight:600;color:"},{theme:"bodyText",defaultValue:"#323130"},{rawString:"}.od-ItemActivity-item-linkText{font-weight:600;text-decoration:none}.od-ItemActivity-item-clickableLinkText{max-width:100%;color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:";cursor:pointer;font-family:inherit}.isFluent .od-ItemActivity-item-clickableLinkText{font-size:12px}.od-ItemActivity-otherActors{list-style-type:none;margin:0;padding:0}.od-ItemActivity-item-textContent{overflow:hidden;text-overflow:ellipsis;display:inline-block;max-width:100%;vertical-align:middle}.od-ItemActivity-item .ms-ActivityItem-activityContent{width:190px}.od-ItemActivity-timeStamp{display:inline-block;vertical-align:middle}html[dir='ltr'] .od-ItemActivity-timeStamp{padding-left:0}html[dir='rtl'] .od-ItemActivity-timeStamp{padding-right:0}.od-ItemActivity-timeStamp:before{content:'\\00a0\\2219\\00a0'}.od-ItemActivity-persona{position:relative;width:100%;height:100%;font-weight:400}.od-ItemActivity-personaIcon{position:absolute;top:0px;left:0px;width:100%;height:100%;border-radius:50%}\n"}])},"162df8efbe1f5220c650":function(e,t,i){"use strict";i.r(t),i.d(t,"strings",function(){return n});var n=i("4986dedaa57d766e48bb")["_I2E4T+qBCepxDcAwcgF/RA"];t.default=n},"18798f5d42e515ed48da":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i("a8c7165f33a4dc07ab0d").loadStyles([{rawString:".od-itemActivityMenu-dialogButton-default{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border:1px solid "},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-itemActivityMenu-dialogButton-default:hover{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-itemActivityMenu-dialogButton-default:active{background-color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-itemActivityMenu-dialogButton-primary{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-itemActivityMenu-dialogButton-primary:hover{background-color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}.od-itemActivityMenu-dialogButton-primary:active{background-color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}\n"}])},"2061b0836c1382c71d4c":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i("a8c7165f33a4dc07ab0d").loadStyles([{rawString:".od-addCommentTextField{display:-webkit-box;display:-ms-flexbox;display:flex;margin:4px 0px 16px 0px}.od-addCommentTextField .ms-TextField-suffix{margin:8px 0;padding:0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-addCommentTextField-input{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1}.od-addCommentTextField-input .ms-TextField-fieldGroup{background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-addCommentTextField-sendButton{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";background-color:unset}.od-addCommentTextField-spinner{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin:4px}.od-addCommentTextField-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}\n"}])},"28bf9cdfabbde49cc9ca":function(e,t,i){"use strict";i.r(t),i.d(t,"driveItemActivityFieldControlHandler",function(){return p});var n,r=i("275976081ce1abf67779"),o=i("95da7825c4969f34e250"),s=i("162df8efbe1f5220c650"),a=i("a7dc7556d5006d20bf06"),c=i("5fef64b3561abb2ebffa"),l=i("21bb5ae55361f0d7547d"),d=i("b42a92de8b5644477b18"),m=i("4fab54035bc77294dc42");function u(e,t){var i=e.activity,n=e.hoverCardElementsPerUser,o=e.personKeyByEmail;if(i){var a,c=(a=i.type,h[a]);return c?new c({activity:i,canOpenItem:function(){return!1},containingItem:{absolutePath:"",isFolder:!1,name:t,graphItemUrl:""},onRenderUser:function(e,t){if(!e||!t)return null;var i=t(e),s=e.user,a=s.email||"",c=n[a],l=o[a];return c?r.cloneElement(c,{displayValue:s.displayName,personKey:l,user:s},i):i},currentUserEmail:"",isSingleLevel:!0,onItemClick:function(){},strings:s.default}):void 0}}var h=((n={})[0]=a.EditItemActivity,n[1]=a.MoveItemActivity,n[2]=a.CommentItemActivity,n[3]=a.CommentResponseItemActivity,n[4]=a.MentionItemActivity,n[5]=a.VersionItemActivity,n[6]=a.RestoreItemActivity,n[9]=a.RenameItemActivity,n[10]=a.DeleteItemActivity,n[11]=a.CreateItemActivity,n[12]=a.ShareItemActivity,n);var p=Object(o.a)()(function(){return function(){return function(e,t){var i=t.itemKey,n=t.activity,r={},o={};if(m.a.matches(i)){var s=m.a.deserialize(i),a=s.endpoint,h=n&&n.actors||[],p=n&&n.action,g=p&&p.mention&&p.mention.mentionees||[],y=p&&p.share&&p.share.recipients||[],f=p&&p.commentResponse&&p.commentResponse.commentAuthor,v=h.concat(g,y);f&&v.push(f);for(var b=0,C=v;b<C.length;b++){var _=C[b];if(_.email){var x=d.a.serialize({email:_.email,endpoint:a}),F={itemKey:x,displayValue:_.displayName},A=Object(l.b)(e,F).hoverCardElement;r[_.email]=A,o[_.email]=x}}}var E=e.demandItemFacet(c.fileNameFacet,i),S=n&&E&&u({activity:n,hoverCardElementsPerUser:r,personKeyByEmail:o},E.name);return{itemActivity:S}}}})},"2a8d4253e5521c6ccadc":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.shade30="#004578",e.shade20="#005a9e",e.shade10="#106ebe",e.primary="#0078d4",e.tint10="#2b88d8",e.tint20="#c7e0f4",e.tint30="#deecf9",e.tint40="#eff6fc"}(t.CommunicationColors||(t.CommunicationColors={})),function(e){e.black="#000000",e.gray220="#11100f",e.gray210="#161514",e.gray200="#1b1a19",e.gray190="#201f1e",e.gray180="#252423",e.gray170="#292827",e.gray160="#323130",e.gray150="#3b3a39",e.gray140="#484644",e.gray130="#605e5c",e.gray120="#797775",e.gray110="#8a8886",e.gray100="#979593",e.gray90="#a19f9d",e.gray80="#b3b0ad",e.gray70="#bebbb8",e.gray60="#c8c6c4",e.gray50="#d2d0ce",e.gray40="#e1dfdd",e.gray30="#edebe9",e.gray20="#f3f2f1",e.gray10="#faf9f8",e.white="#ffffff"}(t.NeutralColors||(t.NeutralColors={})),function(e){e.pinkRed10="#750b1c",e.red20="#a4262c",e.red10="#d13438",e.redOrange20="#603d30",e.redOrange10="#da3b01",e.orange30="#8e562e",e.orange20="#ca5010",e.orange10="#ffaa44",e.yellow10="#fce100",e.orangeYellow20="#986f0b",e.orangeYellow10="#c19c00",e.yellowGreen10="#8cbd18",e.green20="#0b6a0b",e.green10="#498205",e.greenCyan10="#00ad56",e.cyan40="#005e50",e.cyan30="#005b70",e.cyan20="#038387",e.cyan10="#00b7c3",e.cyanBlue20="#004e8c",e.cyanBlue10="#0078d4",e.blue10="#4f6bed",e.blueMagenta40="#373277",e.blueMagenta30="#5c2e91",e.blueMagenta20="#8764b8",e.blueMagenta10="#8378de",e.magenta20="#881798",e.magenta10="#c239b3",e.magentaPink20="#9b0062",e.magentaPink10="#e3008c",e.gray40="#393939",e.gray30="#7a7574",e.gray20="#69797e",e.gray10="#a0aeb2"}(t.SharedColors||(t.SharedColors={}))},"2eb6c007b234c6e13333":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("64328bb588b46459132d");i("2061b0836c1382c71d4c"),i("df676915c716da19c40f");var r=i("275976081ce1abf67779"),o=i("646ed378ac0e9617b57e"),s=i("a2d31539bf2fc81e7f2d"),a=i("eff2fc75ac80acbd49db"),c=i("15445632c7c7b851c44c"),l=i("edcba52cd65fc036ab4e"),d=i("c66f09e6ff6ae2202829"),m=function(e){function t(t){var i=e.call(this,t)||this;return i._textField=r.createRef(),i.COMMENT_TEXT_MAX_LENGTH=2e3,i.charLimitExceededMessage="Maximum character limit exceeded",i._onSend=function(){var e=i.props,t=e.onSend,n=e.engagementSource,r=e.engagementExtraData,o=i.state.text;if(o&&t){i.setState({sending:!0,errorMessage:"",successMessage:""}),t(o,function(){i._onClearTextField(),i.setState({successMessage:l.default.CommentAdded})},function(e){i.setState({sending:!1,errorMessage:e})});var s=n?n+".":"AddCommentTextField.";d.Engagement.logData({name:s+"Send.Click",isIntentional:!0,extraData:r})}},i._onClearTextField=function(){i.setState(i._getResetState(),function(){i._textField&&i._textField.current&&i._textField.current.focus()})},i._onTextFieldChange=function(e,t){!t||t.length<=i.COMMENT_TEXT_MAX_LENGTH?i.setState({text:t||"",errorMessage:"",enableSendButton:!(!t||!t.trim())}):i.setState({text:i.state.text,errorMessage:i.charLimitExceededMessage,enableSendButton:!1})},i._onKeyDown=function(e){e.which===o.KeyCodes.enter&&i.state.enableSendButton&&i._onSend()},i.state=i._getResetState(),i}return n.__extends(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.commentItemId===this.props.commentItemId&&e.disabled===this.props.disabled||this.setState(n.__assign({},this._getResetState(),{errorMessage:"",successMessage:""}))},t.prototype.render=function(){var e=this.props,t=e.overrideStyleName,i=(e.engagementSource,e.commentItemId,e.enableNewCommentingExperience);return r.createElement("div",{className:o.css({"od-addCommentTextField":!i},{"od-addNewCommentTextField":i},t)},r.createElement(a.TextField,n.__assign({componentRef:this._textField,"data-lpignore":"true"},this._getTextFieldProps())),r.createElement("div",{className:o.css({"od-addCommentTextField-screenReaderOnly":!i},{"od-addNewCommentTextField-screenReaderOnly":i}),"aria-live":"assertive",role:"status","aria-label":this.state.successMessage},this.state.successMessage))},t.prototype._getTextFieldProps=function(){var e=this,t=this.props,i=t.placeholderText,n=t.disabled,r=t.enableNewCommentingExperience,s=this.state,a=s.sending,c=s.text,l=s.errorMessage;return{className:o.css({"od-addCommentTextField-input":!r},{"od-addNewCommentTextField-input":r},{"od-addNewCommentTextField-disabled":r&&n}),placeholder:i,onChange:this._onTextFieldChange,value:c||"",disabled:n||a,onKeyDown:this._onKeyDown,autoComplete:"off",errorMessage:l,autoAdjustHeight:r&&c.length>0,multiline:r&&c.length>0,rows:1,resizable:!1,onRenderSuffix:function(t){return e._onRenderSuffix()}}},t.prototype._onRenderSuffix=function(){return this.props.enableNewCommentingExperience?this.state.text.length>0&&r.createElement(r.Fragment,null,this._getSendButton(),this._getCancelButton()):r.createElement(r.Fragment,null,this._getCancelButton(),this._getSendButton())},t.prototype._getCancelButton=function(){var e=this.props.enableNewCommentingExperience;return r.createElement(c.IconButton,{iconProps:{iconName:"Cancel"},ariaLabel:l.default.cancelLabel,title:l.default.cancelLabel,onClick:this._onClearTextField,className:o.css({"od-addNewCommentTextField-cancelButton":e})})},t.prototype._getSendButton=function(){var e=this.props,t=e.sendButtonTitle,i=e.enableNewCommentingExperience;return this.state.sending?r.createElement("div",{className:o.css({"od-addCommentTextField-spinner":!i},{"od-addNewCommentTextField-spinner":i})},r.createElement(s.Spinner,{size:s.SpinnerSize.small})):r.createElement(c.IconButton,{className:o.css({"od-addCommentTextField-sendButton":!i},{"od-addNewCommentTextField-sendButton":i}),iconProps:{iconName:"Send"},ariaLabel:l.default.sendLabel||t,title:l.default.sendLabel||t,onClick:this._onSend,disabled:!this.state||!this.state.enableSendButton})},t.prototype._getResetState=function(){return{text:"",enableSendButton:!1,sending:!1,errorMessage:""}},t}(o.BaseComponent);t.default=m},"3a5ea0f2179e1645d98c":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("64328bb588b46459132d"),r=i("275976081ce1abf67779"),o=i("d674d675f168e38dc4f8"),s=i("00dfb328a6cea6a0320f"),a=i("f8d3e2e576810d284ffa"),c=i("613f460ac6104075ad08"),l=i("5a6459d968e8e4449149"),d=i("dc89aa5278a9a06d2126"),m=i("646ed378ac0e9617b57e");i("162aa6fc967bdc23b04b");var u=i("d74772ef7c74c6f2cee8"),h=i("2a8d4253e5521c6ccadc"),p=i("87a575c0d667197cf8b8"),g=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n.charsWithinParenthesisRegex=/\(([^)]*)\)/gi,n.excludedCharactersRegex=/\([^)]*\)|[\0-\u001F\!-/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/gi,n.multipleSpacesRegex=/\s+/gi,n._onRenderIcon=function(){var e=n.props.activity.getIconName();return r.createElement(c.Icon,{iconName:e})},n._onRenderActivityDescription=function(){return r.createElement("div",{className:"od-ItemActivity-item-textContent"},n.props.activity.getTitle({isCompact:n.props.isCompact,hideDate:n.props.hideDate}))},n._onRenderActivityTimeStamp=function(e,t){if(n.props.isCompact){var i=s.getStyles(void 0,void 0),o=a.getClassNames(i,e.className,e.activityPersonas,e.isCompact);return r.createElement("div",{className:m.css(o.timeStamp,"od-ItemActivity-timeStamp")},e.timeStamp)}return t?t(e):null},n._onRenderHiddenTimeStamp=function(e,t){return null},n._onRenderActivityDescription=n._onRenderActivityDescription.bind(n),n._onRenderIcon=n._onRenderIcon.bind(n),n.state={isMouseOver:!1,hasFocus:!1},n}return n.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props,i=t.activity,n=t.isCompact,s=t.hideDate,a=t.isInGrid,c=(t.children,this.props.activity.getIconName()),d=u.isFluentActiveOD?{root:{color:h.NeutralColors.gray130},activityTypeIcon:{color:h.SharedColors.cyanBlue10,height:"16px",marginTop:"8px"}}:void 0,p=i.getResponse(),g=i.getContextualMenu(!this.props.isNewCommentExperienceEnabled||this.state.isMouseOver||this.state.hasFocus);return r.createElement(l.FocusZone,{className:"od-ItemActivity-item-focusZone",direction:l.FocusZoneDirection.horizontal,handleTabKey:l.FocusZoneTabbableElements.all,"data-is-focusable":!0,"aria-label":this._getAriaLabel(),role:a?"row":void 0,onMouseOver:this.props.isNewCommentExperienceEnabled?function(){e._onMouseOver()}:void 0,onMouseLeave:this.props.isNewCommentExperienceEnabled?function(){e._onMouseOut()}:void 0,onFocusNotification:this.props.isNewCommentExperienceEnabled?function(){e._onFocus()}:void 0,onBlur:this.props.isNewCommentExperienceEnabled?function(){e._onBlur()}:void 0},r.createElement("div",{role:a?"gridcell":void 0,key:"activity_"+i.getKey(),className:m.css({"od-ItemActivityList-activity-withCommentResponse":!!p},"od-ItemActivityList-activity")},r.createElement(o.ActivityItem,{key:i.getKey(),className:"od-ItemActivity-item",onRenderActivityDescription:this._onRenderActivityDescription,onRenderIcon:c&&this._onRenderIcon||void 0,activityPersonas:this._getPersonaProperties(),timeStamp:this._onRenderDate(),onRenderTimeStamp:s?this._onRenderHiddenTimeStamp:this._onRenderActivityTimeStamp,isCompact:n,styles:d})),g,p)},t.prototype._onRenderDate=function(){var e=this.props.activity;return(d.getRelativeDateTimeStringForLists(e.getFriendlyDisplayTime()||"")||d.getFriendlyDateTimeStringPast(e.getDate())).toString()},t.prototype._getAriaLabel=function(){return this.props.activity.getDescription({stringOnly:!0}).join("")+" "+this._onRenderDate()},t.prototype._onMouseOver=function(){this.setState({isMouseOver:!0})},t.prototype._onMouseOut=function(){this.setState({isMouseOver:!1})},t.prototype._onFocus=function(){this.setState({hasFocus:!0})},t.prototype._onBlur=function(){this.setState({hasFocus:!1})},t.prototype._getInitial=function(e){var t="";if(!e)return t;var i=(e=(e=(e=(e=e.replace(this.charsWithinParenthesisRegex,"")).replace(this.excludedCharactersRegex,"")).replace(this.multipleSpacesRegex," ")).trim()).split(" ");return i.length>=2?(t+=i[0].charAt(0).toUpperCase(),t+=i[i.length-1].charAt(0).toUpperCase()):0!==i.length&&(t+=i[0].charAt(0).toUpperCase()),t},t.prototype._getPersonaProperties=function(){var e=this.props,t=e.activity,i=e.isNewCommentExperienceEnabled,n=t.getCommentAuthorName(),o=t.getcommentAuthorEmail(),s=n||o,a=this._getInitial(s),c=t.getPersonaIconUrl(),l={imageUrl:c},d={imageInitials:a,initialsColor:p.getPersonaInitialsColor({text:s}),onRenderInitials:function(){return r.createElement("div",{className:"od-ItemActivity-persona"},a,r.createElement("img",{className:"od-ItemActivity-personaIcon",src:c}))}};return i?[d]:[l]},t}(r.Component);t.default=g},"5a6459d968e8e4449149":function(e,t,i){"use strict";i.r(t);var n=i("8e621cbe69c505de07ed");i.d(t,"FocusZone",function(){return n.a}),i.d(t,"FocusZoneTabbableElements",function(){return n.c}),i.d(t,"FocusZoneDirection",function(){return n.b})},"87a575c0d667197cf8b8":function(e,t,i){"use strict";i.r(t);var n=i("763b72f7e135294264be");i.d(t,"getPersonaInitialsColor",function(){return n.getPersonaInitialsColor}),i.d(t,"Persona",function(){return n.Persona}),i.d(t,"PersonaBase",function(){return n.PersonaBase}),i.d(t,"PersonaSize",function(){return n.PersonaSize}),i.d(t,"PersonaPresence",function(){return n.PersonaPresence}),i.d(t,"PersonaInitialsColor",function(){return n.PersonaInitialsColor}),i.d(t,"PersonaCoin",function(){return n.PersonaCoin}),i.d(t,"PersonaCoinBase",function(){return n.PersonaCoinBase}),i.d(t,"personaSize",function(){return n.personaSize}),i.d(t,"personaPresenceSize",function(){return n.personaPresenceSize}),i.d(t,"sizeBoolean",function(){return n.sizeBoolean}),i.d(t,"sizeToPixels",function(){return n.sizeToPixels}),i.d(t,"presenceBoolean",function(){return n.presenceBoolean})},"8e621cbe69c505de07ed":function(e,t,i){"use strict";var n=i("2eebbc2987f7745602b4");Object(n.a)("@fluentui/react-focus","7.13.3");var r=i("9d410805f339fb056b8f"),o=i("8a3684f41d44e5d9df56");i.d(t,"a",function(){return r.a}),i.d(t,"c",function(){return o.b}),i.d(t,"b",function(){return o.a})},"96eba122dd98e5ce14b7":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("64328bb588b46459132d"),r=i("275976081ce1abf67779"),o=i("15445632c7c7b851c44c"),s=i("bf9566cd9ae1eb1ba33c"),a=i("08d36306a67eaad82f6a"),c=i("646ed378ac0e9617b57e"),l=i("c66f09e6ff6ae2202829"),d=i("162df8efbe1f5220c650");i("18798f5d42e515ed48da");var m=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n._onDismissDialog=function(){n.setState({hideDialog:!0})},n.state={dialogTitle:"",onDialogConfirm:void 0,hideDialog:!0,holdMenuButton:!1},n}return n.__extends(t,e),t.prototype.render=function(){var e=this,t=this.state,i=t.dialogTitle,n=t.onDialogConfirm,l=t.hideDialog,m=t.holdMenuButton,u=this.props,h=u.isVisible,p=u.environment,g=this._getMenuItems();if(g)return r.createElement(r.Fragment,null,r.createElement(o.IconButton,{className:c.css("od-ItemActivity-contextMenu",{"od-ItemActivity-contextMenu-opacity":"consumer"===p&&!(h||m)}),role:"button",iconProps:{iconName:"More"},onRenderMenuIcon:function(){},ariaLabel:d.default.activityMenuAriaLabel,menuProps:{directionalHint:a.DirectionalHint.bottomAutoEdge,isBeakVisible:!1,gapSpace:0,shouldFocusOnMount:!0,items:g,styles:{root:"od-ItemActivity-menuItems"}},onMenuClick:function(){e.setState({holdMenuButton:!0})},onAfterMenuDismiss:function(){e.setState({holdMenuButton:!1})}}),r.createElement(s.Dialog,{hidden:l,onDismiss:this._onDismissDialog,dialogContentProps:{type:s.DialogType.normal,title:i}},r.createElement(s.DialogFooter,null,r.createElement(o.DefaultButton,{className:c.css({"od-itemActivityMenu-dialogButton-default":"consumer"===p}),disabled:!1,onClick:function(){n(),e._onDismissDialog()},text:d.default.activityMenuDialogConfirm}),r.createElement(o.DefaultButton,{className:c.css({"od-itemActivityMenu-dialogButton-primary":"consumer"===p}),disabled:!1,primary:!0,onClick:this._onDismissDialog,text:d.default.activityMenuDialogCancel}))))},t.prototype._getMenuItems=function(){var e=this,t=this.props,i=t.itemActivityMenuItems,n=t.activityId;return i.map(function(t){return{key:t.key,name:t.name,onClick:function(i,r){var o=t.dialogOnConfirm;t.dialogTitle&&o?e.setState({dialogTitle:t.dialogTitle,onDialogConfirm:o,hideDialog:!1}):t.onClickMenuOption&&t.onClickMenuOption(i,r),l.Engagement.logData({name:"ActivityItemMenu."+t.name+".Click",isIntentional:!0,extraData:{activityId:n}})}}})},t}(r.Component);t.default=m},a7dc7556d5006d20bf06:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("64328bb588b46459132d"),r=i("c60ca1f143d0e4a661d1"),o=i("96eba122dd98e5ce14b7"),s=i("275976081ce1abf67779"),a=i("0a3e1b609e40999fd831"),c=i("c1f3e5198a9ff76f0d3f"),l=i("537050c76e992e2a700a"),d=i("dc89aa5278a9a06d2126"),m=i("646ed378ac0e9617b57e"),u=i("162df8efbe1f5220c650");function h(e){return e?1:3}var p=function(){function e(e){var t=this;this._onRenderUser=function(e,i){var n=e.user;return t._getUserLabel(n,{stringOnly:!1,isAccusative:e.isAccusative})},this.activity=e.activity,this.currentUserEmail=e.currentUserEmail,this.containingItem=e.containingItem,this.isSingleLevel=e.isSingleLevel,this.canOpenItem=e.canOpenItem,this.onItemClick=e.onItemClick,this.strings=e.strings,this.onRenderUser=e.onRenderUser,this.currentListTitle=e.currentListTitle,this.currentRootTitle=e.currentRootTitle,this.defaultItemTitle=e.defaultItemTitle,this.commentListItem=e.commentListItem,this.isReadonly=e.isReadonly,this.canDeleteActivity=e.canDeleteActivity,this.activityMenuFunctions=e.activityMenuFunctions,this.isNewCommentExperienceEnabled=e.isNewCommentExperienceEnabled,this.environment=e.environment,this.getpersonaIconUrl=e.getpersonaIconUrl,this.displayLargeText=e.displayLargeText}return e.prototype.getKey=function(){return this.activity.id},e.prototype.getTitle=function(e){return void 0===e&&(e={}),this.getDescription(e)},e.prototype.getDescription=function(e){return void 0===e&&(e={}),[]},e.prototype.getIconName=function(){return"ActivityFeed"},e.prototype.getPersonaIconUrl=function(){},e.prototype.getDate=function(){return this.activity.time},e.prototype.getFriendlyDisplayTime=function(){return this.activity.friendlyDisplayTime},e.prototype.getActivityTypeString=function(){return""},e.prototype.getResponse=function(){},e.prototype.getContextualMenu=function(e){},e.prototype.getenvironment=function(){return this.environment},e.prototype.getCommentAuthorName=function(){},e.prototype.getcommentAuthorEmail=function(){},e.prototype._getFilteredActors=function(e){for(var t,i,n=e.actors,r=void 0===n?this.activity.actors||[]:n,o=e.isCompact,s=[],a=0,c=r;a<c.length;a++){var l=c[a];l&&l.self?t=l:s.push(l)}t&&(s=[t].concat(s));var d=h(o);return s.length>d&&(i=s.slice(d,s.length)),{youUser:t,additionalUsers:i,sortedUsers:s.length?s:[void 0]}},e.prototype._getAdditionalUsersTooltip=function(e,t){var i=t.stringOnly,n=t.isCompact,r=t.hideDate,o=t.isAccusative,l=void 0!==o&&o,d=n&&r?l?a.getLocalizedCountValue(this.strings.andOtherUsersCountFormShortAccusative,this.strings.otherActorsCountFormShortIntervals,e.length):a.getLocalizedCountValue(this.strings.andOtherActorsCountFormShort,this.strings.otherActorsCountFormIntervals,e.length):l?a.getLocalizedCountValue(this.strings.andOtherUsersCountFormAccusative,this.strings.otherActorsCountFormShortIntervals,e.length):a.getLocalizedCountValue(this.strings.andOtherActorsCountForm,this.strings.otherActorsCountFormIntervals,e.length),m=a.formatToArray(d,e.length);if(i)return m;var u={onRenderContent:function(){var t=e.map(function(e){return s.createElement("li",null,e.displayName)});return s.createElement("ul",{className:"od-ItemActivity-otherActors"},t)}};return s.createElement(c.TooltipHost,{tooltipProps:u},m)},e.prototype.getRenderedUsers=function(e,t){var i=this,n=t.stringOnly,r=t.isAccusative,o=t.isActor;return e&&0!==e.length?e.map(function(e,t){return i.renderUser(e,{stringOnly:n,isAccusative:r,isActor:o},t)||""}):[this.renderUser(void 0)]},e.prototype.renderUser=function(e,t,i){void 0===i&&(i=0);var n=this.onRenderUser,r=void 0===n?this._onRenderUser:n,o=t.stringOnly,a=t.isAccusative,c=t.isActor,l=this._getUserLabel(e,{stringOnly:!0,isAccusative:a});if(!e||o)return l;var d=(c?"_actor":"_")+i;return s.createElement("span",{key:e.email+d,"aria-label":l},r({user:e,isAccusative:a},this._onRenderUser))},e.prototype.renderMainItemLink=function(e,t,i){return this.isSingleLevel?e:a.formatToArray(t,this.renderItemLink({item:this.activity.item,stringOnly:i}))},e.prototype.renderItemLink=function(e){var t=this,i=e.item,n=e.itemLabel,r=e.stringOnly,o=e.keyPrefix,a=void 0===o?"":o,c=n;if(c||(c=i&&i.isRoot?this._getRootFolderName():void 0),c||(c=i&&i.name?i.name:this._getDefaultItemName()),c){if(r)return c;var d=void 0;if("string"==typeof c){d=c;var u=void 0,h=void 0;if(-1!==c.indexOf(".")){var p=c.split(".");u=p.slice(0,-1).join(),h=p.slice(-1).join()}else u=c,h="";u.length>40&&(c=u.slice(0,37).concat("...").concat(h))}var g=c;if(this.canOpenItem&&this.canOpenItem(i)){var y=void 0;return y=d?s.createElement("span",{className:"od-ItemActivity-item-textContent}",title:d}," ",c," "):s.createElement("span",{className:"od-ItemActivity-item-textContent}"}," ",c," "),s.createElement(l.Link,{key:a+"_"+g+"_link",className:m.css("od-ItemActivity-item-linkText","od-ItemActivity-item-clickableLinkText"),onClick:function(){return t.onItemClick(i,t.getActivityTypeString())},href:"javascript:void(0)"},y)}return d?s.createElement("span",{key:a+"_"+g+"_string",className:"od-ItemActivity-item-linkText",title:d},c):s.createElement("span",{key:a+"_"+g+"_string",className:"od-ItemActivity-item-linkText"},c)}},e.prototype._getRootFolderName=function(){return this.currentRootTitle},e.prototype._getDefaultItemName=function(){return(this.currentListTitle?this.currentListTitle:this.defaultItemTitle)||void 0},e.prototype._getUserLabel=function(e,t){var i,n=t.stringOnly,r=t.isAccusative;return i=e&&e.self?r?this.strings.you:this.strings.youUpperCase:e&&e.displayName?e.displayName:e&&e.email?e.email:this.strings.someoneUpperCase,n?i:s.createElement("span",{className:"od-ItemActivity-item-nameText"},i)},e}();t.BaseItemActivity=p;var g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.getDescription=function(e){var t,i=void 0===e?{}:e,n=i.isCompact,r=i.stringOnly,o=i.hideDate,s=this.renderMainItemLink(this.strings.editThisFile,this.strings.editArbitraryFile,r),c=this._getFilteredActors({isCompact:n}),l=c.youUser,d=c.sortedUsers,m=c.additionalUsers,u=h(n);if(d.length>u){var p=n?!this.isNewCommentExperienceEnabled&&l?this.strings.youEditedCountFormShort:this.strings.othersEditedCountFormShort:!this.isNewCommentExperienceEnabled&&l?this.strings.youEditedCountForm:this.strings.othersEditedCountForm;return a.formatToArray.apply(a,[p,s].concat(this.getRenderedUsers(d.slice(0,u),{stringOnly:r,isActor:!0}),[this._getAdditionalUsersTooltip(m,{stringOnly:r,isCompact:n,hideDate:o})]))}var g=n?!this.isNewCommentExperienceEnabled&&l?this.strings.youEditedListFormShort:this.strings.othersEditedListFormShort:!this.isNewCommentExperienceEnabled&&l?this.strings.youEditedListForm:this.strings.othersEditedListForm;return t=a.getLocalizedCountValue(g,n?this.strings.editedListFormShortIntervals:this.strings.editedListFormIntervals,d.length),a.formatToArray.apply(a,[t,s].concat(this.getRenderedUsers(d,{stringOnly:r,isActor:!0})))},t.prototype.getIconName=function(){return"Edit"},t.prototype.getActivityTypeString=function(){return"edit"},t}(p);t.EditItemActivity=g;var y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.getDescription=function(e){var t,i=void 0===e?{}:e,n=i.isCompact,r=i.stringOnly,o=this.renderMainItemLink(this.strings.moveThisFile,this.strings.moveArbitraryFile,r),s=this._getFilteredActors({isCompact:n}),c=s.youUser,l=this.renderUser(s.sortedUsers[0],{stringOnly:r,isActor:!0});if(!n&&this.activity.action&&this.activity.action.move){var d=this.activity.action.move;if(d.from&&d.to){var m=this.renderItemLink({item:d.from,stringOnly:r,keyPrefix:"old"}),u=this.renderItemLink({item:d.to,stringOnly:r});return t=!this.isNewCommentExperienceEnabled&&c?this.strings.youMovedFromFolderToFolder:this.strings.otherMovedFromFolderToFolder,a.formatToArray(t,o,l,m,u)}if(d.from){m=this.renderItemLink({item:d.from,stringOnly:r,keyPrefix:"old"});return t=!this.isNewCommentExperienceEnabled&&c?this.strings.youMovedFromFolder:this.strings.otherMovedFromFolder,a.formatToArray(t,o,l,m)}if(d.to){u=this.renderItemLink({item:d.to,stringOnly:r});return t=!this.isNewCommentExperienceEnabled&&c?this.strings.youMovedToFolder:this.strings.otherMovedToFolder,a.formatToArray(t,o,l,void 0,u)}}return t=n?!this.isNewCommentExperienceEnabled&&c?this.strings.youMovedShort:this.strings.otherMovedShort:!this.isNewCommentExperienceEnabled&&c?this.strings.youMoved:this.strings.otherMoved,a.formatToArray(t,o,l)},t.prototype.getIconName=function(){return"FabricMovetoFolder"},t.prototype.getActivityTypeString=function(){return"move"},t}(p);t.MoveItemActivity=y;var f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.getDescription=function(e){var t,i,n=void 0===e?{}:e,r=n.isCompact,o=n.stringOnly,s=n.hideDate,c=this.renderMainItemLink(this.strings.commentedOnThisFile,this.strings.commentedOnArbitraryFile,o),l=this._getFilteredActors({isCompact:r}),d=l.youUser,m=l.sortedUsers,u=l.additionalUsers,p=h(r);if(this._isOnFileComment()){var g=void 0;if(r)t=!this.isNewCommentExperienceEnabled&&d?this.strings.youCommentedListFormShort:this.strings.othersCommentedListFormShort;else{var y=this._getCommentMessage(o);this.isSingleLevel&&y?(g=y,t=!this.isNewCommentExperienceEnabled&&d?this.strings.youCommentedOnThisFile:this.strings.othersCommentedOnThisFile):(g=c,t=!this.isNewCommentExperienceEnabled&&d?this.strings.youCommentedOnFile:this.strings.othersCommentedOnFile)}i=a.formatToArray.apply(a,[t,g].concat(this.getRenderedUsers(m,{stringOnly:o,isActor:!0})))}else if(m.length>p){var f=r?!this.isNewCommentExperienceEnabled&&d?this.strings.youCommentedCountFormShort:this.strings.othersCommentedCountFormShort:!this.isNewCommentExperienceEnabled&&d?this.strings.youCommentedCountForm:this.strings.othersCommentedCountForm;i=a.formatToArray.apply(a,[f,c].concat(this.getRenderedUsers(m.slice(0,p),{stringOnly:o,isActor:!0}),[this._getAdditionalUsersTooltip(u,{stringOnly:o,isCompact:r,hideDate:s})]))}else{var v=r?!this.isNewCommentExperienceEnabled&&d?this.strings.youCommentedListFormShort:this.strings.othersCommentedListFormShort:!this.isNewCommentExperienceEnabled&&d?this.strings.youCommentedListForm:this.strings.othersCommentedListForm;t=a.getLocalizedCountValue(v,r?this.strings.commentedListFormShortIntervals:this.strings.commentedListFormIntervals,m.length),i=a.formatToArray.apply(a,[t,c].concat(this.getRenderedUsers(m,{stringOnly:o,isActor:!0})))}return i},t.prototype.getIconName=function(){if(this.isNewCommentExperienceEnabled){var e=this._getCommentDetail();return this.commentListItem&&e?void 0:"Chat"}return this.commentListItem?void 0:"Chat"},t.prototype.getPersonaIconUrl=function(){var e=this._getCommentDetail();if(void 0===this.getpersonaIconUrl){var t=this.commentListItem&&e&&e.author.email;return t&&"/_layouts/15/userphoto.aspx?size=s&accountname="+t||void 0}var i=this.commentListItem&&e&&e.author.id;return i&&this.getpersonaIconUrl(i)||void 0},t.prototype.getActivityTypeString=function(){return"comment"},t.prototype.getContextualMenu=function(e){var t=this,i=[],n=this.activityMenuFunctions&&this.activityMenuFunctions.delete,r=this.activity&&this.activity.action&&this.activity.action.comment&&this.activity.action.comment.commentId;if(this.canDeleteActivity&&this.canDeleteActivity(this.activity.type)&&n&&this.commentListItem&&r&&!this.isReadonly){var a={key:"od-itemActivity.deleteComment"+r,name:u.default.activityMenuOptionDelete,dialogTitle:u.default.deleteCommentDialogTitle,dialogOnConfirm:function(){return n(t.commentListItem.activityItemWrapper,t.currentUserEmail,{commentItem:t.commentListItem,commentId:r})}};i.push(a)}if(i.length)return s.createElement(o.default,{itemActivityMenuItems:i,activityId:this.activity.id,isVisible:e,environment:this.environment})},t.prototype.getResponse=function(e){void 0===e&&(e=!1);var t=this._getCommentDetail(),i=t&&t.replies&&t.replies.comments&&t.replies.comments.length>0;if(this.commentListItem&&t&&(i||!this.isReadonly))return s.createElement(r.default,{key:this.containingItem.graphItemUrl+"_"+t.id,parentComment:t,commentListItem:this.commentListItem,currentUserEmail:this.currentUserEmail,onRenderUser:this.onRenderUser,isReadonly:this.isReadonly,environment:this.environment})},t.prototype.getCommentAuthorName=function(){var e=this._getCommentDetail();if(e&&e.author)return e.author.displayName},t.prototype.getcommentAuthorEmail=function(){var e=this._getCommentDetail();if(e&&e.author)return e.author.email},t.prototype._getCommentMessage=function(e){void 0===e&&(e=!1);var t=this._getCommentDetail();if(t&&t.text)return e?t.text:!0===this.isNewCommentExperienceEnabled&&this.displayLargeText?s.createElement("div",{className:"od-itemActivity-commentActivity-commentContent"},this.displayLargeText({seeMoreText:this.strings.seeMoreLabel,seeLessText:this.strings.seeLessLabel,text:t.text})):s.createElement("div",{className:"od-itemActivity-commentActivity-commentContent",dangerouslySetInnerHTML:{__html:t.text}})},t.prototype._getCommentDetail=function(){var e=this.activity.action;return e&&e.comment&&e.comment.commentDetail},t.prototype._isOnFileComment=function(){var e=this.activity.action&&this.activity.action.comment;return!(!e||!e.commentId)},t}(p);t.CommentItemActivity=f;var v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.getDescription=function(e){var t=void 0===e?{}:e,i=t.isCompact,n=t.stringOnly,r=t.hideDate,o=this.activity.action.commentResponse,s=this._getFilteredActors({isCompact:i}),c=s.youUser,l=s.sortedUsers,d=s.additionalUsers,m=h(i),u=this.renderItemLink({item:this.activity.item,itemLabel:this.strings.commentResponseComment,stringOnly:n});if(o&&o.commentAuthor){var p=o.commentAuthor.self,g=this.renderUser(o.commentAuthor,{stringOnly:n,isAccusative:!0}),y=void 0;if(l.length>m){y=p?i?!this.isNewCommentExperienceEnabled&&c?this.strings.youRepliedToYouCountFormShort:this.strings.otherRepliedToYouCountFormShort:!this.isNewCommentExperienceEnabled&&c?this.strings.youRepliedToYouCountForm:this.strings.otherRepliedToYouCountForm:i?!this.isNewCommentExperienceEnabled&&c?this.strings.youRepliedToOtherCountFormShort:this.strings.otherRepliedToOtherCountFormShort:!this.isNewCommentExperienceEnabled&&c?this.strings.youRepliedToOtherCountForm:this.strings.otherRepliedToOtherCountForm;var f=[g].concat(this.getRenderedUsers(l.slice(0,m),{stringOnly:n,isActor:!0}),[this._getAdditionalUsersTooltip(d,{stringOnly:n,isCompact:i,hideDate:r})]);return i||f.unshift(u),a.formatToArray.apply(a,[y].concat(f))}var v=void 0;v=p?i?!this.isNewCommentExperienceEnabled&&c?this.strings.youRepliedToYouListFormShort:this.strings.otherRepliedToYouListFormShort:!this.isNewCommentExperienceEnabled&&c?this.strings.youRepliedToYouListForm:this.strings.otherRepliedToYouListForm:i?!this.isNewCommentExperienceEnabled&&c?this.strings.youRepliedToOtherListFormShort:this.strings.otherRepliedToOtherListFormShort:!this.isNewCommentExperienceEnabled&&c?this.strings.youRepliedToOtherListForm:this.strings.otherRepliedToOtherListForm,y=a.getLocalizedCountValue(v,i?this.strings.commentResponseListFormShortIntervals:this.strings.commentResponseListFormIntervals,l.length);f=[g].concat(this.getRenderedUsers(l.slice(0,m),{stringOnly:n,isActor:!0}));return i||f.unshift(u),a.formatToArray.apply(a,[y].concat(f))}y=void 0;if(l.length>m)return y=i?!this.isNewCommentExperienceEnabled&&c?this.strings.youRepliedToMissingAuthorCountFormShort:this.strings.otherRepliedToMissingAuthorCountFormShort:!this.isNewCommentExperienceEnabled&&c?this.strings.youRepliedToMissingAuthorCountForm:this.strings.otherRepliedToMissingAuthorCountForm,a.formatToArray.apply(a,[y,u].concat(this.getRenderedUsers(l.slice(0,m),{stringOnly:n,isActor:!0}),[this._getAdditionalUsersTooltip(d,{stringOnly:n,isCompact:i,hideDate:r})]));v=i?!this.isNewCommentExperienceEnabled&&c?this.strings.youRepliedToMissingAuthorListFormShort:this.strings.otherRepliedToMissingAuthorListFormShort:!this.isNewCommentExperienceEnabled&&c?this.strings.youRepliedToMissingAuthorListForm:this.strings.otherRepliedToMissingAuthorListForm;return y=a.getLocalizedCountValue(v,i?this.strings.commentResponseListFormShortIntervals:this.strings.commentResponseListFormIntervals,l.length),a.formatToArray.apply(a,[y,u].concat(this.getRenderedUsers(l,{stringOnly:n,isActor:!0})))},t.prototype.getIconName=function(){return"Reply"},t.prototype.getActivityTypeString=function(){return"commentResponse"},t}(p);t.CommentResponseItemActivity=v;var b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.getDescription=function(e){var t,i,n=void 0===e?{}:e,r=n.isCompact,o=n.stringOnly,s=n.hideDate,c=this.renderMainItemLink(this.strings.mentionedThisFile,this.strings.mentionArbitraryFile,o),l=this._getFilteredActors({actors:this.activity.action.mention.mentionees,isCompact:r}),d=this.getRenderedUsers(l.sortedUsers,{stringOnly:o}),m=l.youUser,u=l.additionalUsers,p=this._getFilteredActors({isCompact:r}),g=p.youUser,y=p.sortedUsers,f=h(r);if(d.length>f)return i=m?r?!this.isNewCommentExperienceEnabled&&g?this.strings.youMentionedOthersCountFormShort:this.strings.othersMentionedYouAndOthersCountFormShort:!this.isNewCommentExperienceEnabled&&g?this.strings.youMentionedYouAndOthersCountForm:this.strings.othersMentionedYouAndOthersCountForm:r?!this.isNewCommentExperienceEnabled&&g?this.strings.youMentionedOthersCountFormShort:this.strings.othersMentionedOthersCountFormShort:!this.isNewCommentExperienceEnabled&&g?this.strings.youMentionedOthersCountForm:this.strings.othersMentionedOthersCountForm,a.formatToArray.apply(a,[i,c].concat(this.getRenderedUsers(y,{stringOnly:o,isActor:!0}),d.slice(0,f),[this._getAdditionalUsersTooltip(u,{stringOnly:o,isCompact:r,hideDate:s})]));var v=void 0;return v=m?r?!this.isNewCommentExperienceEnabled&&g?this.strings.youMentionedYouListFormShort:this.strings.otherMentionedYouListFormShort:!this.isNewCommentExperienceEnabled&&g?this.strings.youMentionedYouAndOthersListForm:this.strings.othersMentionedYouAndOthersListForm:r?!this.isNewCommentExperienceEnabled&&g?this.strings.youMentionedOthersListFormShort:this.strings.othersMentionedOthersListFormShort:!this.isNewCommentExperienceEnabled&&g?this.strings.youMentionedOthersListForm:this.strings.othersMentionedOthersListForm,t=a.getLocalizedCountValue(v,r?this.strings.mentionedListFormShortIntervals:this.strings.mentionedListFormIntervals,d.length),a.formatToArray.apply(a,[t,c].concat(this.getRenderedUsers(y,{stringOnly:o,isActor:!0}),d.slice(0,f)))},t.prototype.getIconName=function(){return"Accounts"},t.prototype.getActivityTypeString=function(){return"mention"},t}(p);t.MentionItemActivity=b;var C=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.getDescription=function(e){var t=void 0===e?{}:e,i=t.isCompact,n=t.stringOnly;if(this.activity.action&&this.activity.action.version&&this.activity.action.version.newVersion){var r=this._getFilteredActors({isCompact:i}),o=r.youUser,s=this.renderUser(r.sortedUsers[0],{stringOnly:n,isActor:!0}),c=i?!this.isNewCommentExperienceEnabled&&o?this.strings.youCreatedVersionShort:this.strings.otherCreatedVersionShort:!this.isNewCommentExperienceEnabled&&o?this.isSingleLevel?this.strings.youCreatedVersionThisFile:this.strings.youCreatedVersion:this.isSingleLevel?this.strings.otherCreatedVersionThisFile:this.strings.otherCreatedVersion,l=this.renderMainItemLink(this.strings.versionThisFile,this.strings.versionArbitraryFile,n),d=this.activity.action.version.newVersion;return a.formatToArray(c,l,s,d)}return[]},t.prototype.getIconName=function(){return"FabricMovetoFolder"},t.prototype.getActivityTypeString=function(){return"version"},t}(p);t.VersionItemActivity=C;var _=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.getDescription=function(e){var t=void 0===e?{}:e,i=(t.isCompact,t.stringOnly),n=this.renderMainItemLink(this.strings.restoreThisFile,this.strings.restoreArbitraryFile,i),r=this.isSingleLevel?this.strings.thisFileRestored:this.strings.arbitraryFileRestored;return a.formatToArray(r,n)},t.prototype.getIconName=function(){return"Refresh"},t.prototype.getActivityTypeString=function(){return"restore"},t}(p);t.RestoreItemActivity=_;var x=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.getDescription=function(e){var t,i=void 0===e?{}:e,n=i.isCompact,r=i.stringOnly,o=this._getFilteredActors({isCompact:n}),s=o.youUser,c=this.renderUser(o.sortedUsers[0],{stringOnly:r,isActor:!0});if(this.activity.action&&this.activity.action.rename&&this.activity.action.rename.oldItem){var l=this.renderItemLink({item:this.activity.action.rename.oldItem,stringOnly:r,keyPrefix:"old"}),d=this.renderItemLink({item:this.activity.item,stringOnly:r});return t=n?!this.isNewCommentExperienceEnabled&&s?this.strings.youRenamedFileToFileShort:this.strings.otherRenamedFileToFileShort:!this.isNewCommentExperienceEnabled&&s?this.strings.youRenamedFileToFile:this.strings.otherRenamedFileToFile,a.formatToArray(t,c,l,d)}var m=this.renderMainItemLink(this.strings.renameThisFile,this.strings.renameArbitraryFile,r);return t=n?!this.isNewCommentExperienceEnabled&&s?this.strings.youRenamedFileShort:this.strings.otherRenamedFileShort:!this.isNewCommentExperienceEnabled&&s?this.strings.youRenamedFile:this.strings.otherRenamedFile,a.formatToArray(t,c,m)},t.prototype.getIconName=function(){return"Rename"},t.prototype.getActivityTypeString=function(){return"restore"},t}(p);t.RenameItemActivity=x;var F=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.getDescription=function(e){var t=void 0===e?{}:e,i=t.isCompact,n=t.stringOnly,r=this.renderMainItemLink(this.strings.deleteThisFile,this.strings.deleteArbitraryFile,n),o=this._getFilteredActors({isCompact:i}),s=o.youUser,c=this.renderUser(o.sortedUsers[0],{stringOnly:n,isActor:!0}),l=i?!this.isNewCommentExperienceEnabled&&s?this.strings.youDeletedShort:this.strings.otherDeletedShort:!this.isNewCommentExperienceEnabled&&s?this.strings.youDeleted:this.strings.otherDeleted;if(this.isSingleLevel)return a.formatToArray(l,r,c);var d=this.renderItemLink({item:this.activity.parentItem,stringOnly:n});return l=!i&&d?!this.isNewCommentExperienceEnabled&&s?this.strings.youDeletedFromFolder:this.strings.otherDeletedFromFolder:l,d?a.formatToArray(l,r,c,d):a.formatToArray(l,r,c)},t.prototype.getIconName=function(){return"Trash"},t.prototype.getActivityTypeString=function(){return"delete"},t}(p);t.DeleteItemActivity=F;var A=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.getDescription=function(e){var t=void 0===e?{}:e,i=t.isCompact,n=t.stringOnly,r=this.renderMainItemLink(this.strings.createThisFile,this.strings.createArbitraryFile,n),o=this._getFilteredActors({isCompact:i}),s=o.youUser,c=this.renderUser(o.sortedUsers[0],{stringOnly:n,isActor:!0}),l=i?!this.isNewCommentExperienceEnabled&&s?this.strings.youCreatedShort:this.strings.otherCreatedShort:!this.isNewCommentExperienceEnabled&&s?this.strings.youCreated:this.strings.otherCreated;if(this.isSingleLevel)return a.formatToArray(l,r,c);var d=this.renderItemLink({item:this.activity.parentItem,stringOnly:n});return l=!i&&d?!this.isNewCommentExperienceEnabled&&s?this.strings.youCreatedInLocation:this.strings.otherCreatedInLocation:l,d?a.formatToArray(l,r,c,d):a.formatToArray(l,r,c)},t.prototype.getIconName=function(){return"Add"},t.prototype.getActivityTypeString=function(){return"create"},t}(p);t.CreateItemActivity=A;var E=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.getDescription=function(e){var t,i=void 0===e?{}:e,n=i.isCompact,r=i.stringOnly,o=i.hideDate,s=this.renderMainItemLink(this.strings.shareThisFile,this.strings.shareArbitraryFile,r),c=this._getFilteredActors({isCompact:n}),l=c.youUser,d=this.renderUser(c.sortedUsers[0],{stringOnly:r,isActor:!0}),m=this.activity.action.share.recipients;if(m&&m.length>0){var u,p=this._getFilteredActors({actors:m,isCompact:n}),g=p.sortedUsers,y=p.youUser,f=p.additionalUsers,v=h(n);if(g.length>v)return u=y?n?!this.isNewCommentExperienceEnabled&&l?this.strings.youSharedWithYouCountFormShort:this.strings.otherSharedWithYouCountFormShort:!this.isNewCommentExperienceEnabled&&l?this.strings.youSharedWithYouCountForm:this.strings.otherSharedWithYouCountForm:n?!this.isNewCommentExperienceEnabled&&l?this.strings.youSharedWithOthersCountFormShort:this.strings.otherSharedWithOthersCountFormShort:!this.isNewCommentExperienceEnabled&&l?this.strings.youSharedWithOthersCountForm:this.strings.otherSharedWithOthersCountForm,a.formatToArray.apply(a,[u,s,d].concat(this.getRenderedUsers(g.slice(0,v),{stringOnly:r,isAccusative:!0}),[this._getAdditionalUsersTooltip(f,{stringOnly:r,isCompact:n,hideDate:o,isAccusative:!0})]));var b=void 0;b=y?n?!this.isNewCommentExperienceEnabled&&l?this.strings.youSharedWithYouListFormShort:this.strings.otherSharedWithYouListFormShort:!this.isNewCommentExperienceEnabled&&l?this.strings.youSharedWithYouListForm:this.strings.otherSharedWithYouListForm:n?!this.isNewCommentExperienceEnabled&&l?this.strings.youSharedWithOthersListFormShort:this.strings.otherSharedWithOthersListFormShort:!this.isNewCommentExperienceEnabled&&l?this.strings.youSharedWithOthersListForm:this.strings.otherSharedWithOthersListForm;var C=a.getLocalizedCountValue(b,n?this.strings.sharedWithOthersListFormShortIntervals:this.strings.sharedWithOthersListFormIntervals,g.length);return a.formatToArray.apply(a,[C,s,d].concat(this.getRenderedUsers(g,{stringOnly:r,isAccusative:!0})))}return t=n?!this.isNewCommentExperienceEnabled&&l?this.strings.youSharedShort:this.strings.otherSharedShort:!this.isNewCommentExperienceEnabled&&l?this.strings.youShared:this.strings.otherShared,a.formatToArray(t,s,d)},t.prototype.getIconName=function(){return"Share"},t.prototype.getActivityTypeString=function(){return"share"},t}(p);t.ShareItemActivity=E;var S=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.getDescription=function(e){var t=void 0===e?{}:e,i=t.isCompact,n=t.stringOnly,r=this.renderMainItemLink(this.strings.shareThisFile,this.strings.createArbitraryFile,n),o=this._getFilteredActors({isCompact:i}),s=o.youUser,c=this.renderUser(o.sortedUsers[0],{stringOnly:n,isActor:!0}),l=i?!this.isNewCommentExperienceEnabled&&s?this.strings.youRestoredDocumentLibraryShort:this.strings.otherRestoredDocumentLibraryShort:!this.isNewCommentExperienceEnabled&&s?this.strings.youRestoredDocumentLibrary:this.strings.otherRestoredDocumentLibrary,m=this.activity.action&&this.activity.action.pointInTimeRestore,u=m&&m.restoreToDateTime;return a.formatToArray(l,c,r,d.getRelativeDateTimeStringPast(u))},t.prototype.getIconName=function(){return"Refresh"},t.prototype.getActivityTypeString=function(){return"pointInTimeRestore"},t}(p);t.PointInTimeRestoreActivity=S;var I=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.getDescription=function(e){var t=void 0===e?{}:e,i=t.isCompact,n=t.stringOnly,r=this.renderMainItemLink(this.strings.restoredVersionThisFile,this.strings.restoredVersionArbitraryFile,n),o=this._getFilteredActors({isCompact:i}),s=o.youUser,c=this.renderUser(o.sortedUsers[0],{stringOnly:n}),l=i?!this.isNewCommentExperienceEnabled&&s?this.strings.youRestoredVersionShort:this.strings.otherRestoredVersionShort:!this.isNewCommentExperienceEnabled&&s?this.strings.youRestoredVersion:this.strings.otherRestoredVersion,d=this.activity.action&&this.activity.action.restoreVersion,m=d&&d.fromVersion;return a.formatToArray(l,c,r,m)},t.prototype.getIconName=function(){return"Refresh"},t.prototype.getActivityTypeString=function(){return"restoreVesion"},t}(p);t.RestoreVersionActivity=I},bf9566cd9ae1eb1ba33c:function(e,t,i){"use strict";i.r(t);var n=i("c9764d34b3eb6a106977"),r=i("a958247ccac93ac07654"),o=i("1afb233404868f4ef908"),s=i("2dcb98874a1d03f441f5"),a=i("b0e26fa7634e6889091e"),c=i("b35be99344d8490bbc85"),l=i("709c166948243d934acd");i.d(t,"Dialog",function(){return n.a}),i.d(t,"DialogBase",function(){return r.a}),i.d(t,"DialogContent",function(){return o.a}),i.d(t,"DialogContentBase",function(){return s.a}),i.d(t,"DialogFooter",function(){return a.a}),i.d(t,"DialogFooterBase",function(){return c.a}),i.d(t,"ResponsiveMode",function(){return l.b}),i.d(t,"DialogType",function(){return l.a}),i.d(t,"default",function(){return n.a})},c60ca1f143d0e4a661d1:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("64328bb588b46459132d"),r=i("275976081ce1abf67779"),o=i("8a2d1b95e05b6a321e74"),s=i("0a3e1b609e40999fd831"),a=i("5a6459d968e8e4449149"),c=i("646ed378ac0e9617b57e"),l=i("4b9f93066051bcaacd4a"),d=i("537050c76e992e2a700a"),m=i("2eb6c007b234c6e13333"),u=i("162df8efbe1f5220c650"),h=i("c66101bfa4353de65e14");i("d962ce3cc4f6ae5d2993");var p=i("646ed378ac0e9617b57e"),g=2,y=function(e){function t(t,i){var n=e.call(this,t,i)||this;n._onFocus=function(){n._focusZone&&n._focusZone.focus()},n._onRenderCell=function(e,t){var i=n.props.onRenderUser,o=n.state,s=o.currentReplies,a=o.numberOfRepliesDisplayed,c=s.comments.length||0,l=a<=c&&c-a||0,d=new f({reply:e,onRenderUser:i});if(e&&t>=l)return r.createElement(h.default,{key:d.getKey(),reply:d,additionalClass:"od-ItemActivityList-commentReply"})},n._onSend=function(e,t,i){var r=n.props,o=r.parentComment,s=r.commentListItem,a=r.currentUserEmail;n._store&&n._store.addItemCommentReply({itemWrapper:s,currentUserEmail:a},o.id,e).then(function(e){n._store.fetchItemCommentReplies({itemWrapper:s,currentUserEmail:a,startIndex:0},o.id),t&&t()},function(e){var t=e&&e.message&&e.message.value;i&&i(t)})},n._onShowMore=function(){var e=n.props,t=e.onShowMore,i=e.parentComment,r=e.commentListItem,o=e.currentUserEmail,s=n.state.currentReplies,a=n.state.numberOfRepliesDisplayed;a<s.comments.length&&(n.setState({numberOfRepliesDisplayed:10*Math.floor(a/10)+10}),s.nextLink&&n._store.fetchItemCommentReplies({itemWrapper:r,currentUserEmail:o},i.id)),t&&t()},n._store=i.itemCommentsStore,n._engagementSource=i.engagementSource||"";var o=t.parentComment,s=t.commentListItem,a=t.currentUserEmail;n._environment=t.environment;var c=n._store.getItemCommentReplies({itemWrapper:s,currentUserEmail:a},o.id),l=c&&c.comments&&c.comments.length,d=l?g:0;return n.state={numberOfRepliesDisplayed:d,currentReplies:c,hasMore:d<l},n}return n.__extends(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.parentComment.id!==this.props.parentComment.id&&this._addListener()},t.prototype.componentDidMount=function(){this._addListener()},t.prototype.componentWillUnmount=function(){this._store.removeRepliesListener(this._storeListener)},t.prototype.UNSAFE_componentWillUpdate=function(){this._focusElement=void 0},t.prototype.render=function(){var e=this.props,t=e.isReadonly,i=e.parentComment,n=this.state.currentReplies.comments||[],o=n.map(function(e){try{return e.action.comment.commentDetail}catch(e){}});return r.createElement("div",{"data-is-focusable":"consumer"!==this._environment,key:"activityResponse_"+i.id,onFocus:this._onFocus,"aria-label":u.default.activityCommentRepliesList,"aria-hidden":"consumer"===this._environment},r.createElement(a.FocusZone,{componentRef:this._resolveRef("_focusZone"),className:p.css("od-ItemActivityList-activity-commentResponse",{"od-ItemActivityList-activity-withHiddenReply":"consumer"===this._environment}),direction:a.FocusZoneDirection.vertical,isCircularNavigation:!1,handleTabKey:a.FocusZoneTabbableElements.inputOnly,shouldInputLoseFocusOnArrowKey:function(e){return!0},isInnerZoneKeystroke:function(e){return e.which===c.getRTLSafeKeyCode(c.KeyCodes.right)}},this._getShowMoreLink(),n&&n.length>0&&r.createElement(l.List,{componentRef:!this._focusElement&&this._resolveRef("_focusElement"),className:"od-activityItem-replies-list",items:o,onRenderCell:this._onRenderCell}),!t&&"consumer"!==this._environment&&r.createElement(m.default,{componentRef:!this._focusElement&&this._resolveRef("_focusElement"),commentItemId:i&&i.id,placeholderText:u.default.replyPlaceholder,sendButtonTitle:"",onSend:this._onSend,engagementSource:this._engagementSource+".AddReply"})))},t.prototype._addListener=function(){var e=this,t=this.props,i=t.parentComment,n=t.commentListItem,r=t.currentUserEmail;this._storeListener=this._store.addRepliesListener(function(){var t=e._store.getItemCommentReplies({itemWrapper:n,currentUserEmail:r},i.id),o=t.comments&&t.comments.length;e.setState({currentReplies:t,numberOfRepliesDisplayed:o>g?e.state.numberOfRepliesDisplayed:o,hasMore:!!t.nextLink||t.comments.length>e.state.numberOfRepliesDisplayed})},{item:n.activityItemWrapper,currentUserEmail:r},i.id)},t.prototype._getShowMoreLink=function(){this.props.parentComment;var e=this.state,t=e.currentReplies;if(e.numberOfRepliesDisplayed<t.comments.length||t.nextLink)return r.createElement("div",{className:"od-ItemActivityList-commentReply od-ItemActivityList-loadMoreReplies"},r.createElement(d.Link,{componentRef:!this._focusElement&&this._resolveRef("_focusElement"),onClick:this._onShowMore,href:"javascript:void(0)"},u.default.commentRepliesGetMore))},t.contextTypes={itemCommentsStore:o.any,engagementSource:o.any},t}(c.BaseComponent);t.default=y;var f=function(){function e(e){var t=this;this._renderUser=function(e,i){var n=e.user;return n||(n=t._getReplyAuthor()),t._renderUserLabel(n,{stringOnly:!1})},this._commentReply=e.reply,this._onRenderUser=e.onRenderUser}return e.prototype.getKey=function(){return"Comment"+this._commentReply.parentId+"_Reply"+this._commentReply.id},e.prototype.getPersonaImgUrl=function(){return"/_layouts/15/userphoto.aspx?size=S&accountname="+this._commentReply.author.email},e.prototype.getFriendlyDisplayTime=function(){return this._commentReply.friendlyDisplayTime},e.prototype.getDate=function(){return this._commentReply.createdDate},e.prototype.getDescription=function(e){void 0===e&&(e={stringOnly:!1});var t=e.stringOnly,i=this._commentReply.text,n=this._getReplyAuthor(),o=this.renderUser(n,{stringOnly:t}),a=t?i:r.createElement("div",{className:"od-itemActivity-commentActivity-commentContent",dangerouslySetInnerHTML:{__html:i}});return n.self?s.formatToArray(u.default.youReplied,a):s.formatToArray(u.default.otherReplied,a,o)},e.prototype.renderUser=function(e,t){var i=t.stringOnly,n=this._renderUserLabel(e,{stringOnly:!0});return!e||i?n:r.createElement("span",{"aria-label":n},this._onRenderUser({user:e},this._renderUser))},e.prototype._renderUserLabel=function(e,t){var i,n=t.stringOnly;return i=e&&e.self?u.default.youUpperCase:e&&e.displayName?e.displayName:e&&e.email?e.email:u.default.someoneUpperCase,n?i:r.createElement("span",{className:"od-ItemActivity-item-nameText"},i)},e.prototype._getReplyAuthor=function(){return this._commentReply.author},e}();t.ItemCommentReplyModel=f},c66101bfa4353de65e14:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("64328bb588b46459132d"),r=i("275976081ce1abf67779"),o=i("d674d675f168e38dc4f8"),s=i("5a6459d968e8e4449149"),a=i("dc89aa5278a9a06d2126");i("162aa6fc967bdc23b04b");var c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onRenderActivityDescription=function(){return r.createElement("div",{className:"od-ItemActivity-item-textContent"},t.props.reply.getDescription())},t._onRenderActivityTimeStamp=function(e,t){return t?t(e):null},t._onRenderHiddenTimeStamp=function(e,t){return null},t}return n.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.reply,i=e.hideDate,n=e.additionalClass,a=void 0===n?"":n;return r.createElement(s.FocusZone,{direction:s.FocusZoneDirection.horizontal,"data-is-focusable":!0,"aria-label":this._getAriaLabel()},r.createElement(o.ActivityItem,{key:t.getKey(),className:"od-ItemActivity-item "+a,activityPersonas:this._activityPersonas(),onRenderActivityDescription:this._onRenderActivityDescription,timeStamp:this._onRenderDate(),onRenderTimeStamp:i?this._onRenderHiddenTimeStamp:this._onRenderActivityTimeStamp}))},t.prototype._onRenderDate=function(){var e=this.props.reply;return(a.getRelativeDateTimeStringForLists(e.getFriendlyDisplayTime()||"")||a.getFriendlyDateTimeStringPast(e.getDate())).toString()},t.prototype._getAriaLabel=function(){return this.props.reply.getDescription({stringOnly:!0}).join("")+" "+this._onRenderDate()},t.prototype._activityPersonas=function(){return[{imageUrl:this.props.reply.getPersonaImgUrl()}]},t}(r.Component);t.default=c},d962ce3cc4f6ae5d2993:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i("a8c7165f33a4dc07ab0d").loadStyles([{rawString:".od-activityItem-replies-list .ms-List-cell{min-height:0}\n"}])},df676915c716da19c40f:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i("a8c7165f33a4dc07ab0d").loadStyles([{rawString:".od-addNewCommentTextField{display:-webkit-box;display:-ms-flexbox;display:flex;margin:4px 0px 16px 0px}.od-addNewCommentTextField .ms-TextField-suffix{padding:0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse}.od-addNewCommentTextField-input{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1}.od-addNewCommentTextField-input .ms-TextField-fieldGroup{background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;max-height:174px}.od-addNewCommentTextField-input .ms-TextField-fieldGroup .ms-TextField-field{height:100%;min-height:0px}.od-addNewCommentTextField-disabled{border:1px solid #EAEAEA;border-radius:2px}.od-addNewCommentTextField-disabled .ms-TextField-field{background:#f3f2f1}.od-addNewCommentTextField-cancelButton{color:#605e5c}.od-addNewCommentTextField-sendButton{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";background-color:unset}.od-addNewCommentTextField-spinner{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin:4px}.od-addNewCommentTextField-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}\n"}])},edcba52cd65fc036ab4e:function(e,t,i){"use strict";i.r(t),i.d(t,"strings",function(){return n});var n=i("4986dedaa57d766e48bb")["_cF1viJ2gMXSZi/Afq34QOg"];t.default=n},eff2fc75ac80acbd49db:function(e,t,i){"use strict";i.r(t);var n=i("0740e1ac327ca777c207"),r=i("8d1d9d8f729a7c94ff84"),o=i("64328bb588b46459132d"),s=i("275976081ce1abf67779"),a=i("410d86e074196589b028"),c=i("230cad3b07783b8f9314"),l={9:/[0-9]/,a:/[a-zA-Z]/,"*":/[a-zA-Z0-9]/};function d(e,t){if(void 0===t&&(t=l),!e)return[];for(var i=[],n=0,r=0;r+n<e.length;r++){var o=e.charAt(r+n);if("\\"===o)n++;else{var s=t[o];s&&i.push({displayIndex:r,format:s})}}return i}function m(e,t,i){var n=e;if(!n)return"";n=n.replace(/\\/g,"");var r=0;t.length>0&&(r=t[0].displayIndex-1);for(var o=0,s=t;o<s.length;o++){var a=s[o],c=" ";a.value?(c=a.value,a.displayIndex>r&&(r=a.displayIndex)):i&&(c=i),n=n.slice(0,a.displayIndex)+c+n.slice(a.displayIndex+1)}return i||(n=n.slice(0,r+1)),n}function u(e,t){for(var i=0;i<e.length;i++)if(e[i].displayIndex>=t)return e[i].displayIndex;return e[e.length-1].displayIndex}function h(e,t,i){for(var n=0;n<e.length;n++)if(e[n].displayIndex>=t){if(e[n].displayIndex>=t+i)break;e[n].value=void 0}return e}function p(e,t,i){for(var n=0,r=0,o=!1,s=0;s<e.length&&n<i.length;s++)if(e[s].displayIndex>=t)for(o=!0,r=e[s].displayIndex;n<i.length;){if(e[s].format.test(i.charAt(n))){e[s].value=i.charAt(n++),s+1<e.length?r=e[s+1].displayIndex:r++;break}n++}return o?r:t}var g=function(e){function t(t){var i=e.call(this,t)||this;return i._textField=s.createRef(),i._onFocus=function(e){i.props.onFocus&&i.props.onFocus(e),i._isFocused=!0;for(var t=0;t<i._maskCharData.length;t++)if(!i._maskCharData[t].value){i.setState({maskCursorPosition:i._maskCharData[t].displayIndex});break}},i._onBlur=function(e){i.props.onBlur&&i.props.onBlur(e),i._isFocused=!1,i._moveCursorOnMouseUp=!0},i._onMouseDown=function(e){i.props.onMouseDown&&i.props.onMouseDown(e),i._isFocused||(i._moveCursorOnMouseUp=!0)},i._onMouseUp=function(e){if(i.props.onMouseUp&&i.props.onMouseUp(e),i._moveCursorOnMouseUp){i._moveCursorOnMouseUp=!1;for(var t=0;t<i._maskCharData.length;t++)if(!i._maskCharData[t].value){i.setState({maskCursorPosition:i._maskCharData[t].displayIndex});break}}},i._onInputChange=function(e,t){var n=i._textField.current;if(null===i._changeSelectionData&&n&&(i._changeSelectionData={changeType:"default",selectionStart:null!==n.selectionStart?n.selectionStart:-1,selectionEnd:null!==n.selectionEnd?n.selectionEnd:-1}),i._changeSelectionData){var r=i.state.displayValue,o=0,s=i._changeSelectionData,a=s.changeType,c=s.selectionStart,l=s.selectionEnd;if("textPasted"===a){var d=l-c,g=t.length+d-r.length,y=c,f=t.substr(y,g);d&&(i._maskCharData=h(i._maskCharData,c,d)),o=p(i._maskCharData,y,f)}else if("delete"===a||"backspace"===a){var v="delete"===a;(g=l-c)?(i._maskCharData=h(i._maskCharData,c,g),o=u(i._maskCharData,c)):v?(i._maskCharData=function(e,t){for(var i=0;i<e.length;i++)if(e[i].displayIndex>=t){e[i].value=void 0;break}return e}(i._maskCharData,c),o=u(i._maskCharData,c)):(i._maskCharData=function(e,t){for(var i=e.length-1;i>=0;i--)if(e[i].displayIndex<t){e[i].value=void 0;break}return e}(i._maskCharData,c),o=function(e,t){for(var i=e.length-1;i>=0;i--)if(e[i].displayIndex<t)return e[i].displayIndex;return e[0].displayIndex}(i._maskCharData,c))}else if(t.length>r.length){y=l-(g=t.length-r.length);var b=t.substr(y,g);o=p(i._maskCharData,y,b)}else if(t.length<=r.length){g=1;var C=r.length+g-t.length;y=l-g,b=t.substr(y,g);i._maskCharData=h(i._maskCharData,y,C),o=p(i._maskCharData,y,b)}i._changeSelectionData=null;var _=m(i.props.mask,i._maskCharData,i.props.maskChar);i.setState({displayValue:_,maskCursorPosition:o}),i.props.onChange&&i.props.onChange(e,_)}},i._onKeyDown=function(e){var t=i._textField.current;if(i.props.onKeyDown&&i.props.onKeyDown(e),i._changeSelectionData=null,t&&t.value){var n=e.keyCode,r=e.ctrlKey,o=e.metaKey;if(r||o)return;if(n===a.a.backspace||n===a.a.del){var s=e.target.selectionStart,c=e.target.selectionEnd;if(!(n===a.a.backspace&&c&&c>0||n===a.a.del&&null!==s&&s<t.value.length))return;i._changeSelectionData={changeType:n===a.a.backspace?"backspace":"delete",selectionStart:null!==s?s:-1,selectionEnd:null!==c?c:-1}}}},i._onPaste=function(e){i.props.onPaste&&i.props.onPaste(e);var t=e.target.selectionStart,n=e.target.selectionEnd;i._changeSelectionData={changeType:"textPasted",selectionStart:null!==t?t:-1,selectionEnd:null!==n?n:-1}},Object(c.a)(i),i._maskCharData=d(t.mask,t.maskFormat),void 0!==t.value&&i.setValue(t.value),i._isFocused=!1,i._moveCursorOnMouseUp=!1,i.state={displayValue:m(t.mask,i._maskCharData,t.maskChar)},i}return Object(o.__extends)(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.mask===this.props.mask&&e.value===this.props.value||(this._maskCharData=d(e.mask,e.maskFormat),void 0!==e.value&&this.setValue(e.value),this.setState({displayValue:m(e.mask,this._maskCharData,e.maskChar)}))},t.prototype.componentDidUpdate=function(){this._isFocused&&void 0!==this.state.maskCursorPosition&&this._textField.current&&this._textField.current.setSelectionRange(this.state.maskCursorPosition,this.state.maskCursorPosition)},t.prototype.render=function(){return s.createElement(n.a,Object(o.__assign)({},this.props,{onFocus:this._onFocus,onBlur:this._onBlur,onMouseDown:this._onMouseDown,onMouseUp:this._onMouseUp,onChange:this._onInputChange,onKeyDown:this._onKeyDown,onPaste:this._onPaste,value:this.state.displayValue||"",componentRef:this._textField}))},Object.defineProperty(t.prototype,"value",{get:function(){for(var e="",t=0;t<this._maskCharData.length;t++){if(!this._maskCharData[t].value)return;e+=this._maskCharData[t].value}return e},enumerable:!0,configurable:!0}),t.prototype.setValue=function(e){for(var t=0,i=0;t<e.length&&i<this._maskCharData.length;){var n=e[t];this._maskCharData[i].format.test(n)&&(this._maskCharData[i].value=n,i++),t++}},t.prototype.focus=function(){var e=this._textField.current;e&&e.focus()},t.prototype.blur=function(){var e=this._textField.current;e&&e.blur()},t.prototype.select=function(){var e=this._textField.current;e&&e.select()},t.prototype.setSelectionStart=function(e){var t=this._textField.current;t&&t.setSelectionStart(e)},t.prototype.setSelectionEnd=function(e){var t=this._textField.current;t&&t.setSelectionEnd(e)},t.prototype.setSelectionRange=function(e,t){var i=this._textField.current;i&&i.setSelectionRange(e,t)},Object.defineProperty(t.prototype,"selectionStart",{get:function(){var e=this._textField.current;return e&&null!==e.selectionStart?e.selectionStart:-1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectionEnd",{get:function(){var e=this._textField.current;return e&&e.selectionEnd?e.selectionEnd:-1},enumerable:!0,configurable:!0}),t.defaultProps={maskChar:"_",maskFormat:l},t}(s.Component);i.d(t,"TextField",function(){return n.a}),i.d(t,"TextFieldBase",function(){return r.a}),i.d(t,"DEFAULT_MASK_CHAR",function(){return"_"}),i.d(t,"MaskedTextField",function(){return g})}}]);