webpackJsonp([43],{2600:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n(2601)},2601:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(2602),o=function(){function t(t,e,n,i,o,a,s,c,r,l,u,d,g){var p=this;this.constants=t,this.$scope=e,this.$translate=i,this.callTogglingService=s,this.callingMRUPhoneNumbersService=r,this.eventingService=l,this.resources=u,this.deviceManagerService=d,this.isPstnAvailable=!1,this.close=e.closeThisDialog,this.call=e.ngDialogData.call,this.callingScreenController=e.ngDialogData.callingScreenController,this.scenarioContext=t.scenarios.calling.context.callMeBackDialog,this.isUserReconsiled=teamspace.components.Calling.ParticipantState.isReconciledPstnParticipant(this.call),this.callChangedCallbackDisposable=this.call.changed(function(){var t=p.isUserReconsiled;p.isUserReconsiled=teamspace.components.Calling.ParticipantState.isReconciledPstnParticipant(p.call),p.isUserReconsiled!==t&&g.digest(e)}),this.isPstnAvailable=e.ngDialogData.isPstnAvailable}return t.$inject=["constants","$scope","$q","$translate","loggingService","ariaLiveService","callTogglingService","settingsService","callingMRUPhoneNumbersService","eventingService","resources","deviceManagerService","utilityService"],t.prototype.$onDestroy=function(){this.callChangedCallbackDisposable.dispose()},t.prototype.isConnectionAudioOn=function(){return!(this.isUserReconsiled||this.call.isContentOnlyMode)},t.prototype.isConnectionContentOnly=function(){return this.call.isContentOnlyMode&&!this.isUserReconsiled},t.prototype.isConnectionPstn=function(){return this.isUserReconsiled},t.prototype.openCallMeBack=function(){this.$scope.$emit(this.constants.events.calling.openPSTNDialog),this.close()},t.prototype.turnAudioOff=function(){this.auxturnAudioOff(),this.close()},t.prototype.turnAudioOn=function(){var t=this;return(this.isConnectionPstn()?this.auxEndCall():Promise.resolve()).then(function(){return t.auxTurnAudioOn()}).then(function(){return t.close()})},t.prototype.endCall=function(){return this.auxEndCall()},t.prototype.openDeviceSettings=function(){this.callingScreenController.panelButtonOptions.deviceSettingsPanelButtonOptions.isSelected||this.$scope.$emit(this.constants.events.calling.toggleRightPanel,teamspace.components.Calling.RightPanel.DeviceSettings),this.close()},Object.defineProperty(t.prototype,"correlationId",{get:function(){return this.callingScreenController.correlationId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"connectingPhoneNumber",{get:function(){if(!this.savedConnectingPhoneNumber){var t=teamspace.components.Calling.ParticipantState.getReconciledPstnParticipantMri(this.call).slice(SkypeX.Services.ChatServiceUtils.PstnPrefix.length);this.savedConnectingPhoneNumber=this.callingMRUPhoneNumbersService.getConnectingPhoneNumber(t)}return this.savedConnectingPhoneNumber},enumerable:!0,configurable:!0}),t.prototype.auxTurnAudioOn=function(){this.callTogglingService.toggleMuteAudio(this.call,1,2),this.callTogglingService.toggleSpeaker(this.call,2)},t.prototype.auxturnAudioOff=function(){this.callTogglingService.turnOffSpeakerAndMicAudio(this.call,"")},t.prototype.auxEndCall=function(){var t=this,e=teamspace.components.Calling.ParticipantState.getReconciledPstnParticipantMri(this.call);return this.savedConnectingPhoneNumber=null,this.call.removeParticipant(e).then(function(){t.eventingService.$emit(t.constants.events.callMeBack.participantRemoved)})},Object.defineProperty(t.prototype,"dialogTitle",{get:function(){return this.$translate.instant(this.resources.strings.calling_manage_meeting_audio_dialog_title)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dialogSubtitle",{get:function(){return this.$translate.instant(this.resources.strings.calling_manage_meeting_audio_dialog_subtitle)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dialogChangeAudioSettings",{get:function(){return this.$translate.instant(this.resources.strings.calling_manage_meeting_audio_dialog_change_audio_settings)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dialogOtherAudioOptions",{get:function(){return this.$translate.instant(this.resources.strings.calling_manage_meeting_audio_dialog_other_audio_options)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dialogUseAPhone",{get:function(){return this.$translate.instant(this.resources.strings.calling_manage_meeting_audio_dialog_use_a_phone)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dialogTurnAudioOff",{get:function(){return this.$translate.instant(this.resources.strings.calling_manage_meeting_audio_dialog_turn_audio_off)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dialogUseThisDevice",{get:function(){return this.$translate.instant(this.resources.strings.calling_manage_meeting_audio_dialog_use_this_device)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dialogUseThisDeviceDescription",{get:function(){return this.$translate.instant(this.resources.strings.calling_manage_meeting_audio_dialog_use_this_device_description)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dialogDisconnect",{get:function(){return this.$translate.instant(this.resources.strings.calling_manage_meeting_audio_dialog_disconnect)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"getSelectedCompositeDeviceLabel",{get:function(){return this.deviceManagerService.getSelectedCompositeDeviceLabel()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dialogUseAPhoneDescription",{get:function(){return this.$translate.instant(this.resources.strings.calling_manage_meeting_audio_dialog_use_a_phone_description)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dialogTurnAudioOffDescription",{get:function(){return this.$translate.instant(this.resources.strings.calling_manage_meeting_audio_dialog_turn_audio_off_description)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dialogAudioIsOff",{get:function(){return this.$translate.instant(this.resources.strings.calling_manage_meeting_audio_dialog_audio_is_off)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dialogAudioIsOffDescription",{get:function(){return this.$translate.instant(this.resources.strings.calling_manage_meeting_audio_dialog_audio_is_off_description)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dialogPstnConfirmation",{get:function(){return this.$translate.instant(this.resources.strings.calling_manage_meeting_audio_dialog_pstn_confirmation)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dialogHowToMuteMicrophoneOnPhone",{get:function(){return this.$translate.instant(this.resources.strings.calling_manage_meeting_audio_dialog_how_to_mute_microphone_on_phone)},enumerable:!0,configurable:!0}),t.prototype.closeDialog=function(){this.close()},t.prototype.isPstnDisabled=function(){var t=this.call.getCallingConversation();return!(this.isPstnAvailable&&!t.isOneToOne())},t}();e.ManageMeetingAudioDialogController=o,angular.module("teamspace.manageMeetingAudioDialog",["teamspace.constants","teamspace.loggingService","teamspace.dialogService","teamspace.callTogglingService","teamspace.settingsService","teamspace.callingMRUPhoneNumbersService","teamspace.deviceManagerService","teamspace.eventingService","teamspace.callingPstnStateComponent","teamspace.utilityService","teamspace.conversationsService"]).directive("manageMeetingAudioDialog",["constants",function(t){return{restrict:"E",scope:{},bindToController:{correlationId:"<"},controller:o,controllerAs:"ctrl"}}]).run(["$templateCache",function(t){t.put("components/manage-meeting-audio-dialog/manage-meeting-audio-dialog.html",i)}]).run(["constants","dialogService",function(t,e){e.register(t.lazyDialogs.manageMeetingAudioDialog,{template:"components/manage-meeting-audio-dialog/manage-meeting-audio-dialog.html",className:"manage-meeting-audio-dialog ts-modal-dialog",closeByEscape:!0,closeByDocument:!0,controller:o,controllerAs:"ctrl",ariaAuto:!1,ariaRole:"dialog",ariaDescribedById:"modalDialog-title",overlay:!1,closeByNavigation:!0})}]).filter("phoneTypeFilter",["$translate","resources",function(t,e){return function(n){switch(n){case teamspace.services.PhoneNumberType.Mobile:return t.instant(e.strings.people_mobile);case teamspace.services.PhoneNumberType.Home:return t.instant(e.strings.people_home);default:return""}}}])},2602:function(t,e){t.exports='<div class="ts-calling-manage-meeting-audio inset-border inset-border-themed" role="dialog">\n  <div class="dialog-content inset-border inset-border-themed">\n    <p class="header-text app-font-title2-bold">\n      {{::ctrl.dialogTitle}}\n    </p>\n\n    <div class="button-container" ng-if="ctrl.isConnectionAudioOn()">\n      <p class="content-text">\n        {{::ctrl.dialogSubtitle}}\n      </p>\n      <div class="audio-on-connection-status-primary-box">\n        <div class="audio-on-current-state-description">\n          {{::ctrl.getSelectedCompositeDeviceLabel}}\n        </div>\n\n        <button class="single-line-truncation ts-btn ts-btn-fluent audio-on-change-button" ng-click="ctrl.openDeviceSettings()" data-tid="change-audio-settings" role="button" track-type="{{::$root.trackConstants.trackType.button}}" track-outcome="{{::$root.trackConstants.trackOutcome.openDialog}}" track-name="{{::$root.trackConstants.trackModuleName.manageMeetingAudio}}" track-summary="Open device settings">\n          {{::ctrl.dialogChangeAudioSettings}}\n        </button>\n      </div>\n\n      <p class="other-audio-options-title app-font-caption-regular">\n        {{::ctrl.dialogOtherAudioOptions}}\n      </p>\n\n      <button class="ngdialog-close button-box" ng-click="ctrl.openCallMeBack()" ng-disabled="::ctrl.isPstnDisabled()" aria-labelledby="use-a-phone-audio-on" aria-describedby="use-a-phone-audio-on-description" data-tid="use-a-phone-audio-on" role="button" track-type="{{::$root.trackConstants.trackType.button}}" track-outcome="{{::$root.trackConstants.trackOutcome.openDialog}}" track-name="{{::$root.trackConstants.trackModuleName.manageMeetingAudio}}" track-summary="Open call me back dialog">\n        <div class="manage-meeting-audio-svg-include-wrapper">\n          <svg-include class="icon-filled" src="\'svg/icons-call-audio.html\'"></svg-include>\n        </div>\n        <div class="button-text">\n          <p id="use-a-phone-audio-on" class="button-text-title">\n            {{::ctrl.dialogUseAPhone}}\n          </p>\n          <p id="use-a-phone-audio-on-description" class="button-text-content" role="tooltip">\n            {{::ctrl.dialogUseAPhoneDescription}}\n          </p>\n        </div>\n      </button>\n\n      <button class="ngdialog-close button-box last" ng-click="ctrl.turnAudioOff()" aria-labelledby="turn-audio-off-audio-on" aria-describedby="turn-audio-off-audio-on-description" data-tid="turn-audio-off-audio-on" role="button" track-type="{{::$root.trackConstants.trackType.button}}" track-outcome="{{::$root.trackConstants.trackOutcome.micOff}}" track-name="{{::$root.trackConstants.trackModuleName.manageMeetingAudio}}" track-summary="Turn audio off">\n        <div class="manage-meeting-audio-svg-include-wrapper">\n          <svg-include class="icon-filled" src="\'svg/icons-no-audio.html\'"></svg-include>\n        </div>\n        <div class="button-text">\n          <p id="turn-audio-off-audio-on" class="button-text-title">\n            {{::ctrl.dialogTurnAudioOff}}\n          </p>\n          <p id="turn-audio-off-audio-on-description" class="button-text-content" role="tooltip">\n            {{::ctrl.dialogTurnAudioOffDescription}}\n          </p>\n        </div>\n      </button>\n    </div>\n\n    <div class="button-container" ng-if="ctrl.isConnectionContentOnly()">\n      <div class="audio-off-status-box">\n        <div class="manage-meeting-audio-svg-include-wrapper">\n          <svg-include class="icon-filled" src="\'svg/icons-no-audio.html\'"></svg-include>\n        </div>\n        <div class="button-text">\n          <p class="button-text-title">\n            {{::ctrl.dialogAudioIsOff}}\n          </p>\n          <p class="button-text-content">\n            {{::ctrl.dialogAudioIsOffDescription}}\n          </p>\n        </div>\n      </div>\n\n      <p class="other-audio-options-title app-font-caption-regular">\n        {{::ctrl.dialogOtherAudioOptions}}\n      </p>\n\n      <button class="ngdialog-close button-box" ng-click="ctrl.turnAudioOn()" aria-labelledby="use-this-device-audio-off" aria-describedby="use-this-device-audio-off-description" data-tid="use-this-device-audio-off" role="button" track-type="{{::$root.trackConstants.trackType.button}}" track-outcome="{{::$root.trackConstants.trackOutcome.micOn}}" track-name="{{::$root.trackConstants.trackModuleName.manageMeetingAudio}}" track-summary="Turn audio on">\n        <div class="manage-meeting-audio-svg-include-wrapper">\n          <svg-include class="icon-filled" src="\'https://statics.teams.cdn.office.net/hashedassets/svg/icons-audio-video-filled-f6cab1d.html\'"></svg-include>\n        </div>\n        <div class="button-text">\n          <p id="use-this-device-audio-off" class="button-text-title">\n            {{::ctrl.dialogUseThisDevice}}\n          </p>\n          <p id="use-this-device-audio-off-description" class="button-text-content" role="tooltip">\n            {{::ctrl.dialogUseThisDeviceDescription}}\n          </p>\n        </div>\n      </button>\n\n      <button class="ngdialog-close button-box last" ng-click="ctrl.openCallMeBack()" ng-disabled="::ctrl.isPstnDisabled()" aria-labelledby="use-a-phone-audio-off" aria-describedby="use-a-phone-audio-off-description" data-tid="use-a-phone-audio-off" role="button" track-type="{{::$root.trackConstants.trackType.button}}" track-outcome="{{::$root.trackConstants.trackOutcome.openDialog}}" track-name="{{::$root.trackConstants.trackModuleName.manageMeetingAudio}}" track-summary="Open call me back dialog">\n        <div class="manage-meeting-audio-svg-include-wrapper">\n          <svg-include class="icon-filled" src="\'svg/icons-call-audio.html\'"></svg-include>\n        </div>\n        <div class="button-text">\n          <p id="use-a-phone-audio-off" class="button-text-title">\n            {{::ctrl.dialogUseAPhone}}\n          </p>\n          <p id="use-a-phone-audio-off-description" class="button-text-content" role="tooltip">\n            {{::ctrl.dialogUseAPhoneDescription}}\n          </p>\n        </div>\n      </button>\n    </div>\n\n    <div class="button-container" ng-if="ctrl.isConnectionPstn()">\n      <p class="content-text top-content-text">\n        {{::ctrl.dialogPstnConfirmation}}\n      </p>\n      <p class="content-text app-font-base-bold">\n        {{::ctrl.dialogHowToMuteMicrophoneOnPhone}}\n      </p>\n\n      <calling-pstn-state-component call="::ctrl.call" scenario-context="{{::ctrl.scenarioContext}}" tooltip-class="call-me-back-dialog-tooltip" correlation-id="::ctrl.correlationId" connecting-phone-number="::ctrl.connectingPhoneNumber" connecting-phone-number-type="::ctrl.connectingPhoneNumber.type|phoneTypeFilter">\n      </calling-pstn-state-component>\n\n      <p class="other-audio-options-title app-font-caption-regular">\n        {{::ctrl.dialogOtherAudioOptions}}\n      </p>\n\n      <button class="ngdialog-close button-box" ng-click="ctrl.turnAudioOn()" aria-labelledby="use-this-device-pstn" aria-describedby="use-this-device-pstn-description" data-tid="use-this-device-pstn" role="button" track-type="{{::$root.trackConstants.trackType.button}}" track-summary="Turn audio on" track-outcome="{{::$root.trackConstants.trackOutcome.micOn}}" track-name="{{::$root.trackConstants.trackModuleName.manageMeetingAudio}}">\n        <div class="manage-meeting-audio-svg-include-wrapper">\n          <svg-include class="icon-filled" src="\'https://statics.teams.cdn.office.net/hashedassets/svg/icons-audio-video-filled-f6cab1d.html\'"></svg-include>\n        </div>\n        <div class="button-text">\n          <p id="use-this-device-pstn" class="button-text-title">\n            {{::ctrl.dialogUseThisDevice}}\n          </p>\n          <p id="use-this-device-pstn-description" class="button-text-content" role="tooltip">\n            {{::ctrl.dialogUseThisDeviceDescription}}\n          </p>\n        </div>\n      </button>\n\n      <button class="ngdialog-close button-box last" ng-click="ctrl.endCall()" aria-labelledby="use-this-device-pstn" aria-describedby="use-this-device-pstn-description" data-tid="turn-audio-off-pstn" role="button" track-type="{{::$root.trackConstants.trackType.button}}" track-name="{{::$root.trackConstants.trackModuleName.manageMeetingAudio}}" track-summary="End PSTN call" track-outcome="{{::$root.trackConstants.trackOutcome.micOff}}">\n        <div class="manage-meeting-audio-svg-include-wrapper">\n          <svg-include class="icon-filled" src="\'svg/icons-no-audio.html\'"></svg-include>\n        </div>\n        <div class="button-text">\n          <p id="turn-audio-off-pstn" class="button-text-title">\n            {{::ctrl.dialogTurnAudioOff}}\n          </p>\n          <p id="turn-audio-off-pstn-description" class="button-text-content" role="tooltip">\n            {{::ctrl.dialogTurnAudioOffDescription}}\n          </p>\n        </div>\n      </button>\n    </div>\n\n    <button aria-label="{{::$root.resources.strings.modal_dialog_close_button|translate}}" ng-click="ctrl.closeDialog()" class="ts-sym icons-close app-icons-fill-hover app-icons-fill-focus inset-border inset-border-round inset-border-themed" calling-screen-focus="pstn-close-button">\n      <svg-include class="icon" src="\'svg/icons-close.html\'"></svg-include>\n    </button>\n  </div>\n</div>\n'}},[2600]);