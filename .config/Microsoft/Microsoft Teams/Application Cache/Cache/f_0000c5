webpackJsonp([32],{2192:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(2193)},2193:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2194),s=teamspace.components.ChannelViewModel,i=teamspace.components.SortDirection,r=function(){function e(e,t,n,a,s,i,r,l,c,o,d,h,u,v,p,g,m,b,f,C,y,k,T,S,$){var w=this;this.$filter=e,this.$scope=n,this.$translate=a,this.appStateAdapter=s,this.ariaLiveService=i,this.channelActionDialogUtilityService=r,this.channelService=l,this.constants=c,this.timeagoCalcService=o,this.dialogService=d,this.eventingService=h,this.localizationService=u,this.loggingService=v,this.navigationService=p,this.personalConversationService=g,this.pinChannelService=m,this.resources=b,this.settingsService=C,this.storageService=y,this.teamMembershipPropertiesService=k,this.teamSettingsService=T,this.tooltipService=S,this.activeChannelsCollapsed=!1,this.activeChannelsCount=0,this.deletedChannelsCollapsed=!0,this.deletedChannelsCount=0,this.activeChannelsList=[],this.deletedChannelsList=[],this.filteredActiveChannelsList=[],this.filteredActiveChannelsCount=0,this.filteredDeletedChannelsList=[],this.filteredDeletedChannelsCount=0,this.sortedColumn={name:"displayName",direction:teamspace.components.SortDirection.Up},this.channelLastActivityPlaceholderDate=1451606399e3;var x=f.getRootRouteParams();if(this.threadId=x.threadId,this.threadId){this.setEventHandlers(),this.isPrivateChannelsInTeamDashboardEnabled=C.valueAsBoolean(c.settings.names.enablePrivateChannelsInTeamDashboard),this.isChannelRestoreV2Enabled=C.valueAsBoolean(c.settings.names.enableRestoreChannelV2),this.uniqueIdForContextMenu=$.generateUUID(),this.uniqueIdForFavDefaultExceededTooltip=$.generateUUID(),this.createChannelTypeMap(),this.isNewTerminologyForFavoriteEnabled=C.valueAsBoolean(c.settings.names.enableNewTerminologyForTeamChannelFavorites);var D=this.isNewTerminologyForFavoriteEnabled?b.strings.td_channels_tab_show_hide_tooltip:b.strings.td_channels_tab_favorite;this.favoriteTooltipText=a.instant(D),this.narrateFilterResults=_.debounce(function(){return w.narrateFilterResultsInternal()},1e3),this.filterAndSortActiveChannels=_.debounce(function(){return w.filterAndSortActiveChannelsInternal()},200),this.filterAndSortDeletedChannels=_.debounce(function(){return w.filterAndSortDeletedChannelsInternal()},200),this.enableEnhancedTelemetry=C.valueAsBoolean(c.settings.names.enableEnhancedTelemetry)}else t.go(c.states.appYourSpaces)}return e.$inject=["$filter","$state","$scope","$translate","appStateAdapter","ariaLiveService","channelActionDialogUtilityService","channelService","constants","timeagoCalcService","dialogService","eventingService","localizationService","loggingService","navigationService","personalConversationService","pinChannelService","resources","routeUtilityService","settingsService","storageService","teamMembershipPropertiesService","teamSettingsService","tooltipService","utilityService"],Object.defineProperty(e.prototype,"isTeamAdmin",{get:function(){return this.teamMembershipPropertiesService.isAdmin(this.team.objectId)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showDeletedChannelsHeader",{get:function(){return(this.isTeamAdmin||this.teamSettingsService.canDeleteChannel(this.team.objectId))&&!!(this.filteredActiveChannelsCount||this.searchString&&!this.filteredActiveChannelsCount)&&!!(!this.searchString||this.searchString&&this.filteredDeletedChannelsCount)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showDeletedChannels",{get:function(){return this.showDeletedChannelsHeader&&!this.deletedChannelsCollapsed&&!!this.filteredDeletedChannelsCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showActiveChannelsHeader",{get:function(){return!!this.filteredActiveChannelsCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showActiveChannels",{get:function(){return!this.activeChannelsCollapsed&&!!this.filteredActiveChannelsCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isMainNotificationBannerVisible",{get:function(){return this.appStateAdapter.mainNotificationBannerStore&&!!this.appStateAdapter.mainNotificationBannerStore.currentBanner},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"searchString",{get:function(){return this._searchString},set:function(e){this._searchString!==e&&(this._searchString=e,this.filterAndSortActiveChannels(),this.filterAndSortDeletedChannels(),this._searchString&&this.narrateFilterResults())},enumerable:!0,configurable:!0}),e.prototype.$onInit=function(){var e=this;this.logger=this.loggingService.newLogger("ChannelsTab"),this.searchPlaceholder=this.$translate.instant(this.resources.strings.team_dashboard_channel_tab_search_placeholder),this.activeChannelsHeader=this.$translate.instant(this.resources.strings.team_dashboard_active_channel_tab_header),this.deletedChannelsHeader=this.$translate.instant(this.resources.strings.team_dashboard_deleted_channel_tab_header),this.searchChannels=function(t){return e.showChannel(t)},this.wait=!0,this.errored=!1,this.channelService.getTeamById(this.threadId).then(function(t){e.team=t,e.enableDefaultFavChannel=e.settingsService.valueAsBoolean(e.constants.settings.names.enableDefaultFavChannel)&&e.isTeamAdmin,e.setPermissionProps(),e.isPrivateChannelsInTeamDashboardEnabled?(e.triggerChannelFetch().finally(function(){return e.wait=!1}),e.setEventListeners()):e.$scope.$watchCollection("tdct.team.channels",function(){return e.updateActiveChannelsList(),e.channelService.getDeletedChannelsInTeam(t.objectId).then(function(t){var n=e.channelService.getSoftDeletedChannels(t);e.updateDeletedChannelsList(n)})}),e.startNonFavoriteChannelsPoll(),e.enableDefaultFavChannel&&(e.favDefaultChannelsLimit=e.channelService.favDefaultChannelsLimit,e.defaultFavHeader=e.$translate.instant(e.resources.strings.td_channels_tab_set_favorite_as_default_title_and_aria,{favDefaultChannelsLimit:e.favDefaultChannelsLimit}))}).catch(function(t){e.logger.error('[Initialization] Failed to get the team with ID "'+e.threadId+'"'),e.errorInfo=t,e.errored=!0}).finally(function(){e.isPrivateChannelsInTeamDashboardEnabled||(e.wait=!1)})},e.prototype.narrateFilterResultsInternal=function(){var e=this.filteredActiveChannelsCount+this.filteredDeletedChannelsCount;e>1?this.ariaLiveService.update(this.$translate.instant(this.resources.strings.td_channels_tab_multiple_search_results_aria,{resultCount:e})):1===e?this.ariaLiveService.update(this.$translate.instant(this.resources.strings.td_channels_tab_one_search_result_aria)):this.ariaLiveService.update(this.$translate.instant(this.resources.strings.td_members_tab_no_search_result_aria,{searchString:this.searchString}))},e.prototype.setEventListeners=function(){var e=this;this.eventingService.$on(this.$scope,this.constants.events.channels.deletedChannelLocal,function(){e.triggerChannelFetch()}),this.eventingService.$on(this.$scope,this.constants.events.channels.restoredChannelLocal,function(){e.triggerChannelFetch()})},e.prototype.triggerChannelFetch=function(){var e=this;return this.channelService.getAllChannelsInTeam(this.team.objectId,this.isTeamAdmin).then(function(t){e.updateActiveChannelsListV2(t)})},e.prototype.$onDestroy=function(){this.nonFavoriteChannelsPollIntervalId&&window.clearInterval(this.nonFavoriteChannelsPollIntervalId)},e.prototype.setPermissionProps=function(){this.setCanCreateChannel(),this.setCanRestoreChannels()},e.prototype.setCanCreateChannel=function(){this.canCreateChannel=!this.team.isArchived&&(this.isTeamAdmin||this.teamSettingsService.canCreateChannel(this.team.objectId))},e.prototype.setCanRestoreChannels=function(){this.showRestoreOption=!this.team.isArchived&&(this.isTeamAdmin||this.teamSettingsService.canDeleteChannel(this.team.objectId))},e.prototype.setEventHandlers=function(){var e=this;this.$scope.$$destroyed||(this.teamSettingsService.safeSubscribe(this.$scope,function(t,n){e.team&&e.team.objectId===n&&e.setPermissionProps()},this.constants.ChannelConversationAdapterService.Type_ChannelConversationsChanged,this.constants.events.teams.updatedTeamAdminSettings),this.teamMembershipPropertiesService.safeSubscribe(this.$scope,function(t,n){e.team&&e.team.objectId===n&&e.setPermissionProps()},this.constants.ChannelConversationAdapterService.Type_ChannelConversationsChanged,this.constants.events.teams.updatedTeamMembershipProperties),this.$scope.$watch("tdct.team.isArchived",function(t,n){n!==t&&e.setPermissionProps()}))},e.prototype.showFavoriteActionBtn=function(e){return!e.isPinned&&(!e.isGeneral&&(!this.isPrivateChannelsInTeamDashboardEnabled||this.isPrivateChannelsInTeamDashboardEnabled&&e.isResolved))},e.prototype.constructAndApplyAriaLabel=function(e,t){var n=this.$translate.instant(this.resources.strings.td_channels_tab_channel_aria,{channelName:t.displayName,channelType:this.channelTypeMap.get(t.channelType),description:t.description,lastActivity:this.getTimeString(t.lastActivity)});e.target.setAttribute("aria-label",n)},e.prototype.toggleDeletedChannelsSection=function(){this.deletedChannelsCollapsed=!this.deletedChannelsCollapsed,this.activeChannelsCollapsed=!0},e.prototype.toggleActiveChannelsSection=function(){this.activeChannelsCollapsed=!this.activeChannelsCollapsed,this.deletedChannelsCollapsed=!0},e.prototype.getMembers=function(e){var t=this;if(e&&e.members){var n=e.getMembersWithoutExpiration();return _.filter(n,function(e){return!t.isBot(e)})}},e.prototype.getLastActivity=function(e){return e&&e.lastMessageTimeUtc?new Date(e.lastMessageTimeUtc).valueOf():null},e.prototype.sortTable=function(e,t){void 0===t&&(t=!1),e&&(e==this.sortedColumn.name&&(this.sortedColumn.direction=this.sortedColumn.direction===i.Up?i.Down:i.Up),this.sortedColumn.name=e);var n=this.$filter("orderBy");t?this.filteredDeletedChannelsList=n(this.filteredDeletedChannelsList,this.sortedColumn.name,this.sortedColumn.direction!==i.Up):this.filteredActiveChannelsList=n(this.filteredActiveChannelsList,this.sortedColumn.name,this.sortedColumn.direction!==i.Up),"lastActivity"!==this.sortedColumn.name||t||this.updateChannelOrderByLastAcitvity(),t||this.shiftGeneralToTop()},e.prototype.shouldDisableCheckboxIfFavChannelLimitReached=function(e){return!e.isFavDefault&&(this.numberOfFavDefaultChannelsSet=this.activeChannelsList.filter(function(e){return e.isFavDefault}).length,this.numberOfFavDefaultChannelsSet>=this.favDefaultChannelsLimit)},e.prototype.generateCheckboxTitle=function(e){var t=this.isNewTerminologyForFavoriteEnabled?this.resources.strings.fav_default_checkbox_show_title:this.resources.strings.fav_default_checkbox_unselected_title;return e.isFavDefault?t=this.isNewTerminologyForFavoriteEnabled?this.resources.strings.show_channel_default_checkbox_selected_title:this.resources.strings.fav_default_checkbox_selected_title:this.shouldDisableCheckboxIfFavChannelLimitReached(e)&&(t=this.isNewTerminologyForFavoriteEnabled?this.resources.strings.show_channel_default_limit_reached_title:this.resources.strings.fav_default_limit_reached_title),this.$translate.instant(t)},e.prototype.updateDefaultFavChannel=function(e){var t=this,n=/true/i.test(this.storageService.get(this.constants.storageServiceKeys.favDefaultDialogSuppressStorageKey)),a=function(){e.isFavDefault=!e.isFavDefault},s=function(n){t.storageService.set(t.constants.storageServiceKeys.favDefaultDialogSuppressStorageKey,String(n)),t.channelService.setDefaultChannel(e.objectId,e.isFavDefault).catch(function(e){a()})};e.isFavDefault&&!n?this.dialogService.open(this.constants.dialogs.setChannelFavDefault,{cancel:a,confirm:s,channel:e}):s(n)},e.prototype.generateFavDefaultTrackConstants=function(e){return{trackScenario:teamspace.components.PanelActionScenario.channelFavoritedByDefault,trackScenarioType:teamspace.components.PanelActionScenarioType.admin,trackName:teamspace.components.PanelModuleName.channelFavoritedByDefaultCheckbox,trackType:teamspace.components.PanelModuleType.other,trackSummary:e.objectId,trackData:{isFavDefault:!e.isFavDefault}}},e.prototype.generateFavoriteTrackConstants=function(e){return{trackScenario:teamspace.components.PanelActionScenario.channelFavorite,trackScenarioType:teamspace.components.PanelActionScenarioType.admin,trackName:teamspace.components.PanelModuleName.starButton,trackType:teamspace.components.PanelModuleType.other,trackSummary:e.objectId,trackOutcome:teamspace.components.PanelActionOutcome.submit}},e.prototype.openFavDefaultExceededTooltip=function(e){var t=this.isNewTerminologyForFavoriteEnabled?this.$translate.instant(this.resources.strings.show_channel_default_limit_reached_title):this.$translate.instant(this.resources.strings.fav_default_limit_reached_title),n={templateUrl:"components/team-dashboard-stripe/td-channels-tab/td-channels-tab-fav-default-exceeded-tooltip.html",placement:"auto",target:$(e.currentTarget),scope:this.$scope,content:t},a={sourceElement:$(e.currentTarget),tooltipType:teamspace.services.TooltipType.Popover,tooltipId:this.uniqueIdForFavDefaultExceededTooltip,options:n};e.preventDefault(),e.stopPropagation(),this.tooltipService.showTooltip(a)},e.prototype.closeFavDefaultExceededTooltip=function(){this.tooltipService.clearTooltip(teamspace.services.TooltipType.Popover,this.uniqueIdForFavDefaultExceededTooltip)},e.prototype.updateChannelOrderByLastAcitvity=function(){for(var e=[],t=[],n=0;n<this.filteredActiveChannelsList.length;n++)this.filteredActiveChannelsList[n].lastActivity?t.push(this.filteredActiveChannelsList[n]):e.push(this.filteredActiveChannelsList[n]);this.filteredActiveChannelsList=t.concat(e)},e.prototype.createChannel=function(){this.team.isArchived||(this.loggingService.newScenario(this.constants.scenarios.teamAndChannel.openCreateChannelDialog).clientId="td-channels-tab",this.dialogService.open(this.constants.dialogs.createChannel,{team:this.team}))},e.prototype.toggleFavoriteChannel=function(e,t){void 0===t&&(t=!1),t?this.personalConversationService.toggleFavoriteSettingForChannel(e.model,void 0,e.model.isFavorite,void 0,!0):this.personalConversationService.toggleFavoriteSettingForChannel(e.model)},e.prototype.clearSearch=function(){this.searchString=null,angular.element(".td-channels-tab .ts-search-input").focus()},e.prototype.restoreChannel=function(e){this.channelActionDialogUtilityService.openRestoreDeletedChannelDialog(this.team,e)},e.prototype.createChannelTypeMap=function(){this.channelTypeMap=new Map,this.channelTypeMap.set(teamspace.services.ChannelType[teamspace.services.ChannelType.Shared],this.$translate.instant(this.resources.strings.td_manage_channels_dashboard_channel_visibility_k2)),this.channelTypeMap.set(teamspace.services.ChannelType[teamspace.services.ChannelType.Private],this.$translate.instant(this.resources.strings.td_manage_channels_dashboard_channel_visibility_private)),this.channelTypeMap.set(teamspace.services.ChannelType[teamspace.services.ChannelType.Regular],this.$translate.instant(this.resources.strings.td_manage_channels_dashboard_channel_visibility_standard))},e.prototype.startNonFavoriteChannelsPoll=function(){var e=this;this.team&&this.team.channels&&(this.eventingService.$on(this.$scope,this.constants.events.appState.interactive,function(){e.channelService.updateChannelStatusFromServer(e.team.objectId,e.team.channels.filter(function(e){return!e.isFavorite}).map(function(e){return e.objectId}),"td-channels-tab")}),this.channelService.updateChannelStatusFromServer(this.team.objectId,this.team.channels.filter(function(e){return!e.isFavorite}).map(function(e){return e.objectId}),"td-channels-tab"))},e.prototype.updateDeletedChannelsList=function(e){var t=this;e&&e.length?this.deletedChannelsList=e.map(function(e){var n=new teamspace.services.ChannelLocal({objectId:e.objectId,displayName:e.displayName,groupId:e.groupId});t.isPrivateChannelsInTeamDashboardEnabled&&(n.channelType=teamspace.services.ChannelType[e.channelType]);var a=new s(n,t.pinChannelService.isPinned(n.objectId));return a.deleteTime=t.localizationService.getDate(e.deleteTime,"shortDate"),t.checkAndMarkIfRowIsRestorable(a),a}):(this.activeChannelsCollapsed=!1,this.deletedChannelsList=[]),this.filterAndSortDeletedChannels()},e.prototype.updateActiveChannelsList=function(){var e=this;this.activeChannelsCount=this.team&&this.team.channels&&this.team.channels.length||0,this.activeChannelsList=this.team.channels.map(function(t){return new s(t,e.pinChannelService.isPinned(t.objectId))}),this.filterAndSortActiveChannels()},e.prototype.updateActiveChannelsListV2=function(e){var t=this;this.parseChannelsForCacheCheck(e),this.activeChannelsList=this.team.getChannels(!0).map(function(e){return e.lastActivity==t.channelLastActivityPlaceholderDate&&Object.assign(e,{lastActivity:null}),new s(e,t.pinChannelService.isPinned(e.objectId))});var n=[],a=this.team.privateChannels,i=new Set;_.forEach(a,function(e){i.add(e.objectId)}),e.forEach(function(e){if(teamspace.components.ChannelState[e.channelState]===teamspace.components.ChannelState.Deleted)n.push(e);else if(t.isTeamAdmin&&!i.has(e.objectId)){var a=new teamspace.services.ChannelLocal({objectId:e.objectId,displayName:e.displayName,description:e.description,groupId:e.groupId});a.parentTeamId=t.team.objectId,e.channelType&&(a.channelType=teamspace.services.ChannelType[e.channelType]);var r=new s(a,t.pinChannelService.isPinned(e.objectId),!1);t.activeChannelsList.push(r)}}),this.activeChannelsCount=this.activeChannelsList.length,this.updateDeletedChannelsList(n),this.filterAndSortActiveChannels()},e.prototype.parseChannelsForCacheCheck=function(e){var t=[];e.forEach(function(e){teamspace.components.ChannelState[e.channelState]!==teamspace.components.ChannelState.Deleted&&teamspace.services.ChannelType[e.channelType]===teamspace.services.ChannelType.Private&&t.push(e.objectId)}),this.channelService.reparseConversations(t)},e.prototype.checkAndMarkIfRowIsRestorable=function(e){e.canRestore=!0,e.channelType!==teamspace.services.ChannelType[teamspace.services.ChannelType.Private]||this.isChannelRestoreV2Enabled||(e.canRestore=!1)},e.prototype.shiftGeneralToTop=function(){if(this.filteredActiveChannelsList)for(var e=0;e<this.filteredActiveChannelsList.length;e++)if(this.filteredActiveChannelsList[e].isGeneral){this.filteredActiveChannelsList.unshift(this.filteredActiveChannelsList.splice(e,1)[0]);break}},e.prototype.showChannel=function(e){if(!this.searchString)return!0;var t=this.searchString.toLowerCase();return e.displayName&&-1!=e.displayName.toLowerCase().indexOf(t)||e.description&&-1!=e.description.toLowerCase().indexOf(t)},e.prototype.filterOnSearchString=function(e){if(this.searchString){var t=this.searchString.toLowerCase();return _.filter(e,function(e){return e.displayName&&-1!=e.displayName.toLowerCase().indexOf(t)||e.description&&-1!=e.description.toLowerCase().indexOf(t)})}return e},e.prototype.filterAndSortActiveChannelsInternal=function(){this.activeChannelsList&&this.activeChannelsCount&&(this.filteredActiveChannelsList=this.filterOnSearchString(this.activeChannelsList),this.filteredActiveChannelsCount=this.filteredActiveChannelsList&&this.filteredActiveChannelsList.length||0,this.filteredActiveChannelsCount&&this.sortTable(),this.$scope.$applyAsync())},e.prototype.filterAndSortDeletedChannelsInternal=function(){this.filteredDeletedChannelsList=this.filterOnSearchString(this.deletedChannelsList),this.deletedChannelsCount=this.deletedChannelsList&&this.deletedChannelsList.length||0,this.filteredDeletedChannelsCount=this.filteredDeletedChannelsList&&this.filteredDeletedChannelsList.length||0,this.filteredDeletedChannelsCount?this.sortTable(null,!0):this.deletedChannelsCollapsed=!0,this.$scope.$applyAsync()},e.prototype.openChannelContextMenu=function(e,t,n){var a={templateUrl:n.isResolved?this.constants.files.templates.channelsTabChannelActionMenu:this.constants.files.templates.channelsTabChannelAdminActionMenu,container:"body",trigger:"manual",scope:t,autoClose:!0,placement:"left"},s={sourceElement:$(e.currentTarget),tooltipType:teamspace.services.TooltipType.Popover,tooltipId:this.uniqueIdForContextMenu,options:a};e.preventDefault(),e.stopPropagation(),this.tooltipService.showTooltip(s)},e.prototype.navigateToChannel=function(e){if(e&&e.isResolved){var t={slug:e.displayName,groupName:this.team.displayName,middlePane:this.constants.messages.panes.conversations,threadId:e.objectId,messageId:void 0,ctx:"channel",navCtx:"td-channels-tab"};return this.navigationService.navigate(this.$scope,this.constants.states.appConversation,t)}},e.prototype.getTimeString=function(e){return this.timeagoCalcService.transformIntoTimeago(e)},e.prototype.isBot=function(e){return SkypeX.Services.ChatServiceUtils.isBotMri(e.id,!1)},e}();t.TdChannelsTabController=r,angular.module("teamspace.tdChannelsTab",["teamspace.localizationService","teamspace.channelActionDialogUtilityService","teamspace.routeUtilityService","teamspace.storageService","teamspace.locales","teamspace.timeagoCalcService"]).directive("tdChannelsTab",[function(){return{restrict:"E",scope:{},bindToController:{},template:a,controller:r,controllerAs:"tdct"}}])},2194:function(e,t){e.exports='<div class="td-channels-tab team-dashboard-tab flex-fill team-dashboard" ng-class="{\'archived\': tdct.team.isArchived}" data-tid="tdChannelsTab">\n  <div class="user-actions-container">\n    <div class="search-box">\n      <input sanitized type="text" autocapitalize="off" autocorrect="off" autocomplete="off" ng-model="tdct.searchString" ng-model-options="{ debounce: 150 }" placeholder="{{::tdct.searchPlaceholder}}" class="ts-search-input" ng-click="console.info(\'Analytics: Search Team Channels\')" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.teamChannelSearch}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.search}}" track-name="{{::$root.trackConstants.trackModuleName.searchBox}}" track-type="{{::$root.trackConstants.trackType.other}}"/>\n      <ng-include class="icon search-box-icon" ng-if="!tdct.searchString" src="\'svg/icons-search.html\'"></ng-include>\n      <button class="ts-btn search-box-icon app-icons-fill-hover app-icons-fill-focus" ng-if="tdct.searchString" ng-click="tdct.clearSearch()" aria-label="{{ ::$root.resources.strings.chat_clear_search_button|translate}}">\n        <ng-include class="icon" src="\'svg/icons-close.html\'"></ng-include>\n      </button>\n    </div>\n    <div class="left-action-btns">\n      <button type="button" class="ts-btn ts-btn-fluent ts-btn-fluent-with-icon ts-btn-fluent-primary" ng-click="tdct.createChannel()" ng-if="tdct.canCreateChannel" ng-disabled="tdct.team.isArchived" data-tid="td-new-channel" track-outcome="{{::tdct.enableEnhancedTelemetry ? $root.trackConstants.trackOutcome.nav : $root.trackConstants.trackOutcome.select}}" track-outcome-new="{{::$root.trackConstants.trackOutcome.nav}}" track-scenario="{{::$root.trackConstants.trackScenario.addChannel}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.openDialog}}" track-name="{{::tdct.enableEnhancedTelemetry ? $root.trackConstants.trackModuleName.addChannel : $root.trackConstants.trackModuleName.button}}" track-type="{{::tdct.enableEnhancedTelemetry ? $root.trackConstants.trackType.addChannelButton : $root.trackConstants.trackType.other}}" track-name-new="{{::$root.trackConstants.trackModuleName.addChannel}}" track-type-new="{{::$root.trackConstants.trackType.addChannelButton}}" track-work-load="{{::$root.trackConstants.trackWorkLoad.teamChannelManagement}}" track-sub-work-load="{{::$root.trackConstants.trackSubWorkLoad.addChannel}}" track-panel-type="{{::$root.trackConstants.panelType.memberSettings}}" track-panel-type-new="{{::$root.trackConstants.panelType.memberSettings}}" track-panel-region="{{::$root.trackConstants.PanelRegion.main}}" track-panel-region-new="{{::$root.trackConstants.PanelRegion.main}}">\n        <ng-include class="icon" src="\'svg/icons-channel-icon.html\'"></ng-include>\n        <span>{{::$root.resources.strings.td_channels_tab_add_channel|translate}}</span>\n      </button>\n    </div>\n  </div>\n\n  <div class="error-container" tabindex="-1" ng-if="tdct.searchString && tdct.filteredActiveChannelsList.length == 0 && tdct.filteredDeletedChannelsList.length == 0">\n    <img class="noresults-image" src="https://statics.teams.cdn.office.net/hashedassets/search_noresults-cb863fb.svg" aria-hidden="true"/>\n    <div class="error-message" aria-label="{{::$root.resources.strings.td_channels_tab_no_search_result|translate}}" translate-once="{{::$root.resources.strings.td_channels_tab_no_search_result}}"></div>\n  </div>\n  \x3c!--active channels section where header with channel count is shown only when restore deleted channel is enabled.--\x3e\n  <div ng-if="tdct.wait" class="busy-container">\n    <busy-animation size="medium" context="td-channels-tab"></busy-animation>\n  </div>\n  <div>\n    <button class="ts-sym expand-collapse-button" ng-if="tdct.showActiveChannelsHeader" tabindex="0" data-tid="td-channels-active-accordion" ng-click="tdct.toggleActiveChannelsSection()" track-scenario="{{::$root.trackConstants.trackScenario.channelListSelect}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.nav}}" track-name="{{::$root.trackConstants.trackModuleName.activeChannelsList}}" track-type="{{::$root.trackConstants.trackType.channelList}}" aria-expanded="{{!tdct.activeChannelsCollapsed}}" role="button">\n      <div class="expand-collapse-icon expand-collapse-icon-default icons-gray-06-triangle-fill">\n        <ng-include ng-if="tdct.activeChannelsCollapsed" src="\'svg/icons-triangle-right-small.html\'"></ng-include>\n        <ng-include ng-if="!tdct.activeChannelsCollapsed" src="\'svg/icons-triangle-down-small.html\'"></ng-include>\n      </div>\n      <span class="app-font-base-bold" title="{{::tdct.activeChannelsHeader}}" ng-bind="::tdct.activeChannelsHeader"></span>&nbsp;\n      <span class="section-header-count">({{tdct.filteredActiveChannelsCount}})</span>\n    </button>\n  </div>\n  <div ng-if="tdct.showActiveChannels" class="access-container flex-fill" acc-role-dom="{{tdct.showDeletedChannelsHeader && tdct.filteredDeletedChannelsCount ? \'table-keyboard\' : \'table-keyboard tab-handler-table-list\' }}">\n    <div class="td-channel-container-headers" ng-class="{\'archived\': tdct.team.isArchived}" ng-if="!tdct.wait" acc-role="table-header-row" role="rowheader">\n      <div class="td-header-pinned" tabindex="-1" ng-if="::!tdct.isNewTerminologyForFavoriteEnabled">\n      </div>\n      \x3c!--channel name header--\x3e\n      <div class="td-header-name" acc-role="table-header-column clickable" aria-label="{{::$root.resources.strings.td_channels_tab_header_name_aria|translate}}" role="columnheader">\n        <button class="btn btn-default header-button icons-gray-06-triangle-fill" ng-click="tdct.sortTable(\'displayName\')" tabindex="-1">\n          <div>\n            <div class="header-button-text" translate-once="{{::$root.resources.strings.td_channels_tab_header_name}}"></div>\n            <div ng-if="tdct.sortedColumn.name === \'displayName\' && tdct.sortedColumn.direction === 1" aria-label="{{::$root.resources.strings.td_channels_tab_header_ascending|translate}}"><ng-include class="icon" src="\'svg/icons-triangle-down-small.html\'"></ng-include></div>\n            <div ng-if="tdct.sortedColumn.name === \'displayName\' && tdct.sortedColumn.direction === 0" aria-label="{{::$root.resources.strings.td_channels_tab_header_descending|translate}}"><ng-include class="icon" src="\'svg/icons-triangle-up-small.html\'"></ng-include></div>\n          </div>\n        </button>\n      </div>\n      \x3c!--favorite header if new terminology for favorite is enabled--\x3e\n      <div class="td-header-enable-default td-channel-show-default" ng-if="::tdct.isNewTerminologyForFavoriteEnabled" acc-role="table-header-column clickable" aria-label="{{::$root.resources.strings.td_channels_tab_header_show_for_me|translate}}" role="columnheader">\n        <button class="btn btn-default header-button icons-gray-06-triangle-fill" ng-click="tdct.sortTable(\'isFavorite\')" tabindex="-1">\n          <div>\n            <div class="header-button-text" translate-once="{{::$root.resources.strings.td_channels_tab_header_show_for_me}}"></div>\n            <div ng-if="tdct.sortedColumn.name === \'isFavorite\' && tdct.sortedColumn.direction === 1" aria-label="{{::$root.resources.strings.td_channels_tab_header_ascending|translate}}"><ng-include class="icon" src="\'svg/icons-triangle-down-small.html\'"></ng-include></div>\n            <div ng-if="tdct.sortedColumn.name === \'isFavorite\' && tdct.sortedColumn.direction === 0" aria-label="{{::$root.resources.strings.td_channels_tab_header_descending|translate}}"><ng-include class="icon" src="\'svg/icons-triangle-up-small.html\'"></ng-include></div>\n         </div>\n        </button>\n      </div>\n      \x3c!--owner-favorite header if new terminology for favorite is enabled--\x3e\n      <div class="td-header-enable-default td-channel-show-default" acc-role="table-header-column clickable" ng-if="::tdct.enableDefaultFavChannel && tdct.isNewTerminologyForFavoriteEnabled" aria-label="{{::tdct.defaultFavHeader}}" role="columnheader" title="{{::tdct.defaultFavHeader}}">\n        <button class="btn btn-default header-button icons-gray-06-triangle-fill" ng-click="tdct.sortTable(\'isFavDefault\')" tabindex="-1">\n          <div>\n            <div class="header-button-text" translate-once="{{::$root.resources.strings.td_channels_tab_header_show_default}}"></div>\n            <div ng-if="tdct.sortedColumn.name === \'isFavDefault\' && tdct.sortedColumn.direction === 1" aria-label="{{::$root.resources.strings.td_channels_tab_header_ascending|translate}}"><ng-include class="icon" src="\'svg/icons-triangle-down-small.html\'"></ng-include></div>\n            <div ng-if="tdct.sortedColumn.name === \'isFavDefault\' && tdct.sortedColumn.direction === 0" aria-label="{{::$root.resources.strings.td_channels_tab_header_descending|translate}}"><ng-include class="icon" src="\'svg/icons-triangle-up-small.html\'"></ng-include></div>\n         </div>\n        </button>\n      </div>\n      \x3c!--channel description header--\x3e\n      <div class="td-header-description" acc-role="table-header-column clickable" aria-label="{{::$root.resources.strings.td_channels_tab_header_description_aria|translate}}" role="columnheader">\n        <button class="btn btn-default header-button icons-gray-06-triangle-fill" ng-click="tdct.sortTable(\'description\')" tabindex="-1">\n          <div>\n            <div class="header-button-text" translate-once="{{::$root.resources.strings.td_channels_tab_header_description}}"></div>\n            <div ng-if="tdct.sortedColumn.name === \'description\' && tdct.sortedColumn.direction === 1" aria-label="{{::$root.resources.strings.td_channels_tab_header_ascending|translate}}"><ng-include class="icon" src="\'svg/icons-triangle-down-small.html\'"></ng-include></div>\n            <div ng-if="tdct.sortedColumn.name === \'description\' && tdct.sortedColumn.direction === 0" aria-label="{{::$root.resources.strings.td_channels_tab_header_descending|translate}}"><ng-include class="icon" src="\'svg/icons-triangle-up-small.html\'"></ng-include></div>\n          </div>\n        </button>\n      </div>\n      \x3c!--owner fav header when new terminology for favorite is disabled--\x3e\n      <div class="td-header-enable-default" acc-role="table-header-column clickable" ng-if="::tdct.enableDefaultFavChannel && !tdct.isNewTerminologyForFavoriteEnabled" aria-label="{{::tdct.defaultFavHeader}}" role="columnheader" title="{{::tdct.defaultFavHeader}}">\n        <button class="btn btn-default header-button icons-gray-06-triangle-fill" ng-click="tdct.sortTable(\'isFavDefault\')" tabindex="-1">\n          <div>\n            <div ng-if="::!tdct.isNewTerminologyForFavoriteEnabled" class="header-button-text" translate-once="{{::$root.resources.strings.td_channels_tab_header_fav_default}}"></div>\n            <div ng-if="tdct.sortedColumn.name === \'isFavDefault\' && tdct.sortedColumn.direction === 1" aria-label="{{::$root.resources.strings.td_channels_tab_header_ascending|translate}}"><ng-include class="icon" src="\'svg/icons-triangle-down-small.html\'"></ng-include></div>\n            <div ng-if="tdct.sortedColumn.name === \'isFavDefault\' && tdct.sortedColumn.direction === 0" aria-label="{{::$root.resources.strings.td_channels_tab_header_descending|translate}}"><ng-include class="icon" src="\'svg/icons-triangle-up-small.html\'"></ng-include></div>\n         </div>\n        </button>\n      </div>\n      <div ng-if="::tdct.isPrivateChannelsInTeamDashboardEnabled" class="td-header-channel-type" acc-role="table-header-column clickable" aria-label="{{::$root.resources.strings.td_channels_tab_header_type_aria|translate}}" role="columnheader">\n        <button class="btn btn-default header-button icons-gray-06-triangle-fill" ng-click="tdct.sortTable(\'channelType\')" tabindex="-1">\n          <div>\n            <div class="header-button-text" translate-once="{{::$root.resources.strings.td_manage_channels_dashboard_channel_visibility_header_title}}"></div>\n            <div ng-if="tdct.sortedColumn.name === \'channelType\' && tdct.sortedColumn.direction === 1" aria-label="{{::$root.resources.strings.td_channels_tab_header_ascending|translate}}"><ng-include class="icon" src="\'svg/icons-triangle-down-small.html\'"></ng-include></div>\n            <div ng-if="tdct.sortedColumn.name === \'channelType\' && tdct.sortedColumn.direction === 0" aria-label="{{::$root.resources.strings.td_channels_tab_header_descending|translate}}"><ng-include class="icon" src="\'svg/icons-triangle-up-small.html\'"></ng-include></div>\n          </div>\n        </button>\n      </div>\n      <div class="td-header-last-active" acc-role="table-header-column clickable" aria-label="{{::$root.resources.strings.td_channels_tab_header_active_aria|translate}}" role="columnheader">\n        <button class="btn btn-default header-button icons-gray-06-triangle-fill" ng-click="tdct.sortTable(\'lastActivity\')" tabindex="-1">\n          <div>\n            <div class="header-button-text" translate-once="{{::$root.resources.strings.td_channels_tab_header_active}}"></div>\n            <div ng-if="tdct.sortedColumn.name === \'lastActivity\' && tdct.sortedColumn.direction === 1" aria-label="{{::$root.resources.strings.td_channels_tab_header_ascending|translate}}"><ng-include class="icon" src="\'svg/icons-triangle-down-small.html\'"></ng-include></div>\n            <div ng-if="tdct.sortedColumn.name === \'lastActivity\' && tdct.sortedColumn.direction === 0" aria-label="{{::$root.resources.strings.td_channels_tab_header_descending|translate}}"><ng-include class="icon" src="\'svg/icons-triangle-up-small.html\'"></ng-include></div>\n          </div>\n        </button>\n      </div>\n      <div class="td-channel-actions" aria-role="presentation">\n        \x3c!-- placeholder for column alignment. --\x3e\n      </div>\n    </div>\n    <div class="td-channels-scroll-container" ng-class="{\'scroll-container-power-bar\': tdct.showDeletedChannelsHeader && !tdct.isMainNotificationBannerVisible,\n                    \'scroll-container-main-notif-bar\': !tdct.showDeletedChannelsHeader && tdct.isMainNotificationBannerVisible,\n                    \'scroll-container-power-main-notif-bar\': tdct.showDeletedChannelsHeader && tdct.isMainNotificationBannerVisible}" ng-if="!tdct.wait && tdct.filteredActiveChannelsCount" scenario-end="{{tdct.scenarioName}}" simple-scrollbar tabindex="-1">\n      <div>\n        <div class="no-td-channels" ng-if="tdct.errored" translate-once="{{::$root.resources.strings.td_channels_tab_error}}"></div>\n        \x3c!-- Uses Virtual Repeat control which limits the list of items to the visible area and\n            manages adding/removing items based on the scroll https://github.com/kamilkp/angular-vs-repeat --\x3e\n        \x3c!-- vs-repeat="48" Note: without Row Height(48px) vs-repeat is rendering the full-list and scoping it down --\x3e\n        <div class="td-channels-container" data-tid="tdChannelsTab-active-channelsList" vs-repeat="48" vs-excess="10" vs-scroll-parent=".td-channels-scroll-container" role="rowgroup" tabindex="-1">\n          <div class="td-channel" ng-repeat="channel in tdct.filteredActiveChannelsList" data-tid="tdChannelsTab-active-channel-{{::channel.displayName}}" acc-role="table-content-row" role="row" ng-focus="tdct.constructAndApplyAriaLabel($event, channel)">\n              <div class="td-channel-pinned" acc-role="table-content-cell clickable" role="gridcell" ng-if="::tdct.showFavoriteActionBtn(channel) && !tdct.isNewTerminologyForFavoriteEnabled" aria-label="{{::tdct.favoriteTooltipText}}">\n                <div>\n                  <button class="btn btn-default app-icons-fill-hover icons-star" ng-class="{\'unfavorite-icon\': channel.isFavorite}" ng-click="tdct.toggleFavoriteChannel(channel)" data-tid="toggle-{{::channel.displayName}}-favorite" title="{{::tdct.favoriteTooltipText}}" track-outcome="{{::$root.trackConstants.trackOutcome.submit}}" track-scenario="{{::$root.trackConstants.trackScenario.channelFavorite}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.admin}}" track-name="{{::$root.trackConstants.trackModuleName.starButton}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="{{channel.objectId}}" space-action role="checkbox" aria-checked="{{channel.isFavorite}}" tabindex="-1">\n                          <svg-include class="unfavorite" src="\'svg/icons-starred.html\'" data-tid="{{::channel.displayName}}-unfav"></svg-include>\n                          <svg-include class="favorite" src="\'svg/icons-star.html\'" data-tid="{{::channel.displayName}}-fav"></svg-include>\n                  </button>\n                </div>\n            </div>\n            \x3c!-- empty div is present for accessibility purpose --\x3e\n            <div class="td-channel-pinned" ng-if="::!tdct.showFavoriteActionBtn(channel) && !tdct.isNewTerminologyForFavoriteEnabled">\n            </div>\n            <div class="td-channel-name" acc-role="table-content-cell" aria-label="{{channel.displayName}}" role="gridcell">\n              \x3c!-- Do not modify the telemetry values below. They are used for auto renewal of teams. --\x3e\n              <a class="channel-name" ng-class="{\'unread\': channel.unread, \'link-disabled\': !channel.isResolved}" title="{{channel.displayName}}" ng-click="tdct.navigateToChannel(channel)" ng-bind="channel.displayName" track-outcome="{{::$root.trackConstants.trackOutcome.nav}}" track-scenario="{{::$root.trackConstants.trackScenario.teamChannelNav}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.nav}}" track-name="{{::$root.trackConstants.trackModuleName.listItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="{{channel.objectId}}" dir="auto">\n              </a>\n            </div>\n            \x3c!--fav check box when new terminology for favorite is enabled--\x3e\n            <div class="td-channel-pinned td-channel-show" acc-role="table-content-cell clickable" role="cell" ng-if="::tdct.showFavoriteActionBtn(channel) && tdct.isNewTerminologyForFavoriteEnabled">\n                <teams-checkbox disable-keyboard-nav="true" generate-track-constants-function="tdct.generateFavoriteTrackConstants(channel)" hide-text="true" narrator-text="{{::tdct.favoriteTooltipText}}" ng-model="channel.model.isFavorite" on-click="tdct.toggleFavoriteChannel(channel, true)" prefix-data-tid="fav-{{::channel.displayName}}" tabindex="-1" title="{{::tdct.favoriteTooltipText}}"></teams-checkbox>\n            </div>\n            \x3c!-- empty div is present for accessibility purpose --\x3e\n            <div class="td-channel-pinned td-channel-show" ng-if="::!tdct.showFavoriteActionBtn(channel) && tdct.isNewTerminologyForFavoriteEnabled">\n            </div>\n            \x3c!--owner fav check box when new terminology for favorite is enabled--\x3e\n            <div ng-if="::tdct.enableDefaultFavChannel && tdct.isNewTerminologyForFavoriteEnabled" class="td-channel-enable-default td-channel-show-default" role="cell" acc-role="table-content-cell clickable">\n                <teams-checkbox disable-keyboard-nav="true" generate-track-constants-function="tdct.generateFavDefaultTrackConstants(channel)" hide-text="true" is-disabled="tdct.team.isArchived || tdct.shouldDisableCheckboxIfFavChannelLimitReached(channel)" narrator-text="{{tdct.generateCheckboxTitle(channel)}}" ng-if="::!channel.isGeneral && channel.channelType === \'Regular\'" ng-model="channel.model.isFavDefault" ng-mouseenter="tdct.shouldDisableCheckboxIfFavChannelLimitReached(channel) && tdct.openFavDefaultExceededTooltip($event)" ng-mouseleave="tdct.closeFavDefaultExceededTooltip()" on-click="tdct.updateDefaultFavChannel(channel)" prefix-data-tid="favChannelIcon-{{::channel.displayName}}" tabindex="-1" title="{{tdct.shouldDisableCheckboxIfFavChannelLimitReached(channel) ? \'\' : tdct.generateCheckboxTitle(channel)}}"></teams-checkbox>\n            </div>\n            <div class="td-channel-description" acc-role="table-content-cell" aria-label="{{channel.description}}" role="cell">\n              <span ng-bind="channel.description" title="{{channel.description}}" data-tid="tdChannelsTab-channelDescription" dir="auto"></span>\n            </div>\n            \x3c!--owner fav check box when new terminology for favorite is disabled--\x3e\n            <div ng-if="::tdct.enableDefaultFavChannel && !tdct.isNewTerminologyForFavoriteEnabled" class="td-channel-enable-default" acc-role="table-content-cell clickable">\n                <teams-checkbox disable-keyboard-nav="true" generate-track-constants-function="tdct.generateFavDefaultTrackConstants(channel)" hide-text="true" is-disabled="tdct.team.isArchived || tdct.shouldDisableCheckboxIfFavChannelLimitReached(channel)" narrator-text="{{tdct.generateCheckboxTitle(channel)}}" ng-if="::!channel.isGeneral && channel.channelType === \'Regular\'" ng-model="channel.model.isFavDefault" ng-mouseenter="tdct.shouldDisableCheckboxIfFavChannelLimitReached(channel) && tdct.openFavDefaultExceededTooltip($event)" ng-mouseleave="tdct.closeFavDefaultExceededTooltip()" on-click="tdct.updateDefaultFavChannel(channel)" prefix-data-tid="favChannelIcon-{{::channel.displayName}}" tabindex="-1" title="{{tdct.shouldDisableCheckboxIfFavChannelLimitReached(channel) ? \'\' : tdct.generateCheckboxTitle(channel)}}"></teams-checkbox>\n            </div>\n            <div ng-if="::tdct.isPrivateChannelsInTeamDashboardEnabled" class="td-channel-channel-type" acc-role="table-content-cell" role="cell">\n              \x3c!-- TODO marcomu: remove references of isBackedBySubstrateGroup --\x3e\n              <div ng-if="::!channel.isBackedBySubstrateGroup && channel.channelType === \'Regular\'" title="{{::$root.resources.strings.td_manage_channels_dashboard_channel_visibility_standard|translate}}" aria-label="{{::$root.resources.strings.td_manage_channels_dashboard_channel_visibility_standard_aria|translate}}">\n                <ng-include src="\'svg/icons-website.html\'"></ng-include>\n                <label class="sr-only" translate-once="{{::$root.resources.strings.td_manage_channels_dashboard_channel_visibility_standard_aria}}"></label>\n              </div>\n              <div ng-if="::!channel.isBackedBySubstrateGroup && channel.channelType === \'Private\'" title="{{::$root.resources.strings.td_manage_channels_dashboard_channel_visibility_private|translate}}" aria-label="{{::$root.resources.strings.td_manage_channels_dashboard_channel_visibility_private_aria|translate}}">\n                <ng-include src="\'svg/icons-private.html\'"></ng-include>\n                <label class="sr-only" translate-once="{{::$root.resources.strings.td_manage_channels_dashboard_channel_visibility_private_aria}}"></label>\n              </div>\n              <div ng-if="::channel.isBackedBySubstrateGroup || channel.channelType === \'Shared\'" title="{{::$root.resources.strings.td_manage_channels_dashboard_channel_visibility_k2|translate}}" aria-label="{{::$root.resources.strings.td_manage_channels_dashboard_channel_visibility_k2_aria|translate}}">\n                <ng-include src="\'svg/icons-people-circle.html\'"></ng-include>\n                <label class="sr-only" translate-once="{{::$root.resources.strings.td_manage_channels_dashboard_channel_visibility_k2_aria}}"></label>\n              </div>\n            </div>\n            <div class="td-channel-last-active" acc-role="table-content-cell" role="cell">\n              <span ng-if="::channel.lastActivity" time-ago="channel.lastActivity"></span>\n            </div>\n            <div class="td-channel-actions dropdown" acc-role="table-content-cell clickable" id="tdct-channel-{{::channel.objectId}}" aria-label="{{::$root.resources.strings.td_channels_tab_more_options|translate}}" role="gridcell">\n              <button class="ts-btn app-icons-fill-hover channel-actions-btn icons-more" type="button" ng-click="tdct.openChannelContextMenu($event, this, channel)" track-default="moreOptions" data-tid="channel-actions-btn" title="{{::$root.resources.strings.td_channels_tab_more_options|translate}}" track-outcome="{{::tdct.enableEnhancedTelemetry ? $root.trackConstants.trackOutcome.nav : $root.trackConstants.trackOutcome.select}}" track-outcome-new="{{::$root.trackConstants.trackOutcome.nav}}" track-scenario="{{::$root.trackConstants.trackScenario.addChannel}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.openDialog}}" track-name="{{::tdct.enableEnhancedTelemetry ? $root.trackConstants.trackModuleName.channelOverflowMenu : $root.trackConstants.trackModuleName.button}}" track-type="{{::tdct.enableEnhancedTelemetry ? $root.trackConstants.trackType.channelOverflowMenu : $root.trackConstants.trackType.other}}" track-name-new="{{::$root.trackConstants.trackModuleName.channelOverflowMenu}}" track-type-new="{{::$root.trackConstants.trackType.channelOverflowMenu}}" track-work-load="{{::$root.trackConstants.trackWorkLoad.teamChannelManagement}}" track-sub-work-load="{{::$root.trackConstants.trackSubWorkLoad.channelManagement}}" track-panel-type="{{::$root.trackConstants.panelType.teamChannels}}" track-panel-type-new="{{::$root.trackConstants.panelType.teamChannels}}" track-panel-region="{{::$root.trackConstants.PanelRegion.main}}" track-panel-region-new="{{::$root.trackConstants.PanelRegion.main}}" tabindex="-1">\n                <ng-include class="icon icons-dropdown" src="\'svg/icons-more.html\'"></ng-include>\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n</div>\n  \x3c!--end of active channels section--\x3e\n\n  \x3c!--deleted channels section--\x3e\n  <div>\n    <button ng-if="tdct.showDeletedChannelsHeader" data-tid="td-channels-delete-accordion" class="ts-sym expand-collapse-button" ng-disabled="!tdct.filteredDeletedChannelsCount" ng-class="{\'last-section-header-collapsed\': tdct.deletedChannelsCollapsed,\n                   \'disable-header\': !tdct.filteredDeletedChannelsCount}" tabindex="0" ng-click="tdct.toggleDeletedChannelsSection()" track-scenario="{{::$root.trackConstants.trackScenario.channelListSelect}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.nav}}" track-name="{{::$root.trackConstants.trackModuleName.deletedChannelsList}}" track-type="{{::$root.trackConstants.trackType.channelList}}" aria-expanded="{{!tdct.deletedChannelsCollapsed}}" role="button">\n      <div class="expand-collapse-icon expand-collapse-icon-default icons-gray-06-triangle-fill">\n        <ng-include ng-if="tdct.deletedChannelsCollapsed" src="\'svg/icons-triangle-right-small.html\'"></ng-include>\n        <ng-include ng-if="!tdct.deletedChannelsCollapsed" src="\'svg/icons-triangle-down-small.html\'"></ng-include>\n      </div>\n      <span class="app-font-base-bold" title="{{::tdct.deletedChannelsHeader}}" ng-bind="::tdct.deletedChannelsHeader"></span>&nbsp;\n      <span class="section-header-count">({{tdct.filteredDeletedChannelsCount}})</span>\n    </button>\n  </div>\n\n  <div ng-if="tdct.showDeletedChannels && tdct.wait" class="busy-container">\n    <busy-animation size="medium" context="td-channels-tab"></busy-animation>\n  </div>\n\n  <div ng-if="tdct.showDeletedChannels" class="access-container flex-fill del-channel-container" acc-role-dom="table-keyboard tab-handler-table-list">\n    <div class="td-channel-container-headers del-container-headers" ng-if="!tdct.wait" acc-role="table-header-row" role="rowheader">\n      <div class="td-del-header-name" acc-role="table-header-column clickable" aria-label="{{::$root.resources.strings.td_channels_tab_header_name_aria|translate}}" role="columnheader">\n        <button class="btn btn-default header-button icons-gray-06-triangle-fill" ng-click="tdct.sortTable(\'displayName\', true)" tabindex="-1">\n          <div>\n            <div class="header-button-text" translate-once="{{::$root.resources.strings.td_channels_tab_header_name}}"></div>\n            <div ng-if="tdct.sortedColumn.name === \'displayName\' && tdct.sortedColumn.direction === 1" aria-label="{{::$root.resources.strings.td_channels_tab_header_ascending|translate}}"><ng-include class="icon" src="\'svg/icons-triangle-down-small.html\'"></ng-include></div>\n            <div ng-if="tdct.sortedColumn.name === \'displayName\' && tdct.sortedColumn.direction === 0" aria-label="{{::$root.resources.strings.td_channels_tab_header_descending|translate}}"><ng-include class="icon" src="\'svg/icons-triangle-up-small.html\'"></ng-include></div>\n          </div>\n        </button>\n      </div>\n      <div ng-if="::tdct.isPrivateChannelsInTeamDashboardEnabled" class="td-header-channel-type" acc-role="table-header-column clickable" aria-label="{{::$root.resources.strings.td_channels_tab_header_type_aria|translate}}" role="columnheader">\n        <button class="btn btn-default header-button icons-gray-06-triangle-fill" ng-click="tdct.sortTable(\'channelType\', true)" tabindex="-1">\n          <div>\n            <div class="header-button-text" translate-once="{{::$root.resources.strings.td_manage_channels_dashboard_channel_visibility_header_title}}"></div>\n            <div ng-if="tdct.sortedColumn.name === \'channelType\' && tdct.sortedColumn.direction === 1" aria-label="{{::$root.resources.strings.td_channels_tab_header_ascending|translate}}"><ng-include class="icon" src="\'svg/icons-triangle-down-small.html\'"></ng-include></div>\n            <div ng-if="tdct.sortedColumn.name === \'channelType\' && tdct.sortedColumn.direction === 0" aria-label="{{::$root.resources.strings.td_channels_tab_header_descending|translate}}"><ng-include class="icon" src="\'svg/icons-triangle-up-small.html\'"></ng-include></div>\n          </div>\n        </button>\n      </div>\n      <div class="td-del-header-time" acc-role="table-header-column clickable" aria-label="{{::$root.resources.strings.td_channels_tab_header_name_aria|translate}}" role="columnheader">\n        <button class="btn btn-default header-button icons-gray-06-triangle-fill" ng-click="tdct.sortTable(\'deleteTime\', true)" tabindex="-1">\n          <div>\n            <div class="header-button-text" translate-once="{{::$root.resources.strings.td_channels_tab_header_deleted_date}}"></div>\n            <div ng-if="tdct.sortedColumn.name === \'deleteTime\' && tdct.sortedColumn.direction === 1" aria-label="{{::$root.resources.strings.td_channels_tab_header_ascending|translate}}"><ng-include class="icon" src="\'svg/icons-triangle-down-small.html\'"></ng-include></div>\n            <div ng-if="tdct.sortedColumn.name === \'deleteTime\' && tdct.sortedColumn.direction === 0" aria-label="{{::$root.resources.strings.td_channels_tab_header_descending|translate}}"><ng-include class="icon" src="\'svg/icons-triangle-up-small.html\'"></ng-include></div>\n          </div>\n        </button>\n      </div>\n      <div class="td-del-channel-actions" aria-role="presentation">\n        \x3c!-- placeholder for column alignment. --\x3e\n      </div>\n    </div>\n    <div class="td-del-channels-scroll-container" ng-class="{\'scroll-container-power-bar\': !tdct.isMainNotificationBannerVisible, \'scroll-container-power-main-notif-bar\': tdct.isMainNotificationBannerVisible}" ng-if="!tdct.wait && tdct.filteredDeletedChannelsList.length" scenario-end="{{tdct.scenarioName}}" simple-scrollbar>\n      <div class="no-td-channels" ng-if="tdct.errored" translate-once="{{::$root.resources.strings.td_channels_tab_error}}"></div>\n      \x3c!-- Uses Virtual Repeat control which limits the list of items to the visible area and\n          manages adding/removing items based on the scroll https://github.com/kamilkp/angular-vs-repeat--\x3e\n      \x3c!-- vs-repeat="48" Note: without Row Height(48px) vs-repeat is rendering the full-list and scoping it down --\x3e\n      <div class="td-channels-container" data-tid="tdChannelsTab-deleted-channelsList" vs-repeat="48" vs-excess="10" vs-scroll-parent=".td-del-channels-scroll-container" role="rowgroup">\n        <div class="td-channel td-channel-del-row" ng-repeat="channel in tdct.filteredDeletedChannelsList" data-tid="tdChannelsTab-del-channel-{{::channel.displayName}}" acc-role="table-content-row" role="row" aria-label="{{ $root.resources.strings.td_channels_tab_delete_channel_aria|translate:{channelName:channel.displayName, description:channel.description, deleteDate:channel.deleteTime} }}">\n          <div class="td-del-channel-name" acc-role="table-content-cell" aria-label="{{channel.displayName}}" role="gridcell">\n            \x3c!-- NOTE: Do not modify the telemetry values below. They are used for auto renewal of teams. --\x3e\n            <span class="channel-name" title="{{channel.displayName}}" ng-bind="channel.displayName" track-outcome="{{::$root.trackConstants.trackOutcome.nav}}" track-scenario="{{::$root.trackConstants.trackScenario.teamChannelNav}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.nav}}" track-name="{{::$root.trackConstants.trackModuleName.listItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="{{channel.objectId}}" dir="auto">\n            </span>\n          </div>\n          <div ng-if="::tdct.isPrivateChannelsInTeamDashboardEnabled" class="td-del-channel-channel-type" acc-role="table-content-cell" role="cell">\n            \x3c!-- TODO marcomu: remove references of isBackedBySubstrateGroup --\x3e\n            <div ng-if="::!channel.isBackedBySubstrateGroup && channel.channelType === \'Regular\'" title="{{::$root.resources.strings.td_manage_channels_dashboard_channel_visibility_standard|translate}}" aria-label="{{::$root.resources.strings.td_manage_channels_dashboard_channel_visibility_standard_aria|translate}}">\n              <ng-include src="\'svg/icons-website.html\'"></ng-include>\n              <label class="sr-only" translate-once="{{::$root.resources.strings.td_manage_channels_dashboard_channel_visibility_standard_aria}}"></label>\n            </div>            \n            <div ng-if="::!channel.isBackedBySubstrateGroup && channel.channelType === \'Private\'" title="{{::$root.resources.strings.td_manage_channels_dashboard_channel_visibility_private|translate}}" aria-label="{{::$root.resources.strings.td_manage_channels_dashboard_channel_visibility_private_aria|translate}}">\n              <ng-include src="\'svg/icons-private.html\'"></ng-include>\n              <label class="sr-only" translate-once="{{::$root.resources.strings.td_manage_channels_dashboard_channel_visibility_private_aria}}"></label>\n            </div>\n            <div ng-if="::channel.isBackedBySubstrateGroup || channel.channelType === \'Shared\'" title="{{::$root.resources.strings.td_manage_channels_dashboard_channel_visibility_k2|translate}}" aria-label="{{::$root.resources.strings.td_manage_channels_dashboard_channel_visibility_k2_aria|translate}}">\n              <ng-include src="\'svg/icons-people-circle.html\'"></ng-include>\n              <label class="sr-only" translate-once="{{::$root.resources.strings.td_manage_channels_dashboard_channel_visibility_k2_aria}}"></label>\n            </div>\n          </div>\n          <div class="td-del-time">\n            <span ng-bind="channel.deleteTime"></span>\n          </div>\n          <div class="td-del-channel-actions dropdown" ng-if="tdct.showRestoreOption && !!channel.canRestore" acc-role="table-content-cell clickable" aria-label="{{::$root.resources.strings.team_dashboard_deleted_channel_restore_btn|translate}}" role="gridcell">\n            <button class="ts-btn app-icons-fill-hover del-channel-actions-btn" type="button" ng-click="tdct.restoreChannel(channel)" data-tid="del-channel-actions-btn-{{::channel.displayName}}" title="{{::$root.resources.strings.team_dashboard_deleted_channel_restore_btn|translate}}" tabindex="-1" track-scenario="{{::$root.trackConstants.trackScenario.restoreChannel}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.openDialog}}" track-name="{{::$root.trackConstants.trackModuleName.restoreChannel}}" track-type="{{::$root.trackConstants.trackType.teamActionMenu}}" track-summary="Restore Deleted Channel">\n                    <ng-include class="icon" src="\'svg/icons-refresh.html\'"></ng-include>\n                    <span translate-once="{{::$root.resources.strings.team_dashboard_deleted_channel_restore_btn}}"></span>\n            </button>\n          </div>\n          \x3c!-- make up for restore space for private channel --\x3e\n          <div class="td-del-channel-actions" ng-if="!tdct.showRestoreOption || !channel.canRestore" aria-hidden="true" role="gridcell">\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n  \x3c!--end of deleted channels section--\x3e\n</div>\n'}},[2192]);