(window.webPackBridgeJsonp=window.webPackBridgeJsonp||[]).push([[27],{"115d528efe62c6643bec":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i("0b8514f932f40951d460"),n=i("cc08c169973ba8efeefa"),s={ownerCannotShareWithSelf:!0,maximumRecipientsExceeded:!0,invalidAclEmailSpecified:!0,duplicateMembersInRequest:!0,secureSharingInvalidRequest:!0},o=function(){function e(e,t){this._dataRequestor=t.dataRequestor}return e.prototype.createBundle=function(e,t){var i=JSON.stringify({children:e.map(function(e){return{id:e}}),bundle:{},name:t});return i=i.slice(0,-1)+',"@microsoft.graph.conflictBehavior": "rename"}',this._dataRequestor.send({path:"/drive/bundles",apiName:"bundles",requestType:"POST",useAuthorizationHeaders:!0,postData:i,getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(e){return e})},e.prototype.getFamily=function(){return this._dataRequestor.send({path:"/household/me/family",apiName:"family",requestType:"GET",useAuthorizationHeaders:!0,getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(e){return e})},e.prototype.getFamilyMembers=function(){return this._dataRequestor.send({path:"/household/me/family/members",apiName:"familyMembers",requestType:"GET",useAuthorizationHeaders:!0,getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(e){return e})},e.prototype.isUserPremium=function(){return this._dataRequestor.send({path:"/me/drive",apiName:"drive",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(e){return!!e.quota.storagePlanInformation&&!e.quota.storagePlanInformation.upgradeAvailable})},e.prototype.createLink=function(e){var t=this,i=e.itemIds,r=e.type,n=e.scope,s=e.preventDownload,o=e.password,a=e.expiration,d=e.bundleName;return 1===i.length?this.createLinkSingleItem({itemUrl:this.getDrivesPathFromItemId(i[0]),type:r,scope:n,preventDownload:s,password:o,expiration:a}):this.createBundle(i,d).then(function(e){return t.createLinkSingleItem({itemUrl:t.getDrivesPathFromItemId(e.id),type:r,scope:n,preventDownload:s,password:o,expiration:a})})},e.prototype.createLinkFromItemUrl=function(e){var t=e.itemUrl,i=e.type,r=e.scope,n=e.preventDownload,s=e.password,o=e.expiration;return this.createLinkSingleItem({itemUrl:this.getSharesPathFromItemUrl(t),type:i,scope:r,preventDownload:n,password:s,expiration:o})},e.prototype.getCurrentUserId=function(){return this._dataRequestor.send({path:"/me",apiName:"me",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(e){return e.id})},e.prototype.getItemInfo=function(e){var t=""+this.getDrivesPathFromItemId(e);return this._dataRequestor.send({path:t,apiName:"item",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(e){return e})},e.prototype.getItemInfoFromItemUrl=function(e){var t=""+this.getSharesPathFromItemUrl(e);return this._dataRequestor.send({path:t,apiName:"item",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(e){return e})},e.prototype.getPermissions=function(e){var t=this.getDrivesPathFromItemId(e)+"/permissions";return this._dataRequestor.send({path:t,apiName:"permissions",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(e){return e.value})},e.prototype.getPermissionsFromItemUrl=function(e){var t=this.getSharesPathFromItemUrl(e)+"/permissions";return this._dataRequestor.send({path:t,apiName:"permissions",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(e){return e.value})},e.prototype.invite=function(e){var t=this,i=e.itemIds,r=e.recipients,n=e.message,s=e.requireSignIn,o=e.sendInvitation,a=e.roles,d=e.password,u=e.expiration,l=e.bundleName;return 1===i.length?this.inviteSingleItem(this.getDrivesPathFromItemId(i[0]),r,n,s,o,a,d,u):this.createBundle(i,l).then(function(e){return t.inviteSingleItem(t.getDrivesPathFromItemId(e.id),r,n,s,o,a,d,u)})},e.prototype.inviteFromItemUrl=function(e){var t=e.itemUrl,i=e.recipients,r=e.message,n=e.requireSignIn,s=e.sendInvitation,o=e.roles,a=e.password,d=e.expiration;return this.inviteSingleItem(this.getSharesPathFromItemUrl(t),i,r,n,s,o,a,d)},e.prototype.getDefaultLink=function(e,t,i){var s={prefer:"getDefaultLink"};return n.Killswitch.isActivated("c95677d4-d350-4951-a5a2-9d9f3b856dfc","06/22/2020","Also add ReturnSpecificErrorCode to Prefer header list")||(s.prefer+=",ReturnSpecificErrorCode"),t.length>0?this.inviteSingleItem(this.getSharesPathFromItemUrl(e),t,"",!0,!1,[],"",void 0,s,i):this.createLinkSingleItem({itemUrl:this.getSharesPathFromItemUrl(e),useMultiPart:i}).then(function(e){return r.default.wrap([e])})},e.prototype.getDefaultLinkByUniqueId=function(e,t,i){var s={prefer:"getDefaultLink"};return n.Killswitch.isActivated("c95677d4-d350-4951-a5a2-9d9f3b856dfc","06/22/2020","Also add ReturnSpecificErrorCode to Prefer header list")||(s.prefer+=",ReturnSpecificErrorCode"),t.length>0?this.inviteSingleItem(this.getPathFromUniqueId(e),t,"",!0,!1,[],"",void 0,s,i):this.createLinkSingleItem({itemUrl:this.getPathFromUniqueId(e),useMultiPart:i}).then(function(e){return r.default.wrap([e])})},e.prototype.updatePermissions=function(e,t,i){var r=this.getDrivesPathFromItemId(e)+"/permissions/"+t,n={roles:[i]};return this._dataRequestor.send({path:r,apiName:"updatePermission",requestType:"PATCH",useAuthorizationHeaders:!0,postData:JSON.stringify(n),getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(e){return e.value})},e.prototype.updatePermissionsFromItemUrl=function(e,t,i){var r=this.getSharesPathFromItemUrl(e)+"/permissions/"+t,n={roles:[i]};return this._dataRequestor.send({path:r,apiName:"updatePermission",requestType:"PATCH",useAuthorizationHeaders:!0,postData:JSON.stringify(n),getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(e){return e.value})},e.prototype.unshareLink=function(e,t){var i=this.getDrivesPathFromItemId(e)+"/permissions/"+t;return this._dataRequestor.send({path:i,apiName:"removePermission",requestType:"DELETE",useAuthorizationHeaders:!0,getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(){return!0})},e.prototype.unshareLinkFromItemUrl=function(e,t){var i=this.getSharesPathFromItemUrl(e)+"/permissions/"+t;return this._dataRequestor.send({path:i,apiName:"removePermission",requestType:"DELETE",useAuthorizationHeaders:!0,getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(){return!0})},e.prototype.createLinkSingleItem=function(e){var t=e.type,i=e.itemUrl,r=e.scope,n=e.preventDownload,o=e.password,a=e.useMultiPart,d=e.expiration,u=i+"/createLink",l=t&&r?{type:t,scope:r,preventDownload:n}:void 0;return(o||""===o)&&(l.password=o),d&&(l.expirationDateTime=d),this._dataRequestor.send({path:u,apiName:"createLink",requestType:"POST",useMultiPart:a,useAuthorizationHeaders:!0,postData:JSON.stringify(l||{}),getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(e){return e})},e.prototype.getSharesPathFromItemUrl=function(e){return"/shares/u!"+btoa(unescape(encodeURIComponent(e))).replace(/=+$/,"").replace("/","_").replace("+","-")+"/driveItem"},e.prototype.getPathFromUniqueId=function(e){return"/sites/root/items/"+e+"/driveItem"},e.prototype.getDrivesPathFromItemId=function(e){var t=e.split("!");return t.length>1?"/drives/"+t[0]+"/items/"+e:"/drive/items/"+e},e.prototype.inviteSingleItem=function(e,t,i,r,n,o,a,d,u,l){var c=e+"/invite",p={recipients:t,message:i,requireSignIn:r,sendInvitation:n,roles:o};return a&&(p.password=a),d&&(p.expirationDateTime=d),this._dataRequestor.send({path:c,apiName:"invite",requestType:"POST",useAuthorizationHeaders:!0,postData:JSON.stringify(p),useMultiPart:l,headers:u,getErrorAsMessage:!0,expectedErrorCodes:s}).then(function(e){return e.value})},e}();t.default=o},"13e40aa9f992db5e9396":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i("64328bb588b46459132d"),n=i("f89d5af06abf23eb5d7d"),s=i("84b3634427834dceb831"),o=i("d3c3815ad5c194f24c4e"),a=i("79820e3cd1611ca69f1c"),d=function(e){function t(t){return e.call(this,t)||this}return r.__extends(t,e),t}(s.fromUserAuthToken()(o.forSharedControls()(a.withAriaLoader()(n.AriaTelemetryHandler))));t.SharedAriaTelemetryHandler=d},"1599ff704a3f1e0ee534":function(e,t,i){"use strict";var r,n,s,o,a,d;i.r(t),function(e){e[e.NONE=0]="NONE",e[e.VIEW=1]="VIEW",e[e.EDIT=2]="EDIT"}(r||(r={})),function(e){e[e.uninitialized=0]="uninitialized",e[e.direct=1]="direct",e[e.organizationView=2]="organizationView",e[e.organizationEdit=3]="organizationEdit",e[e.anonymousView=4]="anonymousView",e[e.anonymousEdit=5]="anonymousEdit",e[e.flexible=6]="flexible"}(n||(n={})),function(e){e[e.Network=1]="Network",e[e.Embed=3]="Embed",e[e.App=4]="App",e[e.View=5]="View",e[e.Edit=6]="Edit",e[e.Form=7]="Form",e[e.Direct=8]="Direct",e[e.Organization=9]="Organization",e[e.AppAccess=10]="AppAccess"}(s||(s={})),function(e){e[e.Email=0]="Email",e[e.User=1]="User",e[e.Group=2]="Group",e[e.Link=3]="Link",e[e.Public=4]="Public",e[e.Friends=5]="Friends",e[e.Facebook=6]="Facebook",e[e.Application=7]="Application",e[e.GroupOwned=99]="GroupOwned"}(o||(o={})),function(e){e[e.Owner=0]="Owner",e[e.View=1]="View",e[e.Edit=2]="Edit",e[e.Submitter=3]="Submitter",e[e.CoOwner=4]="CoOwner",e[e.None=5]="None",e[e.Review=6]="Review",e[e.Custom=7]="Custom"}(a||(a={})),function(e){e[e.none=1]="none",e[e.pending=2]="pending",e[e.hasAccess=3]="hasAccess"}(d||(d={}));var u,l,c=i("2d57ae24be4947e6007b");!function(e){e[e.authFailure=1]="authFailure",e[e.serverFailure=2]="serverFailure",e[e.invalidItem=3]="invalidItem",e[e.invalidWebAbsoluteUrl=4]="invalidWebAbsoluteUrl",e[e.generic=5]="generic",e[e.objectNotSupported=6]="objectNotSupported",e[e.invalidEmail=7]="invalidEmail",e[e.linkNoLongerAvailable=8]="linkNoLongerAvailable"}(u||(u={})),function(e){e[e.getSharingInformation=1]="getSharingInformation",e[e.shareLink=2]="shareLink",e[e.shareObject=3]="shareObject",e[e.permissions=4]="permissions",e[e.item=5]="item",e[e.me=6]="me",e[e.drive=7]="drive",e[e.invite=8]="invite"}(l||(l={}));var p,h=u,m=i("480174dbefe5385f4aac");!function(e){e[e.view=1]="view",e[e.edit=2]="edit"}(p||(p={}));var f,g,_,v=p,I=i("7cb20ef8ef4d81489def");!function(e){e[e.anyone=0]="anyone",e[e.organization=1]="organization",e[e.specificPeople=2]="specificPeople"}(f||(f={})),function(e){e[e.none=0]="none",e[e.view=1]="view",e[e.edit=2]="edit",e[e.owner=3]="owner",e[e.review=6]="review",e[e.restrictedview=7]="restrictedview",e[e.submit=8]="submit"}(g||(g={})),function(e){e[e.uninitialized=0]="uninitialized",e[e.AddressBarLink=1]="AddressBarLink"}(_||(_={})),i.d(t,"UpdatePermissionsRole",function(){return r}),i.d(t,"SharingLinkKind",function(){return n}),i.d(t,"SharingLinkType",function(){return s}),i.d(t,"SharingInfoType",function(){return o}),i.d(t,"SharingRole",function(){return a}),i.d(t,"AccessStatus",function(){return d}),i.d(t,"ClientId",function(){return c.a}),i.d(t,"Error",function(){return h}),i.d(t,"Category",function(){return l}),i.d(t,"Mode",function(){return m.a}),i.d(t,"SharePermission",function(){return v}),i.d(t,"SharingAudience",function(){return I.a}),i.d(t,"SharingAudienceTemplates",function(){return f}),i.d(t,"SharingRoleV3",function(){return g}),i.d(t,"SharingLinkExpressOptions",function(){return _})},"16e0e7de7c7a198c78cc":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.aria=i("5f18827c166f02fc8d18")},"1e9e213928ed89bcb429":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i("64328bb588b46459132d"),n=i("115d528efe62c6643bec"),s=i("60e0518b24b76347603c"),o=i("0b8514f932f40951d460"),a=i("c1a09d7dd35e11297e15"),d=i("1599ff704a3f1e0ee534"),u=i("e64bb55c7377947459c9"),l=i("bf1fd7836373b186b583"),c=i("9a07fb223dfaa81a8d0c"),p=i("16f7a8beee83cf78aabb"),h=i("8605abf9448f5c554409"),m=i("c1d76209a7f2fe28e159"),f=i("a24d70c7702f13f024d9"),g=i("6f8ae5b6dc470397fb69"),_=function(){function e(e){if(this._iframe=document.createElement("iframe"),this._signal=new a.default,this._context=e.context,this._iframeWidth=0,this._iframeHeight=0,this._timeoutId=-1,this._isShareReady=!1,this._iframeUrl="",this._iframeBaseUrl="",this._messagesReceived={},this._props=e,this._receiveMessageBound=this._receiveMessage.bind(this),this._elementWindow=this._props.elementWindow||window,this._manager=p.createManager(),this._sessionQos=new(g.Qos.withManager(this._manager))({name:"SharingSession."+d.Mode[e.context.mode||d.Mode.share]}),!this._context.authToken)throw new Error("An access token is required for SharePrefetch optimization");switch(new c.WebSharedAriaTelemetryHandler({clientName:this._context.clientId,userAuthToken:this._context.authToken}).attach(this._manager),e.environment){case"pathfinder":this._iframeBaseUrl="https://od.apps.mil";break;case"trailblazer":this._iframeBaseUrl="https://admin.onedrive.us";break;case"test":this._iframeBaseUrl="https://www.onedrive-tst.com",this._iframeUrl=e.testEnvironmentUrl||"";break;default:this._iframeBaseUrl="https://www.odwebp.svc.ms"}this._iframeUrl||(this._iframeUrl=this._iframeBaseUrl+"/share?smkt="+e.locale),this._iframeStartTime=new Date,this._initializeIframe(),e.element.appendChild(this._iframe)}return e.prototype.initializeUI=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,i,n,s,a,u=this;return r.__generator(this,function(l){return e=this._context&&this._context.correlationId,t=this._context.mode===d.Mode.copy&&"teams"===this._context.clientId&&!this._context.shareId,i=t?this._getDefaultLink():Promise.resolve(void 0),n=this._getSharingInformation(),this._isShareReady=!1,Promise.all([this._toTuple(i),this._toTuple(this._getSharingInformation()),this._toTuple(this._signal.getPromise())]).then(function(t){var i=t[0],n=t[1];t[2];try{var s=!1,a=u._props.options.onError;if(u._isError(i)&&(s=!0,a&&a({name:"SharePrefetchError",message:"",error:i.error,resultCode:o.default.isCanceled(i.error)?"Canceled":f.getResultCodeFromError(i.error)})),u._isError(n)){s=!0;var d=n.error,l={code:d.code,status:d.status};a&&a({name:"SharePrefetchError",message:"",error:d,resultCode:o.default.isCanceled(n.error)?"Canceled":"["+l.status.toString()+"] "+(l.code||"Unknown")})}var c=u._props.options.spRestTokenProvider,p=r.__assign({},u._context,{rawInvite:i.value,sharingInformation:n.value,hasTokenProvider:!!c&&!!c.getAuthToken}),h=u._iframe.contentWindow;h?h.postMessage(p,u._iframeUrl):s||u._sessionQos.end({resultType:g.ResultTypeEnum.ExpectedFailure,resultCode:"abandoned",extraData:{error:"contentWindow not defined to postMessage context",iframeInBody:u._elementWindow.document.body.contains(u._iframe),messagesReceived:Object.keys(u._messagesReceived).join(","),mode:u._context.mode,correlationId:e}})}catch(t){u._sessionQos.end({resultType:g.ResultTypeEnum.Failure,extraData:{unhandledError:t.toString(),correlationId:e}})}}),this._props.disableIframeDomainCheck||(s=!this._props.iframeCheckTimeout||this._props.iframeCheckTimeout<=0?8e3:this._props.iframeCheckTimeout,setTimeout(function(){if(!u._scriptsLoadedTime){var t=new Image;t.onerror=function(){var t="ShareDomainNotReachable"+(window.navigator&&window.navigator.onLine?"Online":"Offline"),i=u._props.options&&u._props.options.onError;i&&i({name:"SharePrefetchError",message:t,error:new Error(t),debugErrorMessage:"Unable to reach "+u._iframeBaseUrl+" domain. Refer to https://docs.microsoft.com/en-us/office365/enterprise/urls-and-ip-address-ranges",resultCode:t}),u._sessionQos.end({resultType:g.ResultTypeEnum.ExpectedFailure,resultCode:t,extraData:{mode:u._context.mode,iframeBaseUrl:u._iframeBaseUrl,correlationId:e}}),clearTimeout(u._timeoutId)},t.src=u._iframeBaseUrl+"/favicon.ico?"+Math.random()}},s)),a=this._props.timeout||45e3,this._timeoutId=setTimeout(function(){return r.__awaiter(u,void 0,void 0,function(){var t,s,o,d,u,l,c,p,h,m;return r.__generator(this,function(r){switch(r.label){case 0:s=!1,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,n];case 2:return o=r.sent(),s=o&&!!o,[3,4];case 3:return d=r.sent(),t=d,[3,4];case 4:l=!1,r.label=5;case 5:return r.trys.push([5,7,,8]),[4,i];case 6:return c=r.sent(),l=!(!c||!c),[3,8];case 7:return p=r.sent(),u=p,[3,8];case 8:return h={isTimeout:!0,iframeInBody:this._elementWindow.document.body.contains(this._iframe),messagesReceived:Object.keys(this._messagesReceived).join(","),getSharingHasData:s,getSharingError:t,inviteHasData:l,inviteError:u,timeout:a,mode:this._context.mode,isOnline:window.navigator&&window.navigator.onLine,scriptsLoadedTime:this._scriptsLoadedTime?this._scriptsLoadedTime.getTime()-this._iframeStartTime.getTime():-1,iframeLoadedTime:this._iframeLoadedTime,correlationId:e},this._showShareUX(),(m=this._props.options&&this._props.options.onTimeout)&&m(),this._sessionQos.end({resultType:g.ResultTypeEnum.Failure,resultCode:"timeout",extraData:h}),[2]}})})},a),[2]})})},e.prototype.dispose=function(){var e=this._context&&this._context.correlationId;clearTimeout(this._timeoutId),this._messagesReceived.sharePrefetch_dispose=!0,this._elementWindow.removeEventListener("message",this._receiveMessageBound),this._props.element.removeChild(this._iframe),this._sessionQos.end({resultType:g.ResultTypeEnum.ExpectedFailure,resultCode:"disposed",extraData:{isDisposed:!0,iframeInBody:this._elementWindow.document.body.contains(this._iframe),messagesReceived:Object.keys(this._messagesReceived).join(","),mode:this._context.mode,correlationId:e,isOnline:window.navigator&&window.navigator.onLine,iframeLoadedTime:this._iframeLoadedTime}})},e.prototype._getDefaultLink=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,i,a=this;return r.__generator(this,function(r){switch(r.label){case 0:return e=new s.default({},{urlDataSource:{getApiBaseUrl:function(){return a._context.webAbsoluteUrl+"/_api/v2.0"}},sessionManagementProvider:this._props.options.graphTokenProvider||{getToken:function(){return o.default.resolve({accessToken:a._context.authToken})}},apiEvent:h.Api.withManager(this._manager)}),t=new n.default({},{dataRequestor:e}),i=[],this._context.defaultRecipients&&this._context.defaultRecipients.length>0&&(i=this._context.defaultRecipients.map(function(e){return{email:e}})),[4,this._context.uniqueId?t.getDefaultLinkByUniqueId(this._context.uniqueId||"",i,!this._props.disableUseMultiPart):t.getDefaultLink(this._context.itemUrl||"",i,!this._props.disableUseMultiPart)];case 1:return[2,{value:r.sent()}]}})})},e.prototype._getSharingInformation=function(){var e={authToken:this._context.authToken,webAbsoluteUrl:this._context.webAbsoluteUrl,webTemplate:this._context.isODB?"21":"1",env:"prod"},t=this._props.options.spRestTokenProvider,i=this._manager,n=new u.SharingDataSource({pageContext:e,getParentListId:this._getParentListId,sharingContextInformation:this._context},{pageContext:e,dataRequestorType:function(n){function s(r){return n.call(this,r,{pageContext:e,apiEvent:h.Api.withManager(i),tokenProvider:t})||this}return r.__extends(s,n),s}(m.DataRequestor),tokenProvider:t}),s=new l.SharingProvider({pageContext:e,getParentListId:this._getParentListId,itemProvider:{invalidateItem:function(){}},sharingDataSource:n}),o=this._context.mode===d.Mode.copy||this._context.mode===d.Mode.linkSettings;return s.getSharingInformation({key:"",name:this._context.itemName,properties:{}},o,!0)},e.prototype._initializeIframe=function(){var e=this;this._elementWindow.addEventListener("message",this._receiveMessageBound,!1),this._iframe.onload=function(){e._iframeLoadedTime=(new Date).getTime()-e._iframeStartTime.getTime()},this._iframe.src=this._iframeUrl,this._iframe.style.width="0px",this._iframe.style.height="0px",this._iframe.style.visibility="hidden";var t=this._props.styles;t&&t.border?this._iframe.style.border=t.border:this._iframe.style.border="0",t&&(t.margin&&(this._iframe.style.margin=t.margin),t.minWidth&&(this._iframe.style.minWidth=t.minWidth),t.minHeight&&(this._iframe.style.minHeight=t.minHeight))},e.prototype._showShareUX=function(){this._isShareReady=!0,this._iframe.style.visibility="visible",this._iframe.style.height=(this._iframeHeight||400)+"px",this._iframe.style.width=(this._iframeWidth||320)+"px",clearTimeout(this._timeoutId)},e.prototype._receiveMessage=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,i,n,s,o,a,d,u,l,c,p,h,m,f,_,v,I,b,y,S;return r.__generator(this,function(r){switch(r.label){case 0:t=this._context&&this._context.correlationId;try{i=e&&e.data&&JSON.parse(e.data)}catch(e){return[2]}try{if(!this._elementWindow.document.body.contains(this._props.element))return this._messagesReceived.sharePrefetch_selfDispose=!0,this.dispose(),[2]}catch(e){}switch(n=i.name,this._messagesReceived[n||""]=!0,n){case"share_scriptsLoaded":return[3,1];case"share_resize":return[3,2];case"share_started":return[3,3];case"share_ready":return[3,4];case"share_error":return[3,5];case"share_completed":return[3,6];case"share_dismiss":return[3,7];case"share_manageAccessClicked":return[3,8];case"share_linkSettingsCompleted":return[3,9];case"share_grantAccessCompleted":return[3,10];case"share_getToken":return[3,11]}return[3,18];case 1:return this._scriptsLoadedTime=new Date,this._signal.complete(),(s=this._props.options&&this._props.options.onScriptsLoaded)&&s(),[3,18];case 2:return(o=this._props.options&&this._props.options.onResize)&&i.width&&i.height&&o(i.width,i.height),this._iframeWidth=i.width||320,this._iframeHeight=i.height||400,this._isShareReady&&(this._iframe.style.height=this._iframeHeight+"px",this._iframe.style.width=this._iframeWidth+"px"),[3,18];case 3:return(a=this._props.options&&this._props.options.onStarted)&&a(),[3,18];case 4:return this._showShareUX(),d={scriptsLoadedTime:this._scriptsLoadedTime?this._scriptsLoadedTime.getTime()-this._iframeStartTime.getTime():-1,iframeLoadedTime:this._iframeLoadedTime,mode:this._context.mode,recipientsCount:this._context.defaultRecipients&&this._context.defaultRecipients.length||0,shareId:this._context.shareId,correlationId:t},this._sessionQos.end({resultType:g.ResultTypeEnum.Success,extraData:d}),(u=this._props.options&&this._props.options.onReady)&&u(),[3,18];case 5:return this._showShareUX(),l=this._props.options&&this._props.options.onError,c=JSON.parse(i.debugErrorMessage||"{}"),p=c.code||c.status||"ShareError: ["+i.error+"]",this._sessionQos.end({resultType:g.ResultTypeEnum.Failure,resultCode:p,extraData:{correlationId:t}}),l&&l({name:"SharePrefetchError",message:i.errorMessage||"",error:i.error,debugErrorMessage:i.debugErrorMessage,errorMessage:i.errorMessage,resultCode:p}),[3,18];case 6:return(h=this._props.options&&this._props.options.onCompleted)&&h({scope:i.scope||""}),[3,18];case 7:return(m=this._props.options&&this._props.options.onDismiss)&&m(),[3,18];case 8:return(f=this._props.options&&this._props.options.openManageAccess)&&f(),[3,18];case 9:return(_=this._props.options&&this._props.options.onLinkSettingsComplete)&&_(i),[3,18];case 10:return v=this._props.options&&this._props.options.onGrantAccessComplete,i.successful&&v&&v(),[3,18];case 11:if(I=new g.Qos({name:"SharingSession.GetToken"}),!(b=this._iframe.contentWindow))return I.end({resultType:g.ResultTypeEnum.Failure,error:"no_window"}),[3,18];if(!this._props.options.spRestTokenProvider||!this._props.options.spRestTokenProvider.getAuthToken)return[3,16];r.label=12;case 12:return r.trys.push([12,14,,15]),[4,this._props.options.spRestTokenProvider.getAuthToken(i)];case 13:return(y=r.sent())?(b.postMessage(JSON.stringify({name:"share_newToken",token:y}),this._iframeUrl),I.end({resultType:g.ResultTypeEnum.Success})):(b.postMessage(JSON.stringify({name:"share_newToken",error:"no_token"}),this._iframeUrl),I.end({resultType:g.ResultTypeEnum.Failure,error:"no_token"})),[3,15];case 14:return S=r.sent(),b.postMessage(JSON.stringify({name:"share_newToken",error:"token_exception",errorDetails:S}),this._iframeUrl),I.end({resultType:g.ResultTypeEnum.Failure,error:String(S)}),[3,15];case 15:return[3,17];case 16:b.postMessage(JSON.stringify({name:"share_newToken",error:"no_handler"}),this._iframeUrl),I.end({resultType:g.ResultTypeEnum.Failure,error:"no_handler"}),r.label=17;case 17:return[3,18];case 18:return[2]}})})},e.prototype._getParentListId=function(e){return""},e.prototype._toTuple=function(e){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),t={},[4,e];case 1:return[2,(t.value=i.sent(),t)];case 2:return[2,{error:i.sent()}];case 3:return[2]}})})},e.prototype._isError=function(e){return!!e.error},e}();t.SharePrefetch=_},"2d57ae24be4947e6007b":function(e,t,i){"use strict";var r;!function(e){e[e.unknown=1]="unknown",e[e.odb=2]="odb",e[e.sharePoint=3]="sharePoint",e[e.ngsc=4]="ngsc",e[e.word=5]="word",e[e.powerpoint=6]="powerpoint",e[e.excel=7]="excel",e[e.onenoteWeb=8]="onenoteWeb",e[e.wac=9]="wac",e[e.visio=10]="visio",e[e.officecom=11]="officecom",e[e.listPart=12]="listPart",e[e.outlookWeb=13]="outlookWeb",e[e.odIos=14]="odIos",e[e.odAndroid=15]="odAndroid",e[e.teams=16]="teams",e[e.sample=17]="sample",e[e.odc=18]="odc",e[e.wordAndroid=19]="wordAndroid",e[e.excelAndroid=20]="excelAndroid",e[e.powerpointAndroid=21]="powerpointAndroid",e[e.wordIos=22]="wordIos",e[e.excelIos=23]="excelIos",e[e.powerpointIos=24]="powerpointIos",e[e.onenote=25]="onenote",e[e.teamsIos=26]="teamsIos",e[e.teamsAndroid=27]="teamsAndroid",e[e.onenoteIos=28]="onenoteIos",e[e.visioIos=29]="visioIos",e[e.onenoteAndroid=30]="onenoteAndroid",e[e.visioAndroid=31]="visioAndroid",e[e.outlookWindows=32]="outlookWindows",e[e.outlookMac=33]="outlookMac",e[e.onenoteUWP=34]="onenoteUWP",e[e.officemobileIos=35]="officemobileIos",e[e.officemobileAndroid=36]="officemobileAndroid",e[e.odcWac=37]="odcWac",e[e.outlookGroupsWeb=38]="outlookGroupsWeb",e[e.fluid=39]="fluid"}(r||(r={})),t.a=r},"480174dbefe5385f4aac":function(e,t,i){"use strict";var r;!function(e){e[e.share=1]="share",e[e.copy=2]="copy",e[e.atMention=3]="atMention",e[e.linkSettings=4]="linkSettings",e[e.manageAccess=5]="manageAccess",e[e.notify=6]="notify",e[e.addPeople=7]="addPeople"}(r||(r={})),t.a=r},"79820e3cd1611ca69f1c":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i("64328bb588b46459132d");t.withAriaLoader=function(){return function(e){return function(e){function t(t){var n=this,s=t.context,o=void 0===s?{}:s,a=t.ariaLoader,d=void 0===a?function(){return r.__awaiter(n,void 0,void 0,function(){return r.__generator(this,function(e){switch(e.label){case 0:return[4,Promise.resolve().then(function(){return i("16e0e7de7c7a198c78cc")})];case 1:return[2,e.sent().aria]}})})}:a,u=(t.context,r.__rest(t,["ariaLoader","context"]));return n=e.call(this,r.__assign({ariaLoader:d,context:r.__assign({},o)},u))||this}return r.__extends(t,e),t}(e)}}},"7cb20ef8ef4d81489def":function(e,t,i){"use strict";var r;!function(e){e[e.specificPeople=0]="specificPeople",e[e.organization=1]="organization",e[e.anyone=2]="anyone",e[e.existing=3]="existing",e[e.specificPeopleFlex=4]="specificPeopleFlex",e[e.customLabeledSpecificPeople=5]="customLabeledSpecificPeople"}(r||(r={})),t.a=r},"84b3634427834dceb831":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i("64328bb588b46459132d");t.fromUserAuthToken=function(){return function(e){return function(e){function t(t){var i=t.context,n=void 0===i?{}:i,s=t.userAuthToken,o=t.userId,a=(t.context,r.__rest(t,["userAuthToken","userId","context"])),d=s&&function(e){try{var t=e.split(".")[1];if(t)return JSON.parse(atob(t.replace(/-/g,"+").replace(/_/g,"/")))}catch(e){return}}(s),u=d&&d.puid?"Business":"Unknown",l=d&&d.app_displayname||"Unknown",c=d&&d.appid||"Unknown",p=function(e,t,i){return e?"Unknown"===i?"":e:"Business"===i&&t&&t.puid||""}(o,d,u),h=p?1:0,m=d&&d.tid||"Unknown";return e.call(this,r.__assign({context:r.__assign({AccountType:u,AppName:l,AppId:c,IsAuthenticated:h,SiteSubscriptionId:m,UserId:p},n)},a))||this}return r.__extends(t,e),t}(e)}}},"9a07fb223dfaa81a8d0c":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i("64328bb588b46459132d"),n=i("13e40aa9f992db5e9396"),s=function(e){function t(t){return e.call(this,t)||this}return r.__extends(t,e),t}(i("ed1acfdb37b46203a676").fromWebPlatform()(n.SharedAriaTelemetryHandler));t.WebSharedAriaTelemetryHandler=s},bf1fd7836373b186b583:function(e,t,i){"use strict";i.r(t),i.d(t,"SharingProvider",function(){return n});var r=i("e64bb55c7377947459c9"),n=function(){function e(e){this._dataSource=e.sharingDataSource||new r.SharingDataSource({getParentListId:e.getParentListId,pageContext:e.pageContext}),this._itemProvider=e.itemProvider}return e.prototype.getSharingInformation=function(e,t,i,r,n){return this._dataSource.getSharingInformation(e,t,i,r,n)},e.prototype.shareLink=function(e){var t=this;return this._dataSource.shareLink(e).then(function(i){return t._invalidateItem(e.items[0]),i})},e.prototype.unshareLink=function(e){var t=this;return this._dataSource.unshareLink(e).then(function(i){return t._invalidateItem(e.item),i})},e.prototype.updatePermissions2=function(e,t,i){var r=this;return this._dataSource.updatePermissions2(e,t,i).then(function(e){return r._invalidateItem(t),e})},e.prototype.updatePermissionsMultiple=function(e,t,i,r,n){var s=this;return this._dataSource.updatePermissionsMultiple(e,t,i,r,n).then(function(e){return s._invalidateItem(t),e})},e.prototype.getClientId=function(){return this._dataSource.getClientId()},e.prototype.parseRawSharingInformation=function(e){return this._dataSource.parseRawSharingInformation(e)},e.prototype.emailWithoutPermissioning=function(e,t,i,r){return this._dataSource.emailWithoutPermissioning(e,t,i,r).then(function(e){return e})},e.prototype.checkPermissions=function(e,t){return this._dataSource.checkPermissions(e,t)},e.prototype.share=function(e,t,i){return this._dataSource.share(e,t).then(function(e){return e})},e.prototype.setAddressBarLinkCapability=function(e,t){return this._dataSource.setAddressBarLinkCapability(e,t)},e.prototype._invalidateItem=function(e){this._itemProvider&&e&&e.parent&&e.parent.key&&this._itemProvider.invalidateItem(e.parent.key)},e}()},d3c3815ad5c194f24c4e:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i("64328bb588b46459132d"),n=i("2231d4b2f5084c1aefe5"),s="eeddb977348d43ebaaae45e759ea6e96-42528e91-0556-4879-9b8d-af7b3b8417e4-6984";t.forSharedControls=function(){return function(e){return function(e){function t(t){var i=t.context,o=void 0===i?{}:i,a=t.accountType,d=void 0===a?"Unknown":a,u=t.clientName,l=void 0===u?"Unknown":u,c=t.correlationId,p=t.environment,h=void 0===p?t.ariaEnvironment||"prod":p,m=t.isAuthenticated,f=void 0===m?"NA":m,g=t.language,_=void 0===g?o.Market:g,v=t.scenario,I=void 0===v?"Unknown":v,b=t.siteSubscriptionId,y=void 0===b?"Unknown":b,S=t.userId,k=void 0===S?"Unknown":S,w=t.version,x=void 0===w?"Unknown":w,P=t.tenantToken,L=void 0===P?s:P,A=(t.context,r.__rest(t,["accountType","clientName","correlationId","environment","isAuthenticated","language","scenario","siteSubscriptionId","userId","version","tenantToken","context"]));return e.call(this,r.__assign({tenantToken:L,context:r.__assign({AccountType:d,ClientName:l,CorrelationId:c,Environment:h,IsAuthenticated:f,IsSharedControl:!0,Market:_,Scenario:I,Session:n.generate(),SiteSubscriptionId:y,UserId:k,Version:x,Workload:"SharedControls"},o)},A))||this}return r.__extends(t,e),t}(e)}}},e64bb55c7377947459c9:function(e,t,i){"use strict";i.r(t);var r=i("64328bb588b46459132d"),n=i("875585d4e3d834656340"),s=i("1d2727e1b6137177eca9"),o=i("ed82754416f168d14460"),a=i("5e729a564cfb43974b42"),d=i("c2801f66d553d6a165e0"),u=i("2d57ae24be4947e6007b"),l=i("7cb20ef8ef4d81489def"),c=i("480174dbefe5385f4aac"),p=i("5c1e3c3a333c0e96782a"),h=i("f698cfbaff8a2434ab85"),m=i("6e62786e04351f279fc3"),f=function(){function e(e){this._itemUrlHelper=e.itemUrlHelper,this._sharingContextInformation=e.sharingContextInformation}return e.prototype.getApiRoot=function(e,t,i){if(this._sharingContextInformation){if(this._sharingContextInformation.uniqueId){var r=this._sharingContextInformation.isFolder?"GetFolderById":"GetFileById",n={guid:this._sharingContextInformation.uniqueId};return e.build().webByUrl({webUrl:this._sharingContextInformation.webAbsoluteUrl}).method(r,n).segment("ListItemAllFields")}return this._sharingContextInformation.listUrl?e.build().webByUrl({listUrl:this._sharingContextInformation.listUrl}).method("GetListItem",this._sharingContextInformation.serverRelativeItemUrl):this._sharingContextInformation.itemUrl?e.build().webByUrl({webUrl:this._sharingContextInformation.webAbsoluteUrl}).method("GetFileByUrl",m.canonicalizeUrl(this._sharingContextInformation.itemUrl)).segment("ListItemAllFields"):this._sharingContextInformation.listId&&this._sharingContextInformation.listItemId?e.build().webByUrl({webUrl:this._sharingContextInformation.webAbsoluteUrl}).method("Lists",this._sharingContextInformation.listId).method("GetItemById",this._sharingContextInformation.listItemId):e.build().webByUrl({webUrl:this._sharingContextInformation.webAbsoluteUrl}).method("GetListItemByResourceId",this._sharingContextInformation.resourceId)}var s;s=t.properties.path?this._itemUrlHelper.getUrlParts({path:t.properties.path}):this._itemUrlHelper.getItemUrlParts(t.key);var o=e.build().webByItemUrl(s).method("Lists",i);return o=t.properties.ID?o.method("GetItemById",t.properties.ID):o.method("GetItemByUniqueId",t.properties.uniqueId)},e.prototype.getFileUrl=function(e){return this._itemUrlHelper.getItemUrlParts(e.key).fullItemUrl},e.prototype.canUseSecurable=function(e){var t=e.properties;return!!t&&(!!t.ID||!!t.uniqueId)},e}(),g=i("969a82330cafca70aa6d"),_=i("95a42c24c7003bcd6d09"),v=i("cc08c169973ba8efeefa"),I=(i("0b8514f932f40951d460"),i("bb35b6a9f7d825abb325"));i.d(t,"EDIT_ROLE",function(){return b}),i.d(t,"VIEW_ROLE",function(){return y}),i.d(t,"HasInheritedLinksUI",function(){return S}),i.d(t,"SharingDataSource",function(){return k}),i.d(t,"parseSharingLinkInfo",function(){return w});var b="role:1073741827",y="role:1073741826",S={ODB:1657},k=function(e){function t(t,i){void 0===i&&(i={pageContext:t.pageContext});var r=e.call(this,{dataSourceName:"SharingDataSource"},i)||this;r._getParentListId=t.getParentListId,r._itemUrlHelper=t.itemUrlHelper||new s.a({},{pageContext:t.pageContext}),r._apiUrlHelper=t.apiUrlHelper||new a.a({},{pageContext:t.pageContext,itemUrlHelper:r._itemUrlHelper}),r._sharingContextInformation=t.sharingContextInformation||void 0,r._sharingDataSourceHelper=new f({itemUrlHelper:r._itemUrlHelper,sharingContextInformation:r._sharingContextInformation,isItemUrlEncoded:t.isItemUrlEncoded});var n=Object(p.getSafeWebServerRelativeUrl)(r._pageContext);return r._shareUrl=n+"/_api/SP.Web.ShareObject",r}return r.__extends(t,e),t.parsePeople=function(e){return e.map(function(e){var i={role:t.parseSharingRole(e.CurrentRole),statusCode:Number(!e.Status),errorMessage:e.Message||null};return{name:e.DisplayName,email:e.Email,userId:e.UserId,sharingInfo:i}})},t.parseSharingRole=function(e){switch(e){case 0:return 5;case 1:return 1;case 2:return 2;case 6:return 6;default:return 1}},t.prototype.getSharingInformation=function(e,t,i,r,n){var s,o=this,a=(r=r||this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e,this._getParentListId(e))).segment("GetSharingInformation"),d="pickerSettings";return t&&(d+=",permissionsInformation"),i&&(d+=",sharingLinkTemplates"),n&&(d+=",addressBarLinkSettings"),s=a.oDataParameter("$Expand",d).toString(),this.getData(function(){return s},function(t){var i=JSON.parse(t);return o._parseGetSharingInformationResponse(i,e)},"GetSharingInformation",null,"POST",null,null,null,!0,void 0,void 0,void 0,this._getExtraData())},t.prototype.emailWithoutPermissioning=function(e,i,r,n){var s=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,i,this._getParentListId(i)).segment("ForwardObjectLink").toString();return this.getData(function(){return s},function(e){var r=JSON.parse(e).d,n=[];r.UniquelyPermissionedUsers&&r.UniquelyPermissionedUsers.results&&(n=r.UniquelyPermissionedUsers.results);var s=[];r.InvitedUsers&&r.InvitedUsers.results&&(s=r.InvitedUsers.results);var o={};if(o.statusCode=r.StatusCode,o.errorMessage=r.ErrorMessage,o.people=t.parsePeople(n),o.invitedUsers=t.parsePeople(s),o.itemId=i&&i.id,s.length>0&&(o.invitationLink=s[0].InvitationLink),o.invalidEmails=[],r.UsersWithInvalidEmails&&r.UsersWithInvalidEmails.results)for(var a=0,d=r.UsersWithInvalidEmails.results;a<d.length;a++){var u=d[a];o.invalidEmails.push(u.User)}return o},"ForwardObjectLink",function(){for(var t=[],i=0,s=e;i<s.length;i++){var o=s[i];t.push(o.rawPersonData)}var a={peoplePickerInput:JSON.stringify(t),emailBody:r,emailSubject:n};return JSON.stringify(a)})},t.prototype.checkPermissions=function(e,t){var i=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("CheckPermissions").toString();return this.getData(function(){return i},function(e){var t=JSON.parse(e);return t.d?t.d.CheckPermissions.results:null},"CheckPermissions",function(){var t={recipients:e};return JSON.stringify(t)})},t.prototype.share=function(e,i){var r,n=this,s=!!this._sharingContextInformation||this._sharingDataSourceHelper.canUseSecurable(i.items[0]);if(9===i.linkType||6===i.linkType||5===i.linkType)return this._shareLink(e,i);if(s){var o=i.items[0],a=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,o,this._getParentListId(o));r=a.segment("ShareObject").toString()}else r=this._shareUrl;return this.getData(function(){return r},function(e){var r=JSON.parse(e).d,n=[];r.UniquelyPermissionedUsers&&r.UniquelyPermissionedUsers.results&&(n=r.UniquelyPermissionedUsers.results);var s=[];r.InvitedUsers&&r.InvitedUsers.results&&(s=r.InvitedUsers.results);var o={};if(o.statusCode=r.StatusCode,o.errorMessage=r.ErrorMessage,o.people=t.parsePeople(n),o.invitedUsers=t.parsePeople(s),o.itemId=i.items[0]&&i.items[0].id,s.length>0&&(o.invitationLink=s[0].InvitationLink),o.invalidEmails=[],r.UsersWithInvalidEmails&&r.UsersWithInvalidEmails.results)for(var a=0,d=r.UsersWithInvalidEmails.results;a<d.length;a++){var u=d[a];o.invalidEmails.push(u.User)}return o},"Share",function(){for(var t=[],r=0;r<e.length;r++){var o=e[r];t.push(o.rawPersonData)}i.roleValue===2..toString()?i.roleValue=b:i.roleValue===1..toString()&&(i.roleValue=y);var a={peoplePickerInput:JSON.stringify(t),roleValue:i.roleValue,sendEmail:i.sendEmail,emailBody:i.message,emailSubject:i.subject,includeAnonymousLinkInEmail:!i.requireSignIn,propagateAcl:i.propagateSharing,useSimplifiedRoles:!0};return s||(a.url=n._sharingDataSourceHelper.getFileUrl(i.items[0])),JSON.stringify(a)})},t.prototype.updatePermissions2=function(e,t,i){var r=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("UpdateDocumentSharingInfo").toString();return this.getData(function(){return r},function(e){var t=JSON.parse(e).d;return t?{role:t.UpdateDocumentSharingInfo.results[0].CurrentRole}:null},"UpdatePermissions2",function(){var t;switch(i){case 0:t=0;break;case 1:t=1;break;case 6:t=6;break;case 2:t=2;break;default:t=1}var r={userRoleAssignments:[{UserId:e.loginName,Role:t}],validateExistingPermissions:!1,additiveMode:!1,sendServerManagedNotification:!1,customMessage:null,includeAnonymousLinksInNotification:!1,propagateAcl:!0};return JSON.stringify(r)})},t.prototype.updatePermissionsMultiple=function(e,t,i,r,n){var s=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("UpdateDocumentSharingInfo").toString();return this.getData(function(){return s},function(e){var t=JSON.parse(e).d;return t?{role:t.UpdateDocumentSharingInfo.results[0].CurrentRole,success:t.UpdateDocumentSharingInfo.results.map(function(e){return e.Status}).reduce(function(e,t){return e&&t},!0)}:null},"UpdatePermissionsMultiple",function(){var t;switch(i){case 0:t=0;break;case 1:t=1;break;case 6:t=6;break;case 2:t=2;break;default:t=1}var s={userRoleAssignments:e.map(function(e){return{UserId:e.userId,Role:t}}),validateExistingPermissions:!1,additiveMode:!1,sendServerManagedNotification:r,customMessage:n,includeAnonymousLinksInNotification:!1,propagateAcl:!0};return JSON.stringify(s)})},t.prototype.parseRawSharingInformation=function(e){return this._parseGetSharingInformationResponse(e,void 0)},t.prototype.unshareLink=function(e){var t=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e.item,this._getParentListId(e.item)).segment("UnshareLink").toString();return this.getData(function(){return t},function(e){return!!JSON.parse(e).d},"UnshareLink",function(){var t={linkKind:e.kind,shareId:e.shareId};return JSON.stringify(t)})},t.prototype.shareLink=function(e){var t=e.settings,i=e.items[0],r=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e.items[0],this._getParentListId(i)).segment("ShareLink").toString();return this.getData(function(){return r},function(e){var t=JSON.parse(e);return t.d?w(t):t.error?{error:5,errorMessage:t.error.message}:void 0},"ShareLink",function(){var i=null;t.expiration&&(i=Object(n.a)(t.expiration.toString()));var r=null;if(e.recipients&&e.recipients.length>0){r=[];for(var s=0,o=e.recipients;s<o.length;s++){var a=o[s];a.rawPersonData&&r.push(a.rawPersonData)}}var d=null;if(t.inviteesToRemove&&t.inviteesToRemove.length>0){d=[];for(var u=0,l=t.inviteesToRemove;u<l.length;u++){var c=l[u];d.push({id:c.id,loginName:c.loginName,name:c.primaryText,isExternal:c.isExternal,principalType:c.type,email:c.email})}}var p={request:{createLink:!0,settings:{allowAnonymousAccess:t.allowAnonymousAccess,linkKind:t.sharingLinkKind,expiration:i,role:t.role,restrictShareMembership:t.restrictShareMembership,updatePassword:t.updatePassword,password:t.password,shareId:t.shareId,description:t.description}}};if(d&&(p.request.settings.inviteesToRemove={results:d}),r&&r.length>0){p.request.peoplePickerInput=JSON.stringify(r);var h=e.emailData,m=e.emailSubject;void 0!==h&&void 0===m&&(p.request.emailData={body:e.emailData,subject:""}),void 0===h&&void 0!==m&&(p.request.emailData={body:"",subject:e.emailSubject}),void 0!==h&&void 0!==m&&(p.request.emailData={body:e.emailData,subject:e.emailSubject})}var f=e.settings.shareId;return f&&(p.request.settings.shareId=f,p.request.emailData={body:""}),JSON.stringify(p)},"POST",null,null,null,!0,void 0,void 0,void 0,this._getExtraData()).catch(function(e){var t="";try{t=JSON.stringify(e)}catch(e){}return{error:5,debugErrorMessage:t}})},t.prototype.setAddressBarLinkCapability=function(e,t){var i=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e,this._getParentListId(e)).segment("SetAddressBarLinkCapability").toString();return this.getData(function(){return i},function(e){return!!JSON.parse(e).d},"SetAddressBarLinkCapability",function(){var e={enable:t};return JSON.stringify(e)})},t.prototype.shareLinkExpress=function(e,t,i){var r=this._apiUrlHelper.build().webByUrl({webUrl:this._pageContext.webAbsoluteUrl}).method("Lists",e).method("GetItemById",t).segment("ShareLinkExpress").toString();return this.getData(function(){return r},function(e){var t=JSON.parse(e);return t.d?x(t.d.ShareLinkExpress.sharingLinkInfo):t.error?{error:5,errorMessage:t.error.message}:void 0},"ShareLinkExpress",function(){var e={expressOption:i};return JSON.stringify(e)},"POST",null,null,null,!0,void 0,void 0,void 0,this._getExtraData()).catch(function(e){var t="";try{t=JSON.stringify(e)}catch(e){}return{error:5,debugErrorMessage:t}})},t.prototype.getClientId=function(){var e=Number(this._pageContext.webTemplate);if(function(e){var t=v.Killswitch.isActivated("fcc930ba-8fe4-4065-b185-8b74488eba20","10/08/2019","SitePagePublishing_FeatureEnabled"),i=v.Killswitch.isActivated("1c067c05-41cd-48a7-bf78-bb398a461041","10/15/2019","Check comm site feature instead of template");if(t||i||!e.featureInfo)return Number(e.webTemplate)===g.b.sitePagePublishing;var r=new I.a(e.featureInfo);if(r){var n=r.get("SitePagePublishing");return!!n&&n.enabled}return!1}(this._pageContext))return u.a.sharePoint;switch(e){case g.b.teamSite:case g.b.group:case g.b.subgroup:case g.b.sitePagePublishing:return u.a.sharePoint;case g.b.mySite:return u.a.odb;default:return v.Killswitch.isActivated("49c1f4de-c1fb-47ed-8d4b-695083cb10ef","11/08/2019","Default clientId to SharePoint if unknown for other web templates")?u.a.unknown:u.a.sharePoint}},t.prototype._shareLink=function(e,t){var i=this,r=t.items[0],s=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,r,this._getParentListId(r)).segment("ShareLink").toString();return this.getData(function(){return s},function(i){return{statusCode:0,errorMessage:"",people:e,itemId:t.items[0].id}},"ShareLink",function(){for(var r=[],s=0,o=e;s<o.length;s++){var a=o[s];r.push(a.rawPersonData)}var d=null;t.expiration&&(d=Object(n.a)(t.expiration));var u={request:{peoplePickerInput:JSON.stringify(r),emailData:{body:t.message,subject:t.subject},linkKind:i._getSharingLinkKind(t.linkType,t.roleValue),createLink:!0,expiration:d}};return JSON.stringify(u)})},t.prototype._getSharingLinkKind=function(e,t){var i=1;return 6===e?i=5:5===e?i=4:9===e&&(i=t===2..toString()?3:2),i},t.prototype._parseGetSharingInformationResponse=function(e,t){if(e.error)return{error:5,anonymousLinkExpirationRestrictionDays:void 0,canAddExternalPrincipal:void 0,canAddInternalPrincipal:void 0,canManagePermissions:void 0,defaultSharingLink:void 0,defaultShareLinkToExistingAccess:void 0,hasInheritedLinks:void 0,isShared:void 0,item:void 0,fileExtension:void 0,sharingLinks:void 0,sharingPrincipals:void 0,peoplePickerSettings:void 0,userDisplayName:void 0,blockPeoplePickerAndSharing:void 0,userRole:void 0,defaultShareLinkPermission:void 0,sharingAbilities:void 0,defaultLinkKind:void 0,directLink:void 0,hasPermissionsInformation:void 0,sharingLinkTemplates:void 0,webTemplateId:void 0,itemUniqueId:void 0};var i=e.d,r=!!i.permissionsInformation,n=!!i.sharingLinkTemplates,s=_.default.isFeatureEnabled(S)&&r,o=!!i.addressBarLinkSettings,a=r?this._parseSharingLinks(i.permissionsInformation.links.results,i.directUrl):[],d=n?this._parseSharingLinkTemplates(i.sharingLinkTemplates.templates.results):[],u=o?i.addressBarLinkSettings:null,c=r?i.permissionsInformation.siteAdmins.results.concat(i.permissionsInformation.principals.results):[],p=this._parseSharingPrincipals(c),m=this._getDefaultSharingLink(i.defaultLinkKind,a,i.sharingAbilities),f={name:this._sharingContextInformation?this._sharingContextInformation.itemName:void 0,childCount:this._sharingContextInformation?this._sharingContextInformation.itemCount:void 0,hasDlpPolicy:this._sharingContextInformation?this._sharingContextInformation.hasDlpPolicy:void 0,extension:this._sharingContextInformation&&this._sharingContextInformation.itemExtension?this._sharingContextInformation.itemExtension:i.fileExtension,appmap:this._sharingContextInformation?this._sharingContextInformation.itemAppmap:void 0,itemType:this._sharingContextInformation?this._sharingContextInformation.itemType:void 0};if(t){var g=t.properties,v=g.ItemChildCount?parseInt(g.ItemChildCount,10):0,I=g.FolderChildCount?parseInt(g.FolderChildCount,10):0,b=t.type===h.default.OneNote?0:v+I,y=this._isPolicyTipFlagSet(t.policyTip,4);f={name:t.name,childCount:b,hasDlpPolicy:y,extension:t.extension,appmap:t.appMap,itemType:t.type}}var k=i.canRequestAccessForGrantAccess||i.canAddInternalPrincipal||a.length>1;return{anonymousLinkExpirationRestrictionDays:0===i.anonymousLinkExpirationRestrictionDays?-1:i.anonymousLinkExpirationRestrictionDays,canAddExternalPrincipal:i.canAddExternalPrincipal,canAddInternalPrincipal:i.canAddInternalPrincipal,defaultShareLinkToExistingAccess:i.defaultShareLinkToExistingAccess,canManagePermissions:k,defaultSharingLink:m,fileExtension:i.fileExtension,hasInheritedLinks:!!s&&i.permissionsInformation.hasInheritedLinks,isShared:this._computeIsShared(a,p),item:f,sharingLinks:a,sharingPrincipals:p,peoplePickerSettings:i.pickerSettings,userDisplayName:this._pageContext.userDisplayName,blockPeoplePickerAndSharing:i.blockPeoplePickerAndSharing,requiresAccessApproval:!i.canAddInternalPrincipal&&i.canRequestAccessForGrantAccess,userRole:i.currentRole,defaultShareLinkPermission:i.defaultShareLinkPermission,sharingAbilities:i.sharingAbilities,defaultLinkKind:i.defaultLinkKind,directLink:{allowsAnonymousAccess:!1,audience:l.a.existing,expiration:null,description:null,isActive:!0,isEdit:!0,principals:[],invitees:[],shareId:"",sharingLinkKind:1,url:i.directUrl,updatePassword:!1,password:"",passwordLastModifiedBy:null},hasPermissionsInformation:!!i.permissionsInformation,sharingLinkTemplates:d,addressBarLinkSettings:u,webTemplateId:i.webTemplateId,itemUniqueId:i.itemUniqueId,customizedExternalSharingServiceUrl:i.customizedExternalSharingServiceUrl||"",siteIBSegmentIDs:i.siteIBSegmentIDs?i.siteIBSegmentIDs.results:null,enforceIBSegmentFiltering:(i.enforceIBSegmentFiltering,!0)}},t.prototype._computeIsShared=function(e,t){for(var i=!1,r=0,n=e;r<n.length;r++){var s=n[r];s.isActive&&1!==s.sharingLinkKind&&(i=!0)}return i||(i=t.length>0),i},t.prototype._parseSharingLinks=function(e,t){var i=this,r=(e=e.filter(function(e){return!e.isInherited})).map(function(e){var t=e.linkDetails;return{allowsAnonymousAccess:t.AllowsAnonymousAccess,hasPassword:t.RequiresPassword,blockDownload:t.BlocksDownload,description:t.Description,audience:P(t.LinkKind,t.AllowsAnonymousAccess,t.RestrictedShareMembership),expiration:t.Expiration?new Date(t.Expiration):null,isActive:t.IsActive,isEdit:L(t.LinkKind)||t.IsEditLink,isReview:t.IsReviewLink,principals:i._parseSharingPrincipals(e.linkMembers.results,t.LinkKind),invitees:i._parseLinkInvitees(t),shareId:t.ShareId,sharingLinkKind:t.LinkKind,url:t.Url,updatePassword:t.UpdatePassword,password:t.Password,passwordLastModifiedBy:i._parseSharingPrincipal(t.PasswordLastModifiedBy),isCreateOnlyLink:t.IsCreateOnlyLink,isAddressBarLink:t.IsAddressBarLink,isUnhealthy:t.IsUnhealthy}});return(r=r.sort(function(e,t){return i._getLinkRanking(t)-i._getLinkRanking(e)})).push({allowsAnonymousAccess:!1,audience:l.a.specificPeople,expiration:null,description:null,isActive:!0,isEdit:!0,principals:[],invitees:[],shareId:"",sharingLinkKind:1,url:t,updatePassword:!1,password:"",passwordLastModifiedBy:null}),r},t.prototype._getLinkRanking=function(e){var t=0;switch(e.audience){case l.a.anyone:t+=30;break;case l.a.organization:t+=20;break;case l.a.specificPeopleFlex:t+=10}return e.isEdit?t+=3:e.isReview?t+=2:e.isEdit||e.isReview||e.blockDownload||(t+=1),t},t.prototype._parseSharingLinkTemplates=function(e){var t=this;return e.map(function(e){var i,r=e.linkDetails;return null!==r&&(i={allowsAnonymousAccess:r.AllowsAnonymousAccess,hasPassword:r.RequiresPassword,blockDownload:r.BlocksDownload,audience:P(r.LinkKind,r.AllowsAnonymousAccess,r.RestrictedShareMembership),expiration:r.Expiration?new Date(r.Expiration):null,description:r.Description,isActive:r.IsActive,isEdit:L(r.LinkKind)||r.IsEditLink,isReview:r.IsReviewLink,principals:void 0,invitees:t._parseLinkInvitees(r),shareId:r.ShareId,sharingLinkKind:r.LinkKind,url:r.Url,updatePassword:r.UpdatePassword,password:r.Password,passwordLastModifiedBy:t._parseSharingPrincipal(r.PasswordLastModifiedBy)}),{linkDetails:i,passwordProtected:e.passwordProtected,role:e.role,scope:e.scope,shareKind:e.shareKind}})},t.prototype._parseLinkInvitees=function(e){var t=this,i=e.Invitations;if(!i)return[];for(var r=[],n=0,s=i.results;n<s.length;n++){var o=s[n];o&&o.invitee&&r.push(o.invitee)}return r.map(function(e){return{id:e.id,email:e.email,primaryText:e.name,isExternal:e.isExternal,loginName:e.loginName,role:null,secondaryText:e.jobTitle,type:e.principalType,imageUrl:t._getImageUrl(e.email)}})},t.prototype._parseSharingPrincipals=function(e,t){var i=this,r=e.map(function(e){var r=e.principal;r||(r=e);var n={id:r.id,isExternal:r.isExternal,loginName:r.loginName,primaryText:r.name,role:e.role,secondaryText:r.jobTitle,type:r.principalType,imageUrl:i._getImageUrl(r.email),email:r.email};return t&&(n.sharingLinkKind=t),n}),n=new Set;return r.filter(function(e){var t=e.loginName;return!n.has(t)&&n.add(t)})},t.prototype._getExtraData=function(){var e;return this._sharingContextInformation&&(e={clientId:this._sharingContextInformation.clientId,mode:c.a[this._sharingContextInformation.mode]}),e},t.prototype._parseSharingPrincipal=function(e){if(e){var t=e.principal;return t||(t=e),{id:t.id,isExternal:t.isExternal,loginName:t.loginName,primaryText:t.name,role:e.role,secondaryText:t.jobTitle,type:t.principalType,imageUrl:this._getImageUrl(t.email),email:t.email}}return null},t.prototype._getDefaultSharingLink=function(e,t,i){(i.peopleSharingLinkAbilities.canManageEditLink.enabled||i.peopleSharingLinkAbilities.canManageReadLink.enabled)&&1===e&&(e=6);var r=e;return 5!==r||i.anonymousLinkAbilities.canManageEditLink.enabled||(r=4),4!==r||i.anonymousLinkAbilities.canManageReadLink.enabled||(r=3),3!==r||i.organizationLinkAbilities.canManageEditLink.enabled||(r=2),2!==r||i.organizationLinkAbilities.canManageReadLink.enabled||(r=1),{allowsAnonymousAccess:void 0,audience:void 0,expiration:void 0,description:void 0,isActive:!0,isEdit:void 0,principals:void 0,shareId:void 0,sharingLinkKind:r,url:void 0,invitees:void 0,updatePassword:!1,password:"",passwordLastModifiedBy:void 0}},t.prototype._getImageUrl=function(e){if(e&&this._sharingContextInformation){var t=this._sharingContextInformation&&this._sharingContextInformation.clientId;return"word"===t||"powerpoint"===t||"excel"===t?null:e&&this._sharingContextInformation?this._sharingContextInformation.webAbsoluteUrl+Object(o.a)({userLoginName:e}):null}return e&&this._pageContext?Object(p.getSafeWebServerRelativeUrl)(this._pageContext)+Object(o.a)({userLoginName:e}):null},t.prototype._isPolicyTipFlagSet=function(e,t){return e&&(e&t)===t},t}(d.b);function w(e){if(e.d)return x(e.d.ShareLink.sharingLinkInfo)}function x(e){var t=e.Expiration?new Date(e.Expiration):void 0;return{link:{allowsAnonymousAccess:e.AllowsAnonymousAccess,audience:P(e.LinkKind,e.AllowsAnonymousAccess,e.RestrictedShareMembership),expiration:t,description:e.Description,isActive:e.IsActive,isEdit:L(e.LinkKind)||e.IsEditLink,principals:null,invitees:null,shareId:e.ShareId,sharingLinkKind:e.LinkKind,url:e.Url,updatePassword:e.UpdatePassword,password:e.Password,passwordLastModifiedBy:e.PasswordLastModifiedBy,shareTokenString:e.ShareTokenString,isAddressBarLink:e.IsAddressBarLink,isUnhealthy:e.IsUnhealthy}}}function P(e,t,i){return 5===e||4===e?l.a.anyone:3===e||2===e?l.a.organization:1===e?l.a.specificPeople:6===e?t?l.a.anyone:!1===i?l.a.organization:l.a.specificPeopleFlex:void 0}function L(e){return 5===e||3===e||4!==e&&2!==e&&null}},ed1acfdb37b46203a676:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i("64328bb588b46459132d"),n=i("a918e6b023e78a8f38a9");t.fromWebPlatform=function(){return function(e){return function(e){function t(t){var i=new n.PlatformDetection,s=t.context,o=void 0===s?{}:s;return e.call(this,r.__assign({language:window.navigator.language},t,{context:r.__assign({BrowserIsMobile:i.isMobile,BrowserMajVer:i.browserMajor,BrowserMinVer:i.browserMinor,BrowserName:i.browserName,BrowserUserAgent:i.userAgent,OSName:i.osName,OSVersion:i.osVersion},o)}))||this}return r.__extends(t,e),t}(e)}}}}]);