webpackJsonp([9],{2229:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n(2230),n(2233),n(2235),n(2237),n(2239),n(2241),n(2243),n(2245),n(2247),n(2249),n(2251),n(2253),n(2255),n(2257),n(2259)},2230:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(2231),s=n(2232),i=function(){function t(t,e,n,o,s,i,a,r,c,l,d,u,p){var g=this;this.$rootScope=t,this.esTranslate=e,this.loggingService=n,this.resources=o,this.$sce=s,this.utilityService=r,this.tooltipService=c,this.mobileUpsellActionHandler=l,this.analyticsService=u,this.$state=p,this.tooltipId=r.generateUUID(),this.context.isValid=void 0,this.isSmsEnabled=this.context.control.options&&this.context.control.options.enableSms,this.showMobileBadges=this.context.control.options&&this.context.control.options.showMobileBadges;var m=this.context.control.options&&this.context.control.options.preFillEmail,h=this.context.control.options&&this.context.control.options.smsEnabledDescriptionResxKey,v=this.context.control.options&&this.context.control.options.emailDescriptionResxKey,y=this.context.control.options&&this.context.control.options.smsEnabledPlaceHolderResxKey,f=this.context.control.options&&this.context.control.options.emailPlaceHolderResxKey,S=a.valueFor(i.settings.names.webserviceEnvironmentName),b=!S||/prod-usea|prod-uswe|prod-usce|dev-local|skypespacesdev/.test(S);this.isSmsEnabled=this.isSmsEnabled&&b,!this.isSmsEnabled&&m&&d.getUserInformation().then(function(t){g.context.value=t.userName,g.validateInput()}),this.description=this.isSmsEnabled?h?e.instant(h):e.instant(o.strings.mobile_upsell_dialog_email_prefill_instruction):v?e.instant(v):e.instant(o.strings.mobile_upsell_dialog_instruction),this.placeholder=this.isSmsEnabled?y?e.instant(y):e.instant(o.strings.mobile_upsell_dialog_input_placeholder_email_sms):f?e.instant(f):e.instant(o.strings.mobile_upsell_dialog_input_placeholder_email),this.infoBubbleText=this.isSmsEnabled?[e.instant(o.strings.mobile_upsell_sms_disclaimer),e.instant(o.strings.mobile_upsell_phone_caveat)]:[e.instant(o.strings.mobile_upsell_email_disclaimer)],this.sendPanelViewEvent()}return t.$inject=["$rootScope","esTranslate","loggingService","resources","$sce","constants","settingsService","utilityService","tooltipService","mobileUpsellActionHandler","authenticationService","analyticsService","$state"],t.prototype.showInfoTooltip=function(t,e){var n=angular.extend(this.$rootScope.$new(),this),o={template:s,trigger:"manual",container:"body",placement:"right",autoClose:!0,scope:n},i={sourceElement:angular.element(t.currentTarget),tooltipType:teamspace.services.TooltipType.Popover,options:o,tooltipId:this.tooltipId};e?this.tooltipService.showTooltip(i):this.tooltipService.clearTooltip(teamspace.services.TooltipType.Popover,this.tooltipId)},t.prototype.trustAsHtml=function(t){return this.$sce.trustAsHtml(t)},t.prototype.validateInputOnKeyUp=function(){this.context.isValid=void 0,this.errorText=void 0,this.isInputValid()&&(this.context.isValid=!0)},t.prototype.validateInput=function(){if(this.context.isValid=this.isInputValid(),this.errorText=void 0,!this.context.isValid){var t=/^\d*$/.test(_.trim(this.context.value).replace(/\W*/g,""));this.errorText=this.isSmsEnabled&&t?this.esTranslate.instant(this.resources.strings.mobile_upsell_mobile_phone_validation_error):this.esTranslate.instant(this.resources.strings.mobile_upsell_email_validation_error)}},t.prototype.isInputValid=function(){var t=!1;if(this.context.phoneNumber=void 0,validator.isEmail(this.context.value))t=!0;else if(this.isSmsEnabled){var e=libphonenumber.PhoneNumberUtil.getInstance(),n=_.trim(this.context.value).replace(/\W*/g,"");n.startsWith("1")?n="+"+n:n.startsWith("+1")||(n="+1"+n);try{var o=e.parse(n);(t=10===o.getNationalNumber().toString().length)&&(this.context.phoneNumber=o)}catch(e){t=!1}}return t},Object.defineProperty(t.prototype,"buttonText",{get:function(){return this.context.isLoading?this.esTranslate.instant(this.resources.strings.mobile_upsell_sending_link):this.esTranslate.instant(this.resources.strings.mobile_upsell_dialog_send_link)},enumerable:!0,configurable:!0}),t.prototype.sendLink=function(){this.mobileUpsellActionHandler.handleAction(this.context.dialogCtrl)},t.prototype.sendPanelViewEvent=function(){this.analyticsService.sendPanelView({panel:{launchMethod:teamspace.components.LaunchMethod[teamspace.components.LaunchMethod.direct],previousUri:void 0,previousUriParams:void 0,region:teamspace.PanelRegion[teamspace.PanelRegion.modal],uri:this.$state.current.name,uriParams:this.loggingService.hashUriParamsPII(this.$state.params),viewId:this.utilityService.generateUUID(),type:teamspace.PanelType[teamspace.PanelType.engagementSurfaceEmailSmsControl]},dataBag:{sendLinkOption:this.isSmsEnabled?"EmailAndSMS":"EmailOnly",id:this.context.id,treatment:this.context.treatment}})},t}();e.EngagementSurfaceEmailSmsControl=i,angular.module("teamspace.engagementSurfaceEmailSmsControl",["teamspace.esTranslate","teamspace.loggingService","teamspace.locales","teamspace.constants","teamspace.settingsService","teamspace.utilityService","teamspace.tooltipService","teamspace.authenticationService","teamspace.esActionHandler","teamspace.engagementSurfaceMobileBadgesControl"]).component("engagementSurfaceUicontrolEmailSms",{bindings:{context:"<"},template:o,controller:i})},2231:function(t,e){t.exports='<div class="es-email-sms" ng-class="{ \'without-mobile-badges\': !$ctrl.showMobileBadges }" data-tid="es-email-sms">\n  <p class="es-text">\n    <span ng-bind-html="::$ctrl.trustAsHtml($ctrl.description)"></span>\n\n    <span class="es-email-sms-description-info">\n      <a class="info-link" ng-if="::$ctrl.infoBubbleText.length" ng-mouseenter="::$ctrl.showInfoTooltip($event, true)" ng-mouseleave="::$ctrl.showInfoTooltip($event, false)">\n        <ng-include src="\'svg/icons-info.html\'"></ng-include>\n      </a>\n    </span>\n  </p>\n\n  <div class="es-input">\n    <span class="es-input-wrapper">\n      <input sanitized id="email-sms-form" class="form-control" acc-focus-default aria-label="{{::$ctrl.description}}" ng-blur="$ctrl.context.value && $ctrl.validateInput()" ng-keyup="::$ctrl.validateInputOnKeyUp()" ng-readonly="$ctrl.context.isLoading" type="text" placeholder="{{::$ctrl.placeholder}}" spellcheck="false" ng-model="$ctrl.context.value"/>\n\n      <ng-include class="icon error" ng-if="$ctrl.context.isValid === false" src="\'svg/icons-input-invalid.html\'"></ng-include>\n\n      <ng-include class="icon valid" ng-if="$ctrl.context.isValid" src="\'svg/icons-input-valid.html\'"></ng-include>\n    </span>\n\n    <button class="ts-btn ts-btn-primary inset-border" ng-click="$ctrl.sendLink()" ng-disabled="!$ctrl.context.isValid" track-type="{{::$root.trackConstants.trackType.button}}" track-outcome="{{::$root.trackConstants.trackOutcome.submit}}" track-name="{{::$root.trackConstants.trackModuleName.engagementSurfaceDialogButton}}" track-scenario="{{::$root.trackConstants.trackScenario.engagementSurfaceSendLinkButton}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.engagementSurface}}" track-data="{ sendType: {{$ctrl.context.phoneNumber ? \'\\\'SMS\\\'\' : \'\\\'Email\\\'\'}},\n                          id: \'{{$ctrl.context.id}}\',\n                          treatment: \'{{$ctrl.context.treatment}}\' }" data-tid="es-email-sms-send-link-btn">\n      <busy-animation size="small" ng-if="$ctrl.context.isLoading"></busy-animation>\n      <span ng-bind="$ctrl.buttonText"></span>\n    </button>\n\n  </div>\n\n  <div class="validation-error-contents">\n    <p class="form-field-error es-text small" aria-live="assertive" ng-if="$ctrl.context.isValid === false" role="alert">\n      <span ng-bind="::$ctrl.errorText"></span>\n    </p>\n  </div>\n\n  <engagement-surface-uicontrol-mobile-badges ng-if="$ctrl.showMobileBadges" context="$ctrl.context"></engagement-surface-uicontrol-mobile-badges>\n\n</div>'},2232:function(t,e){t.exports='<div class="tooltip-container input-info-text">\n  <div class="content-container">\n    <div class="tooltip-arrow-left"></div>\n    <span class="tooltip-content">\n      <div ng-repeat="text in infoBubbleText track by $index">\n        <p class="es-text small" ng-bind="::text"></p>\n      </div>\n    </span>\n  </div>\n</div>\n'},2233:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(2234),s=function(){function t(t,e,n,o,s,i,a,r,c,l){var d=this;this.esTranslate=t,this.resources=e,this.$sce=o,this.analyticsService=s,this.ariaLiveService=i,this.updateDiscoverySettingsActionHandler=l,this.hideCheckboxes=!1,this.clickedCount=0,this.remindMeLaterEnabled=!1,this.isSuccess=!1,this.didFocusOnSecondaryButton=!1,this.logger=a.newLogger("EngagementSurfaceDiscoverySettingsControl"),this.context.isValid=void 0;var u=this.context.control.options&&this.context.control.options.titleResxKey,p=this.context.control.options&&this.context.control.options.bodyResxKey,g=this.context.control.options&&this.context.control.options.enableRemindMeLater;this.title=t.instant(u),this.description=t.instant(p),this.learnMoreLink=n.akaMs.teamDiscoverySettingUrl,this.remindMeLaterEnabled=g,this.context.handleError=this.handleError.bind(this),this.context.handleSuccess=this.handleSuccess.bind(this),this.context.isLoading=!0,this.context.erroredSettings=[],r.getNonDiscoverableTeams().then(function(t){var e=c.createOrderedTeamLists(t);if(d.context.discoverySettings=e.favoriteTeamsByOrder.concat(e.moreTeamsByName).map(function(t){return{team:t,isDiscoverable:!1,retryFailed:!1}}),1===d.context.discoverySettings.length)d.hideCheckboxes=!0,d.clickedCount=1,d.context.discoverySettings[0].isDiscoverable=!0;else if(d.context.discoverySettings.length<1)return void d.context.dialogCtrl.close();d.context.isLoading=!1,setTimeout(function(){var t=d.hideCheckboxes?angular.element("#btn-make-discoverable")[0]:angular.element(".es-discovery-settings .app-checkbox--input")[0];t&&t.focus()}),d.sendOpenEvent()}).catch(function(t){d.context.dialogCtrl.close()})}return t.$inject=["esTranslate","resources","constants","$sce","analyticsService","ariaLiveService","loggingService","channelService","channelTeamSortHelper","updateDiscoverySettingsActionHandler"],t.prototype.trustAsHtml=function(t){return this.$sce.trustAsHtml(t)},Object.defineProperty(t.prototype,"bulkOperationButtonText",{get:function(){return this.clickedCount==this.context.discoverySettings.length?this.esTranslate.instant(this.resources.strings.discovery_setting_promo_unselect_all):this.esTranslate.instant(this.resources.strings.discovery_setting_promo_select_all)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"secondaryButtonText",{get:function(){return this.remindMeLaterEnabled&&!this.errorState?this.esTranslate.instant(this.resources.strings.discovery_setting_promo_btn_remind_later):this.esTranslate.instant(this.resources.strings.discovery_setting_promo_btn_cancel)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"primaryButtonText",{get:function(){return this.esTranslate.instant(this.resources.strings.discovery_setting_promo_btn_make_discoverable)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"primaryButtonLabel",{get:function(){return this.context.isSuccess?" ":this.context.isPending?this.esTranslate.instant(this.resources.strings.discovery_setting_promo_btn_pending):this.hideCheckboxes?this.esTranslate.instant(this.resources.strings.discovery_setting_promo_btn_make_discoverable_single,{teamName:"teamName"},{teamName:this.context.discoverySettings[0].team.displayName}):this.primaryButtonText},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"errorState",{get:function(){return this.context.erroredSettings&&this.context.erroredSettings.length>0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"errorText",{get:function(){return this.context.erroredSettings?this.context.isPending?this.esTranslate.instant(this.resources.strings.discovery_setting_promo_error_retrying):1===this.context.erroredSettings.length?this.esTranslate.instant(this.resources.strings.discovery_setting_promo_error_single,{teamCount:"teamCount"},{teamCount:this.context.erroredSettings.length}):this.esTranslate.instant(this.resources.strings.discovery_setting_promo_error_plural,{teamCount:"teamCount"},{teamCount:this.context.erroredSettings.length}):""},enumerable:!0,configurable:!0}),t.prototype.bulkOperation=function(){this.clickedCount==this.context.discoverySettings.length?this.unselectAll():this.selectAll()},t.prototype.selectAll=function(){this.context.discoverySettings.forEach(function(t){t.isDiscoverable=!0}),this.clickedCount=this.context.discoverySettings.length,this.ariaLiveService.update(this.esTranslate.instant(this.resources.strings.discovery_setting_promo_selected_all_announcement))},t.prototype.unselectAll=function(){this.context.discoverySettings.forEach(function(t){t.isDiscoverable=!1}),this.clickedCount=0,this.ariaLiveService.update(this.esTranslate.instant(this.resources.strings.discovery_setting_promo_unselected_all_announcement))},t.prototype.handleToggleSetting=function(t){t.isDiscoverable?this.clickedCount++:this.clickedCount--},t.prototype.generateSettingTrackConstants=function(t){var e=!t.isDiscoverable;return{trackScenario:e?teamspace.components.PanelActionScenario.selected:teamspace.components.PanelActionScenario.unselected,trackName:teamspace.components.PanelModuleName.reviewTeamDiscoverySettings,trackType:teamspace.components.PanelModuleType.checkbox,trackSummary:e?"Team selected in ReviewTeamDiscoverySettings":"Team unselected in ReviewTeamDiscoverySettings",trackOutcome:e?teamspace.components.PanelActionOutcome.checked:teamspace.components.PanelActionOutcome.unchecked,trackData:{count:this.context.discoverySettings.length,clickCount:e?this.clickedCount+1:this.clickedCount-1,teamId:t.team.objectId}}},t.prototype.tryAgain=function(){this.context.discoverySettings.forEach(function(t){t.retryFailed=!1}),this.updateDiscoverySettingsActionHandler.handleAction(this.context.dialogCtrl)},t.prototype.onFocusOnSecondaryButton=function(){if(!this.didFocusOnSecondaryButton){var t=this.hideCheckboxes?angular.element("#btn-make-discoverable")[0]:angular.element(".es-discovery-settings .app-checkbox--input")[0];t&&t.focus(),this.didFocusOnSecondaryButton=!0}},t.prototype.dismissDialog=function(){var t=this.remindMeLaterEnabled&&!this.errorState;this.sendTelemetryEvent(teamspace.components.PanelActionOutcome.closeDialog,t?teamspace.components.PanelActionScenario.remindMeLater:teamspace.components.PanelActionScenario.cancel,teamspace.components.PanelModuleName.reviewTeamDiscoverySettings,t?"Remind me Later selected for ReviewTeamDiscoverySettings":"ReviewTeamDiscoverySettings cancelled",{count:this.context.discoverySettings.length}),this.context.dialogCtrl.close()},t.prototype.updateSettings=function(){this.sendTelemetryEvent(teamspace.components.PanelActionOutcome.submit,teamspace.components.PanelActionScenario.makeDiscoverable,teamspace.components.PanelModuleName.reviewTeamDiscoverySettings,"Make Discoverable selected for ReviewTeamDiscoverySettings",{count:this.clickedCount}),this.updateDiscoverySettingsActionHandler.handleAction(this.context.dialogCtrl)},t.prototype.handleError=function(){var t=this.context.erroredSettings?this.context.erroredSettings.length:0;this.sendTelemetryEvent(teamspace.components.PanelActionOutcome.show,teamspace.components.PanelActionScenario.error,teamspace.components.PanelModuleName.errorReviewTeamDiscoverySettings,"ReviewTeamDiscoverySettings update failed",{count:t}),this.ariaLiveService.update(this.errorText,!0)},t.prototype.handleSuccess=function(){var t=this,e=this.context.erroredSettings?this.context.erroredSettings.length:0,n=this.clickedCount-e;this.sendTelemetryEvent(teamspace.components.PanelActionOutcome.closeDialog,teamspace.components.PanelActionScenario.success,teamspace.components.PanelModuleName.successReviewTeamDiscoverySettings,"ReviewTeamDiscoverySettings update successful",{count:n}),this.ariaLiveService.update(this.esTranslate.instant(this.resources.strings.discovery_setting_promo_success_title),!0),setTimeout(function(){t.context.dialogCtrl.close()},3e3)},t.prototype.sendOpenEvent=function(){this.sendTelemetryEvent(teamspace.components.PanelActionOutcome.openDialog,teamspace.components.PanelActionScenario.openDiscoverySettingDialog,teamspace.components.PanelModuleName.reviewTeamDiscoverySettings,"Appearance of review team discovery settings pop up",{count:this.context.discoverySettings.length},void 0,this.remindMeLaterEnabled?"ZeroReminder":"FirstReminder")},t.prototype.sendTelemetryEvent=function(t,e,n,o,s,i,a){var r={panel:{type:teamspace.PanelType[teamspace.PanelType.engagementSurfaceDialog]},action:{gesture:teamspace.components.PanelActionGesture[teamspace.components.PanelActionGesture.click],outcome:teamspace.components.PanelActionOutcome[t],scenario:teamspace.shared.AttributeHelper.tryGetEnum(e.toString(),teamspace.components.PanelActionScenario,this.logger)},module:{name:teamspace.components.PanelModuleName[n],type:teamspace.components.PanelModuleType[teamspace.components.PanelModuleType.discoverySettingsDialog],summary:o}};s&&(r.dataBag=s),i&&(r.team=i),a&&(r.module.state=a),this.analyticsService.sendPanelAction(r)},t}();e.EngagementSurfaceDiscoverySettingsControl=s,angular.module("teamspace.engagementSurfaceDiscoverySettingsControl",["teamspace.esTranslate","teamspace.loggingService","teamspace.locales","teamspace.constants","teamspace.settingsService","teamspace.utilityService","teamspace.esActionHandler","teamspace.channelTeamSortHelper"]).component("engagementSurfaceUicontrolDiscoverySettings",{bindings:{context:"<"},template:o,controller:s})},2234:function(t,e){t.exports='<div class="es-discovery-settings" data-tid="es-discovery-settings" role="dialog" aria-labelledby="ds-title" aria-describedby="ds-description">\n\n  \x3c!-- Text --\x3e\n  <span ng-if="!$ctrl.context.isSuccess" id="ds-title" class="ds-title app-font-title2-bold" ng-bind="$ctrl.title"></span>\n\n  <p class="es-text" ng-if="!$ctrl.errorState && !$ctrl.context.isSuccess">\n    <span id="ds-description" ng-bind-html="::$ctrl.trustAsHtml($ctrl.description)"></span>\n    <a href="{{::$ctrl.learnMoreLink}}" target="_blank" translate-once="{{::$root.resources.strings.discovery_setting_promo_learn_more}}"></a>\n  </p>\n\n  \x3c!-- Loading indicator --\x3e\n  <div ng-if="$ctrl.context.isLoading" class="centered-container">\n    <busy-animation size="medium"></busy-animation>\n  </div>\n\n  <div ng-if="$ctrl.context.isSuccess" class="centered-container success-container">\n    <ng-include src="\'svg/icons-accept.html\'"></ng-include>\n    <span class="ds-title ds-success-title app-font-title2-bold" translate-once="{{::$root.resources.strings.discovery_setting_promo_success_title}}"></span>\n  </div>\n\n  \x3c!-- Team list --\x3e\n  <div ng-if="!$ctrl.context.isLoading && !$ctrl.errorState && !$ctrl.context.isSuccess" class="teams-list-container">\n    <div ng-if="!$ctrl.hideCheckboxes" class="teams-list-header">\n      <span id="team-name-header" class="team-name-header">Your private teams</span>\n      <a class="team-setting-header" href="#" ng-click="$ctrl.bulkOperation()" role="button" aria-describedby="team-name-header" track-scenario="{{$ctrl.clickedCount != $ctrl.context.discoverySettings.length ? $root.trackConstants.trackScenario.selectAllClicked : $root.trackConstants.trackScenario.unselectAllClicked}}" track-outcome="{{$ctrl.clickedCount != $ctrl.context.discoverySettings.length ? $root.trackConstants.trackOutcome.checked : $root.trackConstants.trackOutcome.unchecked}}" track-name="{{::$root.trackConstants.trackModuleName.reviewTeamDiscoverySettings}}" track-type="{{::$root.trackConstants.trackType.button}}" track-data="{count: $ctrl.context.discoverySettings.length}" track-summary="{{$ctrl.clickedCount != $ctrl.context.discoverySettings.length ? \'Select all clicked for ReviewTeamDiscoverySettings\' : \'Unselect all clicked for ReviewTeamDiscoverySettings\'}}" ng-bind="$ctrl.bulkOperationButtonText"></a>\n    </div>\n    <div ng-class="{\'teams-list-overflow-shadow\': $ctrl.context.discoverySettings.length > 10}" simple-scrollbar>\n      <ul class="teams-list">\n        <li ng-repeat="discoverySetting in $ctrl.context.discoverySettings track by $index" class="teams-list-item">\n          <profile-picture css-class="team-icon" class="team-profile-pic" title="{{::discoverySetting.team.displayName}}" display-name="discoverySetting.team.displayName" team-id="discoverySetting.team.siteInfo.groupId" etag="discoverySetting.team.pictureETag" aria-hidden="true" retain-in-cache="true" source="engagement-surface-uicontrol-discovery-settings">\n          </profile-picture>\n          <span ng-if="$ctrl.hideCheckboxes" class="team-displayname">{{::discoverySetting.team.displayName}}</span>\n          <teams-checkbox ng-if="!$ctrl.hideCheckboxes" class="team-setting-checkbox" on-click="$ctrl.handleToggleSetting(discoverySetting)" ng-model="discoverySetting.isDiscoverable" swap-order="true" is-disabled="$ctrl.context.isPending" generate-track-constants-function="$ctrl.generateSettingTrackConstants(discoverySetting)" label-text="{{::discoverySetting.team.displayName}}" narrator-text="{{::discoverySetting.team.displayName}}">\n          </teams-checkbox>\n        </li>\n      </ul>\n    </div>\n  </div>\n\n  \x3c!-- Team list (error state) --\x3e\n  <div ng-if="$ctrl.errorState && !$ctrl.context.isSuccess" class="teams-list-container">\n      <div class="teams-list-header error-list-header">\n        <span id="ds-error-text" ng-bind="$ctrl.errorText"></span>\n        <a id="ds-try-again" class="inline-link" href="#" ng-click="$ctrl.tryAgain()" role="button" acc-role="focus-default" aria-describedby="ds-error-text" track-scenario="{{::$root.trackConstants.trackScenario.tryAgain}}" track-outcome="{{::$root.trackConstants.trackOutcome.submit}}" track-name="{{::$root.trackConstants.trackModuleName.reviewTeamDiscoverySettings}}" track-type="{{::$root.trackConstants.trackType.button}}" track-data="{count: $ctrl.context.erroredSettings.length}" track-summary="Try again clicked for ReviewTeamDiscoverySettings" translate-once="{{::$root.resources.strings.discovery_setting_promo_error_try_again}}"></a>\n      </div>\n      <div ng-class="{\'teams-list-overflow-shadow\': $ctrl.context.erroredSettings.length > 10}" simple-scrollbar>\n        <ul class="teams-list">\n          <li ng-repeat="discoverySetting in $ctrl.context.erroredSettings track by $index" class="teams-list-item">\n            <profile-picture css-class="team-icon" class="team-profile-pic" title="{{::discoverySetting.team.displayName}}" display-name="discoverySetting.team.displayName" team-id="discoverySetting.team.siteInfo.groupId" etag="discoverySetting.team.pictureETag" aria-hidden="true" retain-in-cache="true" source="engagement-surface-uicontrol-discovery-settings">\n            </profile-picture>\n            <span class="team-displayname">{{::discoverySetting.team.displayName}}</span>\n            <div class="error-status-wrapper">\n                <ng-include ng-if="discoverySetting.retryFailed" class="error-icon" src="\'svg/icons-call-alert.html\'"></ng-include>\n                <busy-animation ng-if="!discoverySetting.retryFailed && $ctrl.context.isPending" size="small"></busy-animation>\n            </div>\n          </li>\n        </ul>\n      </div>\n    </div>\n\n  \x3c!-- Buttons --\x3e\n  <div ng-if="!$ctrl.context.isLoading && !$ctrl.context.isSuccess" class="buttons-container">\n    <button type="button" class="ts-btn ts-btn-secondary shadow-level-1" ng-click="$ctrl.dismissDialog()" ng-focus="$ctrl.onFocusOnSecondaryButton()" track-click-silent="true" aria-labelledby="secondary-btn-text">\n      <span id="secondary-btn-text" class="btn-text" ng-bind="$ctrl.secondaryButtonText"></span>\n    </button>\n    <button ng-if="!$ctrl.errorState" type="button" id="btn-make-discoverable" class="ts-btn ts-btn-primary shadow-level-1" ng-click="$ctrl.updateSettings()" ng-disabled="$ctrl.clickedCount == 0" track-click-silent="true" aria-label="{{::$ctrl.primaryButtonLabel}}" aria-describedby="{{$ctrl.context.isPending ? \'\' : \'ds-description\'}}">\n      <busy-animation aria-hidden="true" size="small" ng-if="$ctrl.context.isPending"></busy-animation>\n      <span aria-hidden="true" class="btn-text" ng-if="!$ctrl.context.isPending" ng-bind="$ctrl.primaryButtonText"></span>\n    </button>\n  </div>\n</div>'},2235:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(2236),s=function(){function t(t,e,n){var o=n.getFileExtension(this.src).toLowerCase(),s=_.indexOf(e.fileExtensions.html,o)>=0;this.control=this.context.control,this.src=this.control.src,this.altText=t.instant(this.control.resxKey,this.control.resxParams,this.context.context),this.cssClass=[this.control.background,this.control.customClass,s?"es-html":"es-image"],this.width=this.control.width,this.height=this.control.height}return t.$inject=["esTranslate","constants","utilityService"],t}();e.EngagementSurfaceImageControl=s,angular.module("teamspace.engagementSurfaceImageControl",["teamspace.esTranslate","teamspace.utilityService","teamspace.constants"]).component("engagementSurfaceUicontrolImage",{bindings:{context:"<"},template:o,controller:s})},2236:function(t,e){t.exports='<render-image src="::$ctrl.src" css-class="::$ctrl.cssClass" alt="::$ctrl.altText" width="::$ctrl.width" height="::$ctrl.height">\n</render-image>'},2237:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(2238),s=function(){function t(t,e,n,o,s){this.constants=e,this.settingsService=s,this.control=this.context.control;var i=this.control.removeDefaultMargin?"remove-default-margin":"";this.cssClass=[this.control.background,this.control.align,i];var a=o.getLocale(),r=e.growth.engagementSurfaces.mobileUpsell.badge.apple,c=e.growth.engagementSurfaces.mobileUpsell.badge.google,l=e.growth.engagementSurfaces.mobileUpsell.badge.microsoft;this.badges=[{display:!0,src:this.getBadgeLink(r,a),fallbackSrc:this.getBadgeLink(r),href:e.growth.engagementSurfaces.mobileUpsell.iOSLink,alt:t.instant(n.strings.mobile_upsell_ios_alt_text),trackSummaryName:r},{display:!0,src:this.getBadgeLink(c,a),fallbackSrc:this.getBadgeLink(c),href:e.growth.engagementSurfaces.mobileUpsell.androidLink,alt:t.instant(n.strings.mobile_upsell_android_alt_text),trackSummaryName:c},{display:!1,src:this.getBadgeLink(l,a),fallbackSrc:this.getBadgeLink(l),href:e.growth.engagementSurfaces.mobileUpsell.windowsPhoneLink,alt:t.instant(n.strings.mobile_upsell_windows_phone_alt_text),trackSummaryName:l}]}return t.$inject=["esTranslate","constants","resources","localizationService","settingsService"],t.prototype.getBadgeLink=function(t,e){return void 0===e&&(e="en-us"),""+this.settingsService.getStaticsUri()+this.constants.growth.engagementSurfaces.mobileUpsell.mobileDownloadCdnRelativeBase+e+"/"+t+".png"},t}();e.EngagementSurfaceMobileBadgesControl=s,angular.module("teamspace.engagementSurfaceMobileBadgesControl",["teamspace.esTranslate","teamspace.constants","teamspace.locales","teamspace.localizationService","teamspace.settingsService"]).component("engagementSurfaceUicontrolMobileBadges",{bindings:{context:"<?"},template:o,controller:s})},2238:function(t,e){t.exports='<div class="es-mobile-badges" ng-class="::$ctrl.cssClass">\n  \x3c!-- empty ng-click is required for keyboard navigation in accessibility --\x3e\n  <a class="mobile-badge-link" ng-repeat="badge in $ctrl.badges track by $index" ng-if="badge.display" ng-href="{{::badge.href}}" track-outcome="{{::$root.trackConstants.trackOutcome.nav}}" track-scenario="{{::$root.trackConstants.trackScenario.engagementSurfaceDialogButton}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.engagementSurface}}" track-name="{{::$root.trackConstants.trackModuleName.button}}" track-type="{{::$root.trackConstants.trackType.button}}" track-summary="Click on mobile download badge {{::badge.trackSummaryName}}" track-data="{ id: \'{{$ctrl.context.id}}\',\n                   treatment: \'{{$ctrl.context.treatment}}\' }" target="_blank" ng-click="">\n    <img ng-src="{{::badge.src}}" fallback-src="{{::badge.fallbackSrc}}" ng-attr-alt="{{::badge.alt}}">\n  </a>\n</div>'},2239:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(2240),s=n(8),i=function(){function t(t,e){if(this.logger=t.newLogger("EngagementSurfaceTextControl"),this.control=this.context.control,s.IsUserInterfaceControlText(this.context.control)){this.text=e.instant(this.context.control.resxKey,this.context.control.resxParams,this.context.context);var n=this.context.control.removeDefaultMargin?"remove-default-margin":"";this.cssClass=[this.context.control.size,this.context.control.weight,this.context.control.align,this.context.control.padding,this.context.control.background,n]}else{var o=(this.context.control||{}).type;this.logger.error("unknown control: "+o+". Make sure constants.growth.engagementSurfaces.uiControls has been updated!")}}return t.$inject=["esLogger","esTranslate"],t}();e.EngagementSurfaceTextControl=i,angular.module("teamspace.engagementSurfaceTextControl",["teamspace.esTranslate","teamspace.esLogger"]).component("engagementSurfaceUicontrolText",{bindings:{context:"<"},template:o,controller:i})},2240:function(t,e){t.exports='<p class="es-text" ng-class="::$ctrl.cssClass" ng-bind-html="::$ctrl.text"></p>'},2241:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(2242),s=function(){return function(){this.style={height:this.context.control.height||"0"}}}();e.EngagementSurfaceSpaceControl=s,angular.module("teamspace.engagementSurfaceSpaceControl",[]).component("engagementSurfaceUicontrolSpace",{bindings:{context:"<"},template:o,controller:s})},2242:function(t,e){t.exports='<div class="es-space" ng-style="::$ctrl.style"></div>'},2243:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(2244),s=function(){function t(t){this.control=this.context.control,this.url=this.control.url,this.linkText=t.instant(this.control.resxKey,this.control.resxParams,this.context.context),this.postText=this.control.postResxKey?t.instant(this.control.postResxKey):void 0,this.preText=this.control.preResxKey?t.instant(this.control.preResxKey):void 0,this.cssClass=[this.control.size,this.control.weight,this.control.align,this.control.padding,this.control.background]}return t.$inject=["esTranslate"],t}();e.EngagementSurfaceLinkControl=s,angular.module("teamspace.engagementSurfaceLinkControl",["teamspace.esTranslate"]).component("engagementSurfaceUicontrolLink",{bindings:{context:"<"},template:o,controller:s})},2244:function(t,e){t.exports='<div class="es-link">\n  <span ng-if="::$ctrl.preText" ng-class="::$ctrl.cssClass">{{::$ctrl.preText}}</span>\n  <a ng-class="::$ctrl.cssClass" ng-click="" href="{{::$ctrl.url}}" target="_blank" track-outcome="{{::$root.trackConstants.trackOutcome.nav}}" track-scenario="{{::$root.trackConstants.trackScenario.engagementSurfaceSendLink}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.engagementSurface}}" track-name="{{::$root.trackConstants.trackModuleName.linkViewButton}}" track-type="{{::$root.trackConstants.trackType.link}}" track-data="{ id: \'{{$ctrl.context.id}}\',\n                   treatment: \'{{$ctrl.context.treatment}}\' }">{{::$ctrl.linkText}}</a>\n  <span ng-if="::$ctrl.postText" ng-class="::$ctrl.cssClass">{{::$ctrl.postText}}</span>\n</div>\n\n'},2245:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(2246),s=function(){function t(t,e){this.control=this.context.control,this.text=t.instant(this.control.resxKey,this.control.resxParams,this.context.context),this.tooltip=e.actionTitle(this.control.actionKey),this.biActionKey=e.parseActionKey(this.control.actionKey).key}return t.$inject=["esTranslate","esActionHandler"],t.prototype.onClick=function(){this.context.dialogCtrl.onButtonClick(this.control.actionKey)},t}();e.EngagementSurfaceContentButtonControl=s,angular.module("teamspace.engagementSurfaceContentButtonControl",["teamspace.esTranslate","teamspace.esActionHandler"]).component("engagementSurfaceUicontrolContentButton",{bindings:{context:"<"},template:o,controller:s})},2246:function(t,e){t.exports='<button class="es-content-button ts-btn" ng-class="::{\'ts-btn-secondary\': !$ctrl.control.isPrimary,\n                   \'ts-btn-primary inset-border\': $ctrl.control.isPrimary}" ng-attr-title="{{::$ctrl.tooltip}}" ng-click="$ctrl.onClick()" track-outcome="{{::$root.trackConstants.trackOutcome.openDialog}}" track-scenario="{{::$root.trackConstants.trackScenario.engagementSurfaceDialogButton}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.engagementSurface}}" track-name="{{::$root.trackConstants.trackModuleName.button}}" track-type="{{::$root.trackConstants.trackType.button}}" track-data="{ id: \'{{$ctrl.context.id}}\',\n                      treatment: \'{{$ctrl.context.treatment}}\',\n                      isPrimary: \'{{$ctrl.control.isPrimary}}\',\n                      actionKey: \'{{$ctrl.biActionKey}}\' }">{{::$ctrl.text}}</button>'},2247:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(2248),s=function(){function t(t,e,n,o,s,i){this.$scope=t,this.utilityService=e,this.tooltipService=n,this.settingsService=o,this.constants=s,this.control=this.context.control,this.title=i.instant(this.control.resxKey,this.control.resxParams,this.context.context),this.link=i.instant(this.control.linkContent,this.control.linkContentParams,this.context.context),this.copyLinkIcon=this.control.icon,this.linkCopied=!1,this.cssClass=this.control.cssClass,this.joinLinkTooltipId=e.generateUUID(),this.joinLinkTooltipText=i.instant(this.control.tooltipContent,this.control.tooltipContentParams,this.context.context)}return t.$inject=["$scope","utilityService","tooltipService","settingsService","constants","esTranslate"],t.prototype.copyLink=function(){this.utilityService.copyToClipboard(this.link),this.title=this.control.copiedText,this.copyLinkIcon=this.control.copiedIcon,this.linkCopied=!0},t.prototype.showJoinLinkInfoTooltip=function(t,e){if(e){var n={templateUrl:"components/freemium/invitation-wizard-dialog/invitation-wizard-dialog-join-link-tooltip.html",trigger:"manual",container:"body",placement:"right",autoClose:!0,scope:this.$scope,content:this.joinLinkTooltipText},o={sourceElement:angular.element(t.currentTarget),tooltipType:teamspace.services.TooltipType.Popover,options:n,tooltipId:this.joinLinkTooltipId};this.tooltipService.showTooltip(o)}else this.tooltipService.clearTooltip(teamspace.services.TooltipType.Popover,this.joinLinkTooltipId)},t.prototype.isOneClickJoinEcsEnabled=function(){return this.settingsService.valueAsBoolean(this.constants.settings.names.enableOneClickJoin)},t}();e.EngagementSurfaceCopyLinkButtonControl=s,angular.module("teamspace.engagementSurfaceCopyLinkButtonControl",["teamspace.esTranslate","teamspace.utilityService","teamspace.tooltipService","teamspace.settingsService","teamspace.constants"]).component("engagementSurfaceUicontrolCopyLinkButton",{bindings:{context:"<"},template:o,controller:s})},2248:function(t,e){t.exports='<button ng-class="::$ctrl.cssClass" ng-click="$ctrl.copyLink()" track-gesture="{{::$root.trackConstants.trackGesture.click}}" track-outcome="{{::$root.trackConstants.trackOutcome.openDialog}}" track-scenario="{{::$root.trackConstants.trackScenario.engagementSurfaceDialogButton}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.engagementSurface}}" track-name="{{::$root.trackConstants.trackModuleName.button}}" track-type="{{::$root.trackConstants.trackType.button}}" track-data="{ id: \'{{$ctrl.context.id}}\',\n                      treatment: \'{{$ctrl.context.treatment}}\'}">\n  <ng-include class="icon icons-default-fill" src="$ctrl.copyLinkIcon" ng-class="{ \'copied\': $ctrl.linkCopied }"/>\n  <div class="title-container">\n    <div class="copy-button-title">\n          <span translate="{{$ctrl.title}}"></span>\n          <span class="tooltip-icon-container" ng-if="$ctrl.isOneClickJoinEcsEnabled()" tabindex="0" ng-click="$ctrl.showJoinLinkInfoTooltip($event, true)" ng-focus="$ctrl.showJoinLinkInfoTooltip($event, true)" ng-blur="$ctrl.showJoinLinkInfoTooltip($event, false)" ng-mouseenter="$ctrl.showJoinLinkInfoTooltip($event, true)" ng-mouseleave="$ctrl.showJoinLinkInfoTooltip($event, false)" data-prevent-refocus="true" role="text">\n              <ng-include class="icon" src="\'svg/icons-info.html\'"></ng-include>\n          </span>\n    </div>\n    <div class="copy-link-text">{{$ctrl.link}}</div>\n  </div>\n</button>'},2249:function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0});var s=n(2250),i=function(t){function e(e,n,o,s,i,a,r,c,l,d,u,p,g){var m=t.call(this,e,n,o,s,i,a,r,c,l,d,u,p,g)||this;return m.$q=e,m.$scope=n,m.$translate=o,m.authenticationService=s,m.constants=i,m.ariaLiveService=a,m.loggingService=r,m.peopleService=c,m.resources=l,m.utilityService=d,m.Upload=u,m.settingsService=p,m.analyticsService=g,m.context.onSave=m.onSave.bind(m),m.isFre=!0,m.saveButtonControl={type:"button",actionKey:i.growth.engagementSurfaces.actionKey.updateUserProfile,resxKey:l.strings.update_user_profile_fre_next,isPrimary:!0,disabled:!c.isValidName(m.currentUserDisplayName)},m.skipButtonControl={type:"button",resxKey:l.strings.update_user_profile_skip,isPrimary:!1,disabled:!1},m.context.dialogCtrl.updateButtonControls([m.saveButtonControl]),m}return o(e,t),e.$inject=["$q","$scope","$translate","authenticationService","constants","ariaLiveService","loggingService","peopleService","resources","utilityService","Upload","settingsService","analyticsService"],Object.defineProperty(e.prototype,"uploadButtonText",{get:function(){return this.resources.strings.user_profile_picture_upload_fre},enumerable:!0,configurable:!0}),e.prototype.evaluateSaveBtnState=function(){var t=this;_(this.context.dialogCtrl.footerButtons).filter(function(t){return t.dataBag.isPrimary}).forEach(function(e){return e.disabled=!t.peopleService.isValidName(t.currentUserDisplayName)})},e.prototype.close=function(){this.userPictureContext.close(),this.context.dialogCtrl.close()},e.prototype.displaySkipAndSaveButton=function(){this.saveButtonControl&&this.skipButtonControl&&(this.saveButtonControl.resxKey=this.resources.strings.update_user_profile_fre_retry,this.context.dialogCtrl.updateButtonControls([this.skipButtonControl,this.saveButtonControl]))},e}(n(126).UpdateUserProfileController);e.EngagementSurfaceUpdateUserProfileControl=i,angular.module("teamspace.engagementSurfaceUpdateUserProfileControl",["ngFileUpload","pascalprecht.translate","teamspace.locales","teamspace.authenticationService","teamspace.constants","teamspace.loggingService","teamspace.peopleService","teamspace.dialogService","teamspace.utilityService","teamspace.settingsService","teamspace.ariaLiveService","teamspace.analyticsService"]).component("engagementSurfaceUicontrolUpdateUserProfile",{bindings:{context:"<"},template:s,controller:i})},2250:function(t,e){t.exports='<div class="es-update-user-profile update-user-profile-dialog">\n  <div class="name-container">\n    <section class="name-input-field">\n      <label id="uupcDisplayNameLabel" for="displayname" class="form-field-title">\n             {{::$ctrl.displayNameFieldTitle}}\n      </label>\n      <div class="form-field-container">\n        <input sanitized type="text" id="displayname" aria-labelledby="uupcDisplayNameLabel" data-tid="updateUserProfile-displayNameInputField" ng-model="$ctrl.currentUserDisplayName" ng-change="$ctrl.evaluateSaveBtnState()"/>\n        <busy-animation class="update-name-indicator update-name" ng-if="$ctrl.isUpdatingName" size="small" context="update-user-display-name"></busy-animation>\n        <ng-include class="update-name-indicator icon green-svg" ng-if="$ctrl.showDisplayNameChangeSuccess" src="\'svg/icons-accept.html\'"></ng-include>\n      </div>\n    </section>\n  </div>\n  <div class="error-container" ng-if="$ctrl.updateNameErrorMessage" aria-live="assertive" role="alert">\n       {{$ctrl.updateNameErrorMessage}}\n  </div>\n  <div class="update-user-profile-content" ng-if="::$ctrl.enableFreUploadPicture">\n    <div class="image-container">\n      <div ng-if="!$ctrl.isUploadingPicture" class="profile-img-parent medium-image-size">\n        <profile-picture ng-if="!$ctrl.newPhoto" css-class="image-mask" principal-name="::$ctrl.currentUserUpn" display-name="::$ctrl.currentUserDisplayName" size="::$ctrl.constants.profilePictureSizes.large" source="change-user-picture"></profile-picture>\n        <div ngf-background="$ctrl.newPhoto" ng-if="$ctrl.newPhoto" class="image-mask medium-image-size"></div>\n      </div>\n      <busy-animation class="change-picture" ng-if="$ctrl.isUploadingPicture" size="medium" context="upload-profile-picture"></busy-animation>\n    </div>\n    <div class="buttons-container">\n      <button class="btn btn-default app-icons-fill-focus action-button" data-tid="updateUserProfile-uploadPictureBtn" ngf-model-invalid="$ctrl.invalidFile" ngf-dimensions="{{::$ctrl.profilePictureNgfParams.dimensions}}" ngf-max-size="{{::$ctrl.profilePictureNgfParams.maxSize}}" ngf-select="$ctrl.uploadPhoto($file)" ng-model="$ctrl.newPhoto" ng-disabled="$ctrl.uploadButton.disabled" ngf-pattern="\'{{::$ctrl.profilePictureNgfParams.profilePicturePattern}}\'" accept="{{::$ctrl.profilePictureNgfParams.profilePictureAccept}}" aria-labelledby="{{::$ctrl.uploadButton.id}}">\n        \x3c!-- Required for flexbox to work on Firefox --\x3e\n        <div class="update-user-picture-item-container">\n          <ng-include class="ts-sym" src="\'svg/icons-files-upload.html\'"></ng-include>\n          <div id="{{::$ctrl.uploadButton.id}}" class="action-button-text" translate-once="{{::$ctrl.uploadButtonText}}"></div>\n        </div>\n      </button>\n      <div class="error-container error-message-container" ng-if="$ctrl.uploadPictureErrorMessage" aria-live="assertive" role="alert">\n        {{$ctrl.uploadPictureErrorMessage}}\n      </div>\n    </div>\n  </div>\n</div>\n'},2251:function(t,e,n){"use strict";var o=this&&this.__assign||function(){return(o=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++){e=arguments[n];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])}return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var s=n(2252),i=function(){function t(t,e,n,o,s,i,a,r,c,l,d,u,p,g){var m=this;this.$q=t,this.$rootScope=e,this.loggingService=o,this.constants=s,this.settingsService=i,this.analyticsService=a,this.localizationService=r,this.ariaLiveService=c,this.resources=l,this.esTranslate=d,this.appStateService=u,this.lazyLoadService=p,this.placeholderId="ts-one-player-container",this.autoCloseDefaults={videoStatusCheckIntervalInMs:5e3,videoStatusCheckMaxTime:6,videoStalledTimeoutInMs:1e4},this.verboseLoggingDefaults={enableMediaEventsLogging:!1,enableDebugLogging:!1},this.initialized=!1,this.videoEnded=!1,this.videoPaused=!1,this.currentVideoCheckpoint=0,this.mediaEvents=[],this.videoStatusCheckCount=0,this.showButtons=!1,this.videoReady=!1,this.showCloseButton=!1,this.showReplayButton=!1,this.isInteractive=!0,this.control=this.context.control,this.videoId=this.getVideoId(this.control.videoIds),this.logger=g.newLogger("EngagementSurfaceVideoControl"),this.videoLoadScenario=o.newScenario(s.scenarios.firstRun.freVideoLoad),this.videoLoadScenario.cancelIfOffline=!0,this.videoLoadScenario.appendEventData({videoId:this.videoId,id:this.context.id,treatment:this.context.treatment}),this.videoLoadScenario.mark("Video_dialog_showed"),this.playerEventListener=function(t){return m.playerEventCallback(t)},this.videoId?(n.$on("$destroy",function(){m.destroy()}),this.loadScript().then(function(){try{m.logLoadStep("Video_library_loaded"),m.showCloseButton=!!m.control.showCloseButton,m.showReplayButton=!!m.control.showReplayButton,m.isInteractive=!!m.control.isInteractive,m.control.autoCloseOptions=_.merge({},m.autoCloseDefaults,m.control.autoCloseOptions),m.control.verboseLoggingOptions=_.merge({},m.verboseLoggingDefaults,m.control.verboseLoggingOptions),m.loadVideo()}catch(t){m.logErrorAndClose("Exception from render() function",t)}}).catch(function(t){m.logErrorAndClose("Load script error",t)}),this.checkVideoStatus()):this.logErrorAndClose("Video id is not valid")}return t.$inject=["$q","$rootScope","$scope","loggingService","constants","settingsService","analyticsService","localizationService","ariaLiveService","resources","esTranslate","appStateService","lazyLoadService","esLogger"],t.prototype.getVideoId=function(t){if(t){var e=this.localizationService.getSupportedVideoLocale(this.localizationService.getLocale(),t,null);return e&&t[e]}return null},t.prototype.loadScript=function(){var t=this;if(window.MsOnePlayer)return this.$q.resolve();var e=this.$q.defer();return this.onePlayerJsUrl=this.settingsService.valueFor(this.constants.settings.names.onePlayerJsUrl),this.lazyLoadService.loadFromUrl("MsOnePlayer",this.onePlayerJsUrl).then(function(){if(window.MsOnePlayer)e.resolve();else{var n="MsOnePlayer not defined after loading OnePlayer library.";t.logger.error(n),e.reject(n)}}).catch(function(n){t.logger.error("Failed to load one player script from "+t.onePlayerJsUrl+". Error: "+JSON.stringify(n)+"."),e.reject(n)}),e.promise},t.prototype.loadVideo=function(){var t=this,e={options:{autoplay:!!this.control.autoPlay,mute:!!this.control.mute,controls:!!this.control.showPlayerControls,showEndImage:!!this.control.showEndImage},metadata:{videoId:this.videoId}};window.MsOnePlayer.render(this.placeholderId,e,function(e){e?(t.onePlayer=e,t.logLoadStep("Video_player_loaded"),e.addPlayerEventListener(t.playerEventListener)):t.logErrorAndClose("Player is undefined")})},t.prototype.checkVideoStatus=function(){var t=this;this.videoStatusCheckIntervalVar=setInterval(function(){!t.videoReady&&t.videoStatusCheckCount++<t.control.autoCloseOptions.videoStatusCheckMaxTime?(t.logLoadStep("Video_stillloading"),t.logMediaEvents("ESP video still loading")):(t.videoStatusCheckIntervalVar&&(clearInterval(t.videoStatusCheckIntervalVar),t.videoStatusCheckIntervalVar=void 0),t.videoReady||t.logErrorAndClose("Video still not playing"))},this.control.autoCloseOptions.videoStatusCheckIntervalInMs)},t.prototype.initialize=function(){var t=this;this.initialized||(this.initialized=!0,this.videoReady=!0,this.$rootScope.$apply(),this.videoDuration=this.onePlayer.getDuration(),this.videoLoadScenario.stop(),this.sendVideoTelemetry(teamspace.components.PanelActionGesture.asyncStateChange,teamspace.components.PanelActionOutcome.videoStart)),angular.element("body .ngdialog-overlay").on("click",function(){t.sendVideoTelemetry(teamspace.components.PanelActionGesture.click,teamspace.components.PanelActionOutcome.clickOutsideVideo,{videoPercent:t.videoPercent})}),angular.element("#engagement-surface-dialog #ts-es-video-player-overlay").on("contextmenu",function(t){t.preventDefault()})},t.prototype.playerEventCallback=function(t){if(this.control.verboseLoggingOptions.enableMediaEventsLogging&&t&&"timeupdate"!=t.name&&this.mediaEvents.push(t),t&&t.name)switch(t.name){case"playing":this.initialize(),this.onVideoPlaying();break;case"ended":this.onVideoEnded();break;case"pause":this.onVideoPause();break;case"ContentCheckpoint":this.onVideoCheckpoint(t);break;case"loadstart":case"loadedmetadata":case"loadeddata":this.onVideoLoad(t);break;case"error":case"ContentError":case"PlayerError":this.onVideoError(t);break;case"stalled":this.onVideoStalled()}this.control.verboseLoggingOptions.enableDebugLogging&&console.log("ESP video event: "+JSON.stringify(t))},t.prototype.unregisterEvents=function(){this.onePlayer&&this.onePlayer.removePlayerEventListener(this.playerEventListener)},t.prototype.onVideoPause=function(){this.videoPaused=!0,this.ariaLiveService.update(this.esTranslate.instant(this.resources.strings.es_video_player_videopause))},t.prototype.onVideoCheckpoint=function(t){var e=t.data&&t.data.checkpoint&&t.data.checkpoint;_.isNil(e)&&(e=this.videoPercent),e&&e>this.currentVideoCheckpoint&&(this.currentVideoCheckpoint=e,this.sendVideoTelemetry(teamspace.components.PanelActionGesture.asyncStateChange,teamspace.components.PanelActionOutcome.videoCheckpoint,{message:this.currentVideoCheckpoint}))},t.prototype.onVideoLoad=function(t){this.logLoadStep("Video_"+t.name)},t.prototype.onVideoError=function(t){this.logErrorAndClose("Video error",t)},t.prototype.onVideoStalled=function(){var t=this;_.isNil(this.videoStalledTimeoutVar)&&(this.videoStalledTimeoutVar=setTimeout(function(){t.logErrorAndClose("Video stalled too long"),t.videoStalledTimeoutVar=void 0},this.control.autoCloseOptions.videoStalledTimeoutInMs))},t.prototype.pauseOrPlay=function(){_.isNil(this.onePlayer)||(this.videoPaused||this.videoEnded?this.onePlayer.play():this.onePlayer.pause())},t.prototype.onVideoEnded=function(){this.showButtons=!0,this.videoEnded=!0,this.videoPaused=!1,this.ariaLiveService.update(this.esTranslate.instant(this.resources.strings.es_video_player_videoend)),this.$rootScope.$apply(),this.sendVideoTelemetry(teamspace.components.PanelActionGesture.asyncStateChange,teamspace.components.PanelActionOutcome.videoEnd)},t.prototype.handleKeyPress=function(t){t.which===this.constants.keyCodes.space&&this.pauseOrPlay()},t.prototype.handleKeyUp=function(t){t.which===this.constants.keyCodes.escape&&this.videoEnded&&(this.sendVideoTelemetry(teamspace.components.PanelActionGesture.click,teamspace.components.PanelActionOutcome.closeDialog,{closedBy:"escape"},!1),this.close())},t.prototype.watchAgain=function(){this.currentVideoCheckpoint=0,this.onePlayer.seek(0),this.onePlayer.play()},t.prototype.onVideoPlaying=function(){this.showButtons=!1,this.videoEnded=!1,this.videoPaused?(this.ariaLiveService.update(this.esTranslate.instant(this.resources.strings.es_video_player_videoresume)),this.videoPaused=!1):this.ariaLiveService.update(this.esTranslate.instant(this.resources.strings.es_video_player_videointro)+this.esTranslate.instant(this.control.narratorStringResxKey)),this.videoStalledTimeoutVar&&(clearTimeout(this.videoStalledTimeoutVar),this.videoStalledTimeoutVar=void 0),this.$rootScope.$apply(),angular.element("#engagement-surface-dialog #ts-es-video-player-overlay").focus()},t.prototype.close=function(){this.context.dialogCtrl.close()},Object.defineProperty(t.prototype,"videoPercent",{get:function(){return this.videoEnded?100:this.onePlayer?Math.round(this.onePlayer.getCurrentTime()/this.videoDuration*100):0},enumerable:!0,configurable:!0}),t.prototype.logMediaEvents=function(t){this.control.verboseLoggingOptions.enableMediaEventsLogging&&0!==this.mediaEvents.length&&(this.sendVideoTelemetry(teamspace.components.PanelActionGesture.asyncStateChange,teamspace.components.PanelActionOutcome.videoStatus,{message:JSON.stringify(this.mediaEvents)},!1),this.logger.error(t+". "+this.getLoggingContext()+" Media events: "+JSON.stringify(this.mediaEvents)),this.mediaEvents=[])},t.prototype.logLoadStep=function(t){this.videoLoadScenario.mark(t),this.sendVideoTelemetry(teamspace.components.PanelActionGesture.asyncStateChange,teamspace.components.PanelActionOutcome.videoLoad,{message:t}),this.logger.info("Video load step: "+t+".")},t.prototype.getLoggingContext=function(){return"Id: "+this.context.id+". Treatment: "+this.context.treatment+". Video ID: "+this.videoId+"."},t.prototype.logErrorAndClose=function(t,e){var n=!this.appStateService.isOnline||!this.appStateService.isConnected;this.logMediaEvents("ESP video error");var o="ESP video error: "+t+". "+this.getLoggingContext();e&&(o+=" Error: "+JSON.stringify(e)+"."),n?this.videoLoadScenario.cancel({message:o}):this.videoLoadScenario.fail({message:o}),this.sendVideoTelemetry(teamspace.components.PanelActionGesture.asyncStateChange,teamspace.components.PanelActionOutcome.videoError,{message:o},!1),this.logger.error(o),this.close()},t.prototype.destroy=function(){this.unregisterEvents(),this.videoStatusCheckIntervalVar&&(clearInterval(this.videoStatusCheckIntervalVar),this.videoStatusCheckIntervalVar=void 0),this.videoStalledTimeoutVar&&(clearTimeout(this.videoStalledTimeoutVar),this.videoStalledTimeoutVar=void 0)},t.prototype.sendVideoTelemetry=function(t,e,n,s){var i=this;void 0===n&&(n=void 0),void 0===s&&(s=!0);var a={action:{gesture:t,outcome:teamspace.shared.AttributeHelper.tryGetEnum(e.toString(),teamspace.components.PanelActionOutcome,this.loggingService),scenario:teamspace.shared.AttributeHelper.tryGetEnum(teamspace.components.PanelActionScenario.esVideo.toString(),teamspace.components.PanelActionScenario,this.loggingService),scenarioType:teamspace.shared.AttributeHelper.tryGetEnum(teamspace.components.PanelActionScenarioType.video.toString(),teamspace.components.PanelActionScenarioType,this.loggingService)},module:{name:teamspace.shared.AttributeHelper.tryGetEnum(teamspace.components.PanelModuleName.esVideo.toString(),teamspace.components.PanelModuleName,this.loggingService),type:teamspace.shared.AttributeHelper.tryGetEnum(teamspace.components.PanelModuleType.video.toString(),teamspace.components.PanelModuleType,this.loggingService),summary:"ESP Video"},dataBag:o({id:this.context.id+" - "+this.videoId,context:this.getLoggingContext(),treatment:this.context.treatment},n)};s?_.defer(function(){i.analyticsService.onPanelAction(i.$rootScope,a)}):this.analyticsService.onPanelAction(this.$rootScope,a)},t}();e.EngagementSurfaceVideoControl=i,angular.module("teamspace.engagementSurfaceVideoControl",["teamspace.loggingService","teamspace.locales","teamspace.constants","teamspace.settingsService","teamspace.utilityService","teamspace.dialogService","teamspace.analyticsService","teamspace.localizationService","teamspace.ariaLiveService","teamspace.esTranslate","teamspace.appState","teamspace.lazyLoadService"]).component("engagementSurfaceUicontrolVideo",{bindings:{context:"<"},template:s,controller:i})},2252:function(t,e){t.exports='<div id="ts-es-video-player" role="application" track-outcome="{{::$root.trackConstants.trackOutcome.clickInsideVideo}}" track-scenario="{{::$root.trackConstants.trackScenario.esVideo}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.video}}" track-name="{{::$root.trackConstants.trackModuleName.esVideo}}" track-type="{{::$root.trackConstants.trackType.video}}" track-summary="ES Video" track-data="{videoPercent: {{$ctrl.videoPercent}}, id: {{$ctrl.context.id}}, treatment: {{$ctrl.context.treatment}}}" ng-click="">\n  <div class="video-container">\n    <busy-animation ng-if="!$ctrl.videoReady" size="medium"></busy-animation>\n    <div id="ts-one-player-container" ng-show="$ctrl.videoReady" aria-hidden="true"></div>\n    <div id="ts-es-video-player-overlay" ng-if="!$ctrl.isInteractive" ng-click="$ctrl.pauseOrPlay()" ng-keypress="$ctrl.handleKeyPress($event)" ng-keyup="$ctrl.handleKeyUp($event)" set-focus="true" aria-label="{{::$root.resources.strings.firstrun_video_player_video|translate}}"></div>\n    <div class="ts-es-video-controls" ng-show="$ctrl.showButtons">\n      <button class="ts-es-video-controls-play ts-btn" ng-if="$ctrl.showReplayButton" translate-once="{{::$root.resources.strings.firstrun_video_player_watchagain}}" aria-label="{{::$root.resources.strings.firstrun_video_player_watchagain|translate}}" role="button" ng-click="$ctrl.watchAgain()" track-outcome="{{::$root.trackConstants.trackOutcome.videoStart}}" track-scenario="{{::$root.trackConstants.trackScenario.esVideo}}" track-name="{{::$root.trackConstants.trackModuleName.esVideo}}" track-type="{{::$root.trackConstants.trackType.button}}" track-summary="ES Video - Watch again" track-data="{id: {{$ctrl.context.id}}, treatment: {{$ctrl.context.treatment}}}"/>\n      <button class="ts-es-video-controls-close ts-btn" ng-if="$ctrl.showCloseButton" translate-once="{{::$root.resources.strings.firstrun_video_player_letsgo}}" aria-label="{{::$root.resources.strings.firstrun_video_player_letsgo|translate}}" role="button" ng-click="$ctrl.close()" track-outcome="{{::$root.trackConstants.trackOutcome.closeDialog}}" track-scenario="{{::$root.trackConstants.trackScenario.esVideo}}" track-name="{{::$root.trackConstants.trackModuleName.esVideo}}" track-type="{{::$root.trackConstants.trackType.button}}" track-summary="ES Video - Lets go" track-data="{id: {{$ctrl.context.id}}, treatment: {{$ctrl.context.treatment}}}"/>\n    </div>\n  </div>\n</div>'},2253:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(2254),s=function(){function t(t){this.$sce=t,this.consent=!0,this.consent=!1,this.talkToCortanaButton=this.context.dialogCtrl._footerButtons[1],this.talkToCortanaButton.disabled=!this.consent}return t.$inject=["$sce"],t.prototype.trustAsHtml=function(t){return this.$sce.trustAsHtml(t)},t.prototype.toggleTalkToCortanaButton=function(){this.consent=!this.consent,this.talkToCortanaButton.disabled=!this.consent},t}();e.EngagementSurfaceCortanaConsentCheckboxControl=s,angular.module("teamspace.engagementSurfaceCortanaConsentCheckboxControl",["teamspace.esTranslate","teamspace.loggingService","teamspace.locales","teamspace.constants","teamspace.settingsService","teamspace.utilityService","teamspace.esActionHandler"]).component("engagementSurfaceUicontrolCortanaConsentCheckbox",{bindings:{context:"<",consent:"=",internalUser:"="},template:o,controllerAs:"ctrl",controller:s})},2254:function(t,e){t.exports='  <div id="cortana-consent-box-container">\n    <label class="checkbox-option app-checkbox--label">\n        <input type="checkbox" class="app-checkbox--input hide" name="consent_checkbox" ng-model="$ctrl.consent" ng-change="ctrl.toggleTalkToCortanaButton()" ng-true-value="true" ng-false-value="false" id="cortana-consent-check-box"/>\n        <ng-include class="icons-checkbox-common icons-checkbox--unselected checkbox-box" aria-hidden="true" src="\'svg/icons-checkbox-unselected.html\'"></ng-include>\n        <ng-include class="icons-checkbox-common icons-checkbox--selected" aria-hidden="true" src="\'svg/icons-checkbox-selected.html\'"></ng-include>\n        <span class="app-checkbox--labelText app-font-caption-regular option-title" id="cortana-consent-box-text">\n          <div>\n            {{::$root.resources.strings.cortana_consent_checkbox|translate}}\n          </div>\n        </span>\n      </label>\n</div>'},2255:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(2256),s=function(){return function(){}}();e.EngagementSurfaceCortanaLongConsentControl=s,angular.module("teamspace.engagementSurfaceCortanaLongConsentControl",[]).component("engagementSurfaceUicontrolCortanaLongConsent",{bindings:{context:"<"},template:o,controller:s})},2256:function(t,e){t.exports='<div class="cortana-long-consent__wrapper">\n  <p class="es-text ng-binding large bold">\n    {{::$root.resources.strings.cortana_long_consent_heading|translate}}\n  </p>\n  <div class="cortana-long-consent" simple-scrollbar>\n    <div class="scroll-wrapper">\n      <div class="cortana-long-consent__section">\n        <p class="es-text ng-binding small">\n          {{::$root.resources.strings.cortana_long_consent_text|translate}}\n        </p>\n      </div>\n      <div class="cortana-long-consent__section">\n        <p class="es-text ng-binding small">\n          {{::$root.resources.strings.cortana_long_consent_privacy|translate}}\n        </p>\n        <p class="es-text ng-binding small bold">\n          {{::$root.resources.strings.cortana_long_consent_important|translate}}\n        </p>\n        <p class="es-text ng-binding small">\n          {{::$root.resources.strings.cortana_long_consent_sub|translate}}\n        </p>\n        <ul class="es-text ng-binding small">\n          <li>\n            {{::$root.resources.strings.cortana_long_consent_bullet_point_1|translate}}\n          </li>\n          <li>\n            {{::$root.resources.strings.cortana_long_consent_bullet_point_2|translate}}\n          </li>\n          <li>\n            {{::$root.resources.strings.cortana_long_consent_bullet_point_3|translate}}\n          </li>\n        </ul>\n      </div>\n      <div class="cortana-long-consent__section">\n        <p class="es-text ng-binding small bold">\n          {{::$root.resources.strings.cortana_long_consent_terms_of_use|translate}}\n        </p>\n        <p class="es-text ng-binding small">\n          {{::$root.resources.strings.cortana_long_consent_terms_of_use_head|translate}}\n        </p>\n        <ul class="es-text ng-binding small">\n          <li>\n            {{::$root.resources.strings.cortana_long_consent_terms_of_use_bullet_point1|translate}}\n          </li>\n          <li>\n            {{::$root.resources.strings.cortana_long_consent_terms_of_use_bullet_point2|translate}}\n          </li>\n          <li>\n            {{::$root.resources.strings.cortana_long_consent_terms_of_use_bullet_point3|translate}}\n          </li>\n          <li>\n            {{::$root.resources.strings.cortana_long_consent_terms_of_use_bullet_point4|translate}}\n          </li>\n          <li>\n            {{::$root.resources.strings.cortana_long_consent_terms_of_use_bullet_point5|translate}}\n          </li>\n          <li>\n            {{::$root.resources.strings.cortana_long_consent_terms_of_use_bullet_point6|translate}}\n          </li>\n        </ul>\n      </div>\n      <p class="es-text ng-binding small">\n        <span>{{::$root.resources.strings.cortana_long_consent_footer|translate}}</span>\n        <a href="https://microsoft.sharepoint.com/sites/msw/FAQ/PrivacyStatement">\n          {{::$root.resources.strings.cortana_long_consent_data_protection_notice|translate}}</a>\n      </p>\n    </div>\n  </div>\n</div>'},2257:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(2258),s=function(){return function(){}}();e.EngagementSurfaceCortanaShortConsentControl=s,angular.module("teamspace.engagementSurfaceCortanaShortConsentControl",[]).component("engagementSurfaceUicontrolCortanaShortConsent",{bindings:{context:"<"},template:o,controller:s})},2258:function(t,e){t.exports='<div class="cortana-short-consent__wrapper">\n  <p class="es-text ng-binding large bold">\n    {{::$root.resources.strings.cortana_short_consent_heading|translate}}\n  </p>\n  <div class="cortana-short-consent">\n    <div class="cortana-short-consent__section">\n      <p class="es-text ng-binding small">\n        {{::$root.resources.strings.cortana_short_consent_text|translate}}\n      </p>\n    </div>\n  </div>\n</div>'},2259:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(2260),s=n(8),i=function(){function t(t,e,n,o,s,i){this.$scope=t,this.constants=e,this.esTranslate=n,this.resources=o,this.esSurfaceStack=s,this.esActionHandler=i,this.isLoading=!1,this._footerButtons=[],this.id=t.ngDialogData.id,this.treatment=t.ngDialogData.treatment;var a=t.ngDialogData.uiControls;this.params=t.ngDialogData.params||{},this.context=t.ngDialogData.context,this.closeViaX=this.closeViaX.bind(this),this.initButtons(a),this.contentControlContexts=this.getContentControlContexts(a),t.ngDialogData.scenario.stop()}return t.$inject=["$scope","constants","esTranslate","resources","esSurfaceStack","esActionHandler"],t.prototype.initButtons=function(t){var e=this;this._footerButtons.length=0,this.getButtonControls(t).forEach(function(t){e._footerButtons.push({disabled:!!t.disabled,func:function(){e.onButtonClick(t.actionKey)},secondaryStyle:!t.isPrimary,tid:"engagement-surface-"+e.id+"-btn-"+t.resxKey,text:e.esTranslate.instant(t.resxKey,t.resxParams,e.context),title:e.esActionHandler.actionTitle(t.actionKey),icon:t.icon,name:teamspace.components.PanelModuleName.engagementSurfaceDialogButton,type:teamspace.components.PanelModuleType.button,scenario:teamspace.components.PanelActionScenario.engagementSurfaceDialogButton,scenarioType:teamspace.components.PanelActionScenarioType.engagementSurface,outcome:t.isPrimary?teamspace.components.PanelActionOutcome.select:teamspace.components.PanelActionOutcome.closeDialog,dataBag:{id:e.id,treatment:e.treatment,isPrimary:t.isPrimary,actionKey:e.esActionHandler.parseActionKey(t.actionKey).key},summary:"enagement surface button isPrimary="+t.isPrimary+" resx="+t.resxKey})})},t.prototype.getUiControlComponentName=function(t){return"engagement-surface-uicontrol-"+(this.constants.growth.engagementSurfaces.uiControls[t.type]||this.constants.growth.engagementSurfaces.uiControls.text)},t.prototype.updateButtonControls=function(t){this.initButtons(t)},t.prototype.getButtonControls=function(t){var e=[];return(t||[]).forEach(function(t){s.IsUserInterfaceControlButton(t)&&e.push(t)}),e},t.prototype.getContentControlContexts=function(t){var e=this;return t.filter(function(t){return!s.IsUserInterfaceControlButton(t)}).map(function(t){return{id:e.id,treatment:e.treatment,isValid:!0,value:"",context:e.context,control:t,dialogCtrl:e}})},t.prototype.closeViaX=function(){this.onButtonClick(this.constants.growth.engagementSurfaces.actionKey.xClose)},t.prototype.onButtonClick=function(t){this.esSurfaceStack.setCurrentAction(t),this.errorText=void 0,this.esActionHandler.hasRegisteredAction(t)?this.esActionHandler.handleAction(t,this,this.context):this.$scope.closeThisDialog()},Object.defineProperty(t.prototype,"footerButtons",{get:function(){return this._footerButtons},enumerable:!0,configurable:!0}),t.prototype.getUiControls=function(){return this.contentControlContexts},t.prototype.setIsCompleted=function(t,e){var n=this;this.completedText=t,this.isLoading=!1,this._footerButtons.length=0,e&&this._footerButtons.push({disabled:!1,func:function(){n.completedText=void 0;var t=n.$scope.ngDialogData.uiControls;n.initButtons(t),n.getUiControls().forEach(function(t){return t.isHidden=!1})},secondaryStyle:!0,tid:"engagement-surface-"+this.id+"-btn-reset",text:e,name:teamspace.components.PanelModuleName.engagementSurfaceDialogButton,type:teamspace.components.PanelModuleType.button,scenario:teamspace.components.PanelActionScenario.engagementSurfaceDialogResetButton,scenarioType:teamspace.components.PanelActionScenarioType.engagementSurface,outcome:teamspace.components.PanelActionOutcome.resetDialog,dataBag:{id:this.id,treatment:this.treatment},summary:"enagement surface button to reset the dialog"}),this._footerButtons.push({disabled:!1,func:function(){n.onButtonClick(n.constants.growth.engagementSurfaces.actionKey.completedClose)},tid:"engagement-surface-"+this.id+"-btn-done",text:this.esTranslate.instant(this.resources.strings.done),name:teamspace.components.PanelModuleName.engagementSurfaceDialogButton,type:teamspace.components.PanelModuleType.button,scenario:teamspace.components.PanelActionScenario.engagementSurfaceDialogButton,scenarioType:teamspace.components.PanelActionScenarioType.engagementSurface,outcome:teamspace.components.PanelActionOutcome.closeDialog,dataBag:{id:this.id,treatment:this.treatment},summary:"enagement surface button to close the dialog"})},t.prototype.setErrorText=function(t){this.errorText=t},t.prototype.setIsLoading=function(t){this.isLoading=t},t.prototype.getIsLoading=function(){return this.isLoading},t.prototype.close=function(){this.$scope.closeThisDialog()},t}();e.EngagementSurfaceDialogController=i,angular.module("teamspace.engagementSurfaceDialog",["teamspace.esTranslate","teamspace.constants","teamspace.dialogService","teamspace.locales","teamspace.esSurfaceStack","teamspace.esActionHandler","teamspace.engagementSurfaceTextControl","teamspace.engagementSurfaceSpaceControl","teamspace.engagementSurfaceImageControl","teamspace.engagementSurfaceLinkControl","teamspace.engagementSurfaceContentButtonControl","teamspace.engagementSurfaceMobileBadgesControl","teamspace.engagementSurfaceEmailSmsControl","teamspace.engagementSurfaceUpdateUserProfileControl","teamspace.engagementSurfaceVideoControl","teamspace.engagementSurfaceCortanaConsentCheckboxControl","teamspace.engagementSurfaceCortanaLongConsentControl","teamspace.engagementSurfaceCortanaShortConsentControl","teamspace.engagementSurfaceDiscoverySettingsControl","teamspace.engagementSurfaceCopyLinkButtonControl"]).controller("EngagementSurfaceDialogController",i).run(["$templateCache",function(t){t.put("components/engagement-surface-dialog/engagement-surface-dialog.html",o)}]).run(["constants","dialogService",function(t,e){e.register(t.dialogs.engagementSurfaceDialog,{template:"components/engagement-surface-dialog/engagement-surface-dialog.html",className:"ts-modal-dialog es-height-width-auto",isPersistent:!0,closeByEscape:!1,closeByDocument:!1,showClose:!0,controller:"EngagementSurfaceDialogController",controllerAs:"$ctrl",ariaAuto:!1,ariaRole:"dialog",ariaDescribedById:"modalDialog-title"})}])},2260:function(t,e){t.exports='<div id="engagement-surface-dialog" data-tid="engagement-surface-dialog" ng-style="{ \'width\': $ctrl.params.width || \'60rem\'}" ng-class="{ \'footer-hidden\': $ctrl.footerButtons.length === 0,\n                 \'center-align\': $ctrl.params.centerAlign,\n                 \'remove-default-padding\': $ctrl.params.removeDefaultPadding }">\n  <modal-dialog ng-style="{ \'height\': $ctrl.params.height || \'auto\', \'max-height\':\'100vh\'}" center-align-buttons="$ctrl.params.centerAlign" suppress-default-button="true" footer-buttons="$ctrl.footerButtons" add-close-icon="!$ctrl.params.hideCloseIcon" close-function="$ctrl.closeViaX" suppress-default-footer="$ctrl.footerButtons.length === 0" track-panel-type="{{::$root.trackConstants.panelType.engagementSurfaceDialog}}" track-data="{id: \'{{::$ctrl.id}}\', treatment: \'{{::$ctrl.treatment}}\'}">\n    <div id="es-content" class="content">\n      <div ng-repeat="controlContext in $ctrl.contentControlContexts track by $index">\n        <div ts-load-directive directive="::$ctrl.getUiControlComponentName(controlContext.control)" ng-hide="controlContext.isHidden" context="::controlContext"></div>\n      </div>\n    </div>\n    <div id="es-completed-text" class="es-completed-text es-text" ng-if="$ctrl.completedText" aria-live="assertive" role="alert" ng-bind="::$ctrl.completedText"></div>\n    <div class="form-field-error dialog-error" ng-if="$ctrl.errorText" aria-live="assertive">\n      <ng-include class="icon error" src="\'svg/icons-input-invalid.html\'"></ng-include>\n      <span ng-bind="::$ctrl.errorText"></span>\n    </div>\n  </modal-dialog>\n</div>\n'}},[2229]);