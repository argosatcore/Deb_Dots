webpackJsonp([33],{2171:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n(2172)},2172:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(2173),s=function(){function t(t,e,n,o,s,r,a,i,c,l,p,g,u,m,k,d,h,v,y,b,S,C,P,_,$,f,w,B,T,D){var A=this;this.$window=t,this.$q=e,this.$scope=n,this.$state=o,this.$translate=s,this.ngDialog=r,this.$timeout=a,this.clientDatabase=i,this.teamsUpdateManagementSettingsStore=c,this.desktopUtilityService=l,this.authenticationService=p,this.identityService=g,this.resources=u,this.constants=m,this.appsService=k,this.navigationService=d,this.loggingService=h,this.settingsService=v,this.analyticsService=y,this.dialogService=b,this.helpService=S,this.shortcutService=C,this.layoutService=P,this.workerDataLayerClientHandler=_,this.appInfoService=f,this.tenantPrivacyProfileService=w,this.tenantSettingsStore=B,this.updateAppService=T,this.downloadAppService=D,this.enableNewHelpInAppBar=!1,this.zoomUiEnabled=!1,this.zoomPercentString="100%",this.chatServiceIntEnvironmentApis=["merlotcity","local"],this.displayPreviewButtonInMeMenu=!1,this.teamsPrivacyFaqUrl=void 0,this.logger=h.newLogger("SettingsButtonPopoverController"),this.processApis(),this.processRings(),this.processPublicDevPreviewSetting(),this.isDesktopApp=l.isElectron(),this.enableMopoLink=v.valueAsBoolean(m.settings.names.enableMopoLinkInSettingsDropdown),this.enableHelpItem=v.valueAsBoolean(m.settings.names.botsEnabled),this.enableNewHelpInAppBar=v.valueAsBoolean(m.settings.names.enableNewHelpInAppBar),this.enableWebTPN=v.valueAsBoolean(m.settings.names.enableThirdPartyNoticeEntry)&&!this.isDesktopApp,this.enableDesktopTpn=v.valueAsBoolean(m.settings.names.enableThirdPartyNoticeEntry)&&this.isDesktopApp,this.displayPreviewButtonInMeMenu=this.isDesktopApp&&v.valueAsBoolean(m.settings.names.displayPreviewButtonInMeMenu),this.zoomUiEnabled=l.isElectron()&&t.desktopSettings.zoomUiEnabled,this.handleZoomUi(),this.teamsPrivacyFaqUrl=v.valueFor(m.settings.names.teamsPrivacyFaqUrl);var M=$.isCortanaEnabled();teamspace.services.QCancelable.toCancelablePromise(e,M,n).then(function(t){return A.showCortanaDevTools=t}).catch(function(){return A.showCortanaDevTools=!1}),this.legalLinkUrl=this.isFreemiumTenant?this.isFreemiumAdmin?m.legal.legalUrlFreemium.admin:m.legal.legalUrlFreemium.user:m.legal.legalUrl,this.mopoLinkUrl=m.itpro.mopoUrl,this.showDesktopDownload=D.isDownloadSupported(),this.showMobileDownload=v.valueAsBoolean(m.settings.names.promoteMobile),this.zoomOutButtonTitle=s.instant(u.strings.zoom_out_ui_aria_label),this.zoomInButtonTitle=s.instant(u.strings.zoom_in_ui_aria_label),this.zoomResetButtonTitle=s.instant(u.strings.zoom_reset_ui_aria_label),this.settingsManageAriaLabel=s.instant(u.strings.settings_manage_aria_label),this.helpButtonTitle=s.instant(u.strings.settings_help_aria_label),this.aboutButtonTitle=s.instant(u.strings.settings_about_aria_label),this.checkUpdateButtonTitle=s.instant(u.strings.settings_check_update_aria_label),this.downloadMobileAppButtonTitle=s.instant(u.strings.settings_download_mobile_app_aria_label)}return t.$inject=["$window","$q","$scope","$state","$translate","ngDialog","$timeout","clientDatabase","teamsUpdateManagementSettingsStore","desktopUtilityService","authenticationService","identityService","resources","constants","appsService","navigationService","loggingService","settingsService","analyticsService","dialogService","helpService","shortcutService","layoutService","workerDataLayerClientHandler","cortanaConfigurationService","appInfoService","tenantPrivacyProfileService","tenantSettingsStore","updateAppService","downloadAppService"],Object.defineProperty(t.prototype,"isFreemiumTenant",{get:function(){return this.settingsService.valueAsBoolean(this.constants.settings.names.enableFreemium)&&this.identityService.isFreemiumTenant()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isFreemiumAdmin",{get:function(){return this.isFreemiumTenant&&this.identityService.isTenantAdmin()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isAdmin",{get:function(){return this.identityService.isTenantAdmin()||this.identityService.isServiceAdmin()},enumerable:!0,configurable:!0}),t.prototype.zoomIn=function(){this.zoomIpc(this.constants.events.desktopApp.zoomIn)},t.prototype.zoomOut=function(){this.zoomIpc(this.constants.events.desktopApp.zoomOut)},t.prototype.zoomReset=function(){this.zoomIpc(this.constants.events.desktopApp.zoomReset)},t.prototype.zoomIpc=function(t){this.desktopUtilityService.isElectron()&&this.$window.electronSafeIpc.send(t,!0,this.constants.desktopApp.telemetry.zoomSource.settingsDropdownUi)},t.prototype.onZoomLevelChange=function(t,e){this.loggingService.info("New zoom percent: "+e),this.zoomPercentString=this.$translate.instant(this.resources.strings.zoom_percent_ui_string).replace("{0}",String(e)),this.loggingService.info("New zoom percent string is: "+this.zoomPercentString)},t.prototype.handleZoomUi=function(){var t=this;if(this.zoomUiEnabled&&this.$window.electronSafeIpc){var e=this.onZoomLevelChange.bind(this);this.zoomPercentString=this.$translate.instant(this.resources.strings.zoom_percent_ui_string).replace("{0}",String(this.desktopUtilityService.getZoomPercent())),this.$window.electronSafeIpc.on(this.constants.events.desktopApp.zoomLevelChange,e),this.$scope.$on("$destroy",function(){t.$window.electronSafeIpc.removeListener(t.constants.events.desktopApp.zoomLevelChange,e)})}},t.prototype.settingsDialog=function(t,e,n,o){void 0===n&&(n=!1),this.ngDialog.open({template:"components/settings-list/settings-list.html",className:"ngdialog-settings ngdialog-theme-default",closeByEscape:!0,closeByDocument:!0,controller:"SettingsListController",data:{title:t,cancel:"Cancel",okButton:"OK",settings:e,isTmpSetting:n,allSetting:o}})},t.prototype.debug=function(){this.settingsDialog("Debug settings",this.settingsService.debugSettings)},t.prototype.settings=function(){this.settingsDialog("Experimental settings",this.settingsService.settings)},t.prototype.tmpsettings=function(){this.settingsDialog("TMP experimental settings",this.settingsService.tmpSettings,!0)},t.prototype.openPreviewNewFeaturesDialog=function(){this.sendPreviewNewFeaturesClickedTelemetry(),this.dialogService.open(this.constants.dialogs.previewNewFeaturesDialog)},t.prototype.sendPreviewNewFeaturesClickedTelemetry=function(){var t=this,e={action:{scenarioType:teamspace.shared.AttributeHelper.tryGetEnum(teamspace.components.PanelActionScenarioType.previewFeatures.toString(),teamspace.components.PanelActionScenarioType,this.logger),scenario:teamspace.shared.AttributeHelper.tryGetEnum(teamspace.components.PanelActionScenario.navSettings.toString(),teamspace.components.PanelActionScenario,this.logger),gesture:teamspace.shared.AttributeHelper.tryGetEnum(teamspace.components.PanelActionGesture.click.toString(),teamspace.components.PanelActionGesture,this.logger),outcome:teamspace.shared.AttributeHelper.tryGetEnum(teamspace.components.PanelActionOutcome.nav.toString(),teamspace.components.PanelActionOutcome,this.logger)},module:{name:teamspace.shared.AttributeHelper.tryGetEnum(teamspace.components.PanelModuleName.previewSetting.toString(),teamspace.components.PanelModuleName,this.loggingService).toString(),type:teamspace.shared.AttributeHelper.tryGetEnum(teamspace.components.PanelModuleType.settingsButton.toString(),teamspace.components.PanelModuleType,this.loggingService),summary:"User clicked on preview new features button in settings dropdown"}};this.analyticsService.getAnalyticsPanelActionEventData(e).then(function(e){e.panel.type=teamspace.shared.AttributeHelper.tryGetEnum(teamspace.PanelType.settingsDropdown.toString(),teamspace.PanelType,t.logger).toString(),t.analyticsService.sendPanelAction(e)})},t.prototype.processApis=function(){var t=this;this.apis=[];var e=this.settingsService.getApi();if(e){var n=this.settingsService.valueFor(this.constants.settings.names.apiSettings);n&&_.keys(n).length>0?(this.showApiSelector=!0,this.currentApiDisplayName=e.friendlyName,this.currentApiId=e.id,_.keys(n).forEach(function(o){var s=n[o];s.friendlyName&&s.friendlyName.length>0&&t.apis.push({identifier:s,displayName:s.friendlyName,active:s.id===e.id})})):this.showApiSelector=!1}},t.prototype.processRings=function(){var t=this;this.rings=[];var e=this.settingsService.valueFor(this.constants.settings.names.ringOverridePermission),n=this.settingsService.getRing();if(n){var o=this.settingsService.valueFor(this.constants.settings.names.availableRings);if(e&&o&&(this.showRingSelector=!0),this.ringSelectorTitle=this.$translate.instant(this.resources.strings.settings_version),this.currentWebRingDisplayName=n.friendlyName,e==this.constants.ringSelection.ringOverridePermission.any)_.forEach(o,function(e){e.friendlyName&&e.friendlyName.length>0&&t.rings.push({identifier:e,displayName:e.friendlyName,active:e.id===n.id})});else if(e==this.constants.ringSelection.ringOverridePermission.optOut){this.ringSelectorTitle=this.$translate.instant(this.resources.strings.settings_preview);var s=this.$translate.instant(this.resources.strings.settings_preview_enabled),r=this.$translate.instant(this.resources.strings.settings_preview_disabled);this.currentWebRingDisplayName=n.isPublic?r:s,_.forEach(o,function(e){t.rings.push({identifier:e,displayName:e.isPublic?r:s,active:e.id===n.id})})}}},t.prototype.switchApi=function(t){var e=this;if("local"===t.id&&this.desktopUtilityService.isDesktop())this.showFeatureNotSupportedDialog();else{var n=this.getUrlAndRoute()+"?api="+t.id+(t.additionalQsp||""),o=this.$q.when();if(this.chatServiceIntEnvironmentApis.some(function(n){return n===t.id||n===e.currentApiId})){var s=SkypeX.Services.SyncTasks.fromThenable(this.workerDataLayerClientHandler.wipeLocalData());this.authenticationService.clearSkypeCache(),this.authenticationService.clearAdalCache(),o=SkypeX.Services.SyncTasks.whenAll([this.clientDatabase.nukeDB(),s]).then(function(){}).toNgPromise(this.$q)}o.finally(function(){e.layoutService.reloadApp(e.resources.strings.refresh_message_default,"apiChange",n)})}},t.prototype.getUrlAndRoute=function(){var t=this.isDesktopApp?"_":"";return""+this.settingsService.getRootUri()+t},t.prototype.showFeatureNotSupportedDialog=function(){var t={confirmMessageTitle:"Local middle tier is not supported in desktop app!",confirmMessageHtmlBody:"Desktop app doesn't work with local middle tier yet. There is some work needed to use 3rd party AAD App when connecting to local middle tier instance.",isConfirmation:!0,confirmDialogType:teamspace.PanelType.lastOwnerLeaveTeamDialog};this.dialogService.open(this.constants.dialogs.confirmDialog,t)},t.prototype.switchRing=function(t){var e=this.getUrlAndRoute()+"?ring="+t.id;this.layoutService.reloadApp(this.resources.strings.refresh_message_default,"ringChange",e)},t.prototype.processPublicDevPreviewSetting=function(){this.settingsService.valueAsBoolean(this.constants.settings.names.enableTeamsUpdateManagementSettingsAggFetch)?this.processPublicDevPreviewSettingInternal():this.processPublicDevPreviewSettingV1()},t.prototype.processPublicDevPreviewSettingInternal=function(){var t=!!this.settingsService.valueFor(this.constants.settings.names.publicDevPreviewRing),e=this.teamsUpdateManagementSettingsStore.getSettings(),n=!(!e||!e.allowPreview)&&e.allowPreview;this.publicDevPreviewEnabled=this.settingsService.valueAsBoolean(this.constants.settings.names.publicDevPreviewEnabled),this.showPublicDevPreviewSetting=this.publicDevPreviewEnabled||n&&t},t.prototype.processPublicDevPreviewSettingV1=function(){var t=this,e=this.tenantSettingsStore.getSettingValue(SkypeX.Services.TenantSettingsStorageKey.isSideLoadedAppsEnabled),n=!!this.settingsService.valueFor(this.constants.settings.names.publicDevPreviewRing);this.publicDevPreviewEnabled=this.settingsService.valueAsBoolean(this.constants.settings.names.publicDevPreviewEnabled),this.showPublicDevPreviewSetting=this.publicDevPreviewEnabled||e&&n,this.appsService.getUserAppPolicy("settings-button").then(function(o){e=!(!o||!o.isSideloadingAllowed)&&o.isSideloadingAllowed,t.loggingService.info("settings-button, Get user app policy, isSideloadingAllowed: "+e),t.showPublicDevPreviewSetting=t.publicDevPreviewEnabled||e&&n,t.loggingService.info("settings-button, showPublicDevPreviewSetting: "+t.showPublicDevPreviewSetting)}).catch(function(e){t.loggingService.error("settings-button, Get user app policy failed, error: "+e)})},t.prototype.togglePublicDevPreview=function(){if(this.publicDevPreviewEnabled){var t=this.getUrlAndRoute()+"?ring=clear";this.layoutService.reloadApp(this.resources.strings.refresh_message_default,"disableDevPreview",t)}else this.ngDialog.open({template:"components/dev-preview-dialog/dev-preview-dialog.html",className:"ngdialog-dev-preview ngdialog-shared ngdialog-theme-default",closeByEscape:!0,closeByDocument:!0})},t.prototype.openUiToolkit=function(){return this.navigationService.navigatePromise(this.$scope,this.constants.states.toolkit,{})},t.prototype.cortanaDevToolsDialog=function(){this.dialogService.open(this.constants.dialogs.cortanaDevToolsDialog)},t.prototype.showRingSelectionDialog=function(){this.dialogService.open(this.constants.dialogs.ringSelection)},t.prototype.showRoutingSettingsDialog=function(){this.dialogService.open(this.constants.dialogs.routingSettings)},t.prototype.thirdPartyNoticeDialogShow=function(){this.ngDialog.open({template:"components/third-party-notice/third-party-notice.html",className:"ts-modal-dialog",closeByEscape:!0,closeByDocument:!0})},t.prototype.desktopThirdPartyNoticeShow=function(){this.$window.electronSafeIpc.send(this.constants.events.desktopApp.thirdPartyNotice)},t.prototype.keyboardShortcuts=function(){var t=this;this.$timeout(function(){return t.shortcutService.executeCommand(teamspace.services.CommandIdentifier.ShowShortcuts)})},t.prototype.about=function(){this.appInfoService.getVersionInfo()},t.prototype.hasTeamsPrivacyFaqUrl=function(){return!_.isNil(this.teamsPrivacyFaqUrl)},t.prototype.openPrivacyFaqLink=function(){this.$window.open(this.teamsPrivacyFaqUrl,"_blank")},t.prototype.openPrivacyLink=function(){var t=this;this.tenantPrivacyProfileService.getPrivacyPolicyURL().then(function(e){t.$window.open(e,"_blank")})},t.prototype.checkForUpdates=function(){this.updateAppService.update()},t.prototype.downloadApp=function(){this.downloadAppService.download()},t.prototype.downloadMobileApp=function(){this.settingsService.valueAsBoolean(this.constants.settings.names.enableMobileDownloadMailDialog)?this.dialogService.open(this.constants.dialogs.mobileDownload,{preActiveElementIds:[this.constants.appBar.settingsButtonId]}):this.$window.open("https://aka.ms/downloadteams","_blank")},t.prototype.gotoHelp=function(){this.helpService.gotoHelp()},t.prototype.gotoManage=function(){this.$state.go(this.constants.states.appManageTenant)},t.prototype.hide=function(){this.$scope.$parent.$hide()},t}();e.SettingsButtonPopoverController=s,angular.module("teamspace.settingsButtonPopover",["teamspace.authenticationService","teamspace.identityService","teamspace.constants","teamspace.loggingService","teamspace.settingsService","teamspace.layoutService","teamspace.helpService","teamspace.shortcutService","teamspace.appInfoService","teamspace.appsService","teamspace.tenantPrivacyProfileService","teamspace.updateAppService","teamspace.downloadAppService","skypeX.teamsUpdateManagementSettingsStore"]).component("settingsButtonPopover",{controller:s,controllerAs:"settingsBtnPopoverCtrl",template:o})},2173:function(t,e){t.exports='<div>\n  <ul class="settings-popover-menu" data-tid="settings-popover-menu" acc-role="menu">\n    <li ng-if="settingsBtnPopoverCtrl.zoomUiEnabled" tabindex="-1">\n      <div class="zoom-ui-menu">\n        <span class="zoom-ui-title" translate-once="{{::$root.resources.strings.zoom_percent_ui_title_string}}"></span>\n        <button acc-role="focus-default menu-item" class="zoom-icon inset-border inset-border-round inset-border-themed app-icons-fill-hover" ng-click="settingsBtnPopoverCtrl.zoomOut();" id="zoom-out-button" title="{{::settingsBtnPopoverCtrl.zoomOutButtonTitle}}" aria-label="{{::settingsBtnPopoverCtrl.zoomOutButtonTitle}}" data-tid="zoom-out-button" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="zoomOut">\n          <ng-include src="\'svg/icons-screen-zoom-out.html\'"/>\n        </button>\n        <span class="zoom-percent-ui">({{settingsBtnPopoverCtrl.zoomPercentString}})</span>\n        <button acc-role="menu-item" class="zoom-icon inset-border inset-border-round inset-border-themed app-icons-fill-hover" ng-click="settingsBtnPopoverCtrl.zoomIn();" id="zoom-in-button" title="{{::settingsBtnPopoverCtrl.zoomInButtonTitle}}" aria-label="{{::settingsBtnPopoverCtrl.zoomInButtonTitle}}" data-tid="zoom-in-button" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="zoomIn">\n          <ng-include src="\'svg/icons-screen-zoom-in.html\'"/>\n        </button>\n        <button acc-role="menu-item" class="zoom-icon inset-border inset-border-round inset-border-themed app-icons-fill-hover" ng-click="settingsBtnPopoverCtrl.zoomReset();" id="zoom-reset-button" title="{{::settingsBtnPopoverCtrl.zoomResetButtonTitle}}" aria-label="{{::settingsBtnPopoverCtrl.zoomResetButtonTitle}}" data-tid="zoom-reset-button" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="zoomReset">\n          <ng-include src="\'svg/icons-reset-zoom.html\'"/>\n        </button>\n      </div>\n    </li>\n    <li ng-if="settingsBtnPopoverCtrl.zoomUiEnabled" acc-role="menu-separator" class="divider"></li>\n    <li class="popover-parent" acc-role="menu-item focus-default has-sub-menu" ng-if="::settingsBtnPopoverCtrl.layoutService.showDevMenus">\n      <button class="ts-sym">\n        Dev Tools\n        <ng-include class="right-align-icon" src="\'svg/icons-patharrow.html\'"></ng-include>\n      </button>\n      <ul class="app-default-menu popover child-popover" acc-role="sub-menu" tabindex="-1">\n        <li acc-role="sub-menu-item">\n          <button class="ts-sym" ng-click="settingsBtnPopoverCtrl.settings(); settingsBtnPopoverCtrl.hide()" translate-once="{{::$root.resources.strings.main_gear_experimental_settings}}" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="{{::$root.resources.strings.main_gear_experimental_settings}}"></button>\n        </li>\n        <li acc-role="sub-menu-item">\n          <button class="ts-sym" ng-click="settingsBtnPopoverCtrl.tmpsettings(); settingsBtnPopoverCtrl.hide()" translate-once="{{::$root.resources.strings.main_gear_tmp_settings}}" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="{{::$root.resources.strings.main_gear_tmp_settings}}">\n          </button>\n        </li>\n        <li acc-role="sub-menu-item" ng-if="::!settingsBtnPopoverCtrl.layoutService.hideDebug">\n          <button class="ts-sym" ng-click="settingsBtnPopoverCtrl.debug(); settingsBtnPopoverCtrl.hide()" translate-once="{{::$root.resources.strings.main_gear_debug_settings}}" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="{{::$root.resources.strings.main_gear_debug_settings}}"></button>\n        </li>\n        <li acc-role="sub-menu-item">\n          <button class="ts-sym" ng-click="settingsBtnPopoverCtrl.layoutService.hideDebug = !settingsBtnPopoverCtrl.layoutService.hideDebug; settingsBtnPopoverCtrl.hide()" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="{{settingsBtnPopoverCtrl.layoutService.hideDebug ? $root.resources.strings.main_gear_show_debug_elements : $root.resources.strings.main_gear_hide_debug_elements}}">\n            <span ng-if="settingsBtnPopoverCtrl.layoutService.hideDebug" translate-once="{{::$root.resources.strings.main_gear_show_debug_elements}}"></span>\n            <span ng-if="!settingsBtnPopoverCtrl.layoutService.hideDebug" translate-once="{{::$root.resources.strings.main_gear_hide_debug_elements}}"></span>\n          </button>\n        </li>\n        <li acc-role="sub-menu-item">\n          <button class="ts-sym" ng-click="settingsBtnPopoverCtrl.authenticationService.clearAdalCache(); settingsBtnPopoverCtrl.hide()" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="{{::$root.resources.strings.main_gear_clear_adal_auth_cache}}">\n            <span translate-once="{{::$root.resources.strings.main_gear_clear_adal_auth_cache}}"></span>\n          </button>\n        </li>\n        <li acc-role="sub-menu-item">\n          <button class="ts-sym" ng-click="settingsBtnPopoverCtrl.authenticationService.clearSkypeCache(); settingsBtnPopoverCtrl.hide()" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="{{::$root.resources.strings.main_gear_clear_skype_auth_cache}}">\n            <span translate-once="{{::$root.resources.strings.main_gear_clear_skype_auth_cache}}"></span>\n          </button>\n        </li>\n        <li acc-role="sub-menu-item">\n          <button class="ts-sym" ng-click="settingsBtnPopoverCtrl.openUiToolkit(); settingsBtnPopoverCtrl.hide()" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="{{::$root.resources.strings.main_gear_open_ui_toolkit}}">\n            <span translate-once="{{::$root.resources.strings.main_gear_open_ui_toolkit}}"></span>\n          </button>\n        </li>\n        <li acc-role="sub-menu-item" ng-if="settingsBtnPopoverCtrl.showCortanaDevTools">\n          <button class="ts-sym" ng-click="settingsBtnPopoverCtrl.cortanaDevToolsDialog(); settingsBtnPopoverCtrl.hide()">\n            <span>Cortana Dev Tools</span>\n          </button>\n        </li>\n      </ul>\n    </li>\n    <li class="popover-parent" acc-role="menu-item focus-default has-sub-menu" ng-if="::settingsBtnPopoverCtrl.showApiSelector">\n      <button class="ts-sym">\n        Service: {{::settingsBtnPopoverCtrl.currentApiDisplayName}}\n        <ng-include class="right-align-icon" src="\'svg/icons-patharrow.html\'"></ng-include>\n      </button>\n      <div class="app-default-menu popover child-popover">\n        <div class="scroll-menu-wrapper" simple-scrollbar>\n          <ul acc-role="sub-menu" tabindex="-1">\n            <li ng-repeat="api in settingsBtnPopoverCtrl.apis" acc-role="sub-menu-item" ng-class="::{ active: api.active }">\n              <button class="ts-sym" ng-click="settingsBtnPopoverCtrl.switchApi(api.identifier); settingsBtnPopoverCtrl.hide()">\n                {{::api.displayName}}\n                <ng-include ng-if="api.active" src="\'svg/icons-check.html\'" class="right-align-icon"></ng-include>\n              </button>\n            </li>\n          </ul>\n        </div>\n      </div>\n    </li>\n    <li class="popover-parent" acc-role="menu-item focus-default has-sub-menu" ng-if="::settingsBtnPopoverCtrl.showRingSelector">\n      <button class="ts-sym">\n        {{::settingsBtnPopoverCtrl.ringSelectorTitle}}: {{::settingsBtnPopoverCtrl.currentWebRingDisplayName}}\n        <ng-include class="right-align-icon" src="\'svg/icons-patharrow.html\'"></ng-include>\n      </button>\n      <div class="app-default-menu popover child-popover">\n        <div class="scroll-menu-wrapper" simple-scrollbar>\n          <ul acc-role="sub-menu" tabindex="-1" ng-class="{ \'settings-popover-many-rings\': (settingsBtnPopoverCtrl.rings.length > 4) }">\n            <li ng-repeat="ring in settingsBtnPopoverCtrl.rings" ng-class="{ active: ring.active }" acc-role="sub-menu-item">\n              <button class="ts-sym" ng-click="settingsBtnPopoverCtrl.switchRing(ring.identifier); settingsBtnPopoverCtrl.hide()" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="{{::ring.displayName}}">\n                {{::ring.displayName}}\n                <ng-include ng-if="ring.active" src="\'svg/icons-check.html\'" class="right-align-icon"></ng-include>\n              </button>\n            </li>\n            <li acc-role="menu-separator" class="divider"></li>\n            <li acc-role="sub-menu-item">\n              <button class="ts-sym" ng-click="settingsBtnPopoverCtrl.showRingSelectionDialog(); settingsBtnPopoverCtrl.hide()" translate-once="{{::$root.resources.strings.ringSetting_more_options}}"></button>\n            </li>\n          </ul>\n        </div>\n      </div>\n    </li>\n    <li acc-role="menu-separator" class="divider"></li>\n    <li acc-role="menu-item" ng-if="::settingsBtnPopoverCtrl.displayPreviewButtonInMeMenu">\n      <button class="ts-sym" data-tid="openPreviewNewFeaturesDialogButton" ng-click="settingsBtnPopoverCtrl.openPreviewNewFeaturesDialog(); settingsBtnPopoverCtrl.hide()" translate-once="{{::$root.resources.strings.settings_preview_new_features}}">\n      </button>\n    </li>\n    <li acc-role="sub-menu-item" ng-if="!settingsBtnPopoverCtrl.isFreemiumAdmin && settingsBtnPopoverCtrl.isAdmin && settingsBtnPopoverCtrl.enableMopoLink">\n      <a data-tid="mopoUrl" href="{{::settingsBtnPopoverCtrl.mopoLinkUrl}}" ng-click="settingsBtnPopoverCtrl.hide()" target="_blank" aria-label="{{::settingsBtnPopoverCtrl.settingsManageAriaLabel}}" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="{{::$root.resources.strings.main_gear_admin_portal}}" translate-once="{{::$root.resources.strings.main_gear_admin_portal}}">\n      </a>\n    </li>\n    <li acc-role="menu-item" ng-if="::settingsBtnPopoverCtrl.isFreemiumAdmin" data-prevent-trigger-refocus="true">\n      <button class="ts-sym" ng-click="settingsBtnPopoverCtrl.gotoManage(); settingsBtnPopoverCtrl.hide()" id="manage-button" aria-label="{{::settingsBtnPopoverCtrl.settingsManageAriaLabel}}" data-tid="manage-button" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="{{::$root.resources.strings.main_gear_manage}}" translate-once="{{::$root.resources.strings.main_gear_manage}}">\n      </button>\n    </li>\n    <li acc-role="menu-item" ng-if="settingsBtnPopoverCtrl.enableHelpItem && !settingsBtnPopoverCtrl.enableNewHelpInAppBar">\n      <button class="ts-sym" ng-click="settingsBtnPopoverCtrl.gotoHelp(); settingsBtnPopoverCtrl.hide()" id="help-button" aria-label="{{::settingsBtnPopoverCtrl.helpButtonTitle}}" data-tid="help-button" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="{{::$root.resources.strings.main_gear_help}}" translate-once="{{::$root.resources.strings.main_gear_help}}"></button>\n    </li>\n    <li acc-role="menu-item focus-default">\n      <button class="ts-sym" ng-click="settingsBtnPopoverCtrl.keyboardShortcuts(); settingsBtnPopoverCtrl.hide()" translate-once="{{::$root.resources.strings.main_gear_keyboard_shortcuts}}" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="{{::$root.resources.strings.main_gear_keyboard_shortcuts}}"></button>\n    </li>\n    <li class="popover-parent" data-tid="about-menu" acc-role="menu-item has-sub-menu">\n      <button class="ts-sym" aria-label="{{::settingsBtnPopoverCtrl.aboutButtonTitle}}">\n        {{::$root.resources.strings.main_gear_about | translate}}\n        <ng-include class="right-align-icon" src="\'svg/icons-patharrow.html\'"></ng-include>\n      </button>\n      <ul class="app-default-menu popover child-popover move-up" acc-role="sub-menu" tabindex="-1">\n        <li acc-role="sub-menu-item" ng-if="settingsBtnPopoverCtrl.isDesktopApp">\n          <button class="ts-sym" ng-click="settingsBtnPopoverCtrl.about(); settingsBtnPopoverCtrl.hide()" id="about-button" data-tid="about-button" translate-once="{{::$root.resources.strings.settings_version}}" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="{{::$root.resources.strings.main_gear_about}}"></button>\n        </li>\n        <li acc-role="sub-menu-item">\n          <a data-tid="legal" href="{{::settingsBtnPopoverCtrl.legalLinkUrl}}" ng-click="settingsBtnPopoverCtrl.hide()" target="_blank" translate-once="{{::$root.resources.strings.main_gear_legal}}" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="{{::$root.resources.strings.main_gear_legal}}">\n          </a>\n        </li>\n        <li acc-role="sub-menu-item">\n          <button class="ts-sym" ng-click="settingsBtnPopoverCtrl.openPrivacyLink(); settingsBtnPopoverCtrl.hide()" id="privacy-button" data-tid="privacy-cookies" translate-once="{{::$root.resources.strings.main_gear_privacy}}" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="{{::$root.resources.strings.main_gear_privacy}}"></button>\n        </li>\n        <li acc-role="sub-menu-item" ng-if="::settingsBtnPopoverCtrl.hasTeamsPrivacyFaqUrl()">\n          <button class="ts-sym" ng-click="settingsBtnPopoverCtrl.openPrivacyFaqLink(); settingsBtnPopoverCtrl.hide()" id="teams-privacy-faq-button" data-tid="teams-privacy-faq" translate-once="{{::$root.resources.strings.main_gear_teams_privacy_faq}}" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="{{::$root.resources.strings.main_gear_teams_privacy_faq}}"></button>\n        </li>\n        <li acc-role="sub-menu-item" ng-if="::settingsBtnPopoverCtrl.enableDesktopTpn">\n          <button class="ts-sym" ng-click="settingsBtnPopoverCtrl.desktopThirdPartyNoticeShow(); settingsBtnPopoverCtrl.hide()" translate-once="{{::$root.resources.strings.main_gear_desktop_third_party_notice}}" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="{{::$root.resources.strings.main_gear_desktop_third_party_notice}}"></button>\n        </li>\n        <li acc-role="sub-menu-item" ng-if="::settingsBtnPopoverCtrl.enableDesktopTpn">\n          <button class="ts-sym" data-tid="third-party-notice-button" ng-click="settingsBtnPopoverCtrl.thirdPartyNoticeDialogShow(); settingsBtnPopoverCtrl.hide()" translate-once="{{::$root.resources.strings.main_gear_desktop_browser_third_party_notice}}" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="{{::$root.resources.strings.main_gear_desktop_browser_third_party_notice}}"></button>\n        </li>\n        <li acc-role="sub-menu-item" ng-if="::settingsBtnPopoverCtrl.enableWebTPN">\n          <button class="ts-sym" data-tid="third-party-notice-button" ng-click="settingsBtnPopoverCtrl.thirdPartyNoticeDialogShow(); settingsBtnPopoverCtrl.hide()" translate-once="{{::$root.resources.strings.main_gear_third_party_notice}}" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="{{::$root.resources.strings.main_gear_third_party_notice}}"></button>\n        </li>\n        <li acc-role="sub-menu-item" ng-if="::settingsBtnPopoverCtrl.showPublicDevPreviewSetting" ng-class="::{\'active\': settingsBtnPopoverCtrl.publicDevPreviewEnabled}">\n          <button class="ts-sym" ng-click="settingsBtnPopoverCtrl.togglePublicDevPreview(); settingsBtnPopoverCtrl.hide()" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="{{::settingsBtnPopoverCtrl.publicDevPreviewEnabled ? \'Disable PublicDevPreview\' : \'Enable PublicDevPreview\'}}">\n            {{::$root.resources.strings.main_gear_developer_preview | translate}}\n            <ng-include ng-if="::settingsBtnPopoverCtrl.publicDevPreviewEnabled" src="\'svg/icons-check.html\'" class="right-align-icon"></ng-include>\n          </button>\n        </li>\n      </ul>\n    </li>\n    <li acc-role="menu-item" ng-if="settingsBtnPopoverCtrl.isDesktopApp">\n      <button class="ts-sym" ng-click="settingsBtnPopoverCtrl.checkForUpdates(); settingsBtnPopoverCtrl.hide()" id="checkupdates-button" aria-label="{{::settingsBtnPopoverCtrl.checkUpdateButtonTitle}}" data-tid="checkupdates-button" translate-once="{{::$root.resources.strings.main_gear_check_for_updates}}" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="{{::$root.resources.strings.main_gear_check_for_updates}}"></button>\n    </li>\n    <li acc-role="menu-item" ng-if="::settingsBtnPopoverCtrl.showDesktopDownload">\n      <button class="ts-sym" ng-click="settingsBtnPopoverCtrl.downloadApp(); settingsBtnPopoverCtrl.hide()" id="download-app-button" data-tid="download-app-button" translate-once="{{::$root.resources.strings.main_gear_download_app}}" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="{{::$root.resources.strings.main_gear_download_app}}"></button>\n    </li>\n    <li acc-role="menu-item" ng-if="::settingsBtnPopoverCtrl.showMobileDownload">\n      <button class="ts-sym" ng-click="settingsBtnPopoverCtrl.downloadMobileApp(); settingsBtnPopoverCtrl.hide()" id="download-mobile-app-button" aria-label="{{::settingsBtnPopoverCtrl.downloadMobileAppButtonTitle}}" data-tid="download-mobile-app-button" translate-once="{{::$root.resources.strings.main_gear_download_mobile_apps}}" track-outcome="{{::$root.trackConstants.trackOutcome.select}}" track-scenario="{{::$root.trackConstants.trackScenario.selectSettingOption}}" track-scenario-type="{{::$root.trackConstants.trackScenarioType.config}}" track-name="{{::$root.trackConstants.trackModuleName.settingMenuItem}}" track-type="{{::$root.trackConstants.trackType.other}}" track-summary="{{::$root.resources.strings.main_gear_download_mobile_apps}}"></button>\n    </li>\n  </ul>\n</div>\n'}},[2171]);