webpackJsonp([15],{2206:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2207),i(2209),i(2211),i(2213),i(2217),i(2219),i(2221),i(2223),i(2225),i(2227)},2207:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(2208),a=function(){function e(){this.selectAll=!1,this.updateDeviceSelection()}return e.prototype.toggleSelectAll=function(){this.context.deviceSelection=[],this.context.deviceList&&this.selectAll&&(this.context.deviceSelection=this.context.deviceList.map(function(e){return e})),this.updateDeviceSelection()},e.prototype.selectDevice=function(e){this.isDeviceSelected(e)?this.context.deviceSelection=this.context.deviceSelection.filter(function(t){return t.mri!=e.mri}):this.context.deviceSelection.push(e),this.updateDeviceSelection()},e.prototype.updateDeviceSelection=function(){var e=this;this.context.deviceList?this.selectedDevices=this.context.deviceList.map(function(t){return e.isDeviceSelected(t)}):(this.selectedDevices=[],this.context.deviceList=[],this.context.deviceSelection=[]),this.context.deviceList.length>0&&(this.selectAll=this.context.deviceList.length===this.context.deviceSelection.length)},e.prototype.isDeviceSelected=function(e){return this.context.deviceSelection&&void 0!=this.context.deviceSelection.find(function(t){return e.mri===t.mri})},e}();t.DigitalSignageDevicePickerController=a;var s="components/digital-signage-device-picker/digital-signage-device-picker.html";angular.module("teamspace.digitalSignageDevicePicker",["teamspace.constants","teamspace.loggingService"]).directive("digitalSignageDevicePicker",["constants",function(e){return{restrict:"E",scope:{},bindToController:{context:"="},controller:a,controllerAs:"dsCtrl",templateUrl:s}}]).run(["$templateCache",function(e){e.put(s,n)}])},2208:function(e,t){e.exports='<div class="ts-digital-signage-device-picker">\n  <div class="ds-device-picker-header">\n    <div class="ds-device-picker-displays-label">\n      <span ng-bind="::$root.resources.strings.digital_signage_device_picker_displays | translate"></span>\n      (<span ng-bind="::dsCtrl.context.deviceList.length"></span>)\n    </div>\n    <div class="ds-device-picker-displays-select-all">\n      <span ng-bind="::$root.resources.strings.digital_signage_device_picker_select_all | translate"></span>\n      <teams-checkbox ng-model="dsCtrl.selectAll" tabindex="-1" title="{{::$root.resources.strings.digital_signage_device_picker_click_select_all | translate}}" hide-text="true" ng-click="dsCtrl.toggleSelectAll()" narrator-text="{{::$root.resources.strings.digital_signage_device_picker_click_select_all | translate}}"/>\n    </div>\n  </div>\n  <div class="ds-device-picker-display-list-container" simple-scrollbar>\n    <div class="ds-device-picker-display-list">\n      <div class="ds-device-picker-display-item" ng-repeat="device in ::dsCtrl.context.deviceList" acc-row tabindex="-1" acc-role-dom="table-content-row">\n        <div class="ds-device-picker-icon">\n          <profile-picture person-card pc-mri="::device.mri" pc-display-name="::device.displayName" css-class="ts-profile-img" principal-name="::device.userPrincipalName" display-name="::device.displayName" source="digital-signage-device-picker"/>\n        </div>\n        <div class="ds-device-picker-display-name" acc-cell ng-bind="::device.displayName" acc-role-dom="table-content-cell" tabindex="-1">\n        </div>\n        <div class="ds-device-picker-selection" acc-cell tabindex="-1" acc-role-dom="table-content-cell clickable">\n          <teams-checkbox ng-model="dsCtrl.selectedDevices[$index]" on-click="dsCtrl.selectDevice(device)" tabindex="-1" title="{{::$root.resources.strings.digital_signage_device_picker_click_add_remove_device | translate}}" hide-text="true" narrator-text="{{::$root.resources.strings.digital_signage_device_picker_click_add_remove_device | translate}}"/>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n'},2209:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(2210),a=function(){function e(e,t,i,n){this.okayButtonText=t.instant(i.strings.okay),this.dialogHeaderText=e.ngDialogData.dialogHeaderText,this.dialogDescriptionText=e.ngDialogData.dialogDescriptionText,e.performAction=function(){n.closeAll()}}return e.$inject=["$scope","$translate","resources","ngDialog"],e}();t.DigitalSignageErrorController=a;var s="components/digital-signage-error-dialog/digital-signage-error-dialog.html";angular.module("teamspace.digitalSignageErrorDialog",["teamspace.dialogService","teamspace.loggingService"]).run(["constants","dialogService",function(e,t){t.register(e.dialogs.digitalSignageError,{template:s,className:"ts-modal-dialog ts-confirm-modal-dialog",closeByEscape:!0,closeByDocument:!0,controller:"DigitalSignageErrorController",controllerAs:"dsCtrl",ariaAuto:!1,ariaRole:"dialog"})}]).controller("DigitalSignageErrorController",a).run(["$templateCache",function(e){e.put(s,n)}])},2210:function(e,t){e.exports='<div class="ts-digital-signage-error-dialog" data-tid="digitalSignageErrorDialog">\n  <div class="ts-modal-dialog-header">\n    <div>\n      <img class="error-image" src="https://statics.teams.cdn.office.net/hashedassets/digital-signage-error-ab9e6d5.svg" aria-hidden="true"/>\n    </div>\n    <h1 class="app-font-family-base ts-modal-dialog-title header-text" ng-bind="::dsCtrl.dialogHeaderText" id="digital-signage-error-dialog-title" data-tid="digital-signage-error-dialog-title" aria-label="::dsCtrl.dialogHeaderText">\n    </h1>\n  </div>\n  <div class="ts-modal-dialog-content">\n    <div class="dialog-description">\n      <div ng-bind="::dsCtrl.dialogDescriptionText" aria-label="::dsCtrl.dialogDescriptionText" data-tid="digital-signage-error-dialog-description">\n      </div>\n    </div>\n    <div class="footer-line" data-tid="digital-signage-error-dialog-footer-line">\n    </div>\n  </div>\n  <div class="ts-modal-dialog-footer">\n    <div class="ts-modal-dialog-footer-buttons">\n      <div class="ts-modal-button-div">\n        <button ng-click="performAction($event);" ng-disabled="dialogBusy" class="ts-btn ts-btn-primary inset-border" data-tid="digital-signage-error-dialog-okay-button" acc-role="focus-default" aria-label="{{::$root.resources.strings.okay | translate}}" ng-bind="::dsCtrl.okayButtonText">\n        </button>\n      </div>\n    </div>\n  </div>\n</div>\n'},2211:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(2212),a=function(){function e(e,t,i,n){this.okayButtonText=t.instant(i.strings.okay),this.dialogHeaderText=e.ngDialogData.dialogHeaderText,this.dialogDescriptionText=e.ngDialogData.dialogDescriptionText,e.performAction=function(){n.closeAll()}}return e.$inject=["$scope","$translate","resources","ngDialog"],e}();t.DigitalSignageConfirmationController=a;var s="components/digital-signage-confirmation-dialog/digital-signage-confirmation-dialog.html";angular.module("teamspace.digitalSignageConfirmationDialog",["teamspace.dialogService","teamspace.loggingService"]).run(["constants","dialogService",function(e,t){t.register(e.dialogs.digitalSignageConfirmation,{template:s,className:"ts-modal-dialog ts-confirm-modal-dialog",closeByEscape:!0,closeByDocument:!0,controller:"DigitalSignageConfirmationController",controllerAs:"dsCtrl",ariaAuto:!1,ariaRole:"dialog"})}]).controller("DigitalSignageConfirmationController",a).run(["$templateCache",function(e){e.put(s,n)}])},2212:function(e,t){e.exports='<div class="ts-digital-signage-confirmation-dialog" data-tid="digitalSignageConfirmationDialog">\n  <div class="ts-modal-dialog-header">\n    <h1 class="app-font-family-base ts-modal-dialog-title header-text" ng-bind="::dsCtrl.dialogHeaderText" id="digital-signage-confirmation-dialog-title" data-tid="digital-signage-confirmation-dialog-title" aria-label="::dsCtrl.dialogHeaderText">\n    </h1>\n  </div>\n  <div class="ts-modal-dialog-content">\n    <div ng-bind="::dsCtrl.dialogDescriptionText" aria-label="::dsCtrl.dialogDescriptionText" data-tid="digital-signage-confirmation-dialog-description">\n    </div>\n  </div>\n  <div class="ts-modal-dialog-footer">\n    <div class="ts-modal-dialog-footer-buttons">\n      <div class="ts-modal-button-div">\n        <button ng-click="performAction($event);" ng-disabled="dialogBusy" class="ts-btn ts-btn-primary inset-border" data-tid="digital-signage-confirmation-dialog-okay-button" acc-role="focus-default" aria-label="{{::$root.resources.strings.okay | translate}}" ng-bind="::dsCtrl.okayButtonText"></button>\n      </div>\n    </div>\n  </div>\n</div>\n'},2213:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(2214),a=i(2215),s=i(2216),o=function(){function e(e,t,i,n,a,s,o,l,r,d,c){this.$filter=e,this.$translate=t,this.loggingService=i,this.constants=a,this.resources=s,this.peopleService=l,this.dialogService=r,this.navigationService=d,this.digitalSignageService=c,this.isErrored=!1,this.isLoading=!0,this.isDisplaySectionCollapsed=!1,this.displays=[],this.logger=i.newLogger("digitalSignageTeamDashboardTab");var g=n.getRootRouteParams();this.team=o.getTeamByObjectId(g.threadId)}return e.$inject=["$filter","$translate","loggingService","routeUtilityService","constants","resources","channelService","peopleService","dialogService","navigationService","digitalSignageService"],e.prototype.$onInit=function(){return this.getDisplays()},e.prototype.toggleDisplaySection=function(){this.isDisplaySectionCollapsed=!this.isDisplaySectionCollapsed},e.prototype.sortTable=function(e){this.sortedColumn&&e===this.sortedColumn.name?this.sortedColumn.reverse=!this.sortedColumn.reverse:this.sortedColumn={name:e},this.sortTableInternal()},e.prototype.getContentCellText=function(e){return e.content&&e.content.length?1===e.content.length?this.$translate.instant(this.resources.strings.digital_signage_team_dashboard_tab_header_content_single):this.$translate.instant(this.resources.strings.digital_signage_team_dashboard_tab_header_content_multiple,{contentCount:e.content.length}):this.$translate.instant(this.resources.strings.digital_signage_team_dashboard_tab_header_content_none)},e.prototype.navigateToMembersTab=function(){this.navigationService.navigateDirectPromise(this.constants.states.appTeamDashboard,{teamName:this.team.displayName,threadId:this.team.objectId,middlePane:this.constants.teamDashboardTabs.membersId})},e.prototype.openAddDialog=function(){var e=this;this.dialogService.open(this.constants.dialogs.digitalSignageTeamDashboardTabAdd,{team:this.team,existingDisplayUsers:this.displays.map(function(e){return e.user}),doneCallback:function(t){var i;(i=e.displays).push.apply(i,t)}})},e.prototype.openRemoveDialog=function(e){var t=this;this.dialogService.open(this.constants.dialogs.digitalSignageTeamDashboardTabRemove,{showcase:e.showcase,user:e.user,team:this.team,doneCallback:function(){_.pull(t.displays,e)}})},e.prototype.sortTableInternal=function(){if(this.sortedColumn||(this.sortedColumn={name:"name"}),!(this.displays.length<2)){var e=this.sortedColumn.name;switch(e){case"location":e="user.userLocation";break;case"content":e="showcase.content.length";break;case"name":default:e="user.displayName"}this.displays=this.$filter("orderBy")(this.displays,e,this.sortedColumn.reverse)}},e.prototype.getDisplays=function(){var e=this;this.isLoading=!0;var t=this.loggingService.newScenario(this.constants.scenarios.digitalSignage.teamDashboardTab.tab),i=[];return t.mark(this.constants.scenarios.digitalSignage.step.fetchingShowcases),this.digitalSignageService.getShowcases(this.team.objectId).then(function(n){return i=n.filter(function(t){return t.schemaVersion===e.constants.digitalSignage.tabInTeamDashboardSettings.schemaVersion}),e.logger.debug("Fetched "+i.length+" showcases for teamId: "+e.team.objectId),i.length?(t.mark(e.constants.scenarios.digitalSignage.step.getAllPeopleProfile),e.peopleService.getAllPeopleProfile(i.map(function(e){return e.id}),"digital-signage-team-dashboard-tab")):[]}).then(function(n){e.displays=[],i.forEach(function(t){var i=n.find(function(e){return e.mri===t.id});i?e.displays.push({showcase:t,user:i}):e.logger.error("User is missing for showcase "+t.id+".")}),e.sortTableInternal(),t.stop()}).catch(function(i){e.isErrored=!0,t.fail();var n=JSON.stringify(i);e.logger.error("Error fetching showcases for teamId: "+e.team.objectId+". Error: "+n)}).finally(function(){e.isLoading=!1})},e}();t.DigitalSignageTeamDashboardTabController=o,angular.module("teamspace.digitalSignageTeamDashboardTab",["teamspace.constants","teamspace.locales","pascalprecht.translate","teamspace.routeUtilityService","teamspace.loggingService","teamspace.channelService","teamspace.peopleService","teamspace.navigationService","teamspace.dialogService","teamspace.digitalSignageService"]).run(["$templateCache",function(e){e.put("components/digital-signage/digital-signage-team-dashboard-tab/digital-signage-table.html",a),e.put("components/digital-signage/digital-signage-team-dashboard-tab/digital-signage-empty.html",s)}]).directive("digitalSignageTeamDashboardTab",[function(){return{restrict:"E",scope:{},bindToController:{},template:n,controller:o,controllerAs:"dstdt"}}])},2214:function(e,t){e.exports='<div class="td-digital-signage-tab team-dashboard-tab flex-fill team-dashboard" ng-class="{\'archived\': dstdt.team.isArchived}" data-tid="digitalSignageTeamDashboardTab">\n  <div class="user-actions-container">\n    <div class="left-action-btns">\n      <button type="button" ng-click="dstdt.openAddDialog()" ng-if="dstdt.team && dstdt.team.isAdmin" class="ts-btn ts-btn-fluent ts-btn-fluent-with-icon ts-btn-fluent-primary" ng-disabled="!dstdt.team || dstdt.team.isArchived || dstdt.isLoading">\n        <ng-include class="icon" src="\'svg/icons-desktop.html\'"></ng-include>\n        <span translate-once="{{::$root.resources.strings.digital_signage_team_dashboard_tab_add_display}}"></span>\n      </button>\n    </div>\n  </div>\n\n  <div class="busy-container" ng-if="dstdt.isLoading">\n    <busy-animation size="medium"></busy-animation>\n  </div>\n\n  <div ng-if="!dstdt.isErrored && !dstdt.isLoading">\n    <ng-include ng-if="!dstdt.displays || !dstdt.displays.length" src="\'components/digital-signage/digital-signage-team-dashboard-tab/digital-signage-empty.html\'">\n    </ng-include>\n\n    <ng-include ng-if="dstdt.displays.length" src="\'components/digital-signage/digital-signage-team-dashboard-tab/digital-signage-table.html\'">\n    </ng-include>\n  </div>\n</div>'},2215:function(e,t){e.exports='<div>\n  <div>\n    <button class="ts-sym expand-collapse-button" tabindex="0" data-tid="td-digital-signage-accordion" ng-click="dstdt.toggleDisplaySection()" aria-expanded="{{!dstdt.isDisplaySectionCollapsed}}" role="button">\n      <div class="expand-collapse-icon expand-collapse-icon-default icons-gray-06-triangle-fill">\n        <ng-include ng-if="dstdt.isDisplaySectionCollapsed" src="\'svg/icons-triangle-right-small.html\'">\n        </ng-include>\n        <ng-include ng-if="!dstdt.isDisplaySectionCollapsed" src="\'svg/icons-triangle-down-small.html\'">\n        </ng-include>\n      </div>\n      <span class="section-header-count">({{dstdt.displays.length}})</span>\n    </button>\n  </div>\n  <div ng-if="!dstdt.isDisplaySectionCollapsed && dstdt.displays.length" class="access-container flex-fill" acc-role-dom="table-keyboard tab-handler-table-list">\n    <div class="td-digital-signage-container-headers" ng-if="!dstdt.isLoading" acc-role="table-header-row" role="rowheader">\n      \x3c!-- digital signage name header--\x3e\n      <div class="td-header-name" acc-role="table-header-column clickable" aria-label="{{::$root.resources.strings.digital_signage_team_dashboard_tab_header_name_aria|translate}}" role="columnheader">\n        <button class="btn btn-default header-button icons-gray-06-triangle-fill" ng-click="dstdt.sortTable(\'name\')" tabindex="-1">\n          <div>\n            <div class="header-button-text" translate-once="{{::$root.resources.strings.digital_signage_team_dashboard_tab_header_name}}"></div>\n            <div ng-if="dstdt.sortedColumn.name === \'name\' && dstdt.sortedColumn.reverse" aria-label="{{::$root.resources.strings.digital_signage_team_dashboard_tab_header_ascending|translate}}">\n              <ng-include class="icon" src="\'svg/icons-triangle-down-small.html\'"></ng-include>\n            </div>\n            <div ng-if="dstdt.sortedColumn.name === \'name\' && !dstdt.sortedColumn.reverse" aria-label="{{::$root.resources.strings.digital_signage_team_dashboard_tab_header_descending|translate}}">\n              <ng-include class="icon" src="\'svg/icons-triangle-up-small.html\'"></ng-include>\n            </div>\n          </div>\n        </button>\n      </div>\n      \x3c!-- digital signage location header--\x3e\n      <div class="td-header-location" acc-role="table-header-column clickable" aria-label="{{::$root.resources.strings.digital_signage_team_dashboard_tab_header_location_aria|translate}}" role="columnheader">\n        <button class="btn btn-default header-button icons-gray-06-triangle-fill" ng-click="dstdt.sortTable(\'location\')" tabindex="-1">\n          <div>\n            <div class="header-button-text" translate-once="{{::$root.resources.strings.digital_signage_team_dashboard_tab_header_location}}"></div>\n            <div ng-if="dstdt.sortedColumn.name === \'location\' && dstdt.sortedColumn.reverse" aria-label="{{::$root.resources.strings.digital_signage_team_dashboard_tab_header_ascending|translate}}">\n              <ng-include class="icon" src="\'svg/icons-triangle-down-small.html\'">\n              </ng-include>\n            </div>\n            <div ng-if="dstdt.sortedColumn.name === \'location\' && !dstdt.sortedColumn.reverse" aria-label="{{::$root.resources.strings.digital_signage_team_dashboard_tab_header_descending|translate}}">\n              <ng-include class="icon" src="\'svg/icons-triangle-up-small.html\'">\n              </ng-include>\n            </div>\n          </div>\n        </button>\n      </div>\n        \x3c!-- digital signage content header--\x3e\n      <div class="td-header-content" acc-role="table-header-column clickable" aria-label="{{::$root.resources.strings.digital_signage_team_dashboard_tab_header_content_aria|translate}}" role="columnheader">\n        <button class="btn btn-default header-button icons-gray-06-triangle-fill" ng-click="dstdt.sortTable(\'content\')" tabindex="-1">\n          <div>\n            <div class="header-button-text" translate-once="{{::$root.resources.strings.digital_signage_team_dashboard_tab_header_content}}"></div>\n            <div ng-if="dstdt.sortedColumn.name === \'content\' && dstdt.sortedColumn.reverse" aria-label="{{::$root.resources.strings.digital_signage_team_dashboard_tab_header_ascending|translate}}">\n              <ng-include class="icon" src="\'svg/icons-triangle-down-small.html\'">\n              </ng-include>\n            </div>\n            <div ng-if="dstdt.sortedColumn.name === \'content\' && !dstdt.sortedColumn.reverse" aria-label="{{::$root.resources.strings.digital_signage_team_dashboard_tab_header_descending|translate}}">\n              <ng-include class="icon" src="\'svg/icons-triangle-up-small.html\'">\n              </ng-include>\n            </div>\n          </div>\n        </button>\n      </div>\n      <div class="td-digital-signage-actions" aria-role="presentation">\n        \x3c!-- placeholder for column alignment. --\x3e\n      </div>\n    </div>\n    <div class="td-digital-signage-scroll-container" ng-if="!dstdt.isLoading && dstdt.displays.length" tabindex="-1" simple-scrollbar enable-dynamic-adjusting-scrollbar="true">\n      <div>\n        \x3c!-- Uses Virtual Repeat control which limits the list of items to the visible area and\n            manages adding/removing items based on the scroll https://github.com/kamilkp/angular-vs-repeat --\x3e\n        \x3c!-- vs-repeat="48" Note: without Row Height(48px) vs-repeat is rendering the full-list and scoping it down --\x3e\n        <div class="td-digital-signage-container" data-tid="digitalSignageTeamDashboardTab-digital-signage-table" vs-repeat="48" vs-excess="10" vs-scroll-parent=".td-digital-signage-scroll-container" role="rowgroup" tabindex="-1">\n          <div class="td-digital-signage" ng-repeat="display in dstdt.displays track by display.user.objectId" data-tid="digitalSignageTeamDashboardTab-digital-signage-{{::display.name}}" acc-role="table-content-row" role="row">\n              <div class="td-cell-name" acc-role="table-content-cell" aria-label="{{::display.user.displayName}}" role="cell">\n              <div class="display-avatar" aria-hidden="true">\n                <profile-picture mri="::display.user.mri" css-class="img-circle" size="::dstdt.constants.profilePictureSizes.xsmall" principal-name="::display.user.userPrincipalName" display-name="::display.user.displayName" source="digital-signage-team-dashboard-tab">\n                </profile-picture>\n              </div>\n              <span class="display-name" ng-bind="::display.user.displayName"></span>\n            </div>\n            \x3c!-- digital signage location cell --\x3e\n            <div class="td-cell-location" acc-role="table-content-cell" role="cell">\n              <span ng-bind="::display.user.userLocation"></span>\n            </div>\n            \x3c!-- digital signage content cell --\x3e\n            <div class="td-cell-content" acc-role="table-content-cell" role="cell">\n              <span ng-bind="::dstdt.getContentCellText(display.showcase)"></span>\n            </div>\n            \x3c!-- digital signage action cell --\x3e\n            <div class="td-digital-signage-actions hover-visible" acc-role="table-content-cell" role="cell">\n              <button class="ts-btn app-icons-fill-hover digital-signage-action-btn icons-close" ng-if="dstdt.team && dstdt.team.isAdmin" ng-disabled="dstdt.isLoading" ng-click="dstdt.openRemoveDialog(display)" type="button" aria-label="{{::$root.resources.strings.digital_signage_remove | translate}}" data-tid="digital-signage-action-btn-close">\n                <ng-include class="icon icons-close" src="\'svg/icons-close.html\'">\n                </ng-include>\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>'},2216:function(e,t){e.exports='<div class="empty-container">\n  <svg-include class="empty-image" src="\'svg/something-went-wrong-empty-state.html\'">\n  </svg-include>\n  <div ng-if="dstdt.team && dstdt.team.isAdmin" class="empty-title empty-text-max-width app-font-title2-bold" translate-once="{{::$root.resources.strings.digital_signage_team_dashboard_tab_empty_admin}}">\n  </div>\n  <div ng-if="!dstdt.team || !dstdt.team.isAdmin" class="empty-title empty-text-max-width app-font-title2-bold">\n    <span translate-once="{{::$root.resources.strings.digital_signage_team_dashboard_tab_empty_member_1}}"></span>\n    <span class="member-button" ng-click="dstdt.navigateToMembersTab()" translate-once="{{::$root.resources.strings.digital_signage_team_dashboard_tab_empty_member_2}}"></span>\n    <span translate-once="{{::$root.resources.strings.digital_signage_team_dashboard_tab_empty_member_3}}"></span>\n  </div>\n</div>\n'},2217:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(2218),a=function(){function e(e,t,i,n,a,s,o){var l=this;this.$scope=e,this.$timeout=t,this.loggingService=i,this.constants=a,this.teamMembershipService=s,this.digitalSignageService=o,this.isLoading=!1,this.isDone=!1,this.selectedDisplayUsers=[],this.selectDisplayUser=function(e){l.selectedDisplayUsers.push(e),l.focusPeoplePickerInput()},this.logger=i.newLogger("DigitalSignageTeamDashboardTabAddDialogController");var r=n.valueAsBoolean(a.settings.names.enableDigitalSignageTeamExpoFilter);this.peoplePickerFilters=r?teamspace.services.PeoplePickerFor[teamspace.services.PeoplePickerFor.searchExpoDisplays]:teamspace.services.PeoplePickerFor[teamspace.services.PeoplePickerFor.addToTeam],this.team=e.ngDialogData.team,this.existingDisplayUsers=e.ngDialogData.existingDisplayUsers,this.doneCallback=e.ngDialogData.doneCallback,this.focusPeoplePickerInput(500)}return e.$inject=["$scope","$timeout","loggingService","settingsService","constants","teamMembershipService","digitalSignageService"],e.prototype.removeSelectedDisplayUser=function(e){_.pull(this.selectedDisplayUsers,e),this.focusPeoplePickerInput()},Object.defineProperty(e.prototype,"getExcludedUserObjectIds",{get:function(){return this.existingDisplayUsers.map(function(e){return e.objectId}).concat(this.selectedDisplayUsers.map(function(e){return e.objectId}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"getExcludedUsersMris",{get:function(){return this.existingDisplayUsers.map(function(e){return e.mri}).concat(this.selectedDisplayUsers.map(function(e){return e.mri}))},enumerable:!0,configurable:!0}),e.prototype.addDisplays=function(){var e=this;if(!this.selectedDisplayUsers.length)return Promise.resolve();this.isLoading=!0;var t=this.loggingService.newScenario(this.constants.scenarios.digitalSignage.teamDashboardTab.addDialog),i=[],n=this.selectedDisplayUsers.map(function(e){var t=e;return t.isOwner=!1,t.isOwnerSpecified=!1,t.role=teamspace.middletier.Role.Member,t});return t.mark(this.constants.scenarios.digitalSignage.step.addTeamUsers),this.teamMembershipService.addTeamUsers(this.team,n).catch(function(i){var n=JSON.stringify(i);t.fail({message:n}),e.logger.error(n),Promise.all(e.selectedDisplayUsers.map(function(t){return e.teamMembershipService.removeTeamUser(e.team.objectId,t.userPrincipalName,t.mri,e.constants.RoleConstants.User)}))}).then(function(n){if(n)return t.mark(e.constants.scenarios.digitalSignage.step.creatingShowcase),Promise.all(e.selectedDisplayUsers.map(function(t){var n={schemaVersion:e.constants.digitalSignage.tabInTeamDashboardSettings.schemaVersion,display:t.mri};return e.digitalSignageService.createShowcase(e.team.objectId,n).catch(function(i){e.logger.error(JSON.stringify(i)),e.teamMembershipService.removeTeamUser(e.team.objectId,t.userPrincipalName,t.mri,e.constants.RoleConstants.User)}).then(function(n){n&&(i.push({showcase:n,user:t}),_.pull(e.selectedDisplayUsers,t))})}))}).then(function(n){if(n){if(e.doneCallback(i),e.selectedDisplayUsers.length){var a="addDisplays() was incomplete: "+i.length+" added and "+e.selectedDisplayUsers.length+" failed.";return t.incomplete({message:a}),void e.logger.warn(a)}t.stop(),e.isDone=!0,e.$timeout(function(){e.$scope.closeThisDialog()},2e3)}}).finally(function(){e.isLoading=!1})},e.prototype.focusPeoplePickerInput=function(e){return this.$timeout(function(){var e=angular.element(".ts-people-picker input");e&&e.length>0&&e.focus()},e||0)},e}();t.DigitalSignageTeamDashboardTabAddDialogController=a;var s="components/digital-signage-team-dashboard-tab-add-dialog/digital-signage-team-dashboard-tab-add-dialog.html";angular.module("teamspace.digitalSignageTeamDashboardTabAddDialog",["teamspace.dialogService","teamspace.constants","teamspace.loggingService","teamspace.settingsService","teamspace.teamMembershipService","teamspace.digitalSignageService"]).run(["$templateCache",function(e){e.put(s,n)}]).controller("DigitalSignageTeamDashboardTabAddDialogController",a).run(["constants","dialogService",function(e,t){t.register(e.dialogs.digitalSignageTeamDashboardTabAdd,{template:s,className:"ts-modal-dialog ts-modal-dialog-container",closeByEscape:!1,closeByDocument:!1,controller:"DigitalSignageTeamDashboardTabAddDialogController",controllerAs:"ctrl",ariaAuto:!1,ariaRole:"dialog"})}])},2218:function(e,t){e.exports='<div class="td-digital-signage-tab-add-dialog" data-tid="digitalSignageTeamDashboardTabAddDialog">\n  <div class="ts-modal-dialog-header">\n    <span class="app-font-family-base ts-modal-dialog-title" ng-class="{\'invisible\': ctrl.isDone}" translate-once="{{::$root.resources.strings.digital_signage_team_dashboard_tab_add_dialog_header}}" translate-values="::{teamName: ctrl.team.displayName}">\n    </span>\n  </div>\n  <div class="ts-modal-dialog-content">\n    <div ng-if="!ctrl.isDone">\n      <div translate-once="{{::$root.resources.strings.digital_signage_team_dashboard_tab_add_dialog_search_label}}">\n      </div>\n      <div class="people-picker-container" acc-focus-default ng-class="{\'is-focus\': ctrl.isPeoplePickerFocused}">\n        <people-picker type="search" acc-role="focus-default" contact-selected="ctrl.selectDisplayUser" selections="ctrl.selectedDisplayUsers" custom-class="td-digital-signage-tab-add-dialog-people-picker-dropdown" placeholder="{{::$root.resources.strings.digital_signage_team_dashboard_tab_add_dialog_search_placeholder | translate}}" hide-logged-in-user="true" add-number-contact="false" is-external-search-enabled="false" is-bot-search-enabled="false" include-distribution-lists="false" is-add-to-team-and-tenant-enabled="false" should-hide-guest-results="true" get-excluded-object-ids="ctrl.getExcludedUserObjectIds" get-excluded-user-mris="ctrl.getExcludedUsersMris" search-filter="[\'NonADUser\', \'DistributionList\', \'Channel\']" people-picker-filters="{{ctrl.peoplePickerFilters}}" is-disabled="ctrl.isLoading" is-focused="ctrl.isPeoplePickerFocused" picker-usage-area="DigitalSignagePicker">\n        </people-picker>\n        <span class="icon search-box-icon hidden-text" aria-hidden="true">\n          <ng-include src="\'svg/icons-search.html\'"></ng-include>\n        </span>\n      </div>\n      <div class="display-user-list-scroll-container" simple-scrollbar enable-dynamic-adjusting-scrollbar="true">\n        <div class="display-user-list" acc-role="list">\n          <div class="display-user-list-row" acc-role="list-item clickable" role="listitem" ng-repeat="user in ctrl.selectedDisplayUsers track by user.objectId">\n            <div aria-hidden="true">\n              <profile-picture mri="::user.mri" css-class="img-circle" size="::ctrl.constants.profilePictureSizes.xsmall" principal-name="::user.userPrincipalName" display-name="::user.displayName" source="digital-signage-team-dashboard-tab-add-dialog">\n              </profile-picture>\n            </div>\n            <div class="display-user-list-column">\n              <div ng-bind="::user.displayName"></div>\n              <div ng-bind="::user.userLocation"></div>\n            </div>\n            <div>\n              <button class="ts-btn app-icons-fill-hover" type="button" role="button" ng-click="ctrl.removeSelectedDisplayUser(user)" ng-disable="ctrl.isLoading">\n                <ng-include class="icon icons-close" ng-class="{\'icons-close-disabled\': ctrl.isLoading}" src="\'svg/icons-close.html\'">\n                </ng-include>\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div class="ts-modal-dialog-content-confirmation" ng-if="ctrl.isDone">\n      <img src="https://statics.teams.cdn.office.net/hashedassets/confirmation-653e0fa.svg" class="confirmation-svg"/>\n      <p class="app-font-title-bold" translate-once="{{::$root.resources.strings.digital_signage_team_dashboard_tab_add_dialog_confirmation_1}}">\n      </p>\n      <p translate-with-html-params translate-id="digital_signage_team_dashboard_tab_add_dialog_confirmation_2" translate-values=\'{"memberPermission":\n                              "<a>\n                                <span translate-once=\\"{{::$root.resources.strings.digital_signage_team_dashboard_tab_add_dialog_confirmation_3}}\\"></span>\n                              </a>"\n                            }\'>\n      </p>\n    </div>\n  </div>\n  <div class="ts-modal-dialog-footer">\n    <div class="ts-modal-dialog-footer-buttons" ng-class="{\'invisible\': ctrl.isDone}">\n      <busy-animation ng-if="ctrl.isLoading" size="small">\n      </busy-animation>\n      <div class="ts-modal-button-div">\n        <button class="ts-btn ts-btn-fluent ts-btn-fluent-secondary ngdialog-close" ng-disabled="ctrl.isLoading" translate-once="{{::$root.resources.strings.cancel}}">\n        </button>\n      </div>\n      <div class="ts-modal-button-div">\n        <button class="ts-btn ts-btn-fluent ts-btn-fluent-primary" translate-once="{{::$root.resources.strings.digital_signage_add}}" ng-disabled="ctrl.isLoading || !ctrl.selectedDisplayUsers.length" ng-click="ctrl.addDisplays()">\n        </button>\n      </div>\n    </div>\n  </div>\n</div>'},2219:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(2220),a=function(){function e(e,t,i,n,a){this.$scope=e,this.loggingService=t,this.constants=i,this.teamMembershipService=n,this.digitalSignageService=a,this.isLoading=!1,this.logger=t.newLogger("DigitalSignageTeamDashboardTabRemoveDialogController"),this.showcase=e.ngDialogData.showcase,this.user=e.ngDialogData.user,this.team=e.ngDialogData.team,this.doneCallback=e.ngDialogData.doneCallback}return e.$inject=["$scope","loggingService","constants","teamMembershipService","digitalSignageService"],e.prototype.removeDisplay=function(){var e=this;this.isLoading=!0;var t=this.loggingService.newScenario(this.constants.scenarios.digitalSignage.teamDashboardTab.removeDialog);return t.mark(this.constants.scenarios.digitalSignage.step.removeTeamUser),this.teamMembershipService.removeTeamUser(this.team.objectId,this.user.userPrincipalName,this.user.mri,this.constants.RoleConstants.User).catch(function(i){if(404!==i.status||"UserNotFoundInSkypeTeam"!==i._code){var n=JSON.stringify(i);throw t.fail({message:n}),e.logger.error(n),new Error("handled")}}).then(function(){return t.mark(e.constants.scenarios.digitalSignage.step.removeShowcase),e.digitalSignageService.deleteShowcase(e.team.objectId,e.showcase.id,e.constants.digitalSignage.tabInTeamDashboardSettings.schemaVersion)}).then(function(){t.stop(),e.doneCallback(),e.$scope.closeThisDialog()}).catch(function(i){if("handled"!==i.message){if(404===i.statusCode&&"SharepointItemDoesNotExist"===i.errorCode)return e.doneCallback(),void e.$scope.closeThisDialog();var n=JSON.stringify(i);t.fail({message:n}),e.logger.error(n);var a=e.user;a.isOwner=!1,a.isOwnerSpecified=!1,a.role=teamspace.middletier.Role.Member,e.teamMembershipService.addTeamUsers(e.team,[a])}}).finally(function(){e.isLoading=!1})},e}();t.DigitalSignageTeamDashboardTabRemoveDialogController=a;var s="components/digital-signage-team-dashboard-tab-remove-dialog/digital-signage-team-dashboard-tab-remove-dialog.html";angular.module("teamspace.digitalSignageTeamDashboardTabRemoveDialog",["teamspace.dialogService","teamspace.constants","teamspace.loggingService","teamspace.teamMembershipService","teamspace.digitalSignageService"]).run(["$templateCache",function(e){e.put(s,n)}]).controller("DigitalSignageTeamDashboardTabRemoveDialogController",a).run(["constants","dialogService",function(e,t){t.register(e.dialogs.digitalSignageTeamDashboardTabRemove,{template:s,className:"ts-modal-dialog ts-confirm-modal-dialog",closeByEscape:!1,closeByDocument:!1,controller:"DigitalSignageTeamDashboardTabRemoveDialogController",controllerAs:"ctrl",ariaAuto:!1,ariaRole:"dialog"})}])},2220:function(e,t){e.exports='<div class="td-digital-signage-remove-dialog" data-tid="digitalSignageTeamDashboardTabRemoveDialog">\n    <div class="ts-modal-dialog-header">\n      <div class="app-font-family-base ts-modal-dialog-title header-text" translate-once="{{::$root.resources.strings.digital_signage_team_dashboard_tab_remove_dialog_header}}" translate-values="::{digitalSignageName: ctrl.user.displayName, teamName: ctrl.team.displayName}">\n    </div>\n    </div>\n    <div class="ts-modal-dialog-content">\n    </div>\n    <div class="ts-modal-dialog-footer">\n      <div class="ts-modal-dialog-footer-buttons">\n        <busy-animation ng-if="ctrl.isLoading" size="small">\n        </busy-animation>\n        <div class="ts-modal-button-div">\n          <button class="ts-btn ts-btn-fluent ts-btn-fluent-secondary ngdialog-close" ng-disabled="ctrl.isLoading" translate-once="{{::$root.resources.strings.cancel}}">\n          </button>\n        </div>\n        <div class="ts-modal-button-div">\n          <button class="ts-btn ts-btn-fluent ts-btn-fluent-primary" ng-disabled="ctrl.isLoading" ng-click="ctrl.removeDisplay()" translate-once="{{::$root.resources.strings.digital_signage_remove}}">\n          </button>\n        </div>\n      </div>\n    </div>\n  </div>'},2221:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(2222),a=function(){function e(e,t,i,n,a,s,o){this.constants=e,this.loggingService=t,this.peopleService=a,this.dialogService=s,this.digitalSignageService=o,this.displaysInTeam=[],this.isLoading=!0,this.isInitializing=!0,this.isErrored=!1,this.isAutomaticSharingEnabled=!0,this.displaysOfConversationsContent=[],this.logger=t.newLogger("digitalSignageChannelSettings");var l=i.getRootRouteParams(),r=n.getParentTeamAndChannelByChannelId(l.threadId);r&&(this.channel=r.channel,this.team=r.team)}return e.$inject=["constants","loggingService","routeUtilityService","channelService","peopleService","dialogService","digitalSignageService"],e.prototype.$onInit=function(){var e=this;return this.isInitializing=!0,this.getDisplaysOfChannelConversationContent().finally(function(){e.isInitializing=!1})},e.prototype.toggleAutomaticSharingEnabled=function(e){var t=this;if(!this.displaysOfConversationsContent.length)return Promise.resolve();this.isLoading=!0;var i=this.loggingService.newScenario(this.constants.scenarios.digitalSignage.channelSettings.settings);return this.isErrored=!1,this.isAutomaticSharingEnabled=!1,i.mark(this.constants.scenarios.digitalSignage.step.updatingShowcaseContent),Promise.all(this.displaysOfConversationsContent.map(function(i){var n=t.findChannelConversationsContent(i.showcase);return n.enabled=e,t.digitalSignageService.updateShowcaseContent(t.team.objectId,i.showcase.id,n.id,n,t.constants.digitalSignage.channelSettings.schemaVersion).catch(function(e){404!==e.statusCode||"SharepointItemDoesNotExist"!==e.errorCode?(t.logger.error(JSON.stringify(e)),t.isErrored=!0):_.pull(t.displaysOfConversationsContent,i)})})).then(function(){if(!t.isErrored)return i.stop(),t.displaysOfConversationsContent.length?(t.isAutomaticSharingEnabled=e,void(t.isLoading=!1)):(t.isAutomaticSharingEnabled=!0,void(t.isLoading=!1));i.mark(t.constants.scenarios.digitalSignage.step.updatingShowcaseContent),t.displaysOfConversationsContent.forEach(function(i){var n=t.findChannelConversationsContent(i.showcase);n.enabled=!e,t.digitalSignageService.updateShowcaseContent(t.team.objectId,i.showcase.id,n.id,n,t.constants.digitalSignage.channelSettings.schemaVersion)}),t.isAutomaticSharingEnabled=!e,t.isLoading=!1,i.fail()})},e.prototype.removeDisplayChannelConversationsContent=function(e){var t=this;this.isLoading=!0;var i=this.loggingService.newScenario(this.constants.scenarios.digitalSignage.channelSettings.settings),n=this.findChannelConversationsContent(e.showcase);return i.mark(this.constants.scenarios.digitalSignage.step.removingShowcaseContent),this.digitalSignageService.deleteShowcaseContent(this.team.objectId,e.showcase.id,n.id,this.constants.digitalSignage.channelSettings.schemaVersion).then(function(){_.pull(e.showcase.content,n),_.pull(t.displaysOfConversationsContent,e),i.stop()}).catch(function(a){if(404===a.statusCode&&"SharepointItemDoesNotExist"===a.errorCode)return _.pull(e.showcase.content,n),_.pull(t.displaysOfConversationsContent,e),void i.stop();i.fail(),t.logger.error(JSON.stringify(a))}).finally(function(){t.isLoading=!1})},e.prototype.openAddConversationsContentDialog=function(){this.dialogService.open(this.constants.dialogs.digitalSignageChannelSettingsAdd,{team:this.team,channel:this.channel,displaysOfConversationsContent:this.displaysOfConversationsContent,displaysInTeam:this.displaysInTeam})},e.prototype.findChannelConversationsContent=function(e){var t=this;return e.content.find(function(e){return e.definitionId===t.constants.digitalSignage.conversationsTabDefinitionId&&e.channelThreadId===t.channel.objectId})},e.prototype.getDisplaysOfChannelConversationContent=function(){var e=this;this.isLoading=!0;var t=this.loggingService.newScenario(this.constants.scenarios.digitalSignage.channelSettings.settings);this.displaysOfConversationsContent=[];var i=[];return t.mark(this.constants.scenarios.digitalSignage.step.fetchingShowcases),this.digitalSignageService.getShowcases(this.team.objectId).then(function(n){return i=n.filter(function(t){return t.schemaVersion===e.constants.digitalSignage.channelSettings.schemaVersion}),e.logger.debug("Fetched "+i.length+" showcases for team: "+e.team.objectId),i.length?(t.mark(e.constants.scenarios.digitalSignage.step.getAllPeopleProfile),e.peopleService.getAllPeopleProfile(i.map(function(e){return e.id}),"digital-signage-channel-settings")):[]}).then(function(n){i.forEach(function(t){var i=n.find(function(e){return e.mri===t.id});i?e.displaysInTeam.push({showcase:t,user:i}):e.logger.error("User is missing for showcase "+t.id+".")}),e.displaysOfConversationsContent=e.displaysInTeam.filter(function(t){return t.showcase.content&&e.findChannelConversationsContent(t.showcase)}),t.stop()}).catch(function(i){e.isErrored=!0,t.fail();var n=JSON.stringify(i);e.logger.error("Error fetching showcases for teamId: "+e.team.objectId+". Error: "+n)}).finally(function(){e.isAutomaticSharingEnabled=!e.displaysOfConversationsContent.length||e.findChannelConversationsContent(e.displaysOfConversationsContent[0].showcase).enabled,e.isLoading=!1})},e}();t.DigitalSignageChannelSettingsController=a,angular.module("teamspace.digitalSignageChannelSettings",["teamspace.constants","teamspace.routeUtilityService","teamspace.loggingService","teamspace.channelService","teamspace.peopleService","teamspace.dialogService","teamspace.digitalSignageService"]).directive("digitalSignageChannelSettings",[function(){return{restrict:"E",scope:{},bindToController:{},template:n,controller:a,controllerAs:"dscs"}}])},2222:function(e,t){e.exports='<div class="td-team-section first-section digital-signage-channel-settings">\n  <div class="flex-row" ng-init="showDigitalSignageAutomaticSharing=true">\n    <div class="title-col">\n      <div tabindex="0" class="pointer" aria-labelledby="digitalSignageAutomaticSharingTitle digitalSignageAutomaticSharingDesc" role="menu" aria-expanded="{{showDigitalSignageAutomaticSharing}}" ng-click="showDigitalSignageAutomaticSharing = !showDigitalSignageAutomaticSharing">\n        <div class="ts-sym expand-collapse expand-collapse-button icons-gray-06-triangle-fill triangle-container">\n          <ng-include ng-show="showDigitalSignageAutomaticSharing" src="\'svg/icons-triangle-down-small.html\'"></ng-include>\n          <ng-include ng-show="!showDigitalSignageAutomaticSharing" src="\'svg/icons-triangle-right-small.html\'"></ng-include>\n        </div>\n        <div class="title" id="digitalSignageAutomaticSharingTitle" translate-once="{{::$root.resources.strings.digital_signage_automatic_sharing}}">\n        </div>\n      </div>\n      <toggle-switch class="toggle" data-tid="digital-signage-content-management-dialog-toggle-channel-rules" ds-aria-label="{{dscs.isAutomaticSharingEnabled ? ($root.resources.strings.aria_toggleChannelSettingsAutomaticSharing_on|translate) : ($root.resources.strings.aria_toggleChannelSettingsAutomaticSharing_off|translate)}}" ng-show="showDigitalSignageAutomaticSharing" is-checked="dscs.isAutomaticSharingEnabled" is-disabled="dscs.isLoading || !dscs.team.isAdmin || !dscs.displaysOfConversationsContent.length" on-toggle="dscs.toggleAutomaticSharingEnabled(isChecked)">\n      </toggle-switch>\n    </div>\n    <div class="detail-col" ng-class="{\'disabled\': !dscs.team.isAdmin || !dscs.isAutomaticSharingEnabled}">\n      <div class="caption gray-text desc" id="digitalSignageAutomaticSharingDesc" translate-once="{{::$root.resources.strings.digital_signage_automatic_sharing_header}}">\n      </div>\n    </div>\n  </div>\n  <div class="flex-row" ng-show="showDigitalSignageAutomaticSharing">\n    <div class="title-col"></div>\n    <div class="detail-col td-ts-per-sec" ng-class="{\'disabled\': !dscs.team.isAdmin || !dscs.isAutomaticSharingEnabled}">\n      <busy-animation ng-if="dscs.isInitializing" size="small">\n      </busy-animation>\n      <div class="digital-signage-channel-settings-display" ng-if="!dscs.isInitializing">\n        <div class="digital-signage-channel-settings-display-label">\n          <div class="app-font-caption-bold" translate-once="{{::$root.resources.strings.digital_signage_automatic_sharing_list_label}}">\n          </div>\n          <button type="button" class="ts-sym has-icon" ng-disabled="!dscs.team.isAdmin || dscs.isLoading || !dscs.isAutomaticSharingEnabled" ng-click="dscs.openAddConversationsContentDialog()">\n            <ng-include class="icon" aria-hidden="true" src="\'svg/icons-add.html\'">\n            </ng-include>\n            <div translate-once="{{::$root.resources.strings.digital_signage_add_displays}}"></div>\n          </button>\n        </div>\n        <div class="digital-signage-channel-settings-display-list" ng-if="dscs.displaysOfConversationsContent.length">\n          <div acc-role="list">\n            <div class="digital-signage-channel-settings-display-list-row" acc-role="list-item clickable" role="listitem" ng-repeat="display in dscs.displaysOfConversationsContent track by display.user.objectId">\n              <profile-picture mri="::display.user.mri" css-class="img-circle" size="::dscs.constants.profilePictureSizes.xsmall" principal-name="::display.user.userPrincipalName" display-name="::display.user.displayName" source="digital-signage-channel-settings" aria-hidden="true">\n              </profile-picture>\n              <div class="digital-signage-channel-settings-display-list-row-info" ng-bind="::display.user.displayName">\n              </div>\n              <div class="digital-signage-channel-settings-display-list-row-btn">\n                <button class="ts-btn app-icons-fill-hover icons-close" type="button" role="button" ng-click="dscs.removeDisplayChannelConversationsContent(display)" ng-disabled="!dscs.team.isAdmin || dscs.isLoading || !dscs.isAutomaticSharingEnabled">\n                  <ng-include class="icon icons-close" ng-class="{\'icons-close-disabled\': dscs.isLoading}" src="\'svg/icons-close.html\'">\n                  </ng-include>\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div class="digital-signage-channel-settings-display-list-empty" ng-if="!dscs.displaysOfConversationsContent.length" translate-once="{{::$root.resources.strings.digital_signage_automatic_sharing_list_empty}}">\n        </div>\n      </div>\n    </div>\n  </div>\n</div>'},2223:function(e,t,i){"use strict";var n=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;for(var n=Array(e),a=0,t=0;t<i;t++)for(var s=arguments[t],o=0,l=s.length;o<l;o++,a++)n[a]=s[o];return n};Object.defineProperty(t,"__esModule",{value:!0});var a=i(2224),s=function(){function e(e,t,i,n,a,s){this.$scope=e,this.$translate=t,this.loggingService=i,this.constants=n,this.resources=a,this.digitalSignageService=s,this.isLoading=!1,this.isErrored=!1,this.logger=i.newLogger("DigitalSignageChannelSettingsAddDialogController"),this.team=e.ngDialogData.team,this.channel=e.ngDialogData.channel,this.displaysOfConversationsContent=e.ngDialogData.displaysOfConversationsContent,this.displaysInTeam=e.ngDialogData.displaysInTeam,this.digitalSignageDialogContext={deviceSelection:this.displaysOfConversationsContent.map(function(e){return e.user}),deviceList:this.displaysInTeam.map(function(e){return e.user}),showcaseContent:null,contentProps:null},this.originalDeviceSelection=_.clone(this.digitalSignageDialogContext.deviceSelection)}return e.$inject=["$scope","$translate","loggingService","constants","resources","digitalSignageService"],Object.defineProperty(e.prototype,"textOfDisplaySelection",{get:function(){switch(this.digitalSignageDialogContext.deviceSelection.length){case 0:return null;case 1:return this.$translate.instant(this.resources.strings.digital_signage_automatic_sharing_selected_single);default:return this.$translate.instant(this.resources.strings.digital_signage_automatic_sharing_selected_multiple,{displayCount:this.digitalSignageDialogContext.deviceSelection.length})}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDeviceSelectionMutated",{get:function(){return this.digitalSignageDialogContext.deviceSelection.length!==this.originalDeviceSelection.length||_.xor(this.digitalSignageDialogContext.deviceSelection,this.originalDeviceSelection).length},enumerable:!0,configurable:!0}),e.prototype.chooseDisplaysForConversationsContent=function(){var e=this;this.isLoading=!0,this.isErrored=!1;var t=this.loggingService.newScenario(this.constants.scenarios.digitalSignage.channelSettings.addDialog);return t.mark(this.constants.scenarios.digitalSignage.step.removingShowcaseContent),Promise.all(_.without.apply(_,n([this.originalDeviceSelection],this.digitalSignageDialogContext.deviceSelection)).map(function(t){var i=e.displaysOfConversationsContent.find(function(e){return e.user===t}),n=i.showcase.content.find(function(t){return t.definitionId===e.constants.digitalSignage.conversationsTabDefinitionId&&t.channelThreadId===e.channel.objectId});return e.digitalSignageService.deleteShowcaseContent(e.team.objectId,i.showcase.id,n.id,e.constants.digitalSignage.channelSettings.schemaVersion).then(function(){_.pull(i.showcase.content,n),_.pull(e.displaysOfConversationsContent,i)}).catch(function(t){if(404===t.statusCode&&"SharepointItemDoesNotExist"===t.errorCode)return _.pull(i.showcase.content,n),void _.pull(e.displaysOfConversationsContent,i);e.logger.error(JSON.stringify(t)),e.isErrored=!0})})).then(function(){t.mark(e.constants.scenarios.digitalSignage.step.addingShowcaseContent);var i=e.constants.digitalSignage.conversationsShowcaseUrl+"?teamId="+e.team.objectId+"&channelId="+e.channel.objectId+"&timeFrame="+e.constants.digitalSignage.channelSettings.defaultTimeFrame+"&limitTo="+e.constants.digitalSignage.channelSettings.defaultLimitTo;return Promise.all(_.without.apply(_,n([e.digitalSignageDialogContext.deviceSelection],e.originalDeviceSelection)).map(function(t){var n=e.displaysInTeam.find(function(e){return e.user===t});return e.digitalSignageService.createShowcaseContent(e.team.objectId,n.showcase.id,{channelThreadId:e.channel.objectId,enabled:!0,definitionId:e.constants.digitalSignage.conversationsTabDefinitionId,settings:{websiteUrl:i,url:i}},e.constants.digitalSignage.channelSettings.schemaVersion).then(function(t){n.showcase.content.push(t),e.displaysOfConversationsContent.push(n)}).catch(function(t){e.logger.error(JSON.stringify(t)),e.isErrored=!0})}))}).then(function(){e.isErrored&&t.incomplete(),t.stop(),e.isLoading=!1,e.$scope.closeThisDialog()})},e}();t.DigitalSignageChannelSettingsAddDialogController=s;var o="components/digital-signage-channel-settings-add-dialog/digital-signage-channel-settings-add-dialog.html";angular.module("teamspace.digitalSignageChannelSettingsAddDialog",["teamspace.locales","pascalprecht.translate","teamspace.dialogService","teamspace.constants","teamspace.loggingService","teamspace.digitalSignageService"]).run(["$templateCache",function(e){e.put(o,a)}]).controller("DigitalSignageChannelSettingsAddDialogController",s).run(["constants","dialogService",function(e,t){t.register(e.dialogs.digitalSignageChannelSettingsAdd,{template:o,className:"ts-modal-dialog ts-modal-dialog-container",closeByEscape:!1,closeByDocument:!1,controller:"DigitalSignageChannelSettingsAddDialogController",controllerAs:"ctrl",ariaAuto:!1,ariaRole:"dialog"})}])},2224:function(e,t){e.exports='<div class="digital-signage-channel-settings-add-dialog" data-tid="digitalSignageChannelSettingsAddDialog">\n  <div class="ts-modal-dialog-header">\n    <span class="app-font-family-base ts-modal-dialog-title" translate-once="{{::$root.resources.strings.digital_signage_choose_displays}}">\n    </span>\n  </div>\n  <div class="ts-modal-dialog-content">\n    <digital-signage-device-picker context="ctrl.digitalSignageDialogContext">\n    </digital-signage-device-picker>\n    <div class="app-font-caption-regular device-selected-summary" ng-bind="ctrl.textOfDisplaySelection">\n    </div>\n  </div>\n  <div class="ts-modal-dialog-footer">\n    <div class="ts-modal-dialog-footer-buttons">\n      <busy-animation ng-if="ctrl.isLoading" size="small">\n      </busy-animation>\n      <div class="ts-modal-button-div">\n        <button class="ts-btn ts-btn-fluent ts-btn-fluent-secondary ngdialog-close" ng-disabled="ctrl.isLoading" translate-once="{{::$root.resources.strings.cancel}}">\n        </button>\n      </div>\n      <div class="ts-modal-button-div">\n        <button class="ts-btn ts-btn-fluent ts-btn-fluent-primary" translate-once="{{::$root.resources.strings.digital_signage_choose}}" ng-disabled="ctrl.isLoading || !ctrl.isDeviceSelectionMutated" ng-click="ctrl.chooseDisplaysForConversationsContent()">\n        </button>\n      </div>\n    </div>\n  </div>\n</div>'},2225:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(2226),a=function(){function e(e,t,i,n,a){this.$timeout=i,this.localizationService=n,this.constants=a,this.timePickerSelector="#expiryTimePicker",this.presetDropdownOptions=[{text:e.instant(t.strings.digital_signage_expiration_option_never),value:a.digitalSignage.expiryTime.never},{text:e.instant(t.strings.digital_signage_expiration_option_twentyfourhours),value:a.digitalSignage.expiryTime.afterTwentyFourHours}],this.presetDropdownSelectedValue=a.digitalSignage.expiryTime.never,this.isDateTimePickerEnabled=!this.context.expirationTime,this.switchDateTimePickerAndPresetDropdown()}return e.$inject=["$translate","resources","$timeout","localizationService","constants"],e.prototype.switchDateTimePickerAndPresetDropdown=function(){this.isDateTimePickerEnabled=!this.isDateTimePickerEnabled,this.isDateTimePickerEnabled?this.setupDateTimePicker():this.onPresetDropdownChange()},e.prototype.onPresetDropdownChange=function(){this.presetDropdownSelectedValue===this.constants.digitalSignage.expiryTime.afterTwentyFourHours?this.context.expirationTime=moment().add(1,"days").toDate():this.context.expirationTime=null},e.prototype.onKeyDown=function(e){return!(!e.which||9!==e.which)||(e.preventDefault(),!1)},e.prototype.onDatePickerChange=function(){var e=moment(this.expirationTime,this.localizationService.getDateFormatValue("shortTime",!0)).toDate();this.context.expirationTime=this.combineDateAndTime(this.expirationDate,e);var t="0",i=new Date,n=this.getTimeSnappedToNextHalfHour(i),a=moment(n),s=angular.element(this.timePickerSelector);moment(this.context.expirationTime).isSame(i,"day")&&(t=a.format("HH:mm"),a.day()===moment(i).day()+1&&(this.expirationDate=n,this.context.expirationTime=a.toDate()),s.timepicker("setTime",a.toDate())),s.timepicker("option",{minTime:t})},e.prototype.onTimePickerChange=function(){var e=moment(this.expirationTime,this.localizationService.getDateFormatValue("shortTime",!0)).toDate();this.context.expirationTime=this.combineDateAndTime(this.expirationDate,e)},e.prototype.setupDateTimePicker=function(){var e=this;this.$timeout(function(){var t=e.getTimeSnappedToNextHalfHour(e.context.expirationTime||moment().add(7,"days").toDate());e.expirationDate=moment(t).toDate(),e.context.expirationTime=moment(t).toDate();var i=angular.element(e.timePickerSelector);i.timepicker({showDuration:!1,timeFormat:function(t){return e.localizationService.getDate(t,"shortTime")},maxTime:"23:59"}),i.timepicker("setTime",moment(t).toDate())})},e.prototype.combineDateAndTime=function(e,t){return moment(e).hours(t.getHours()).minutes(t.getMinutes()).milliseconds(0).toDate()},e.prototype.getTimeSnappedToNextHalfHour=function(e){var t=moment(e);return t.minutes()>=30?(t.add(1,"h"),t.minutes(0)):t.minutes(30),t.seconds(0).milliseconds(0).toDate()},e}();t.DigitalSignageExpirationSettingsController=a;var s="components/digital-signage-expiration-settings/digital-signage-expiration-settings.html";angular.module("teamspace.digitalSignageExpirationSettings",["teamspace.constants"]).directive("digitalSignageExpirationSettings",["constants",function(e){return{restrict:"E",scope:{},bindToController:{context:"="},controller:a,controllerAs:"dsCtrl",templateUrl:s}}]).run(["$templateCache",function(e){e.put(s,n)}])},2226:function(e,t){e.exports='<div class="ts-digital-signage-expiration-settings">\n  <div class="preset-options">\n      <div class="control-title" ng-bind="::dsCtrl.context.title"></div>\n\n      <div class="ts-digital-signage-expiration-settings-body">\n        <div class="ts-expiration-settings" ng-if="!dsCtrl.isDateTimePickerEnabled">\n          <div class="control-input repeat-dropdown-container dropdown-container">\n            <dropdown-select ds-text-field="text" ds-highlight-selected-option="true" ds-value-field="value" ds-options="dsCtrl.presetDropdownOptions" ds-selected-value="dsCtrl.presetDropdownSelectedValue" ds-on-change="dsCtrl.onPresetDropdownChange()">\n            </dropdown-select>\n          </div>\n        </div>\n\n        <div class="control-section-col1" ng-if="dsCtrl.isDateTimePickerEnabled">\n          <div class="control-input until-date group-part">\n            <input sanitized type="text" class="until-date end date" data-tid="untilDate" ng-model="dsCtrl.expirationDate" ng-keydown="dsCtrl.onKeyDown($event)" ng-change="dsCtrl.onDatePickerChange()" placeholder="{{::$root.resources.strings.meeting_until_date_placeholder|translate}}" bs-datepicker aria-hidden="false" data-autoclose="true" data-prefix-event="untilDatepicker" data-date-format="mediumDate" data-min-date="today" data-template-url="components/date-picker/date-picker.html"/>\n            <input sanitized id="expiryTimePicker" type="text" class="until-time end time" name="until-time" aria-labelledby="endtimetitle" required aria-atomic="true" aria-relevant="all" ng-model="dsCtrl.expirationTime" ng-keydown="dsCtrl.onKeyDown($event)" ng-change="dsCtrl.onTimePickerChange()" placeholder="{{::$root.resources.strings.meeting_time_placeholder|translate}}"/>\n          </div>\n        </div>\n\n        <button type="button" role="button" acc-role="menu-item" prevent-override-role="true" ng-if="!dsCtrl.isDateTimePickerEnabled" class="ts-sym icons-call app-title-bar-button app-icons-fill-hover app-icons-fill-focus inset-border inset-border-round inset-border-themed" ng-click="dsCtrl.switchDateTimePickerAndPresetDropdown()">\n          <ng-include src="\'svg/icons-calendar.html\'"></ng-include>\n        </button>\n\n        <button type="button" ng-click="dsCtrl.switchDateTimePickerAndPresetDropdown()" role="button" acc-role="sub-menu-item" ng-if="dsCtrl.isDateTimePickerEnabled" class="extension-icon-button focus-round-border ts-sym pull-left app-icons-fill-hover inset-border inset-border-round inset-border-themed compose-stripe-directive" title="{{::$root.resources.strings.edit_message_cancel|translate}}" aria-label="{{::$root.resources.strings.icons_cancel_arialabel|translate}}">\n          <ng-include src="\'svg/icons-close.html\'"></ng-include>\n        </button>\n      </div>\n  </div>\n</div>\n'},2227:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(2228),a=function(){function e(e,t,i){this.$translate=e,this.resources=t,this.constants=i,this.isAnimationSelected=!1,this.title=this.context.title,this.context.animation&&(this.animationSelected=this.context.animation,this.isAnimationSelected=!0),this.checkAnimationLabel=e.instant(t.strings.digital_signage_effects_checkbox_label)||"",this.initializaAnimations()}return e.$inject=["$translate","resources","constants"],e.prototype.initializaAnimations=function(){this.animations=[{key:this.constants.digitalSignage.animationTypes.confetti,label:this.$translate.instant(this.resources.strings.digital_signage_effects_confetti_label),preview:this.constants.digitalSignage.animationAssets.confettiStaticPath,animatedPreview:this.constants.digitalSignage.animationAssets.confettiAnimatedPath},{key:this.constants.digitalSignage.animationTypes.balloons,label:this.$translate.instant(this.resources.strings.digital_signage_effects_balloons_label),preview:this.constants.digitalSignage.animationAssets.balloonsStaticPath,animatedPreview:this.constants.digitalSignage.animationAssets.balloonsAnimatedPath}]},e.prototype.animationToggle=function(){this.isAnimationSelected&&this.updateAnimation(null)},e.prototype.isSelected=function(e){return e===this.animationSelected&&this.isAnimationSelected},e.prototype.updateAnimation=function(e){this.animationSelected=e,this.context.animation=this.animationSelected},e.prototype.setAnimation=function(e){this.updateAnimation(e)},e}();t.DigitalSignageEffectsSettingsController=a;var s="components/digital-signage-effects-settings/digital-signage-effects-settings.html";angular.module("teamspace.digitalSignageEffectsSettings",["teamspace.constants"]).directive("digitalSignageEffectsSettings",["constants",function(e){return{restrict:"E",scope:{},bindToController:{context:"="},controller:a,controllerAs:"dsCtrl",templateUrl:s}}]).run(["$templateCache",function(e){e.put(s,n)}])},2228:function(e,t){e.exports='<div class="ts-digital-signage-effects-settings">\n  <div class="preset-options">\n      <div class="ts-digital-signage-effects-settings-body">\n        <div class="ts-animation-settings">\n            <teams-checkbox ng-model="dsCtrl.isAnimationSelected" ng-click="dsCtrl.animationToggle()" label-text="{{dsCtrl.checkAnimationLabel}}" narator-text="{{dsCtrl.checkAnimationLabel}}"/>\n          <ul role="tablist" acc-role="list">\n           <li ng-repeat="animation in dsCtrl.animations" ng-click="dsCtrl.setAnimation(animation.key)" aria-selected="dsCtrl.selectedAnimation === animation.key" ng-class="{inactive: !dsCtrl.isAnimationSelected}" class="animation-item" acc-role="list-item" role="tab">\n              \x3c!-- <ng-include ng-if="animation.isHover" src="::animation.animatedPreview"/> --\x3e\n              <div class="img-container">\n                <img class="static" ng-class="{selected: dsCtrl.isSelected(animation.key)}" ng-src="{{::animation.preview}}"/>\n                <img class="animated" ng-class="{selected: dsCtrl.isSelected(animation.key)}" ng-src="{{::animation.animatedPreview}}"/>\n              </div>\n              <label ng-class="{inactive: !dsCtrl.isAnimationSelected}" ng-bind="::animation.label"></label>\n            </li>\n          </ul>\n        </div>\n      </div>\n  </div>\n</div>\n'}},[2206]);